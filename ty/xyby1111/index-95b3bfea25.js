!function(){"use strict";function P(e){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function y(e,t,i){return t&&B(e.prototype,t),i&&B(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&D(e,t)}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function D(e,t){return(D=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function T(i){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=g(i),t=(e=n?(e=g(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return O(t)}}function F(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=g(e)););return e}function m(){return(m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=F(e,t);if(n)return n=Object.getOwnPropertyDescriptor(n,t),n.get?n.get.call(arguments.length<3?e:i):n.value}).apply(this,arguments)}function V(e,t,i,n){return(V="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(e,t,i,n){var a,e=F(e,t);if(e){if((a=Object.getOwnPropertyDescriptor(e,t)).set)return a.set.call(n,i),!0;if(!a.writable)return!1}if(a=Object.getOwnPropertyDescriptor(n,t)){if(!a.writable)return!1;a.value=i,Object.defineProperty(n,t,a)}else e=i,(a=t)in(i=n)?Object.defineProperty(i,a,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[a]=e;return!0})(e,t,i,n)}function U(e,t,i,n,a){if(!V(e,t,i,n||e)&&a)throw new Error("failed to set property")}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function Y(e,t){var i,n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return z(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(i="Object"===i&&e.constructor?e.constructor.name:i)||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?z(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length)return n&&(e=n),i=0,{s:t=function(){},n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,r=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){r=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(r)throw a}}}}var G,X,W,L=function(){function t(){b(this,t)}return y(t,null,[{key:"regClass",value:function(e){t.__classMap[e.name]=e}}]),t}(),p=(L.Laya=null,L.Timer=null,L.WorkerLoader=null,L.Dragging=null,L.GraphicsBounds=null,L.Sprite=null,L.TextRender=null,L.TextAtlas=null,L.timer=null,L.systemTimer=null,L.startTimer=null,L.updateTimer=null,L.lateTimer=null,L.physicsTimer=null,L.stage=null,L.Loader=null,L.loader=null,L.TTFLoader=null,L.SoundManager=null,L.WebAudioSound=null,L.AudioSound=null,L.ShaderCompile=null,L.ClassUtils=null,L.SceneUtils=null,L.Context=null,L.Render=null,L.MouseManager=null,L.Text=null,L.Browser=null,L.WebGL=null,L.Pool=null,L.Utils=null,L.Graphics=null,L.Submit=null,L.Stage=null,L.Resource=null,L.__classMap={},function(){function n(){b(this,n)}return y(n,null,[{key:"getPoolBySign",value:function(e){return n._poolDic[e]||(n._poolDic[e]=[])}},{key:"clearBySign",value:function(e){n._poolDic[e]&&(n._poolDic[e].length=0)}},{key:"recover",value:function(e,t){t[n.POOLSIGN]||(t[n.POOLSIGN]=!0,n.getPoolBySign(e).push(t))}},{key:"recoverByClass",value:function(e){var t;e&&(t=e.__className||e.constructor._$gid)&&n.recover(t,e)}},{key:"_getClassSign",value:function(e){var t=e.__className||e._$gid;return t||(e._$gid=t=n._CLSID+"",n._CLSID++),t}},{key:"createByClass",value:function(e){return n.getItemByClass(n._getClassSign(e),e)}},{key:"getItemByClass",value:function(e,t){if(!n._poolDic[e])return new t;var i,e=n.getPoolBySign(e);return e.length?(i=e.pop())[n.POOLSIGN]=!1:i=new t,i}},{key:"getItemByCreateFun",value:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,e=n.getPoolBySign(e),e=e.length?e.pop():t.call(i);return e[n.POOLSIGN]=!1,e}},{key:"getItem",value:function(e){e=n.getPoolBySign(e),e=e.length?e.pop():null;return e&&(e[n.POOLSIGN]=!1),e}}]),n}()),H=(p._CLSID=0,p.POOLSIGN="__InPool",p._poolDic={},function(){function i(){b(this,i)}return y(i,[{key:"recover",value:function(){p.recover("AlphaCmd",this)}},{key:"run",value:function(e,t,i){e.alpha(this.alpha)}},{key:"cmdID",get:function(){return i.ID}}],[{key:"create",value:function(e){var t=p.getItemByClass("AlphaCmd",i);return t.alpha=e,t}}]),i}()),j=(H.ID="Alpha",function(){function h(){b(this,h)}return y(h,[{key:"recover",value:function(){this.fillColor=null,this.lineColor=null,p.recover("DrawCircleCmd",this)}},{key:"run",value:function(e,t,i){e._drawCircle(this.x+t,this.y+i,this.radius,this.fillColor,this.lineColor,this.lineWidth,this.vid)}},{key:"cmdID",get:function(){return h.ID}}],[{key:"create",value:function(e,t,i,n,a,s,r){var o=p.getItemByClass("DrawCircleCmd",h);return o.x=e,o.y=t,o.radius=i,o.fillColor=n,o.lineColor=a,o.lineWidth=s,o.vid=r,o}}]),h}()),q=(j.ID="DrawCircle",function(){function r(){b(this,r)}return y(r,[{key:"recover",value:function(){this.points=null,this.lineColor=null,p.recover("DrawCurvesCmd",this)}},{key:"run",value:function(e,t,i){this.points&&e.drawCurves(this.x+t,this.y+i,this.points,this.lineColor,this.lineWidth)}},{key:"cmdID",get:function(){return r.ID}}],[{key:"create",value:function(e,t,i,n,a){var s=p.getItemByClass("DrawCurvesCmd",r);return s.x=e,s.y=t,s.points=i,s.lineColor=n,s.lineWidth=a,s}}]),r}()),K=(q.ID="DrawCurves",function(){function r(){b(this,r)}return y(r,[{key:"recover",value:function(){this.texture&&this.texture._removeReference(),this.texture=null,p.recover("DrawImageCmd",this)}},{key:"run",value:function(e,t,i){this.texture&&e.drawTexture(this.texture,this.x+t,this.y+i,this.width,this.height)}},{key:"cmdID",get:function(){return r.ID}}],[{key:"create",value:function(e,t,i,n,a){var s=p.getItemByClass("DrawImageCmd",r);return(s.texture=e)._addReference(),s.x=t,s.y=i,s.width=n,s.height=a,s}}]),r}()),Q=(K.ID="DrawImage",function(){function h(){b(this,h)}return y(h,[{key:"recover",value:function(){p.recover("DrawLineCmd",this)}},{key:"run",value:function(e,t,i){e._drawLine(t,i,this.fromX,this.fromY,this.toX,this.toY,this.lineColor,this.lineWidth,this.vid)}},{key:"cmdID",get:function(){return h.ID}}],[{key:"create",value:function(e,t,i,n,a,s,r){var o=p.getItemByClass("DrawLineCmd",h);return o.fromX=e,o.fromY=t,o.toX=i,o.toY=n,o.lineColor=a,o.lineWidth=s,o.vid=r,o}}]),h}()),Z=(Q.ID="DrawLine",function(){function o(){b(this,o)}return y(o,[{key:"recover",value:function(){this.points=null,this.lineColor=null,p.recover("DrawLinesCmd",this)}},{key:"run",value:function(e,t,i){this.points&&e._drawLines(this.x+t,this.y+i,this.points,this.lineColor,this.lineWidth,this.vid)}},{key:"cmdID",get:function(){return o.ID}}],[{key:"create",value:function(e,t,i,n,a,s){var r=p.getItemByClass("DrawLinesCmd",o);return r.x=e,r.y=t,r.points=i,r.lineColor=n,r.lineWidth=a,r.vid=s,r}}]),o}()),J=(Z.ID="DrawLines",function(){function r(){b(this,r)}return y(r,[{key:"recover",value:function(){this.paths=null,this.brush=null,this.pen=null,p.recover("DrawPathCmd",this)}},{key:"run",value:function(e,t,i){this.paths&&e._drawPath(this.x+t,this.y+i,this.paths,this.brush,this.pen)}},{key:"cmdID",get:function(){return r.ID}}],[{key:"create",value:function(e,t,i,n,a){var s=p.getItemByClass("DrawPathCmd",r);return s.x=e,s.y=t,s.paths=i,s.brush=n,s.pen=a,s}}]),r}()),$=(J.ID="DrawPath",function(){function u(){b(this,u)}return y(u,[{key:"recover",value:function(){this.fillColor=null,this.lineColor=null,p.recover("DrawPieCmd",this)}},{key:"run",value:function(e,t,i){e._drawPie(this.x+t,this.y+i,this.radius,this._startAngle,this._endAngle,this.fillColor,this.lineColor,this.lineWidth,this.vid)}},{key:"cmdID",get:function(){return u.ID}},{key:"startAngle",get:function(){return 180*this._startAngle/Math.PI},set:function(e){this._startAngle=e*Math.PI/180}},{key:"endAngle",get:function(){return 180*this._endAngle/Math.PI},set:function(e){this._endAngle=e*Math.PI/180}}],[{key:"create",value:function(e,t,i,n,a,s,r,o,h){var l=p.getItemByClass("DrawPieCmd",u);return l.x=e,l.y=t,l.radius=i,l._startAngle=n,l._endAngle=a,l.fillColor=s,l.lineColor=r,l.lineWidth=o,l.vid=h,l}}]),u}()),ee=($.ID="DrawPie",function(){function l(){b(this,l)}return y(l,[{key:"recover",value:function(){this.points=null,this.fillColor=null,this.lineColor=null,p.recover("DrawPolyCmd",this)}},{key:"run",value:function(e,t,i){this.points&&e._drawPoly(this.x+t,this.y+i,this.points,this.fillColor,this.lineColor,this.lineWidth,this.isConvexPolygon,this.vid)}},{key:"cmdID",get:function(){return l.ID}}],[{key:"create",value:function(e,t,i,n,a,s,r,o){var h=p.getItemByClass("DrawPolyCmd",l);return h.x=e,h.y=t,h.points=i,h.fillColor=n,h.lineColor=a,h.lineWidth=s,h.isConvexPolygon=r,h.vid=o,h}}]),l}()),te=(ee.ID="DrawPoly",function(){function h(){b(this,h)}return y(h,[{key:"recover",value:function(){this.fillColor=null,this.lineColor=null,p.recover("DrawRectCmd",this)}},{key:"run",value:function(e,t,i){e.drawRect(this.x+t,this.y+i,this.width,this.height,this.fillColor,this.lineColor,this.lineWidth)}},{key:"cmdID",get:function(){return h.ID}}],[{key:"create",value:function(e,t,i,n,a,s,r){var o=p.getItemByClass("DrawRectCmd",h);return o.x=e,o.y=t,o.width=i,o.height=n,o.fillColor=a,o.lineColor=s,o.lineWidth=r,o}}]),h}()),Ce=(te.ID="DrawRect",function(){function o(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,r=6<arguments.length&&void 0!==arguments[6]?arguments[6]:0;if(b(this,o),this._bTransform=!1,null!=o._createFun)return o._createFun(e,t,i,n,a,s,r);this.a=e,this.b=t,this.c=i,this.d=n,this.tx=a,this.ty=s,this._checkTransform()}return y(o,[{key:"identity",value:function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this._bTransform=!1,this}},{key:"_checkTransform",value:function(){return this._bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d}},{key:"setTranslate",value:function(e,t){return this.tx=e,this.ty=t,this}},{key:"translate",value:function(e,t){return this.tx+=e,this.ty+=t,this}},{key:"scale",value:function(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this._bTransform=!0,this}},{key:"rotate",value:function(e){var t=Math.cos(e),e=Math.sin(e),i=this.a,n=this.c,a=this.tx;return this.a=i*t-this.b*e,this.b=i*e+this.b*t,this.c=n*t-this.d*e,this.d=n*e+this.d*t,this.tx=a*t-this.ty*e,this.ty=a*e+this.ty*t,this._bTransform=!0,this}},{key:"skew",value:function(e,t){var e=Math.tan(e),t=Math.tan(t),i=this.a,n=this.b;return this.a+=t*this.c,this.b+=t*this.d,this.c+=e*i,this.d+=e*n,this}},{key:"invertTransformPoint",value:function(e){var t=this.a,i=this.b,n=this.c,a=this.d,s=this.tx,r=t*a-i*n,o=(n*this.ty-a*s)/r,s=-(t*this.ty-i*s)/r;return e.setTo(a/r*e.x+-n/r*e.y+o,-i/r*e.x+t/r*e.y+s)}},{key:"transformPoint",value:function(e){return e.setTo(this.a*e.x+this.c*e.y+this.tx,this.b*e.x+this.d*e.y+this.ty)}},{key:"transformPointN",value:function(e){return e.setTo(this.a*e.x+this.c*e.y,this.b*e.x+this.d*e.y)}},{key:"getScaleX",value:function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)}},{key:"getScaleY",value:function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)}},{key:"invert",value:function(){var e=this.a,t=this.b,i=this.c,n=this.d,a=this.tx,s=e*n-t*i;return this.a=n/s,this.b=-t/s,this.c=-i/s,this.d=e/s,this.tx=(i*this.ty-n*a)/s,this.ty=-(e*this.ty-t*a)/s,this}},{key:"setTo",value:function(e,t,i,n,a,s){return this.a=e,this.b=t,this.c=i,this.d=n,this.tx=a,this.ty=s,this}},{key:"concat",value:function(e){var t=this.a,i=this.c,n=this.tx;return this.a=t*e.a+this.b*e.c,this.b=t*e.b+this.b*e.d,this.c=i*e.a+this.d*e.c,this.d=i*e.b+this.d*e.d,this.tx=n*e.a+this.ty*e.c+e.tx,this.ty=n*e.b+this.ty*e.d+e.ty,this}},{key:"scaleEx",value:function(e,t){var i=this.a,n=this.b,a=this.c,s=this.d;0!==n||0!==a?(this.a=e*i,this.b=e*n,this.c=t*a):(this.a=e*i,this.b=0*s,this.c=0*i),this.d=t*s,this._bTransform=!0}},{key:"rotateEx",value:function(e){var t=Math.cos(e),e=Math.sin(e),i=this.a,n=this.b,a=this.c,s=this.d;0!==n||0!==a?(this.a=t*i+e*a,this.b=t*n+e*s,this.c=-e*i+t*a,this.d=-e*n+t*s):(this.a=t*i,this.b=e*s,this.c=-e*i,this.d=t*s),this._bTransform=!0}},{key:"clone",value:function(){var e=o.create();return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e._bTransform=this._bTransform,e}},{key:"copyTo",value:function(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e._bTransform=this._bTransform,e}},{key:"toString",value:function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty}},{key:"destroy",value:function(){this.recover()}},{key:"recover",value:function(){p.recover("Matrix",this.identity())}}],[{key:"mul",value:function(e,t,i){var n=e.a,a=e.b,s=e.c,r=e.d,o=e.tx,e=e.ty,h=t.a,l=t.b,u=t.c,c=t.d,_=t.tx,t=t.ty;return 0!==l||0!==u?(i.a=n*h+a*u,i.b=n*l+a*c,i.c=s*h+r*u,i.d=s*l+r*c,i.tx=h*o+u*e+_,i.ty=l*o+c*e+t):(i.a=n*h,i.b=a*c,i.c=s*h,i.d=r*c,i.tx=h*o+_,i.ty=c*e+t),i}},{key:"mul16",value:function(e,t,i){var n=e.a,a=e.b,s=e.c,r=e.d,o=e.tx,e=e.ty,h=t.a,l=t.b,u=t.c,c=t.d,_=t.tx,t=t.ty;return 0!==l||0!==u?(i[0]=n*h+a*u,i[1]=n*l+a*c,i[4]=s*h+r*u,i[5]=s*l+r*c,i[12]=h*o+u*e+_,i[13]=l*o+c*e+t):(i[0]=n*h,i[1]=a*c,i[4]=s*h,i[5]=r*c,i[12]=h*o+_,i[13]=c*e+t),i}},{key:"create",value:function(){return p.getItemByClass("Matrix",o)}}]),o}()),ie=(Ce.EMPTY=new Ce,Ce.TEMP=new Ce,Ce._createFun=null,function(){function i(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;b(this,i),this.x=e,this.y=t}return y(i,[{key:"setTo",value:function(e,t){return this.x=e,this.y=t,this}},{key:"reset",value:function(){return this.x=this.y=0,this}},{key:"recover",value:function(){p.recover("Point",this.reset())}},{key:"distance",value:function(e,t){return Math.sqrt((this.x-e)*(this.x-e)+(this.y-t)*(this.y-t))}},{key:"toString",value:function(){return this.x+","+this.y}},{key:"normalize",value:function(){var e=Math.sqrt(this.x*this.x+this.y*this.y);0<e&&(this.x*=e=1/e,this.y*=e)}},{key:"copy",value:function(e){return this.setTo(e.x,e.y)}}],[{key:"create",value:function(){return p.getItemByClass("Point",i)}}]),i}()),ne=(ie.TEMP=new ie,ie.EMPTY=new ie,function(){function l(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;b(this,l),this.x=e,this.y=t,this.width=i,this.height=n}return y(l,[{key:"right",get:function(){return this.x+this.width}},{key:"bottom",get:function(){return this.y+this.height}},{key:"setTo",value:function(e,t,i,n){return this.x=e,this.y=t,this.width=i,this.height=n,this}},{key:"reset",value:function(){return this.x=this.y=this.width=this.height=0,this}},{key:"recover",value:function(){this==l.TEMP||this==l.EMPTY?console.log("recover Temp or Empty:",this):p.recover("Rectangle",this.reset())}},{key:"copyFrom",value:function(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}},{key:"contains",value:function(e,t){return!(this.width<=0||this.height<=0)&&(e>=this.x&&e<this.right&&t>=this.y&&t<this.bottom)}},{key:"intersects",value:function(e){return!(e.x>this.x+this.width||e.x+e.width<this.x||e.y>this.y+this.height||e.y+e.height<this.y)}},{key:"intersection",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return this.intersects(e)?((t=t||new l).x=Math.max(this.x,e.x),t.y=Math.max(this.y,e.y),t.width=Math.min(this.right,e.right)-t.x,t.height=Math.min(this.bottom,e.bottom)-t.y,t):null}},{key:"union",value:function(e){var t=(t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null)||new l;return this.clone(t),e.width<=0||e.height<=0?t:(t.addPoint(e.x,e.y),t.addPoint(e.right,e.bottom),this)}},{key:"clone",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;return(e=e||new l).x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}},{key:"toString",value:function(){return this.x+","+this.y+","+this.width+","+this.height}},{key:"equals",value:function(e){return!(!e||e.x!==this.x||e.y!==this.y||e.width!==this.width||e.height!==this.height)}},{key:"addPoint",value:function(e,t){return this.x>e&&(this.width+=this.x-e,this.x=e),this.y>t&&(this.height+=this.y-t,this.y=t),this.width<e-this.x&&(this.width=e-this.x),this.height<t-this.y&&(this.height=t-this.y),this}},{key:"_getBoundPoints",value:function(){var e=l._temB;return(e.length=0)==this.width||0==this.height||e.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),e}},{key:"isEmpty",value:function(){return this.width<=0||this.height<=0}}],[{key:"create",value:function(){return p.getItemByClass("Rectangle",l)}},{key:"_getBoundPointS",value:function(e,t,i,n){var a=l._temA;return(a.length=0)==i||0==n||a.push(e,t,e+i,t,e,t+n,e+i,t+n),a}},{key:"_getWrapRec",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if(!e||e.length<1)return(t||l.TEMP).setTo(0,0,0,0);for(var i,n,t=t||l.create(),a=e.length,s=ie.TEMP,r=i=99999,o=n=-r,h=0;h<a;h+=2)s.x=e[h],s.y=e[h+1],r=r<s.x?r:s.x,i=i<s.y?i:s.y,o=o>s.x?o:s.x,n=n>s.y?n:s.y;return t.setTo(r,i,o-r,n-i)}}]),l}()),S=(ne.EMPTY=new ne,ne.TEMP=new ne,ne._temB=[],ne._temA=[],y(function e(){b(this,e)})),v=(S.ARRAY_BUFFER_TYPE_DATA=0,S.ARRAY_BUFFER_TYPE_CMD=1,S.ARRAY_BUFFER_REF_REFERENCE=0,S.ARRAY_BUFFER_REF_COPY=1,S.UPLOAD_SHADER_UNIFORM_TYPE_ID=0,S.UPLOAD_SHADER_UNIFORM_TYPE_DATA=1,function(){function s(){b(this,s)}return y(s,null,[{key:"__init__",value:function(){var e=S.instance;s._depthFunc=e.LESS,s._blendEquation=e.FUNC_ADD,s._blendEquationRGB=e.FUNC_ADD,s._blendEquationAlpha=e.FUNC_ADD,s._sFactor=e.ONE,s._dFactor=e.ZERO,s._sFactorAlpha=e.ONE,s._dFactorAlpha=e.ZERO,s._activedTextureID=e.TEXTURE0,s._glTextureIDs=[e.TEXTURE0,e.TEXTURE1,e.TEXTURE2,e.TEXTURE3,e.TEXTURE4,e.TEXTURE5,e.TEXTURE6,e.TEXTURE7]}},{key:"useProgram",value:function(e,t){return s._useProgram!==t&&(e.useProgram(t),s._useProgram=t,!0)}},{key:"setDepthTest",value:function(e,t){t!==s._depthTest&&((s._depthTest=t)?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST))}},{key:"setDepthMask",value:function(e,t){t!==s._depthMask&&(s._depthMask=t,e.depthMask(t))}},{key:"setDepthFunc",value:function(e,t){t!==s._depthFunc&&(s._depthFunc=t,e.depthFunc(t))}},{key:"setBlend",value:function(e,t){t!==s._blend&&((s._blend=t)?e.enable(e.BLEND):e.disable(e.BLEND))}},{key:"setBlendEquation",value:function(e,t){t!==s._blendEquation&&(s._blendEquation=t,s._blendEquationRGB=s._blendEquationAlpha=null,e.blendEquation(t))}},{key:"setBlendEquationSeparate",value:function(e,t,i){t===s._blendEquationRGB&&i===s._blendEquationAlpha||(s._blendEquationRGB=t,s._blendEquationAlpha=i,s._blendEquation=null,e.blendEquationSeparate(t,i))}},{key:"setBlendFunc",value:function(e,t,i){t===s._sFactor&&i===s._dFactor||(s._sFactor=t,s._dFactor=i,s._sFactorRGB=null,s._dFactorRGB=null,s._sFactorAlpha=null,s._dFactorAlpha=null,e.blendFunc(t,i))}},{key:"setBlendFuncSeperate",value:function(e,t,i,n,a){t===s._sFactorRGB&&i===s._dFactorRGB&&n===s._sFactorAlpha&&a===s._dFactorAlpha||(s._sFactorRGB=t,s._dFactorRGB=i,s._sFactorAlpha=n,s._dFactorAlpha=a,s._sFactor=null,s._dFactor=null,e.blendFuncSeparate(t,i,n,a))}},{key:"setCullFace",value:function(e,t){t!==s._cullFace&&((s._cullFace=t)?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE))}},{key:"setFrontFace",value:function(e,t){t!==s._frontFace&&(s._frontFace=t,e.frontFace(t))}},{key:"activeTexture",value:function(e,t){s._activedTextureID!==t&&(e.activeTexture(t),s._activedTextureID=t)}},{key:"bindTexture",value:function(e,t,i){s._activeTextures[s._activedTextureID-e.TEXTURE0]!==i&&(e.bindTexture(t,i),s._activeTextures[s._activedTextureID-e.TEXTURE0]=i)}},{key:"__init_native",value:function(){var e;L.Render.supportWebGLPlusRendering&&((e=s).activeTexture=e.activeTextureForNative,e.bindTexture=e.bindTextureForNative)}},{key:"useProgramForNative",value:function(e,t){return e.useProgram(t),!0}},{key:"setDepthTestForNative",value:function(e,t){t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST)}},{key:"setDepthMaskForNative",value:function(e,t){e.depthMask(t)}},{key:"setDepthFuncForNative",value:function(e,t){e.depthFunc(t)}},{key:"setBlendForNative",value:function(e,t){t?e.enable(e.BLEND):e.disable(e.BLEND)}},{key:"setBlendFuncForNative",value:function(e,t,i){e.blendFunc(t,i)}},{key:"setCullFaceForNative",value:function(e,t){t?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE)}},{key:"setFrontFaceForNative",value:function(e,t){e.frontFace(t)}},{key:"activeTextureForNative",value:function(e,t){e.activeTexture(t)}},{key:"bindTextureForNative",value:function(e,t,i){e.bindTexture(t,i)}},{key:"bindVertexArrayForNative",value:function(e,t){e.bindVertexArray(t)}}]),s}()),x=(v._activeTextures=new Array(8),v._useProgram=null,v._depthTest=!0,v._depthMask=!0,v._blend=!1,v._cullFace=!1,v.mainContext=null,function(){function a(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=3<arguments.length&&void 0!==arguments[3]&&arguments[3];b(this,a),this.once=!1,this._id=0,this.setTo(e,t,i,n)}return y(a,[{key:"setTo",value:function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]&&arguments[3];return this._id=a._gid++,this.caller=e,this.method=t,this.args=i,this.once=n,this}},{key:"run",value:function(){if(null==this.method)return null;var e=this._id,t=this.method.apply(this.caller,this.args);return this._id===e&&this.once&&this.recover(),t}},{key:"runWith",value:function(e){if(null==this.method)return null;var t=this._id,e=null==e?this.method.apply(this.caller,this.args):this.args||e.unshift?this.args?this.method.apply(this.caller,this.args.concat(e)):this.method.apply(this.caller,e):this.method.call(this.caller,e);return this._id===t&&this.once&&this.recover(),e}},{key:"clear",value:function(){return this.caller=null,this.method=null,this.args=null,this}},{key:"recover",value:function(){0<this._id&&(this._id=0,a._pool.push(this.clear()))}}],[{key:"create",value:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=!(3<arguments.length&&void 0!==arguments[3])||arguments[3];return a._pool.length?a._pool.pop().setTo(e,t,i,n):new a(e,t,i,n)}}]),a}()),ae=(x._pool=[],x._gid=1,function(){function t(){b(this,t)}return y(t,[{key:"hasListener",value:function(e){return!!(this._events&&this._events[e])}},{key:"event",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if(!this._events||!this._events[e])return!1;var i=this._events[e];if(i.run)i.once&&delete this._events[e],null!=t?i.runWith(t):i.run();else{for(var n=0,a=i.length;n<a;n++){var s=i[n];s&&(null!=t?s.runWith(t):s.run()),s&&!s.once||(i.splice(n,1),n--,a--)}0===i.length&&this._events&&delete this._events[e]}return!0}},{key:"on",value:function(e,t,i){return this._createListener(e,t,i,3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,!1)}},{key:"once",value:function(e,t,i){return this._createListener(e,t,i,3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,!0)}},{key:"_createListener",value:function(e,t,i,n,a){5<arguments.length&&void 0!==arguments[5]&&!arguments[5]||this.off(e,t,i,a);t=se.create(t||this,i,n,a),this._events||(this._events={}),i=this._events;return i[e]?i[e].run?i[e]=[i[e],t]:i[e].push(t):i[e]=t,this}},{key:"off",value:function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]&&arguments[3];if(!this._events||!this._events[e])return this;var a=this._events[e];if(null!=a)if(a.run)t&&a.caller!==t||null!=i&&a.method!==i||n&&!a.once||(delete this._events[e],a.recover());else{for(var s=0,r=0,o=a.length;r<o;r++){var h=a[r];h?!h||t&&h.caller!==t||null!=i&&h.method!==i||n&&!h.once||(s++,a[r]=null,h.recover()):s++}s===o&&delete this._events[e]}return this}},{key:"offAll",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=this._events;if(!t)return this;if(e)this._recoverHandlers(t[e]),delete t[e];else{for(var i in t)this._recoverHandlers(t[i]);this._events=null}return this}},{key:"offAllCaller",value:function(e){if(e&&this._events)for(var t in this._events)this.off(t,e,null);return this}},{key:"_recoverHandlers",value:function(e){if(e)if(e.run)e.recover();else for(var t=e.length-1;-1<t;t--)e[t]&&(e[t].recover(),e[t]=null)}},{key:"isMouseEvent",value:function(e){return t.MOUSE_EVENTS[e]||!1}}]),t}()),se=(ae.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},function(){f(s,x);var a=T(s);function s(e,t,i,n){return b(this,s),a.call(this,e,t,i,n)}return y(s,[{key:"recover",value:function(){0<this._id&&(this._id=0,s._pool.push(this.clear()))}}],[{key:"create",value:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=!(3<arguments.length&&void 0!==arguments[3])||arguments[3];return s._pool.length?s._pool.pop().setTo(e,t,i,n):new s(e,t,i,n)}}]),s}()),re=(se._pool=[],function(){function a(e){b(this,a),this._url=a.formatURL(e),this._path=a.getPath(e)}return y(a,[{key:"url",get:function(){return this._url}},{key:"path",get:function(){return this._path}}],[{key:"basePath",get:function(){return a._basePath},set:function(e){a._basePath=L.Laya._getUrlPath(),a._basePath=a.formatURL(e)}},{key:"formatURL",value:function(e){if(!e)return"null path";if(0<e.indexOf(":"))return e;if(0<(e=null!=a.customFormat?a.customFormat(e):e).indexOf(":"))return e;var t=e.charAt(0);if("."===t)return a._formatRelativePath(a._basePath+e);if("~"===t)return a.rootPath+e.substring(1);if("d"===t){if(0===e.indexOf("data:image"))return e}else if("/"===t)return e;return a._basePath+e}},{key:"_formatRelativePath",value:function(e){for(var t=e.split("/"),i=0,n=t.length;i<n;i++)".."==t[i]&&(t.splice(i-1,2),i-=2);return t.join("/")}},{key:"getPath",value:function(e){var t=e.lastIndexOf("/");return 0<t?e.substr(0,t+1):""}},{key:"getFileName",value:function(e){var t=e.lastIndexOf("/");return 0<t?e.substr(t+1):e}},{key:"getAdptedFilePath",value:function(e){if(!a.exportSceneToJson||!e)return e;for(var t,i=a._adpteTypeList.length,n=0;n<i;n++)t=a._adpteTypeList[n],e=e.replace(t[0],t[1]);return e}}]),a}()),oe=(re.version={},re.exportSceneToJson=!1,re._basePath="",re.rootPath="",re.customFormat=function(e){var t=re.version[e];return!window.conch&&t&&(e+="?v="+t),e},re._adpteTypeList=[[".scene3d",".json"],[".scene",".json"],[".taa",".json"],[".prefab",".json"]],function(){f(i,ae);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this))._id=0,e._url=null,e._cpuMemory=0,e._gpuMemory=0,e._destroyed=!1,e._referenceCount=0,e.lock=!1,e.name=null,e._id=++i._uniqueIDCounter,e._destroyed=!1,e._referenceCount=0,i._idResourcesMap[e.id]=O(e),e.lock=!1,e}return y(i,[{key:"id",get:function(){return this._id}},{key:"url",get:function(){return this._url}},{key:"cpuMemory",get:function(){return this._cpuMemory}},{key:"gpuMemory",get:function(){return this._gpuMemory}},{key:"destroyed",get:function(){return this._destroyed}},{key:"referenceCount",get:function(){return this._referenceCount}},{key:"_setCPUMemory",value:function(e){var t=e-this._cpuMemory;this._cpuMemory=e,i._addCPUMemory(t)}},{key:"_setGPUMemory",value:function(e){var t=e-this._gpuMemory;this._gpuMemory=e,i._addGPUMemory(t)}},{key:"_setCreateURL",value:function(e){var t;e=re.formatURL(e),this._url!==e&&(this._url&&((t=i._urlResourcesMap[this._url]).splice(t.indexOf(this),1),0===t.length&&delete i._urlResourcesMap[this._url]),e&&((t=i._urlResourcesMap[e])||(i._urlResourcesMap[e]=t=[]),t.push(this)),this._url=e)}},{key:"_addReference",value:function(){this._referenceCount+=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1}},{key:"_removeReference",value:function(){this._referenceCount-=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1}},{key:"_clearReference",value:function(){this._referenceCount=0}},{key:"_recoverResource",value:function(){}},{key:"_disposeResource",value:function(){}},{key:"_activeResource",value:function(){}},{key:"destroy",value:function(){var e;this._destroyed||(this._destroyed=!0,this.lock=!1,this._disposeResource(),delete i._idResourcesMap[this.id],this._url&&((e=i._urlResourcesMap[this._url])&&(e.splice(e.indexOf(this),1),0===e.length&&delete i._urlResourcesMap[this._url]),L.Loader.loadedMap[this._url]==this&&delete L.Loader.loadedMap[this._url]))}}],[{key:"cpuMemory",get:function(){return i._cpuMemory}},{key:"gpuMemory",get:function(){return i._gpuMemory}},{key:"_addCPUMemory",value:function(e){i._cpuMemory+=e}},{key:"_addGPUMemory",value:function(e){i._gpuMemory+=e}},{key:"_addMemory",value:function(e,t){i._cpuMemory+=e,i._gpuMemory+=t}},{key:"getResourceByID",value:function(e){return i._idResourcesMap[e]}},{key:"getResourceByURL",value:function(e){return i._urlResourcesMap[e][1<arguments.length&&void 0!==arguments[1]?arguments[1]:0]}},{key:"destroyUnusedResources",value:function(){for(var e in i._idResourcesMap){e=i._idResourcesMap[e];e.lock||0!==e._referenceCount||e.destroy()}}}]),i}()),he=(oe._uniqueIDCounter=0,oe._idResourcesMap={},oe._urlResourcesMap={},oe._cpuMemory=0,oe._gpuMemory=0,function(){f(i,oe);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this))._width=-1,e._height=-1,e}return y(i,[{key:"width",get:function(){return this._width},set:function(e){this._width=e}},{key:"height",get:function(){return this._height},set:function(e){this._height=e}},{key:"_getSource",value:function(){throw"Bitmap: must override it."}}]),i}()),le=((e=G=G||{})[e.R8G8B8=0]="R8G8B8",e[e.R8G8B8A8=1]="R8G8B8A8",e[e.Alpha8=2]="Alpha8",e[e.DXT1=3]="DXT1",e[e.DXT5=4]="DXT5",e[e.ETC1RGB=5]="ETC1RGB",e[e.PVRTCRGB_2BPPV=9]="PVRTCRGB_2BPPV",e[e.PVRTCRGBA_2BPPV=10]="PVRTCRGBA_2BPPV",e[e.PVRTCRGB_4BPPV=11]="PVRTCRGB_4BPPV",e[e.PVRTCRGBA_4BPPV=12]="PVRTCRGBA_4BPPV",e[e.R32G32B32A32=15]="R32G32B32A32",function(){f(a,he);var n=T(a);function a(e,t){var i;return b(this,a),(i=n.call(this))._wrapModeU=a.WARPMODE_REPEAT,i._wrapModeV=a.WARPMODE_REPEAT,i._filterMode=a.FILTERMODE_BILINEAR,i._readyed=!1,i._width=-1,i._height=-1,i._format=e,i._mipmap=t,i._anisoLevel=1,i._glTexture=S.instance.createTexture(),i}return y(a,[{key:"mipmap",get:function(){return this._mipmap}},{key:"format",get:function(){return this._format}},{key:"wrapModeU",get:function(){return this._wrapModeU},set:function(e){this._wrapModeU!==e&&(this._wrapModeU=e,-1!==this._width&&this._setWarpMode(S.instance.TEXTURE_WRAP_S,e))}},{key:"wrapModeV",get:function(){return this._wrapModeV},set:function(e){this._wrapModeV!==e&&(this._wrapModeV=e,-1!==this._height&&this._setWarpMode(S.instance.TEXTURE_WRAP_T,e))}},{key:"filterMode",get:function(){return this._filterMode},set:function(e){e!==this._filterMode&&(this._filterMode=e,-1!==this._width&&-1!==this._height&&this._setFilterMode(e))}},{key:"anisoLevel",get:function(){return this._anisoLevel},set:function(e){e!==this._anisoLevel&&(this._anisoLevel=Math.max(1,Math.min(16,e)),-1!==this._width&&-1!==this._height&&this._setAnisotropy(e))}},{key:"mipmapCount",get:function(){return this._mipmapCount}},{key:"defaulteTexture",get:function(){throw"BaseTexture:must override it."}},{key:"_getFormatByteCount",value:function(){switch(this._format){case G.R8G8B8:return 3;case G.R8G8B8A8:return 4;case G.Alpha8:return 1;case G.R32G32B32A32:return 4;default:throw"Texture2D: unknown format."}}},{key:"_isPot",value:function(e){return 0==(e&e-1)}},{key:"_getGLFormat",value:function(){var e,t=S.instance,i=S.layaGPUInstance;switch(this._format){case G.R8G8B8:e=t.RGB;break;case G.R8G8B8A8:e=t.RGBA;break;case G.Alpha8:e=t.ALPHA;break;case G.R32G32B32A32:e=t.RGBA;break;case G.DXT1:if(!i._compressedTextureS3tc)throw"BaseTexture: not support DXT1 format.";e=i._compressedTextureS3tc.COMPRESSED_RGB_S3TC_DXT1_EXT;break;case G.DXT5:if(!i._compressedTextureS3tc)throw"BaseTexture: not support DXT5 format.";e=i._compressedTextureS3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT;break;case G.ETC1RGB:if(!i._compressedTextureEtc1)throw"BaseTexture: not support ETC1RGB format.";e=i._compressedTextureEtc1.COMPRESSED_RGB_ETC1_WEBGL;break;case G.PVRTCRGB_2BPPV:if(!i._compressedTexturePvrtc)throw"BaseTexture: not support PVRTCRGB_2BPPV format.";e=i._compressedTexturePvrtc.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;break;case G.PVRTCRGBA_2BPPV:if(!i._compressedTexturePvrtc)throw"BaseTexture: not support PVRTCRGBA_2BPPV format.";e=i._compressedTexturePvrtc.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG;break;case G.PVRTCRGB_4BPPV:if(!i._compressedTexturePvrtc)throw"BaseTexture: not support PVRTCRGB_4BPPV format.";e=i._compressedTexturePvrtc.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;break;case G.PVRTCRGBA_4BPPV:if(!i._compressedTexturePvrtc)throw"BaseTexture: not support PVRTCRGBA_4BPPV format.";e=i._compressedTexturePvrtc.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;break;default:throw"BaseTexture: unknown texture format."}return e}},{key:"_setFilterMode",value:function(e){var t=S.instance;switch(v.bindTexture(t,this._glTextureType,this._glTexture),e){case a.FILTERMODE_POINT:this._mipmap?t.texParameteri(this._glTextureType,t.TEXTURE_MIN_FILTER,t.NEAREST_MIPMAP_NEAREST):t.texParameteri(this._glTextureType,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(this._glTextureType,t.TEXTURE_MAG_FILTER,t.NEAREST);break;case a.FILTERMODE_BILINEAR:this._mipmap?t.texParameteri(this._glTextureType,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_NEAREST):t.texParameteri(this._glTextureType,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(this._glTextureType,t.TEXTURE_MAG_FILTER,t.LINEAR);break;case a.FILTERMODE_TRILINEAR:this._mipmap?t.texParameteri(this._glTextureType,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_LINEAR):t.texParameteri(this._glTextureType,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(this._glTextureType,t.TEXTURE_MAG_FILTER,t.LINEAR);break;default:throw new Error("BaseTexture:unknown filterMode value.")}}},{key:"_setWarpMode",value:function(e,t){var i=S.instance;if(v.bindTexture(i,this._glTextureType,this._glTexture),this._isPot(this._width)&&this._isPot(this._height))switch(t){case a.WARPMODE_REPEAT:i.texParameteri(this._glTextureType,e,i.REPEAT);break;case a.WARPMODE_CLAMP:i.texParameteri(this._glTextureType,e,i.CLAMP_TO_EDGE)}else i.texParameteri(this._glTextureType,e,i.CLAMP_TO_EDGE)}},{key:"_setAnisotropy",value:function(e){var t,i=S.layaGPUInstance._extTextureFilterAnisotropic;i&&(e=Math.max(e,1),t=S.instance,v.bindTexture(t,this._glTextureType,this._glTexture),e=Math.min(t.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT),e),t.texParameterf(this._glTextureType,i.TEXTURE_MAX_ANISOTROPY_EXT,e))}},{key:"_disposeResource",value:function(){this._glTexture&&(S.instance.deleteTexture(this._glTexture),this._glTexture=null,this._setGPUMemory(0))}},{key:"_getSource",value:function(){return this._readyed?this._glTexture:null}},{key:"generateMipmap",value:function(){this._isPot(this.width)&&this._isPot(this.height)&&S.instance.generateMipmap(this._glTextureType)}}]),a}()),ue=(le.WARPMODE_REPEAT=0,le.WARPMODE_CLAMP=1,le.FILTERMODE_POINT=0,le.FILTERMODE_BILINEAR=1,le.FILTERMODE_TRILINEAR=2,le.FORMAT_R8G8B8=0,le.FORMAT_R8G8B8A8=1,le.FORMAT_ALPHA8=2,le.FORMAT_DXT1=3,le.FORMAT_DXT5=4,le.FORMAT_ETC1RGB=5,le.FORMAT_PVRTCRGB_2BPPV=9,le.FORMAT_PVRTCRGBA_2BPPV=10,le.FORMAT_PVRTCRGB_4BPPV=11,le.FORMAT_PVRTCRGBA_4BPPV=12,le.RENDERTEXTURE_FORMAT_RGBA_HALF_FLOAT=14,le.FORMAT_R32G32B32A32=15,le.FORMAT_DEPTH_16=0,le.FORMAT_STENCIL_8=1,le.FORMAT_DEPTHSTENCIL_16_8=2,le.FORMAT_DEPTHSTENCIL_NONE=3,function(){f(l,le);var h=T(l);function l(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:G.R8G8B8A8,a=!(3<arguments.length&&void 0!==arguments[3])||arguments[3],s=4<arguments.length&&void 0!==arguments[4]&&arguments[4],n=(b(this,l),e=h.call(this,n,a),S.instance),s=(e._glTextureType=n.TEXTURE_2D,e._width=t,e._height=i,e._canRead=s,e._setWarpMode(n.TEXTURE_WRAP_S,e._wrapModeU),e._setWarpMode(n.TEXTURE_WRAP_T,e._wrapModeV),e._setFilterMode(e._filterMode),e._setAnisotropy(e._anisoLevel),e._gpuCompressFormat());if(a){var r=Math.max(Math.ceil(Math.log2(t))+1,Math.ceil(Math.log2(i))+1);if(!s)for(var o=0;o<r;o++)e._setPixels(null,o,Math.max(t>>o,1),Math.max(i>>o,1));e._mipmapCount=r,e._setGPUMemory(t*i*4*(1+1/3))}else s||e._setPixels(null,0,t,i),e._mipmapCount=1,e._setGPUMemory(t*i*4);return e}return y(l,[{key:"defaulteTexture",get:function(){return l.grayTexture}},{key:"_gpuCompressFormat",value:function(){return this._format==G.DXT1||this._format==G.DXT5||this._format==G.ETC1RGB||this._format==G.PVRTCRGB_2BPPV||this._format==G.PVRTCRGBA_2BPPV||this._format==G.PVRTCRGB_4BPPV||this._format==G.PVRTCRGBA_4BPPV}},{key:"_setPixels",value:function(e,t,i,n){var a=S.instance,s=this._glTextureType,r=this._getGLFormat();switch(v.bindTexture(a,s,this._glTexture),this.format){case G.R8G8B8:a.pixelStorei(a.UNPACK_ALIGNMENT,1),a.texImage2D(s,t,r,i,n,0,r,a.UNSIGNED_BYTE,e),a.pixelStorei(a.UNPACK_ALIGNMENT,4);break;case G.R32G32B32A32:S.layaGPUInstance._isWebGL2?a.texImage2D(s,t,a.RGBA32F,i,n,0,r,a.FLOAT,e):a.texImage2D(s,t,a.RGBA,i,n,0,r,a.FLOAT,e);break;default:a.texImage2D(s,t,r,i,n,0,r,a.UNSIGNED_BYTE,e)}}},{key:"_calcualatesCompressedDataSize",value:function(e,t,i){switch(e){case G.DXT1:case G.ETC1RGB:return(t+3>>2)*(i+3>>2)*8;case G.DXT5:return(t+3>>2)*(i+3>>2)*16;case G.PVRTCRGB_4BPPV:case G.PVRTCRGBA_4BPPV:return Math.floor((Math.max(t,8)*Math.max(i,8)*4+7)/8);case G.PVRTCRGB_2BPPV:case G.PVRTCRGBA_2BPPV:return Math.floor((Math.max(t,16)*Math.max(i,8)*2+7)/8);default:return 0}}},{key:"_pharseDDS",value:function(e){var t=new Int32Array(e,0,31);if(542327876!=t[0])throw"Invalid magic number in DDS header";if(!(4&t[20]))throw"Unsupported format, must contain a FourCC code";var i=t[21];switch(this._format){case G.DXT1:if(827611204!==i)throw"the FourCC code is not same with texture format.";break;case G.DXT5:if(894720068!==i)throw"the FourCC code is not same with texture format.";break;default:throw"unknown texture format."}var n=1;if(131072&t[2]){if(n=Math.max(1,t[7]),!this._mipmap)throw"the mipmap is not same with Texture2D."}else if(this._mipmap)throw"the mipmap is not same with Texture2D.";var a=t[4],s=t[3],t=(this._width=a,this._height=s,t[1]+4);this._upLoadCompressedTexImage2D(e,a,s,n,t,0)}},{key:"_pharseKTX",value:function(e){var t=new Uint8Array(e,0,12);if(171!=t[0]||75!=t[1]||84!=t[2]||88!=t[3]||32!=t[4]||49!=t[5]||49!=t[6]||187!=t[7]||13!=t[8]||10!=t[9]||26!=t[10]||10!=t[11])throw"Invalid fileIdentifier in KTX header";var t=new Int32Array(t.buffer,t.length,13),i=t[4];if(i!==S.layaGPUInstance._compressedTextureEtc1.COMPRESSED_RGB_ETC1_WEBGL)throw"unknown texture format.";this._format=G.ETC1RGB;var i=t[11],n=t[6],a=t[7],t=(this._width=n,this._height=a,64+t[12]);this._upLoadCompressedTexImage2D(e,n,a,i,t,4)}},{key:"_pharsePVR",value:function(e){var t=new Int32Array(e,0,13);if(55727696!=t[0])throw"Invalid magic number in PVR header";switch(t[2]){case 0:this._format=G.PVRTCRGB_2BPPV;break;case 2:this._format=G.PVRTCRGB_4BPPV;break;case 1:this._format=G.PVRTCRGBA_2BPPV;break;case 3:this._format=G.PVRTCRGBA_4BPPV;break;default:throw"Texture2D:unknown PVR format."}var i=t[11],n=t[7],a=t[6],t=(this._width=n,this._height=a,t[12]+52);this._upLoadCompressedTexImage2D(e,n,a,i,t,0)}},{key:"_upLoadCompressedTexImage2D",value:function(e,t,i,n,a,s){for(var r=S.instance,o=this._glTextureType,h=(v.bindTexture(r,o,this._glTexture),this._getGLFormat()),l=a,u=0;u<n;u++){l+=s;var c=this._calcualatesCompressedDataSize(this._format,t,i),_=new Uint8Array(e,l,c);r.compressedTexImage2D(o,u,h,t,i,0,_),t=Math.max(t>>1,1),i=Math.max(i>>1,1),l+=c}a=l;this._setGPUMemory(a),this._readyed=!0,this._activeResource()}},{key:"loadImageSource",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=S.instance,n=e.width,a=e.height,s=(this._width=n,this._height=a,this._isPot(n)&&this._isPot(a)||(this._mipmap=!1),this._setWarpMode(i.TEXTURE_WRAP_S,this._wrapModeU),this._setWarpMode(i.TEXTURE_WRAP_T,this._wrapModeV),this._setFilterMode(this._filterMode),v.bindTexture(i,this._glTextureType,this._glTexture),this._getGLFormat());L.Render.isConchApp?(e.setPremultiplyAlpha&&e.setPremultiplyAlpha(t),i.texImage2D(this._glTextureType,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,e)):(t&&i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),i.texImage2D(this._glTextureType,0,s,s,i.UNSIGNED_BYTE,e),t&&i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1)),this._mipmap?(i.generateMipmap(this._glTextureType),this._setGPUMemory(n*a*4*(1+1/3))):this._setGPUMemory(n*a*4),this._canRead&&(L.Render.isConchApp?this._pixels=new Uint8Array(e._nativeObj.getImageData(0,0,n,a)):(L.Browser.canvas.size(n,a),L.Browser.canvas.clear(),L.Browser.context.drawImage(e,0,0,n,a),this._pixels=new Uint8Array(L.Browser.context.getImageData(0,0,n,a).data.buffer))),this._readyed=!0,this._activeResource()}},{key:"setPixels",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(this._gpuCompressFormat())throw"Texture2D:the format is GPU compression format.";if(!e)throw"Texture2D:pixels can't be null.";var i=Math.max(this._width>>t,1),n=Math.max(this._height>>t,1),a=i*n*this._getFormatByteCount();if(e.length<a)throw"Texture2D:pixels length should at least "+a+".";this._setPixels(e,t,i,n),this._canRead&&(this._pixels=e),this._readyed=!0,this._activeResource()}},{key:"setSubPixels",value:function(e,t,i,n,a){var s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0;if(this._gpuCompressFormat())throw"Texture2D:the format is GPU compression format.";if(!a)throw"Texture2D:pixels can't be null.";var r=S.instance,o=this._glTextureType,h=(v.bindTexture(r,o,this._glTexture),this._getGLFormat());switch(this.format){case G.R8G8B8:r.pixelStorei(r.UNPACK_ALIGNMENT,1),r.texSubImage2D(o,s,e,t,i,n,h,r.UNSIGNED_BYTE,a),r.pixelStorei(r.UNPACK_ALIGNMENT,4);break;case G.R32G32B32A32:r.texSubImage2D(o,s,e,t,i,n,h,r.FLOAT,a);break;default:r.texSubImage2D(o,s,e,t,i,n,h,r.UNSIGNED_BYTE,a)}this._readyed=!0,this._activeResource()}},{key:"setCompressData",value:function(e){switch(this._format){case G.DXT1:case G.DXT5:this._pharseDDS(e);break;case G.ETC1RGB:this._pharseKTX(e);break;case G.PVRTCRGB_2BPPV:case G.PVRTCRGBA_2BPPV:case G.PVRTCRGB_4BPPV:case G.PVRTCRGBA_4BPPV:this._pharsePVR(e);break;default:throw"Texture2D:unkonwn format."}}},{key:"_recoverResource",value:function(){}},{key:"getPixels",value:function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")}}],[{key:"__init__",value:function(){var e=new Uint8Array(3);e[0]=128,e[1]=128,e[2]=128,(l.grayTexture=new l(1,1,G.R8G8B8,!1,!1)).setPixels(e),l.grayTexture.lock=!0,e[0]=255,e[1]=255,e[2]=255,(l.whiteTexture=new l(1,1,G.R8G8B8,!1,!1)).setPixels(e),l.whiteTexture.lock=!0,e[0]=0,e[1]=0,e[2]=0,(l.blackTexture=new l(1,1,G.R8G8B8,!1,!1)).setPixels(e),l.blackTexture.lock=!0}},{key:"_parse",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=i?new l(i[0],i[1],i[2],i[3],i[4]):new l(0,0);switch(t&&(n.wrapModeU=t.wrapModeU,n.wrapModeV=t.wrapModeV,n.filterMode=t.filterMode,n.anisoLevel=t.anisoLevel),n._format){case G.R8G8B8:case G.R8G8B8A8:n.loadImageSource(e);break;case G.DXT1:case G.DXT5:case G.ETC1RGB:case G.PVRTCRGB_2BPPV:case G.PVRTCRGBA_2BPPV:case G.PVRTCRGB_4BPPV:case G.PVRTCRGBA_4BPPV:n.setCompressData(e);break;default:throw"Texture2D:unkonwn format."}return n}},{key:"load",value:function(e,t){L.loader.create(e,t,null,L.Loader.TEXTURE2D)}}]),l}()),ce=(ue.TEXTURE2D="TEXTURE2D",ue.grayTexture=null,ue.whiteTexture=null,ue.blackTexture=null,function(){f(t,oe);var e=T(t);function t(){return b(this,t),e.call(this)}return y(t)}()),_e=function(){function n(){b(this,n)}return y(n,null,[{key:"mat2MatArray",value:function(e,t){var i=t;return i[0]=e.a,i[1]=e.b,i[2]=n.EMPTYMAT4_ARRAY[2],i[3]=n.EMPTYMAT4_ARRAY[3],i[4]=e.c,i[5]=e.d,i[6]=n.EMPTYMAT4_ARRAY[6],i[7]=n.EMPTYMAT4_ARRAY[7],i[8]=n.EMPTYMAT4_ARRAY[8],i[9]=n.EMPTYMAT4_ARRAY[9],i[10]=n.EMPTYMAT4_ARRAY[10],i[11]=n.EMPTYMAT4_ARRAY[11],i[12]=e.tx,i[13]=e.ty,i[14]=n.EMPTYMAT4_ARRAY[14],i[15]=n.EMPTYMAT4_ARRAY[15],t}},{key:"restoreTempArray",value:function(){n.TEMPMAT4_ARRAY[0]=1,n.TEMPMAT4_ARRAY[1]=0,n.TEMPMAT4_ARRAY[4]=0,n.TEMPMAT4_ARRAY[5]=1,n.TEMPMAT4_ARRAY[12]=0,n.TEMPMAT4_ARRAY[13]=0}},{key:"clear",value:function(){n.worldScissorTest=!1,n.worldAlpha=1}}]),n}(),fe=(_e._MAXSIZE=99999999,_e.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],_e.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],_e.worldMatrix4=_e.TEMPMAT4_ARRAY,_e.worldMatrix=new Ce,_e.matWVP=null,_e.worldAlpha=1,_e.worldScissorTest=!1,_e.width=0,_e.height=0,(e=X=X||{})[e.R8G8B8=0]="R8G8B8",e[e.R8G8B8A8=1]="R8G8B8A8",e[e.Alpha8=2]="Alpha8",e[e.R16G16B16A16=14]="R16G16B16A16",(e=W=W||{})[e.DEPTH_16=0]="DEPTH_16",e[e.STENCIL_8=1]="STENCIL_8",e[e.DEPTHSTENCIL_16_8=2]="DEPTHSTENCIL_16_8",e[e.DEPTHSTENCIL_NONE=3]="DEPTHSTENCIL_NONE",function(){f(s,le);var a=T(s);function s(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:X.R8G8B8,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:W.DEPTH_16;return b(this,s),(i=a.call(this,i,!1))._mgrKey=0,i._glTextureType=S.instance.TEXTURE_2D,i._width=e,i._height=t,i._depthStencilFormat=n,i._create(e,t),i.lock=!0,i}return y(s,[{key:"depthStencilFormat",get:function(){return this._depthStencilFormat}},{key:"defaulteTexture",get:function(){return ue.grayTexture}},{key:"getIsReady",value:function(){return!0}},{key:"sourceWidth",get:function(){return this._width}},{key:"sourceHeight",get:function(){return this._height}},{key:"offsetX",get:function(){return 0}},{key:"offsetY",get:function(){return 0}},{key:"_create",value:function(e,t){var i=S.instance,n=(this._frameBuffer=i.createFramebuffer(),v.bindTexture(i,this._glTextureType,this._glTexture),this._getGLFormat());if(i.texImage2D(this._glTextureType,0,n,e,t,0,n,i.UNSIGNED_BYTE,null),this._setGPUMemory(e*t*4),i.bindFramebuffer(i.FRAMEBUFFER,this._frameBuffer),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,this._glTexture,0),this._depthStencilFormat!==W.DEPTHSTENCIL_NONE)switch(this._depthStencilBuffer=i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,this._depthStencilBuffer),this._depthStencilFormat){case W.DEPTH_16:i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_COMPONENT16,e,t),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,this._depthStencilBuffer);break;case W.STENCIL_8:i.renderbufferStorage(i.RENDERBUFFER,i.STENCIL_INDEX8,e,t),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.STENCIL_ATTACHMENT,i.RENDERBUFFER,this._depthStencilBuffer);break;case W.DEPTHSTENCIL_16_8:i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,e,t),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,this._depthStencilBuffer)}i.bindFramebuffer(i.FRAMEBUFFER,null),i.bindRenderbuffer(i.RENDERBUFFER,null),this._setWarpMode(i.TEXTURE_WRAP_S,this._wrapModeU),this._setWarpMode(i.TEXTURE_WRAP_T,this._wrapModeV),this._setFilterMode(this._filterMode),this._setAnisotropy(this._anisoLevel),this._readyed=!0,this._activeResource()}},{key:"generateMipmap",value:function(){this._isPot(this.width)&&this._isPot(this.height)?(this._mipmap=!0,S.instance.generateMipmap(this._glTextureType),this._setFilterMode(this._filterMode),this._setGPUMemory(this.width*this.height*4*(1+1/3))):(this._mipmap=!1,this._setGPUMemory(this.width*this.height*4))}},{key:"start",value:function(){var e=S.instance;S.instance.bindFramebuffer(e.FRAMEBUFFER,this._frameBuffer),this._lastRT=s._currentActive,(s._currentActive=this)._readyed=!0,e.viewport(0,0,this._width,this._height),this._lastWidth=_e.width,this._lastHeight=_e.height,_e.width=this._width,_e.height=this._height,ce.activeShader=null}},{key:"end",value:function(){var e=S.instance;e.bindFramebuffer(e.FRAMEBUFFER,null),s._currentActive=null,this._readyed=!0}},{key:"restore",value:function(){var e=S.instance;this._lastRT!=s._currentActive&&(S.instance.bindFramebuffer(e.FRAMEBUFFER,this._lastRT?this._lastRT._frameBuffer:null),s._currentActive=this._lastRT),this._readyed=!0,e.viewport(0,0,this._lastWidth,this._lastHeight),_e.width=this._lastWidth,_e.height=this._lastHeight,ce.activeShader=null}},{key:"clear",value:function(){var e=S.instance,t=(e.clearColor(0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,3<arguments.length&&void 0!==arguments[3]?arguments[3]:1),e.COLOR_BUFFER_BIT);switch(this._depthStencilFormat){case e.DEPTH_COMPONENT16:t|=e.DEPTH_BUFFER_BIT;break;case e.STENCIL_INDEX8:t|=e.STENCIL_BUFFER_BIT;break;case e.DEPTH_STENCIL:t=(t|=e.DEPTH_BUFFER_BIT)|e.STENCIL_BUFFER_BIT}e.clear(t)}},{key:"getData",value:function(e,t,i,n){if(L.Render.isConchApp&&2==window.conchConfig.threadMode)throw"native 2 thread mode use getDataAsync";var a=S.instance;if(a.bindFramebuffer(a.FRAMEBUFFER,this._frameBuffer),!(a.checkFramebufferStatus(a.FRAMEBUFFER)===a.FRAMEBUFFER_COMPLETE))return a.bindFramebuffer(a.FRAMEBUFFER,null),null;var s=new Uint8Array(this._width*this._height*4),r=this._getGLFormat();return a.readPixels(e,t,i,n,r,a.UNSIGNED_BYTE,s),a.bindFramebuffer(a.FRAMEBUFFER,null),s}},{key:"getDataAsync",value:function(e,t,i,n,a){var s=S.instance;s.bindFramebuffer(s.FRAMEBUFFER,this._frameBuffer),s.readPixelsAsync(e,t,i,n,s.RGBA,s.UNSIGNED_BYTE,function(e){a(new Uint8Array(e))}),s.bindFramebuffer(s.FRAMEBUFFER,null)}},{key:"recycle",value:function(){}},{key:"_disposeResource",value:function(){var e;this._frameBuffer&&((e=S.instance).deleteTexture(this._glTexture),e.deleteFramebuffer(this._frameBuffer),e.deleteRenderbuffer(this._depthStencilBuffer),this._glTexture=null,this._frameBuffer=null,this._depthStencilBuffer=null,this._setGPUMemory(0))}}],[{key:"currentActive",get:function(){return s._currentActive}},{key:"pushRT",value:function(){s.rtStack.push({rt:s._currentActive,w:_e.width,h:_e.height})}},{key:"popRT",value:function(){var e=S.instance,t=s.rtStack.pop();t&&(s._currentActive!=t.rt&&(S.instance.bindFramebuffer(e.FRAMEBUFFER,t.rt?t.rt._frameBuffer:null),s._currentActive=t.rt),e.viewport(0,0,t.w,t.h),_e.width=t.w,_e.height=t.h)}}]),s}()),de=(fe.rtStack=[],fe.defuv=[0,0,1,0,1,1,0,1],fe.flipyuv=[0,1,1,1,1,0,0,0],function(){function e(){b(this,e)}return y(e,null,[{key:"getRT",value:function(e,t){return t|=0,1e4<=(e|=0)&&console.error("getRT error! w too big"),new fe(e,t,X.R8G8B8A8,-1)}},{key:"releaseRT",value:function(e){e._disposeResource()}}]),e}()),pe=(de.dict={},function(){function t(){b(this,t)}return y(t,null,[{key:"_init_",value:function(e){t.fns=[t.BlendNormal,t.BlendAdd,t.BlendMultiply,t.BlendScreen,t.BlendOverlay,t.BlendLight,t.BlendMask,t.BlendDestinationOut],t.targetFns=[t.BlendNormalTarget,t.BlendAddTarget,t.BlendMultiplyTarget,t.BlendScreenTarget,t.BlendOverlayTarget,t.BlendLightTarget,t.BlendMask,t.BlendDestinationOut]}},{key:"BlendNormal",value:function(e){v.setBlendFunc(e,e.ONE,e.ONE_MINUS_SRC_ALPHA)}},{key:"BlendAdd",value:function(e){v.setBlendFunc(e,e.ONE,e.DST_ALPHA)}},{key:"BlendMultiply",value:function(e){v.setBlendFunc(e,e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA)}},{key:"BlendScreen",value:function(e){v.setBlendFunc(e,e.ONE,e.ONE)}},{key:"BlendOverlay",value:function(e){v.setBlendFunc(e,e.ONE,e.ONE_MINUS_SRC_COLOR)}},{key:"BlendLight",value:function(e){v.setBlendFunc(e,e.ONE,e.ONE)}},{key:"BlendNormalTarget",value:function(e){v.setBlendFunc(e,e.ONE,e.ONE_MINUS_SRC_ALPHA)}},{key:"BlendAddTarget",value:function(e){v.setBlendFunc(e,e.ONE,e.DST_ALPHA)}},{key:"BlendMultiplyTarget",value:function(e){v.setBlendFunc(e,e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA)}},{key:"BlendScreenTarget",value:function(e){v.setBlendFunc(e,e.ONE,e.ONE)}},{key:"BlendOverlayTarget",value:function(e){v.setBlendFunc(e,e.ONE,e.ONE_MINUS_SRC_COLOR)}},{key:"BlendLightTarget",value:function(e){v.setBlendFunc(e,e.ONE,e.ONE)}},{key:"BlendMask",value:function(e){v.setBlendFunc(e,e.ZERO,e.SRC_ALPHA)}},{key:"BlendDestinationOut",value:function(e){v.setBlendFunc(e,e.ZERO,e.ZERO)}}]),t}()),ye=(pe.activeBlendFunction=null,pe.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],pe.TOINT={normal:0,add:1,multiply:2,screen:3,overlay:4,light:5,mask:6,"destination-out":7,lighter:1},pe.NORMAL="normal",pe.ADD="add",pe.MULTIPLY="multiply",pe.SCREEN="screen",pe.OVERLAY="overlay",pe.LIGHT="light",pe.MASK="mask",pe.DESTINATIONOUT="destination-out",pe.LIGHTER="lighter",pe.fns=[],pe.targetFns=[],function(){function n(e,t,i){b(this,n),this._value=0,this._name2int=e,this._int2name=t,this._int2nameMap=i}return y(n,[{key:"add",value:function(e){return this._value|="string"==typeof e?this._name2int[e]:e,this._value}},{key:"addInt",value:function(e){return this._value|=e,this._value}},{key:"remove",value:function(e){return this._value&="string"==typeof e?~this._name2int[e]:~e,this._value}},{key:"isDefine",value:function(e){return(this._value&e)===e}},{key:"getValue",value:function(){return this._value}},{key:"setValue",value:function(e){this._value=e}},{key:"toNameDic",value:function(){var e=this._int2nameMap[this._value];return e||n._toText(this._value,this._int2name,this._int2nameMap)}}],[{key:"_reg",value:function(e,t,i,n){n[i[e]=t]=e}},{key:"_toText",value:function(e,t,i){var n=i[e];if(n)return n;for(var a,s,r={},o=0;o<32&&!(e<(a=1<<o));o++)e&a&&((s=t[a])&&(r[s]=""));return i[e]=r}},{key:"_toInt",value:function(e,t){for(var i=e.split("."),n=0,a=0,s=i.length;a<s;a++){var r=t[i[a]];if(!r)throw new Error("Defines to int err:"+e+"/"+i[a]);n|=r}return n}}]),n}()),ge=function(){f(i,ye);var e=T(i);function i(){return b(this,i),e.call(this,i.__name2int,i.__int2name,i.__int2nameMap)}return y(i,null,[{key:"__init__",value:function(){i.reg("TEXTURE2D",i.TEXTURE2D),i.reg("PRIMITIVE",i.PRIMITIVE),i.reg("GLOW_FILTER",i.FILTERGLOW),i.reg("BLUR_FILTER",i.FILTERBLUR),i.reg("COLOR_FILTER",i.FILTERCOLOR),i.reg("COLOR_ADD",i.COLORADD),i.reg("WORLDMAT",i.WORLDMAT),i.reg("FILLTEXTURE",i.FILLTEXTURE),i.reg("MVP3D",i.MVP3D)}},{key:"reg",value:function(e,t){this._reg(e,t,i.__name2int,i.__int2name)}},{key:"toText",value:function(e,t,i){return this._toText(e,t,i)}},{key:"toInt",value:function(e){return this._toInt(e,i.__name2int)}}]),i}(),k=(ge.TEXTURE2D=1,ge.PRIMITIVE=4,ge.FILTERGLOW=8,ge.FILTERBLUR=16,ge.FILTERCOLOR=32,ge.COLORADD=64,ge.WORLDMAT=128,ge.FILLTEXTURE=256,ge.SKINMESH=512,ge.MVP3D=2048,ge.NOOPTMASK=ge.FILTERGLOW|ge.FILTERBLUR|ge.FILTERCOLOR|ge.FILLTEXTURE,ge.__name2int={},ge.__int2name=[],ge.__int2nameMap=[],function(){function t(){b(this,t)}return y(t,null,[{key:"show",value:function(){t._StatRender.show(0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0)}},{key:"enable",value:function(){t._StatRender.enable()}},{key:"hide",value:function(){t._StatRender.hide()}},{key:"clear",value:function(){t.trianglesFaces=t.renderBatches=t.savedRenderBatches=t.shaderCall=t.spriteRenderUseCacheCount=t.frustumCulling=t.octreeNodeCulling=t.canvasNormal=t.canvasBitmap=t.canvasReCache=0}},{key:"onclick",set:function(e){t._StatRender.set_onclick(e)}}]),t}()),e=(k.FPS=0,k.loopCount=0,k.shaderCall=0,k.renderBatches=0,k.savedRenderBatches=0,k.trianglesFaces=0,k.spriteCount=0,k.spriteRenderUseCacheCount=0,k.frustumCulling=0,k.octreeNodeCulling=0,k.canvasNormal=0,k.canvasBitmap=0,k.canvasReCache=0,k.renderSlow=!1,k._fpsData=[],k._timer=0,k._count=0,k._StatRender=null,function(){function e(){b(this,e),this._strsToID={},this._idToStrs=[],this._length=0}return y(e,[{key:"add",value:function(e){var t=this._strsToID[e];return null!=t?t:(this._idToStrs[this._length]=e,this._strsToID[e]=this._length++)}},{key:"getID",value:function(e){e=this._strsToID[e];return null==e?-1:e}},{key:"getName",value:function(e){e=this._idToStrs[e];return null==e?void 0:e}}]),e}()),me=function(){f(h,ce);var r=T(h);function h(e,t){var i,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null;if(b(this,h),(i=r.call(this))._attribInfo=null,i.customCompile=!1,i._curActTexIndex=0,i.tag={},i._program=null,i._params=null,i._paramsMap={},e&&t)return i._attribInfo=s,i._id=++h._count,i._vs=e,i._ps=t,i._nameMap=a||{},null!=n&&(h.sharders[n]=O(i)),i.recreateResource(),i.lock=!0,i;throw"Shader Error"}return y(h,[{key:"recreateResource",value:function(){this._compile(),this._setGPUMemory(0)}},{key:"_disposeResource",value:function(){v.mainContext.deleteShader(this._vshader),v.mainContext.deleteShader(this._pshader),v.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this._setGPUMemory(0),this._curActTexIndex=0}},{key:"_compile",value:function(){if(this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[],this.customCompile&&(e=L.ShaderCompile.preGetParams(this._vs,this._ps));for(var e,t,i=v.mainContext,n=(this._program=i.createProgram(),this._vshader=h._createShader(i,this._vs,i.VERTEX_SHADER),this._pshader=h._createShader(i,this._ps,i.FRAGMENT_SHADER),i.attachShader(this._program,this._vshader),i.attachShader(this._program,this._pshader),this._attribInfo?this._attribInfo.length:0),a=0;a<n;a+=2)i.bindAttribLocation(this._program,this._attribInfo[a+1],this._attribInfo[a]);if(i.linkProgram(this._program),!this.customCompile&&!i.getProgramParameter(this._program,i.LINK_STATUS))throw i.getProgramInfoLog(this._program);var s=this.customCompile?e.uniforms.length:i.getProgramParameter(this._program,i.ACTIVE_UNIFORMS);for(a=0;a<s;a++){var r,o=this.customCompile?e.uniforms[a]:i.getActiveUniform(this._program,a);0<(r={vartype:"uniform",glfun:null,ivartype:1,location:i.getUniformLocation(this._program,o.name),name:o.name,type:o.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(r.name=r.name.substr(0,r.name.length-3),r.isArray=!0,r.location=i.getUniformLocation(this._program,r.name)),this._params.push(r)}for(a=0,t=this._params.length;a<t;a++)switch((r=this._params[a]).indexOfParams=a,r.index=1,r.value=[r.location,null],r.codename=r.name,r.name=this._nameMap[r.codename]||r.codename,(this._paramsMap[r.name]=r)._this=this,r.uploadedValue=[],r.type){case i.INT:r.fun=r.isArray?this._uniform1iv:this._uniform1i;break;case i.FLOAT:r.fun=r.isArray?this._uniform1fv:this._uniform1f;break;case i.FLOAT_VEC2:r.fun=r.isArray?this._uniform_vec2v:this._uniform_vec2;break;case i.FLOAT_VEC3:r.fun=r.isArray?this._uniform_vec3v:this._uniform_vec3;break;case i.FLOAT_VEC4:r.fun=r.isArray?this._uniform_vec4v:this._uniform_vec4;break;case i.SAMPLER_2D:r.fun=this._uniform_sampler2D;break;case i.SAMPLER_CUBE:r.fun=this._uniform_samplerCube;break;case i.FLOAT_MAT4:r.glfun=i.uniformMatrix4fv,r.fun=this._uniformMatrix4fv;break;case i.BOOL:r.fun=this._uniform1i;break;case i.FLOAT_MAT2:case i.FLOAT_MAT3:default:throw new Error("compile shader err!")}}}},{key:"getUniform",value:function(e){return this._paramsMap[e]}},{key:"_uniform1f",value:function(e,t){var i=e.uploadedValue;return i[0]!==t?(v.mainContext.uniform1f(e.location,i[0]=t),1):0}},{key:"_uniform1fv",value:function(e,t){var i;return t.length<4?(i=e.uploadedValue)[0]!==t[0]||i[1]!==t[1]||i[2]!==t[2]||i[3]!==t[3]?(v.mainContext.uniform1fv(e.location,t),i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],1):0:(v.mainContext.uniform1fv(e.location,t),1)}},{key:"_uniform_vec2",value:function(e,t){var i=e.uploadedValue;return i[0]!==t[0]||i[1]!==t[1]?(v.mainContext.uniform2f(e.location,i[0]=t[0],i[1]=t[1]),1):0}},{key:"_uniform_vec2v",value:function(e,t){var i;return t.length<2?(i=e.uploadedValue)[0]!==t[0]||i[1]!==t[1]||i[2]!==t[2]||i[3]!==t[3]?(v.mainContext.uniform2fv(e.location,t),i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],1):0:(v.mainContext.uniform2fv(e.location,t),1)}},{key:"_uniform_vec3",value:function(e,t){var i=e.uploadedValue;return i[0]!==t[0]||i[1]!==t[1]||i[2]!==t[2]?(v.mainContext.uniform3f(e.location,i[0]=t[0],i[1]=t[1],i[2]=t[2]),1):0}},{key:"_uniform_vec3v",value:function(e,t){return v.mainContext.uniform3fv(e.location,t),1}},{key:"_uniform_vec4",value:function(e,t){var i=e.uploadedValue;return i[0]!==t[0]||i[1]!==t[1]||i[2]!==t[2]||i[3]!==t[3]?(v.mainContext.uniform4f(e.location,i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3]),1):0}},{key:"_uniform_vec4v",value:function(e,t){return v.mainContext.uniform4fv(e.location,t),1}},{key:"_uniformMatrix2fv",value:function(e,t){return v.mainContext.uniformMatrix2fv(e.location,!1,t),1}},{key:"_uniformMatrix3fv",value:function(e,t){return v.mainContext.uniformMatrix3fv(e.location,!1,t),1}},{key:"_uniformMatrix4fv",value:function(e,t){return v.mainContext.uniformMatrix4fv(e.location,!1,t),1}},{key:"_uniform1i",value:function(e,t){var i=e.uploadedValue;return i[0]!==t?(v.mainContext.uniform1i(e.location,i[0]=t),1):0}},{key:"_uniform1iv",value:function(e,t){return v.mainContext.uniform1iv(e.location,t),1}},{key:"_uniform_ivec2",value:function(e,t){var i=e.uploadedValue;return i[0]!==t[0]||i[1]!==t[1]?(v.mainContext.uniform2i(e.location,i[0]=t[0],i[1]=t[1]),1):0}},{key:"_uniform_ivec2v",value:function(e,t){return v.mainContext.uniform2iv(e.location,t),1}},{key:"_uniform_vec3i",value:function(e,t){var i=e.uploadedValue;return i[0]!==t[0]||i[1]!==t[1]||i[2]!==t[2]?(v.mainContext.uniform3i(e.location,i[0]=t[0],i[1]=t[1],i[2]=t[2]),1):0}},{key:"_uniform_vec3vi",value:function(e,t){return v.mainContext.uniform3iv(e.location,t),1}},{key:"_uniform_vec4i",value:function(e,t){var i=e.uploadedValue;return i[0]!==t[0]||i[1]!==t[1]||i[2]!==t[2]||i[3]!==t[3]?(v.mainContext.uniform4i(e.location,i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3]),1):0}},{key:"_uniform_vec4vi",value:function(e,t){return v.mainContext.uniform4iv(e.location,t),1}},{key:"_uniform_sampler2D",value:function(e,t){var i=v.mainContext,n=e.uploadedValue;return null==n[0]?(n[0]=this._curActTexIndex,i.uniform1i(e.location,this._curActTexIndex),v.activeTexture(i,i.TEXTURE0+this._curActTexIndex),v.bindTexture(i,i.TEXTURE_2D,t),this._curActTexIndex++,1):(v.activeTexture(i,i.TEXTURE0+n[0]),v.bindTexture(i,i.TEXTURE_2D,t),0)}},{key:"_uniform_samplerCube",value:function(e,t){var i=v.mainContext,n=e.uploadedValue;return null==n[0]?(n[0]=this._curActTexIndex,i.uniform1i(e.location,this._curActTexIndex),v.activeTexture(i,i.TEXTURE0+this._curActTexIndex),v.bindTexture(i,i.TEXTURE_CUBE_MAP,t),this._curActTexIndex++,1):(v.activeTexture(i,i.TEXTURE0+n[0]),v.bindTexture(i,i.TEXTURE_CUBE_MAP,t),0)}},{key:"_noSetValue",value:function(e){console.log("no....:"+e.name)}},{key:"uploadOne",value:function(e,t){v.useProgram(v.mainContext,this._program);e=this._paramsMap[e];e.fun.call(this,e,t)}},{key:"uploadTexture2D",value:function(e){var t=v;t._activeTextures[0]!==e&&(t.bindTexture(v.mainContext,S.instance.TEXTURE_2D,e),t._activeTextures[0]=e)}},{key:"upload",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,i=(ce.activeShader=ce.bindShader=this,v.mainContext);v.useProgram(i,this._program),this._reCompile?(t=this._params,this._reCompile=!1):t=t||this._params;for(var n,a,s=t.length,r=0,o=0;o<s;o++)null!==(a=e[(n=t[o]).name])&&(r+=n.fun.call(this,n,a));k.shaderCall+=r}},{key:"uploadArray",value:function(e,t,i){ce.activeShader=this,ce.bindShader=this,v.useProgram(v.mainContext,this._program);this._params;for(var n,a,s=0,r=t-2;0<=r;r-=2)(a=this._paramsMap[e[r]])&&null!=(n=e[r+1])&&(i&&i[a.name]&&i[a.name].bind(),s+=a.fun.call(this,a,n));k.shaderCall+=s}},{key:"getParams",value:function(){return this._params}},{key:"setAttributesLocation",value:function(e){this._attribInfo=e}}],[{key:"getShader",value:function(e){return h.sharders[e]}},{key:"create",value:function(e,t){return new h(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,4<arguments.length&&void 0!==arguments[4]?arguments[4]:null)}},{key:"withCompile",value:function(e,t,i,n){if(i&&h.sharders[i])return h.sharders[i];var a=h._preCompileShader[h.SHADERNAME2ID*e];if(a)return a.createShader(t,i,n,null);throw new Error("withCompile shader err!"+e)}},{key:"withCompile2D",value:function(e,t,i,n,a){if(n&&h.sharders[n])return h.sharders[n];var s=h._preCompileShader[h.SHADERNAME2ID*e+t];if(s)return s.createShader(i,n,a,5<arguments.length&&void 0!==arguments[5]?arguments[5]:null);throw new Error("withCompile shader err!"+e+" "+t)}},{key:"addInclude",value:function(e,t){L.ShaderCompile.addInclude(e,t)}},{key:"preCompile",value:function(e,t,i,n){e=h.SHADERNAME2ID*e;h._preCompileShader[e]=new L.ShaderCompile(t,i,n)}},{key:"preCompile2D",value:function(e,t,i,n,a){e=h.SHADERNAME2ID*e+t;h._preCompileShader[e]=new L.ShaderCompile(i,n,a)}},{key:"_createShader",value:function(e,t,i){i=e.createShader(i);return e.shaderSource(i,t),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS)?i:(console.log(e.getShaderInfoLog(i)),null)}}]),h}(),ve=(me._count=0,me._preCompileShader={},me.SHADERNAME2ID=2e-4,me.nameKey=new e,me.sharders=new Array(32),function(){f(r,me);var s=T(r);function r(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null;return b(this,r),(e=s.call(this,e,t,i,n,a))._params2dQuick2=null,e._shaderValueWidth=0,e._shaderValueHeight=0,e}return y(r,[{key:"_disposeResource",value:function(){m(g(r.prototype),"_disposeResource",this).call(this),this._params2dQuick2=null}},{key:"upload2dQuick2",value:function(e){this.upload(e,this._params2dQuick2||this._make2dQuick2())}},{key:"_make2dQuick2",value:function(){if(!this._params2dQuick2){this._params2dQuick2=[];for(var e,t=this._params,i=0,n=t.length;i<n;i++)"size"!==(e=t[i]).name&&this._params2dQuick2.push(e)}return this._params2dQuick2}}],[{key:"create",value:function(e,t){return new r(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,4<arguments.length&&void 0!==arguments[4]?arguments[4]:null)}}]),r}()),xe=function(){function n(e,t){b(this,n),this.defines=new ge,this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this.ref=1,this._cacheID=0,this.clipMatDir=[L.Context._MAXSIZE,0,0,L.Context._MAXSIZE],this.clipMatPos=[0,0],this.clipOff=[0,0],this.mainID=e,this.subID=t,this.textureHost=null,this.texture=null,this.color=null,this.colorAdd=null,this.u_mmat2=null,this._cacheID=e|t,this._inClassCache=n._cache[this._cacheID],0<e&&!this._inClassCache&&(this._inClassCache=n._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}return y(n,[{key:"setValue",value:function(e){}},{key:"_ShaderWithCompile",value:function(){return me.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,ve.create,this._attribLocation)}},{key:"upload",value:function(){var e=_e,t=(_e.worldMatrix4!==_e.TEMPMAT4_ARRAY&&this.defines.addInt(ge.WORLDMAT),this.mmat=e.worldMatrix4,_e.matWVP&&(this.defines.addInt(ge.MVP3D),this.u_MvpMatrix=_e.matWVP.elements),me.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile());t._shaderValueWidth!==e.width||t._shaderValueHeight!==e.height?(this.size[0]=e.width,this.size[1]=e.height,t._shaderValueWidth=e.width,t._shaderValueHeight=e.height,t.upload(this,null)):t.upload(this,t._params2dQuick2||t._make2dQuick2())}},{key:"setFilters",value:function(e){if(this.filters=e)for(var t,i=e.length,n=0;n<i;n++)(t=e[n])&&(this.defines.add(t.type),t.action.setValue(this))}},{key:"clear",value:function(){this.defines._value=this.subID,this.clipOff[0]=0}},{key:"release",value:function(){--this.ref<1&&(this._inClassCache&&(this._inClassCache[this._inClassCache._length++]=this),this.clear(),this.filters=null,this.ref=1,this.clipOff[0]=0)}}],[{key:"_initone",value:function(e,t){n._typeClass[e]=t,n._cache[e]=[],n._cache[e]._length=0}},{key:"__init__",value:function(){}},{key:"create",value:function(e,t){var i=n._cache[e|t];return i._length?i[--i._length]:new n._typeClass[e|t](t)}}]),n}(),ke=(xe._cache=[],xe._typeClass=[],xe.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],function(){function e(){b(this,e),this.clear()}return y(e,[{key:"clear",value:function(){this.submitType=-1,this.blendShader=this.other=0}},{key:"copyFrom",value:function(e){this.other=e.other,this.blendShader=e.blendShader,this.submitType=e.submitType}},{key:"copyFrom2",value:function(e,t,i){this.other=i,this.submitType=t}},{key:"equal3_2",value:function(e,t,i){return this.submitType===t&&this.other===i&&this.blendShader===e.blendShader}},{key:"equal4_2",value:function(e,t,i){return this.submitType===t&&this.other===i&&this.blendShader===e.blendShader}},{key:"equal_3",value:function(e){return this.submitType===e.submitType&&this.blendShader===e.blendShader}},{key:"equal",value:function(e){return this.other===e.other&&this.submitType===e.submitType&&this.blendShader===e.blendShader}}]),e}()),we=function(){function a(){b(this,a),this._ref=1,this._key=new ke}return y(a,[{key:"renderSubmit",value:function(){return this.fun.apply(this._this,this.args),1}},{key:"getRenderType",value:function(){return 0}},{key:"releaseRender",value:function(){var e;--this._ref<1&&((e=a.POOL)[e._length++]=this)}}],[{key:"create",value:function(e,t,i){var n=a.POOL._length?a.POOL[--a.POOL._length]:new a;return n.fun=t,n.args=e,n._this=i,n._ref=1,n._key.clear(),n}}]),a}(),be=(we.POOL=[],we.POOL._length=0,function(){function e(){b(this,e)}return y(e,[{key:"type",get:function(){return-1}}]),e}()),Se=(be.BLUR=16,be.COLOR=32,be.GLOW=8,be._filter=function(e,t,i,n){var a=t,s=this._next;if(s){var r=e.filters,o=r.length;if(1==o&&r[0].type==be.COLOR)return t.save(),t.setColorFilter(r[0]),s._fun.call(s,e,t,i,n),void t.restore();var h,l=xe.create(ge.TEXTURE2D,0),u=ie.TEMP,c=a._curMat,_=Ce.create(),c=(c.copyTo(_),0),f=0,d=null,p=e._cacheStyle.filterCache||null;if(p&&0==e.getRepaint()){if((e._cacheStyle.hasGlowFilter||!1)&&(c=50,f=25),(h=e.getBounds()).width<=0||h.height<=0)return;h.width+=c,h.height+=c,u.x=h.x*_.a+h.y*_.c,u.y=h.y*_.d+h.x*_.b,h.x=u.x,h.y=u.y,u.x=h.width*_.a+h.height*_.c,u.y=h.height*_.d+h.width*_.b,h.width=u.x,h.height=u.y}else{e._isHaveGlowFilter()&&(c=50,f=25),(h=new ne).copyFrom(e.getSelfBounds()),h.x+=e.x,h.y+=e.y,h.x-=e.pivotX+4,h.y-=e.pivotY+4;var y=h.x,g=h.y;if(h.width+=c+8,h.height+=c+8,u.x=h.x*_.a+h.y*_.c,u.y=h.y*_.d+h.x*_.b,h.x=u.x,h.y=u.y,u.x=h.width*_.a+h.height*_.c,u.y=h.height*_.d+h.width*_.b,h.width=u.x,h.height=u.y,h.width<=0||h.height<=0)return;p&&de.releaseRT(p);var d=de.getRT(h.width,h.height),m=p=de.getRT(h.width,h.height),c=(e._getCacheStyle().filterCache=p,a.pushRT(),a.useRT(d),e.x-y+f),y=e.y-g+f;s._fun.call(s,e,t,c,y),a.useRT(m);for(var v=0;v<o;v++){0!=v&&(a.useRT(d),a.drawTarget(m,0,0,h.width,h.height,Ce.TEMP.identity(),l,null,pe.TOINT.overlay),a.useRT(m));var x=r[v];switch(x.type){case be.BLUR:case be.GLOW:x._glRender&&x._glRender.render(d,t,h.width,h.height,x);break;case be.COLOR:a.setColorFilter(x),a.drawTarget(d,0,0,h.width,h.height,Ce.EMPTY.identity(),xe.create(ge.TEXTURE2D,0)),a.setColorFilter(null)}}a.popRT()}i=i-f-e.x,n=n-f-e.y,u.setTo(i,n),_.transformPoint(u),i=u.x+h.x,n=u.y+h.y,a._drawRenderTexture(p,i,n,h.width,h.height,Ce.TEMP.identity(),1,fe.defuv),d&&(g=we.create([d],function(e){e.destroy()},this),d=null,t.addRenderObject(g)),_.destroy()}},function(){function c(){b(this,c)}function e(e){return t.apply(this,arguments)}var t;return y(c,null,[{key:"toRadian",value:function(e){return e*c._pi2}},{key:"toAngle",value:function(e){return e*c._pi}},{key:"toHexColor",value:function(e){if(e<0||isNaN(e))return null;for(var t=e.toString(16);t.length<6;)t="0"+t;return"#"+t}},{key:"getGID",value:function(){return c._gid++}},{key:"concatArray",value:function(e,t){if(!t)return e;if(!e)return t;for(var i=t.length,n=0;n<i;n++)e.push(t[n]);return e}},{key:"clearArray",value:function(e){return e&&(e.length=0,e)}},{key:"copyArray",value:function(e,t){if(e=e||[],!t)return e;e.length=t.length;for(var i=t.length,n=0;n<i;n++)e[n]=t[n];return e}},{key:"getGlobalRecByPoints",value:function(e,t,i,n,a){t=ie.create().setTo(t,i),t=e.localToGlobal(t),i=ie.create().setTo(n,a),i=e.localToGlobal(i),n=ne._getWrapRec([t.x,t.y,i.x,i.y]);return t.recover(),i.recover(),n}},{key:"getGlobalPosAndScale",value:function(e){return c.getGlobalRecByPoints(e,0,0,1,1)}},{key:"bind",value:function(e,t){return e.bind(t)}},{key:"updateOrder",value:function(e){if(!e||e.length<2)return!1;for(var t,i,n,a=1,s=e.length;a<s;){for(n=e[t=a],i=e[t]._zOrder;-1<--t&&e[t]._zOrder>i;)e[t+1]=e[t];e[t+1]=n,a++}return!0}},{key:"transPointList",value:function(e,t,i){for(var n=e.length,a=0;a<n;a+=2)e[a]+=t,e[a+1]+=i}},{key:"parseInt",value:(t=function(e){e=parseInt(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0);return isNaN(e)?0:e},e.toString=function(){return t.toString()},e)},{key:"getFileExtension",value:function(e){c._extReg.lastIndex=e.lastIndexOf(".");e=c._extReg.exec(e);return e&&1<e.length?e[1].toLowerCase():null}},{key:"getTransformRelativeToWindow",value:function(e,t,i){var n,a,s,r=c.gStage,e=c.getGlobalPosAndScale(e),o=r._canvasTransform.clone(),h=o.tx,l=o.ty,u=(o.rotate(-Math.PI/180*r.canvasDegree),o.scale(r.clientScaleX,r.clientScaleY),r.canvasDegree%180!=0);return u?(n=i+e.y,a=t+e.x,n*=o.d,a*=o.a,90==r.canvasDegree?(n=h-n,a+=l):(n+=h,a=l-a)):(n=t+e.x,a=i+e.y,n=n*o.a+h,a=a*o.d+l),a+=r._safariOffsetY,t=u?(s=o.d*e.height,o.a*e.width):(s=o.a*e.width,o.d*e.height),{x:n,y:a,scaleX:s,scaleY:t}}},{key:"fitDOMElementInArea",value:function(e,t,i,n,a,s){e._fitLayaAirInitialized||(e._fitLayaAirInitialized=!0,e.style.transformOrigin=e.style.webKittransformOrigin="left top",e.style.position="absolute");t=c.getTransformRelativeToWindow(t,i,n);e.style.transform=e.style.webkitTransform="scale("+t.scaleX+","+t.scaleY+") rotate("+c.gStage.canvasDegree+"deg)",e.style.width=a+"px",e.style.height=s+"px",e.style.left=t.x+"px",e.style.top=t.y+"px"}},{key:"isOkTextureList",value:function(e){if(!e)return!1;for(var t,i=e.length,n=0;n<i;n++)if(!(t=e[n])||!t._getSource())return!1;return!0}},{key:"isOKCmdList",value:function(e){if(!e)return!1;for(var t=e.length,i=0;i<t;i++)e[i];return!0}},{key:"getQueryString",value:function(e){if(L.Browser.onMiniGame)return null;if(!window.location||!window.location.search)return null;e=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),e=window.location.search.substr(1).match(e);return null!=e?unescape(e[2]):null}}]),c}()),Ie=(Se.gStage=null,Se._gid=1,Se._pi=180/Math.PI,Se._pi2=Math.PI/180,Se._extReg=/\.(\w+)\??/g,Se.parseXMLFromString=function(e){if(e=e.replace(/>\s+</g,"><"),-1<(e=(new DOMParser).parseFromString(e,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error(e.firstChild.firstChild.textContent);return e},function(){function o(e){if(b(this,o),this.arrColor=[],null==e)return this.strColor="#00000000",this.numColor=0,void(this.arrColor=[0,0,0,0]);var t;if("string"==typeof e)if(0<=e.indexOf("rgba(")||0<=e.indexOf("rgb(")){var i=(a=e).indexOf("("),n=a.indexOf(")"),a=a.substring(i+1,n);for(this.arrColor=a.split(","),t=this.arrColor.length,r=0;r<t;r++)this.arrColor[r]=parseFloat(this.arrColor[r]),r<3&&(this.arrColor[r]=Math.round(this.arrColor[r]));i=4==this.arrColor.length?256*(256*(256*this.arrColor[0]+this.arrColor[1])+this.arrColor[2])+Math.round(255*this.arrColor[3]):256*(256*this.arrColor[0]+this.arrColor[1])+this.arrColor[2],this.strColor=e}else{if(3===(t=(e="#"===(this.strColor=e).charAt(0)?e.substr(1):e).length)||4===t){for(var s="",r=0;r<t;r++)s+=e[r]+e[r];e=s}i=parseInt(e,16)}else i=e,this.strColor=Se.toHexColor(i);0<=this.strColor.indexOf("rgba")||9===this.strColor.length?(this.arrColor=[((4278190080&i)>>>24)/255,((16711680&i)>>16)/255,((65280&i)>>8)/255,(255&i)/255],this.numColor=(4278190080&i)>>>24|(16711680&i)>>8|(65280&i)<<8|(255&i)<<24):(this.arrColor=[((16711680&i)>>16)/255,((65280&i)>>8)/255,(255&i)/255,1],this.numColor=4278190080|(16711680&i)>>16|65280&i|(255&i)<<16),this.arrColor.__id=++o._COLODID}return y(o,null,[{key:"_initDefault",value:function(){for(var e in o._DEFAULT={},o._COLOR_MAP)o._SAVE[e]=o._DEFAULT[e]=new o(o._COLOR_MAP[e]);return o._DEFAULT}},{key:"_initSaveMap",value:function(){for(var e in o._SAVE_SIZE=0,o._SAVE={},o._DEFAULT)o._SAVE[e]=o._DEFAULT[e]}},{key:"create",value:function(e){var t=e+"",i=o._SAVE[t];return null!=i?i:(o._SAVE_SIZE<1e3&&o._initSaveMap(),o._SAVE[t]=new o(e))}}]),o}()),Te=(Ie._SAVE={},Ie._SAVE_SIZE=0,Ie._COLOR_MAP={purple:"#800080",orange:"#ffa500",white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#808080"},Ie._DEFAULT=Ie._initDefault(),Ie._COLODID=1,function(){f(n,be);var i=T(n);function n(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;return b(this,n),e=i.call(this),t=t||e._copyMatrix(n.IDENTITY_MATRIX),e._mat=new Float32Array(16),e._alpha=new Float32Array(4),e.setByMatrix(t),e}return y(n,[{key:"gray",value:function(){return this.setByMatrix(n.GRAY_MATRIX)}},{key:"color",value:function(){return this.setByMatrix([1,0,0,0,0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,0,1,0,0,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,0,0,1,0,2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,0,0,0,1,3<arguments.length&&void 0!==arguments[3]?arguments[3]:1])}},{key:"setColor",value:function(e){e=Ie.create(e).arrColor,e=[0,0,0,0,256*e[0],0,0,0,0,256*e[1],0,0,0,0,256*e[2],0,0,0,1,0];return this.setByMatrix(e)}},{key:"setByMatrix",value:function(e){this._matrix!=e&&this._copyMatrix(e);for(var t=0,i=0,n=0;n<20;n++)n%5!=4?this._mat[t++]=e[n]:this._alpha[i++]=e[n];return this}},{key:"type",get:function(){return be.COLOR}},{key:"adjustColor",value:function(e,t,i,n){return this.adjustHue(n),this.adjustContrast(t),this.adjustBrightness(e),this.adjustSaturation(i),this}},{key:"adjustBrightness",value:function(e){return 0==(e=this._clampValue(e,100))||isNaN(e)?this:this._multiplyMatrix([1,0,0,0,e,0,1,0,0,e,0,0,1,0,e,0,0,0,1,0,0,0,0,0,1])}},{key:"adjustContrast",value:function(e){if(0==(e=this._clampValue(e,100))||isNaN(e))return this;var t=e<0?127+e/100*127:127*(t=0==(t=e%1)?n.DELTA_INDEX[e]:n.DELTA_INDEX[e<<0]*(1-t)+n.DELTA_INDEX[1+(e<<0)]*t)+127,e=t/127,t=.5*(127-t);return this._multiplyMatrix([e,0,0,0,t,0,e,0,0,t,0,0,e,0,t,0,0,0,1,0,0,0,0,0,1])}},{key:"adjustSaturation",value:function(e){if(0==(e=this._clampValue(e,100))||isNaN(e))return this;var e=1+(0<e?3*e/100:e/100),t=1-e,i=.3086*t,n=.6094*t,t=.082*t;return this._multiplyMatrix([i+e,n,t,0,0,i,n+e,t,0,0,i,n,t+e,0,0,0,0,0,1,0,0,0,0,0,1])}},{key:"adjustHue",value:function(e){if(0==(e=this._clampValue(e,180)/180*Math.PI)||isNaN(e))return this;var t=Math.cos(e),e=Math.sin(e),i=.213,n=.715,a=.072;return this._multiplyMatrix([i+.787*t+e*-i,n+t*-n+e*-n,a+t*-a+.928*e,0,0,i+t*-i+.143*e,n+t*(1-n)+.14*e,a+t*-a+-.283*e,0,0,i+t*-i+-.787*e,n+t*-n+e*n,a+.928*t+e*a,0,0,0,0,0,1,0,0,0,0,0,1])}},{key:"reset",value:function(){return this.setByMatrix(this._copyMatrix(n.IDENTITY_MATRIX))}},{key:"_multiplyMatrix",value:function(e){var t=[];this._matrix=this._fixMatrix(this._matrix);for(var i=0;i<5;i++){for(var n=0;n<5;n++)t[n]=this._matrix[n+5*i];for(n=0;n<5;n++){for(var a=0,s=0;s<5;s++)a+=e[n+5*s]*t[s];this._matrix[n+5*i]=a}}return this.setByMatrix(this._matrix)}},{key:"_clampValue",value:function(e,t){return Math.min(t,Math.max(-t,e))}},{key:"_fixMatrix",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;return null==e?n.IDENTITY_MATRIX:(e.length<n.LENGTH?e=e.slice(0,e.length).concat(n.IDENTITY_MATRIX.slice(e.length,n.LENGTH)):e.length>n.LENGTH&&(e=e.slice(0,n.LENGTH)),e)}},{key:"_copyMatrix",value:function(e){var t=n.LENGTH;this._matrix||(this._matrix=[]);for(var i=0;i<t;i++)this._matrix[i]=e[i];return this._matrix}}]),n}()),Ee=(Te.DELTA_INDEX=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10],Te.GRAY_MATRIX=[.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0],Te.IDENTITY_MATRIX=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1],Te.LENGTH=25,function(){function c(){b(this,c),this.colorFlt=null,this.uv=null}return y(c,[{key:"recover",value:function(){this.texture&&this.texture._removeReference(),this.texture=null,this.matrix=null,p.recover("DrawTextureCmd",this)}},{key:"run",value:function(e,t,i){this.texture&&e.drawTextureWithTransform(this.texture,this.x,this.y,this.width,this.height,this.matrix,t,i,this.alpha,this.blendMode,this.colorFlt,this.uv)}},{key:"cmdID",get:function(){return c.ID}}],[{key:"create",value:function(e,t,i,n,a,s,r,o,h,l){var u=p.getItemByClass("DrawTextureCmd",c);return(u.texture=e)._addReference(),u.x=t,u.y=i,u.width=n,u.height=a,u.matrix=s,u.alpha=r,u.color=o,u.blendMode=h,u.uv=null==l?null:l,o&&(u.colorFlt=new Te,u.colorFlt.setColor(o)),u}}]),c}()),Re=(Ee.ID="DrawTexture",function(){function l(){b(this,l)}return y(l,[{key:"recover",value:function(){this.texture=null,this.offset=null,this.other=null,p.recover("FillTextureCmd",this)}},{key:"run",value:function(e,t,i){e.fillTexture(this.texture,this.x+t,this.y+i,this.width,this.height,this.type,this.offset,this.other)}},{key:"cmdID",get:function(){return l.ID}}],[{key:"create",value:function(e,t,i,n,a,s,r,o){var h=p.getItemByClass("FillTextureCmd",l);return h.texture=e,h.x=t,h.y=i,h.width=n,h.height=a,h.type=s,h.offset=r,h.other=o,h}}]),l}()),Ae=(Re.ID="FillTexture",function(){function e(){b(this,e)}return y(e,[{key:"recover",value:function(){p.recover("RestoreCmd",this)}},{key:"run",value:function(e,t,i){e.restore()}},{key:"cmdID",get:function(){return e.ID}}],[{key:"create",value:function(){return p.getItemByClass("RestoreCmd",e)}}]),e}()),Le=(Ae.ID="Restore",function(){function a(){b(this,a)}return y(a,[{key:"recover",value:function(){p.recover("RotateCmd",this)}},{key:"run",value:function(e,t,i){e._rotate(this.angle,this.pivotX+t,this.pivotY+i)}},{key:"cmdID",get:function(){return a.ID}}],[{key:"create",value:function(e,t,i){var n=p.getItemByClass("RotateCmd",a);return n.angle=e,n.pivotX=t,n.pivotY=i,n}}]),a}()),Ne=(Le.ID="Rotate",function(){function s(){b(this,s)}return y(s,[{key:"recover",value:function(){p.recover("ScaleCmd",this)}},{key:"run",value:function(e,t,i){e._scale(this.scaleX,this.scaleY,this.pivotX+t,this.pivotY+i)}},{key:"cmdID",get:function(){return s.ID}}],[{key:"create",value:function(e,t,i,n){var a=p.getItemByClass("ScaleCmd",s);return a.scaleX=e,a.scaleY=t,a.pivotX=i,a.pivotY=n,a}}]),s}()),Pe=(Ne.ID="Scale",function(){function a(){b(this,a)}return y(a,[{key:"recover",value:function(){this.matrix=null,p.recover("TransformCmd",this)}},{key:"run",value:function(e,t,i){e._transform(this.matrix,this.pivotX+t,this.pivotY+i)}},{key:"cmdID",get:function(){return a.ID}}],[{key:"create",value:function(e,t,i){var n=p.getItemByClass("TransformCmd",a);return n.matrix=e,n.pivotX=t,n.pivotY=i,n}}]),a}()),Be=(Pe.ID="Transform",function(){function n(){b(this,n)}return y(n,[{key:"recover",value:function(){p.recover("TranslateCmd",this)}},{key:"run",value:function(e,t,i){e.translate(this.tx,this.ty)}},{key:"cmdID",get:function(){return n.ID}}],[{key:"create",value:function(e,t){var i=p.getItemByClass("TranslateCmd",n);return i.tx=e,i.ty=t,i}}]),n}()),De=(Be.ID="Translate",function(){function e(){b(this,e),this._controlPoints=[new ie,new ie,new ie],this._calFun=this.getPoint2}return y(e,[{key:"_switchPoint",value:function(e,t){var i=this._controlPoints.shift();i.setTo(e,t),this._controlPoints.push(i)}},{key:"getPoint2",value:function(e,t){var i=this._controlPoints[0],n=this._controlPoints[1],a=this._controlPoints[2],s=Math.pow(1-e,2)*i.x+2*e*(1-e)*n.x+Math.pow(e,2)*a.x,i=Math.pow(1-e,2)*i.y+2*e*(1-e)*n.y+Math.pow(e,2)*a.y;t.push(s,i)}},{key:"getPoint3",value:function(e,t){var i=this._controlPoints[0],n=this._controlPoints[1],a=this._controlPoints[2],s=this._controlPoints[3],r=Math.pow(1-e,3)*i.x+3*n.x*e*(1-e)*(1-e)+3*a.x*e*e*(1-e)+s.x*Math.pow(e,3),i=Math.pow(1-e,3)*i.y+3*n.y*e*(1-e)*(1-e)+3*a.y*e*e*(1-e)+s.y*Math.pow(e,3);t.push(r,i)}},{key:"insertPoints",value:function(e,t){for(var i=1/(e=0<e?e:5),n=0;n<=1;n+=i)this._calFun(n,t)}},{key:"getBezierPoints",value:function(e){var t,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:5,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:2,a=e.length;if(a<2*(n+1))return[];var s=[];switch(n){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=n;)this._controlPoints.push(ie.create());for(t=0;t<2*n;t+=2)this._switchPoint(e[t],e[t+1]);for(t=2*n;t<a;t+=2)this._switchPoint(e[t],e[t+1]),t/2%n==0&&this.insertPoints(i,s);return s}}]),e}()),Oe=(De.I=new De,function(){function l(){b(this,l)}return y(l,null,[{key:"multiply",value:function(e,t,i){return(e.x-i.x)*(t.y-i.y)-(t.x-i.x)*(e.y-i.y)}},{key:"dis",value:function(e,t){return(e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y)}},{key:"_getPoints",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;for(l._mPointList||(l._mPointList=[]);l._mPointList.length<e;)l._mPointList.push(new ie);return(i=i||[]).length=0,t?l.getFrom(i,l._mPointList,e):l.getFromR(i,l._mPointList,e),i}},{key:"getFrom",value:function(e,t,i){for(var n=0;n<i;n++)e.push(t[n]);return e}},{key:"getFromR",value:function(e,t,i){for(var n=0;n<i;n++)e.push(t.pop());return e}},{key:"pListToPointList",value:function(e){for(var t=e.length/2,i=l._getPoints(t,1<arguments.length&&void 0!==arguments[1]&&arguments[1],l._tempPointList),n=0;n<t;n++)i[n].setTo(e[n+n],e[n+n+1]);return i}},{key:"pointListToPlist",value:function(e){for(var t,i=e.length,n=l._temPList,a=n.length=0;a<i;a++)t=e[a],n.push(t.x,t.y);return n}},{key:"scanPList",value:function(e){return Se.copyArray(e,l.pointListToPlist(l.scan(l.pListToPointList(e,!0))))}},{key:"scan",value:function(e){var t,i,n,a,s,r=0,o=(e.length,{}),h=l._temArr;for(h.length=0,t=e.length-1;0<=t;t--)(s=(n=e[t]).x+"_"+n.y)in o||(o[s]=!0,h.push(n));for(a=h.length,Se.copyArray(e,h),t=1;t<a;t++)(e[t].y<e[r].y||e[t].y==e[r].y&&e[t].x<e[r].x)&&(r=t);for(n=e[0],e[0]=e[r],e[r]=n,t=1;t<a-1;t++){for(i=(r=t)+1;i<a;i++)(0<l.multiply(e[i],e[r],e[0])||0==l.multiply(e[i],e[r],e[0])&&l.dis(e[0],e[i])<l.dis(e[0],e[r]))&&(r=i);n=e[t],e[t]=e[r],e[r]=n}if((h=l._temArr).length=0,e.length<3)return Se.copyArray(h,e);for(h.push(e[0],e[1],e[2]),t=3;t<a;t++){for(;2<=h.length&&0<=l.multiply(e[t],h[h.length-1],h[h.length-2]);)h.pop();e[t]&&h.push(e[t])}return h}}]),l}()),Fe=(Oe._tempPointList=[],Oe._temPList=[],Oe._temArr=[],y(function e(){b(this,e)})),Ve=(Fe.animationInterval=50,Fe.isAntialias=!1,Fe.isAlpha=!1,Fe.premultipliedAlpha=!0,Fe.isStencil=!0,Fe.preserveDrawingBuffer=!1,Fe.webGL2D_MeshAllocMaxMem=!0,Fe.is2DPixelArtGame=!1,Fe.useWebGL2=!0,Fe.useRetinalCanvas=!1,window.Config=Fe,function(){function i(e){b(this,i),this.setValue(e)}return y(i,[{key:"setValue",value:function(e){this._color=e?e instanceof Ie?e:Ie.create(e):Ie.create("#000000")}},{key:"reset",value:function(){this._color=Ie.create("#000000")}},{key:"toInt",value:function(){return this._color.numColor}},{key:"equal",value:function(e){return"string"==typeof e?this._color.strColor===e:e instanceof Ie&&this._color.numColor===e.numColor}},{key:"toColorStr",value:function(){return this._color.strColor}}],[{key:"create",value:function(e){var t;return e?(t=e instanceof Ie?e:Ie.create(e))._drawStyle||(t._drawStyle=new i(e)):i.DEFAULT}}]),i}()),Ue=(Ve.DEFAULT=new Ve("#000000"),function(){function e(){b(this,e),this._lastOriX=0,this._lastOriY=0,this.paths=[],this._curPath=null}return y(e,[{key:"beginPath",value:function(e){this.paths.length=1,this._curPath=this.paths[0]=new ze,this._curPath.convex=e}},{key:"closePath",value:function(){this._curPath.loop=!0}},{key:"newPath",value:function(){this._curPath=new ze,this.paths.push(this._curPath)}},{key:"addPoint",value:function(e,t){this._curPath.path.push(e,t)}},{key:"push",value:function(e,t){(!this._curPath||0<this._curPath.path.length)&&(this._curPath=new ze,this.paths.push(this._curPath));var i=this._curPath;i.path=e.slice(),i.convex=t}},{key:"reset",value:function(){this.paths.length=0}}]),e}()),ze=y(function e(){b(this,e),this.path=[],this.loop=!1,this.convex=!1}),w=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:t.TYPE_2D;b(this,t),this.clipInfoID=-1,this._mesh=null,this._blendFn=null,this._id=0,this._renderType=0,this._parent=null,this._key=new ke,this._startIdx=0,this._numEle=0,this._ref=1,this.shaderValue=null,this._renderType=e,this._id=++t.ID}return y(t,[{key:"getID",value:function(){return this._id}},{key:"getRenderType",value:function(){return this._renderType}},{key:"toString",value:function(){return"ibindex:"+this._startIdx+" num:"+this._numEle+" key="+this._key}},{key:"renderSubmit",value:function(){return 1}},{key:"releaseRender",value:function(){}}],[{key:"__init__",value:function(){var e=t.RENDERBASE=new t(-1);e.shaderValue=new xe(0,0),e.shaderValue.ALPHA=1,e._ref=4294967295}}]),t}(),Ye=(w.TYPE_2D=1e4,w.TYPE_CANVAS=10003,w.TYPE_CMDSETRT=10004,w.TYPE_CUSTOM=10005,w.TYPE_BLURRT=10006,w.TYPE_CMDDESTORYPRERT=10007,w.TYPE_DISABLESTENCIL=10008,w.TYPE_OTHERIBVB=10009,w.TYPE_PRIMITIVE=10010,w.TYPE_RT=10011,w.TYPE_BLUR_RT=10012,w.TYPE_TARGET=10013,w.TYPE_CHANGE_VALUE=10014,w.TYPE_SHAPE=10015,w.TYPE_TEXTURE=10016,w.TYPE_FILLTEXTURE=10017,w.KEY_ONCE=-1,w.KEY_FILLRECT=1,w.KEY_DRAWTEXTURE=2,w.KEY_VG=3,w.KEY_TRIANGLES=4,w.ID=1,w.preRender=null,function(){function s(){b(this,s)}return y(s,[{key:"isSaveMark",value:function(){return!1}},{key:"restore",value:function(e){this._dataObj[this._valueName]=this._value,(s.POOL[s.POOL._length++]=this)._newSubmit&&(e._curSubmit=w.RENDERBASE)}}],[{key:"_createArray",value:function(){var e=[];return e._length=0,e}},{key:"_init",value:function(){var e=s._namemap={};return e[s.TYPE_ALPHA]="ALPHA",e[s.TYPE_FILESTYLE]="fillStyle",e[s.TYPE_FONT]="font",e[s.TYPE_LINEWIDTH]="lineWidth",e[s.TYPE_STROKESTYLE]="strokeStyle",e[s.TYPE_ENABLEMERGE]="_mergeID",e[s.TYPE_MARK]=e[s.TYPE_TRANSFORM]=e[s.TYPE_TRANSLATE]=[],e[s.TYPE_TEXTBASELINE]="textBaseline",e[s.TYPE_TEXTALIGN]="textAlign",e[s.TYPE_GLOBALCOMPOSITEOPERATION]="_nBlendType",e[s.TYPE_SHADER]="shader",e[s.TYPE_FILTERS]="filters",e[s.TYPE_COLORFILTER]="_colorFiler",e}},{key:"save",value:function(e,t,i,n){var a;(e._saveMark._saveuse&t)!==t&&(e._saveMark._saveuse|=t,(a=0<(a=s.POOL)._length?a[--a._length]:new s)._value=i[a._valueName=s._namemap[t]],a._dataObj=i,a._newSubmit=n,(t=e._save)[t._length++]=a)}}]),s}()),Ge=(Ye.TYPE_ALPHA=1,Ye.TYPE_FILESTYLE=2,Ye.TYPE_FONT=8,Ye.TYPE_LINEWIDTH=256,Ye.TYPE_STROKESTYLE=512,Ye.TYPE_MARK=1024,Ye.TYPE_TRANSFORM=2048,Ye.TYPE_TRANSLATE=4096,Ye.TYPE_ENABLEMERGE=8192,Ye.TYPE_TEXTBASELINE=16384,Ye.TYPE_TEXTALIGN=32768,Ye.TYPE_GLOBALCOMPOSITEOPERATION=65536,Ye.TYPE_CLIPRECT=131072,Ye.TYPE_CLIPRECT_STENCIL=262144,Ye.TYPE_IBVB=524288,Ye.TYPE_SHADER=1048576,Ye.TYPE_FILTERS=2097152,Ye.TYPE_FILTERS_TYPE=4194304,Ye.TYPE_COLORFILTER=8388608,Ye.POOL=Ye._createArray(),Ye._namemap=Ye._init(),function(){function i(){b(this,i),this._globalClipMatrix=new Ce,this._clipInfoID=-1,this._clipRect=new ne,this.incache=!1}return y(i,[{key:"isSaveMark",value:function(){return!1}},{key:"restore",value:function(e){this._globalClipMatrix.copyTo(e._globalClipMatrix),this._clipRect.clone(e._clipRect),e._clipInfoID=this._clipInfoID,i.POOL[i.POOL._length++]=this,e._clipInCache=this.incache}}],[{key:"save",value:function(e){var t;(e._saveMark._saveuse&Ye.TYPE_CLIPRECT)!=Ye.TYPE_CLIPRECT&&(e._saveMark._saveuse|=Ye.TYPE_CLIPRECT,t=0<(t=i.POOL)._length?t[--t._length]:new i,e._globalClipMatrix.copyTo(t._globalClipMatrix),e._clipRect.clone(t._clipRect),t._clipInfoID=e._clipInfoID,t.incache=e._clipInCache,(e=e._save)[e._length++]=t)}}]),i}()),Xe=(Ge.POOL=Ye._createArray(),function(){function i(){b(this,i),this._saveuse=0}return y(i,[{key:"isSaveMark",value:function(){return!0}},{key:"restore",value:function(e){e._saveMark=this._preSaveMark,i.POOL[i.POOL._length++]=this}}],[{key:"Create",value:function(e){var t=i.POOL,t=0<t._length?t[--t._length]:new i;return t._saveuse=0,t._preSaveMark=e._saveMark,e._saveMark=t}}]),i}()),We=(Xe.POOL=Ye._createArray(),function(){function i(){b(this,i),this._matrix=new Ce}return y(i,[{key:"isSaveMark",value:function(){return!1}},{key:"restore",value:function(e){e._curMat=this._savematrix,i.POOL[i.POOL._length++]=this}}],[{key:"save",value:function(e){var t=e._saveMark;(t._saveuse&Ye.TYPE_TRANSFORM)!==Ye.TYPE_TRANSFORM&&(t._saveuse|=Ye.TYPE_TRANSFORM,(t=0<(t=i.POOL)._length?t[--t._length]:new i)._savematrix=e._curMat,e._curMat=e._curMat.copyTo(t._matrix),(e=e._save)[e._length++]=t)}}]),i}()),He=(We.POOL=Ye._createArray(),function(){function i(){b(this,i),this._mat=new Ce}return y(i,[{key:"isSaveMark",value:function(){return!1}},{key:"restore",value:function(e){this._mat.copyTo(e._curMat),i.POOL[i.POOL._length++]=this}}],[{key:"save",value:function(e){var t=i.POOL,t=0<t._length?t[--t._length]:new i,e=(e._curMat.copyTo(t._mat),e._save);e[e._length++]=t}}]),i}()),je=(He.POOL=Ye._createArray(),function(){function e(){b(this,e),this._nativeVertexArrayObject=S.layaGPUInstance.createVertexArray()}return y(e,[{key:"bind",value:function(){e._curBindedBufferState!==this&&(S.layaGPUInstance.bindVertexArray(this._nativeVertexArrayObject),e._curBindedBufferState=this)}},{key:"unBind",value:function(){if(e._curBindedBufferState!==this)throw"BufferState: must call bind() function first.";S.layaGPUInstance.bindVertexArray(null),e._curBindedBufferState=null}},{key:"destroy",value:function(){S.layaGPUInstance.deleteVertexArray(this._nativeVertexArrayObject)}},{key:"bindForNative",value:function(){S.instance.bindVertexArray(this._nativeVertexArrayObject),e._curBindedBufferState=this}},{key:"unBindForNative",value:function(){S.instance.bindVertexArray(null),e._curBindedBufferState=null}}]),e}()),qe=function(){f(t,je);var e=T(t);function t(){return b(this,t),e.call(this)}return y(t)}(),Ke=function(){function e(){b(this,e),this._byteLength=0,this._glBuffer=S.instance.createBuffer()}return y(e,[{key:"bufferUsage",get:function(){return this._bufferUsage}},{key:"_bindForVAO",value:function(){}},{key:"bind",value:function(){return!1}},{key:"destroy",value:function(){this._glBuffer&&(S.instance.deleteBuffer(this._glBuffer),this._glBuffer=null)}}]),e}(),Qe=y(function e(){b(this,e)}),Ze=(Qe.loopStTm=0,Qe.loopCount=0,function(){f(i,Ke);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this))._maxsize=0,e._upload=!0,e._uploadSize=0,e._bufferSize=0,e._u8Array=null,e}return y(i,[{key:"bufferLength",get:function(){return this._buffer.byteLength}},{key:"byteLength",set:function(e){this.setByteLength(e)}},{key:"setByteLength",value:function(e){this._byteLength!==e&&(e<=this._bufferSize||this._resizeBuffer(2*e+256,!0),this._byteLength=e)}},{key:"needSize",value:function(e){var t=this._byteLength;return e&&((e=this._byteLength+e)<=this._bufferSize||this._resizeBuffer(e<<1,!0),this._byteLength=e),t}},{key:"_bufferData",value:function(){this._maxsize=Math.max(this._maxsize,this._byteLength),Qe.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this._buffer=this._buffer.slice(0,this._maxsize+64),this._bufferSize=this._buffer.byteLength,this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,S.instance.bufferData(this._bufferType,this._uploadSize,this._bufferUsage)),S.instance.bufferSubData(this._bufferType,0,new Uint8Array(this._buffer,0,this._byteLength))}},{key:"_bufferSubData",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;this._maxsize=Math.max(this._maxsize,this._byteLength),Qe.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this._buffer=this._buffer.slice(0,this._maxsize+64),this._bufferSize=this._buffer.byteLength,this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,S.instance.bufferData(this._bufferType,this._uploadSize,this._bufferUsage)),t||i?(t=this._buffer.slice(t,i),S.instance.bufferSubData(this._bufferType,e,t)):S.instance.bufferSubData(this._bufferType,e,this._buffer)}},{key:"_checkArrayUse",value:function(){}},{key:"_bind_uploadForVAO",value:function(){return!!this._upload&&(this._upload=!1,this._bindForVAO(),this._bufferData(),!0)}},{key:"_bind_upload",value:function(){return!!this._upload&&(this._upload=!1,this.bind(),this._bufferData(),!0)}},{key:"_bind_subUpload",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;return!!this._upload&&(this._upload=!1,this.bind(),this._bufferSubData(e,t,i),!0)}},{key:"_resizeBuffer",value:function(e,t){var i=this._buffer;if(e<=i.byteLength)return this;var n,a=this._u8Array;return t&&i&&0<i.byteLength?(t=new ArrayBuffer(e),n=a&&a.buffer==i?a:new Uint8Array(i),(a=this._u8Array=new Uint8Array(t)).set(n,0),i=this._buffer=t):(i=this._buffer=new ArrayBuffer(e),this._u8Array=null),this._checkArrayUse(),this._upload=!0,this._bufferSize=i.byteLength,this}},{key:"append",value:function(e){var t,i;this._upload=!0,t=e.byteLength,e instanceof Uint8Array?(this._resizeBuffer(this._byteLength+t,!0),i=new Uint8Array(this._buffer,this._byteLength)):e instanceof Uint16Array?(this._resizeBuffer(this._byteLength+t,!0),i=new Uint16Array(this._buffer,this._byteLength)):e instanceof Float32Array&&(this._resizeBuffer(this._byteLength+t,!0),i=new Float32Array(this._buffer,this._byteLength)),i.set(e,0),this._byteLength+=t,this._checkArrayUse()}},{key:"appendU16Array",value:function(e,t){this._resizeBuffer(this._byteLength+2*t,!0);var i=new Uint16Array(this._buffer,this._byteLength,t);if(6==t)i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5];else if(100<=t)i.set(new Uint16Array(e.buffer,0,t));else for(var n=0;n<t;n++)i[n]=e[n];this._byteLength+=2*t,this._checkArrayUse()}},{key:"appendEx",value:function(e,t){var i;this._upload=!0,i=e.byteLength,this._resizeBuffer(this._byteLength+i,!0),new t(this._buffer,this._byteLength).set(e,0),this._byteLength+=i,this._checkArrayUse()}},{key:"appendEx2",value:function(e,t,i){var n,a,s=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1;for(this._upload=!0,this._resizeBuffer(this._byteLength+(s=i*s),!0),n=new t(this._buffer,this._byteLength),a=0;a<i;a++)n[a]=e[a];this._byteLength+=s,this._checkArrayUse()}},{key:"getBuffer",value:function(){return this._buffer}},{key:"setNeedUpload",value:function(){this._upload=!0}},{key:"getNeedUpload",value:function(){return this._upload}},{key:"upload",value:function(){var e=S.instance,t=this._bind_upload();return e.bindBuffer(this._bufferType,null),this._bufferType==e.ARRAY_BUFFER&&(Ke._bindedVertexBuffer=null),this._bufferType==e.ELEMENT_ARRAY_BUFFER&&(Ke._bindedIndexBuffer=null),ce.activeShader=null,t}},{key:"subUpload",value:function(){var e=S.instance,t=this._bind_subUpload();return e.bindBuffer(this._bufferType,null),this._bufferType==e.ARRAY_BUFFER&&(Ke._bindedVertexBuffer=null),this._bufferType==e.ELEMENT_ARRAY_BUFFER&&(Ke._bindedIndexBuffer=null),ce.activeShader=null,t}},{key:"_disposeResource",value:function(){this._upload=!0,this._uploadSize=0}},{key:"clear",value:function(){this._byteLength=0,this._upload=!0}}],[{key:"__int__",value:function(e){}}]),i}()),Je=(Ze.FLOAT32=4,Ze.SHORT=2,function(){f(n,Ze);var i=T(n);function n(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:35044;return b(this,n),(e=i.call(this))._bufferUsage=t,e._bufferType=S.instance.ELEMENT_ARRAY_BUFFER,e._buffer=new ArrayBuffer(8),e}return y(n,[{key:"_checkArrayUse",value:function(){this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))}},{key:"getUint16Array",value:function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))}},{key:"_bindForVAO",value:function(){var e=S.instance;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._glBuffer)}},{key:"bind",value:function(){var e;return Ke._bindedIndexBuffer!==this._glBuffer&&((e=S.instance).bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._glBuffer),Ke._bindedIndexBuffer=this._glBuffer,!0)}},{key:"destory",value:function(){this._uint16Array=null,this._buffer=null}},{key:"disposeResource",value:function(){this._disposeResource()}}]),n}()),$e=(Je.create=function(){return new Je(0<arguments.length&&void 0!==arguments[0]?arguments[0]:35044)},function(){f(a,Ze);var n=T(a);function a(e,t){var i;return b(this,a),(i=n.call(this))._vertexStride=e,i._bufferUsage=t,i._bufferType=S.instance.ARRAY_BUFFER,i._buffer=new ArrayBuffer(8),i._floatArray32=new Float32Array(i._buffer),i._uint32Array=new Uint32Array(i._buffer),i}return y(a,[{key:"vertexStride",get:function(){return this._vertexStride}},{key:"getFloat32Array",value:function(){return this._floatArray32}},{key:"appendArray",value:function(e){var t=this._byteLength>>2;this.setByteLength(this._byteLength+4*e.length),this.getFloat32Array().set(e,t),this._upload=!0}},{key:"_checkArrayUse",value:function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer)),this._uint32Array&&(this._uint32Array=new Uint32Array(this._buffer))}},{key:"deleteBuffer",value:function(){m(g(a.prototype),"_disposeResource",this).call(this)}},{key:"_bindForVAO",value:function(){var e=S.instance;e.bindBuffer(e.ARRAY_BUFFER,this._glBuffer)}},{key:"bind",value:function(){var e;return Ke._bindedVertexBuffer!==this._glBuffer&&((e=S.instance).bindBuffer(e.ARRAY_BUFFER,this._glBuffer),Ke._bindedVertexBuffer=this._glBuffer,!0)}},{key:"destroy",value:function(){m(g(a.prototype),"destroy",this).call(this),this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null}}]),a}()),et=($e.create=function(e){return new $e(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:35048)},function(){function n(e,t,i){b(this,n),this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._quadNum=0,this.canReuse=!1,this._stride=e,this._vb=new $e(e,S.instance.DYNAMIC_DRAW),t?this._vb._resizeBuffer(t,!1):Fe.webGL2D_MeshAllocMaxMem&&this._vb._resizeBuffer(65536*e,!1),this._ib=new Je,i&&this._ib._resizeBuffer(i,!1)}return y(n,[{key:"cloneWithNewVB",value:function(){var e=new n(this._stride,0,0);return e._ib=this._ib,e._quadNum=this._quadNum,e._attribInfo=this._attribInfo,e}},{key:"cloneWithNewVBIB",value:function(){var e=new n(this._stride,0,0);return e._attribInfo=this._attribInfo,e}},{key:"getVBW",value:function(){return this._vb.setNeedUpload(),this._vb}},{key:"getVBR",value:function(){return this._vb}},{key:"getIBR",value:function(){return this._ib}},{key:"getIBW",value:function(){return this._ib.setNeedUpload(),this._ib}},{key:"createQuadIB",value:function(e){this._quadNum=e,this._ib._resizeBuffer(6*e*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var t=this._ib.getUint16Array(),i=0,n=0,a=0;a<e;a++)t[i++]=n,t[i++]=n+2,t[i++]=n+1,t[i++]=n,t[i++]=n+3,t[i++]=n+2,n+=4;this._ib.setNeedUpload()}},{key:"setAttributes",value:function(e){if(this._attribInfo=e,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"}},{key:"configVAO",value:function(e){if(!this._applied){this._applied=!0,this._vao||(this._vao=new qe),this._vao.bind(),this._vb._bindForVAO(),this._ib.setNeedUpload(),this._ib._bind_uploadForVAO();for(var t=this._attribInfo.length/3,i=0,n=0;n<t;n++){var a=this._attribInfo[i+1],s=this._attribInfo[i],r=this._attribInfo[i+2];e.enableVertexAttribArray(n),e.vertexAttribPointer(n,a,s,!1,this._stride,r),i+=3}this._vao.unBind()}}},{key:"useMesh",value:function(e){this._applied||this.configVAO(e),this._vao.bind(),this._vb.bind(),this._ib._bind_upload()||this._ib.bind(),this._vb._bind_upload()||this._vb.bind()}},{key:"getEleNum",value:function(){return this._ib.getBuffer().byteLength/2}},{key:"releaseMesh",value:function(){}},{key:"destroy",value:function(){}},{key:"clearVB",value:function(){this._vb.clear()}}]),n}()),tt=(et._gvaoid=0,function(){f(h,et);var t=T(h);function h(){var e;return b(this,h),(e=t.call(this,h.const_stride,4,4)).canReuse=!0,e.setAttributes(h._fixattriInfo),h._fixib?(e._ib=h._fixib,e._quadNum=h._maxIB):(e.createQuadIB(h._maxIB),h._fixib=e._ib),e}return y(h,[{key:"releaseMesh",value:function(){this._vb.setByteLength(0),this.vertNum=0,this.indexNum=0,h._POOL.push(this)}},{key:"destroy",value:function(){this._vb.destroy(),this._vb.deleteBuffer()}},{key:"addQuad",value:function(e,t,i,n){var a=this._vb,s=a._byteLength>>2,r=(a.setByteLength(s+h.const_stride<<2),a._floatArray32||a.getFloat32Array()),o=a._uint32Array,n=n?255:0;r[s++]=e[0],r[s++]=e[1],r[s++]=t[0],r[s++]=t[1],o[s++]=i,o[s++]=n,r[s++]=e[2],r[s++]=e[3],r[s++]=t[2],r[s++]=t[3],o[s++]=i,o[s++]=n,r[s++]=e[4],r[s++]=e[5],r[s++]=t[4],r[s++]=t[5],o[s++]=i,o[s++]=n,r[s++]=e[6],r[s++]=e[7],r[s++]=t[6],r[s++]=t[7],o[s++]=i,o[+s]=n,a._upload=!0}}],[{key:"__int__",value:function(){h._fixattriInfo=[5126,4,0,5121,4,16,5121,4,20]}},{key:"getAMesh",value:function(e){var t=null,t=h._POOL.length?h._POOL.pop():new h;return e&&t._vb._resizeBuffer(65536*h.const_stride,!1),t}}]),h}()),it=(tt.const_stride=24,tt._maxIB=16384,tt._POOL=[],function(){f(I,et);var t=T(I);function I(){var e;return b(this,I),(e=t.call(this,I.const_stride,4,4)).canReuse=!0,e.setAttributes(I._fixattriInfo),e}return y(I,[{key:"addData",value:function(e,t,i,n,a){var s=this._vb,r=this._ib,o=e.length>>1,h=s.needSize(o*I.const_stride)>>2,l=s._floatArray32||s.getFloat32Array(),u=s._uint32Array,c=0,_=n.a,f=n.b,d=n.c,p=n.d,y=n.tx,g=n.ty,m=0;for(m=0;m<o;m++){var v=e[c],x=e[c+1];l[h]=v*_+x*d+y,l[h+1]=v*f+x*p+g,l[h+2]=t[c],l[h+3]=t[c+1],u[h+4]=a,u[h+5]=255,h+=6,c+=2}s.setNeedUpload();var k=this.vertNum,n=i.length,s=r.needSize(i.byteLength),w=r.getUint16Array(),s=s>>1;if(0<k)for(var b=s+n,S=0,m=s;m<b;m++,S++)w[m]=i[S]+k;else w.set(i,s);r.setNeedUpload(),this.vertNum+=o,this.indexNum+=i.length}},{key:"releaseMesh",value:function(){this._vb.setByteLength(0),this._ib.setByteLength(0),this.vertNum=0,this.indexNum=0,I._POOL.push(this)}},{key:"destroy",value:function(){this._ib.destroy(),this._vb.destroy(),this._ib.disposeResource(),this._vb.deleteBuffer()}}],[{key:"__init__",value:function(){S.instance;I._fixattriInfo=[5126,4,0,5121,4,16,5121,4,20]}},{key:"getAMesh",value:function(e){var t=I._POOL.length?I._POOL.pop():new I;return e&&t._vb._resizeBuffer(65536*I.const_stride,!1),t}}]),I}()),nt=(it.const_stride=24,it._POOL=[],function(){f(u,et);var t=T(u);function u(){var e;return b(this,u),(e=t.call(this,u.const_stride,4,4)).canReuse=!0,e.setAttributes(u._fixattriInfo),e}return y(u,[{key:"addVertAndIBToMesh",value:function(e,t,i,n){for(var a=this._vb.needSize(t.length/2*u.const_stride)>>2,s=this._vb._floatArray32||this._vb.getFloat32Array(),r=this._vb._uint32Array,o=0,h=t.length/2,l=0;l<h;l++)s[a++]=t[o],s[a++]=t[o+1],o+=2,r[a++]=i;this._vb.setNeedUpload(),this._ib.append(new Uint16Array(n)),this._ib.setNeedUpload(),this.vertNum+=h,this.indexNum+=n.length}},{key:"releaseMesh",value:function(){this._vb.setByteLength(0),this._ib.setByteLength(0),this.vertNum=0,this.indexNum=0,u._POOL.push(this)}},{key:"destroy",value:function(){this._ib.destroy(),this._vb.destroy(),this._ib.disposeResource(),this._vb.deleteBuffer()}}],[{key:"__init__",value:function(){S.instance;u._fixattriInfo=[5126,2,0,5121,4,8]}},{key:"getAMesh",value:function(e){var t=u._POOL.length?u._POOL.pop():new u;return e&&t._vb._resizeBuffer(65536*u.const_stride,!1),t}}]),u}()),at=(nt.const_stride=12,nt._POOL=[],function(){function i(e,t){b(this,i),this.submitStartPos=0,this.submitEndPos=0,this.context=null,this.touches=[],this.submits=[],this.sprite=null,this.meshlist=[],this.cachedClipInfo=new Ce,this.oldTx=0,this.oldTy=0,this.invMat=new Ce,this.context=e,this.sprite=t,e._globalClipMatrix.copyTo(this.cachedClipInfo)}return y(i,[{key:"startRec",value:function(){this.context._charSubmitCache._enable&&(this.context._charSubmitCache.enable(!1,this.context),this.context._charSubmitCache.enable(!0,this.context)),this.context._incache=!0,this.touches.length=0,this.context.touches=this.touches,this.context._globalClipMatrix.copyTo(this.cachedClipInfo),this.submits.length=0,this.submitStartPos=this.context._submits._length;for(var e=0,t=this.meshlist.length;e<t;e++){var i=this.meshlist[e];i.canReuse?i.releaseMesh():i.destroy()}this.meshlist.length=0,this._mesh=tt.getAMesh(!1),this._pathMesh=nt.getAMesh(!1),this._triangleMesh=it.getAMesh(!1),this.meshlist.push(this._mesh),this.meshlist.push(this._pathMesh),this.meshlist.push(this._triangleMesh),this.context._curSubmit=w.RENDERBASE,this._oldMesh=this.context._mesh,this._oldPathMesh=this.context._pathMesh,this._oldTriMesh=this.context._triangleMesh,this._oldMeshList=this.context.meshlist,this.context._mesh=this._mesh,this.context._pathMesh=this._pathMesh,this.context._triangleMesh=this._triangleMesh,this.context.meshlist=this.meshlist,this.oldTx=this.context._curMat.tx,this.oldTy=this.context._curMat.ty,this.context._curMat.tx=0,this.context._curMat.ty=0,this.context._curMat.copyTo(this.invMat),this.invMat.invert()}},{key:"endRec",value:function(){this.context._charSubmitCache._enable&&(this.context._charSubmitCache.enable(!1,this.context),this.context._charSubmitCache.enable(!0,this.context));for(var e=this.context._submits,t=(this.submitEndPos=e._length,this.submitEndPos-this.submitStartPos),i=0;i<t;i++)this.submits.push(e[this.submitStartPos+i]);e._length-=t,this.context._mesh=this._oldMesh,this.context._pathMesh=this._oldPathMesh,this.context._triangleMesh=this._oldTriMesh,this.context.meshlist=this._oldMeshList,this.context._curSubmit=w.RENDERBASE,this.context._curMat.tx=this.oldTx,this.context._curMat.ty=this.oldTy,this.context.touches=null,this.context._incache=!1}},{key:"isCacheValid",value:function(){var e=this.context._globalClipMatrix;return e.a==this.cachedClipInfo.a&&e.b==this.cachedClipInfo.b&&e.c==this.cachedClipInfo.c&&e.d==this.cachedClipInfo.d&&e.tx==this.cachedClipInfo.tx&&e.ty==this.cachedClipInfo.ty}},{key:"flushsubmit",value:function(){var t=w.RENDERBASE;this.submits.forEach(function(e){e!=w.RENDERBASE&&(w.preRender=t,(t=e).renderSubmit())})}},{key:"releaseMem",value:function(){}}]),i}()),st=(at.matI=new Ce,function(){function e(){b(this,e),this.ALPHA=1,this.defines=new ge,this.shaderType=0,this.fillStyle=Ve.DEFAULT,this.strokeStyle=Ve.DEFAULT}return y(e,[{key:"destroy",value:function(){this.defines=null,this.filters=null}}],[{key:"__init__",value:function(){me.preCompile2D(0,ge.TEXTURE2D,"/*\r\n\ttexture和fillrect使用的。\r\n*/\r\nattribute vec4 posuv;\r\nattribute vec4 attribColor;\r\nattribute vec4 attribFlags;\r\n//attribute vec4 clipDir;\r\n//attribute vec2 clipRect;\r\nuniform vec4 clipMatDir;\r\nuniform vec2 clipMatPos;\t\t// 这个是全局的，不用再应用矩阵了。\r\nvarying vec2 cliped;\r\nuniform vec2 size;\r\nuniform vec2 clipOff;\t\t\t// 使用要把clip偏移。cacheas normal用. 只用了[0]\r\n#ifdef WORLDMAT\r\n\tuniform mat4 mmat;\r\n#endif\r\n#ifdef MVP3D\r\n\tuniform mat4 u_MvpMatrix;\r\n#endif\r\nvarying vec4 v_texcoordAlpha;\r\nvarying vec4 v_color;\r\nvarying float v_useTex;\r\n\r\nvoid main() {\r\n\r\n\tvec4 pos = vec4(posuv.xy,0.,1.);\r\n#ifdef WORLDMAT\r\n\tpos=mmat*pos;\r\n#endif\r\n\tvec4 pos1  =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,0.,1.0);\r\n#ifdef MVP3D\r\n\tgl_Position=u_MvpMatrix*pos1;\r\n#else\r\n\tgl_Position=pos1;\r\n#endif\r\n\tv_texcoordAlpha.xy = posuv.zw;\r\n\t//v_texcoordAlpha.z = attribColor.a/255.0;\r\n\tv_color = attribColor/255.0;\r\n\tv_color.xyz*=v_color.w;//反正后面也要预乘\r\n\t\r\n\tv_useTex = attribFlags.r/255.0;\r\n\tfloat clipw = length(clipMatDir.xy);\r\n\tfloat cliph = length(clipMatDir.zw);\r\n\t\r\n\tvec2 clpos = clipMatPos.xy;\r\n\t#ifdef WORLDMAT\r\n\t\t// 如果有mmat，需要修改clipMatPos,因为 这是cacheas normal （如果不是就错了）， clipMatPos被去掉了偏移\r\n\t\tif(clipOff[0]>0.0){\r\n\t\t\tclpos.x+=mmat[3].x;\t//tx\t最简单处理\r\n\t\t\tclpos.y+=mmat[3].y;\t//ty\r\n\t\t}\r\n\t#endif\r\n\tvec2 clippos = pos.xy - clpos;\t//pos已经应用矩阵了，为了减的有意义，clip的位置也要缩放\r\n\tif(clipw>20000. && cliph>20000.)\r\n\t\tcliped = vec2(0.5,0.5);\r\n\telse {\r\n\t\t//转成0到1之间。/clipw/clipw 表示clippos与normalize之后的clip朝向点积之后，再除以clipw\r\n\t\tcliped=vec2( dot(clippos,clipMatDir.xy)/clipw/clipw, dot(clippos,clipMatDir.zw)/cliph/cliph);\r\n\t}\r\n\r\n}","/*\r\n\ttexture和fillrect使用的。\r\n*/\r\n#ifdef GL_FRAGMENT_PRECISION_HIGH\r\nprecision highp float;\r\n#else\r\nprecision mediump float;\r\n#endif\r\n\r\nvarying vec4 v_texcoordAlpha;\r\nvarying vec4 v_color;\r\nvarying float v_useTex;\r\nuniform sampler2D texture;\r\nvarying vec2 cliped;\r\n\r\n#ifdef BLUR_FILTER\r\nuniform vec4 strength_sig2_2sig2_gauss1;\r\nuniform vec2 blurInfo;\r\n\r\n#define PI 3.141593\r\n\r\nfloat getGaussian(float x, float y){\r\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\r\n}\r\n\r\nvec4 blur(){\r\n    const float blurw = 9.0;\r\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\r\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \r\n    vec2 startpos=v_texcoordAlpha.xy-halfsz;\r\n    vec2 ctexcoord = startpos;\r\n    vec2 step = 1.0/blurInfo;  //每个像素      \r\n    \r\n    for(float y = 0.0;y<=blurw; ++y){\r\n        ctexcoord.x=startpos.x;\r\n        for(float x = 0.0;x<=blurw; ++x){\r\n            //TODO 纹理坐标的固定偏移应该在vs中处理\r\n            vec4Color += texture2D(texture, ctexcoord)*getGaussian(x-blurw/2.0,y-blurw/2.0);\r\n            ctexcoord.x+=step.x;\r\n        }\r\n        ctexcoord.y+=step.y;\r\n    }\r\n    return vec4Color;\r\n}\r\n#endif\r\n\r\n#ifdef COLOR_FILTER\r\nuniform vec4 colorAlpha;\r\nuniform mat4 colorMat;\r\n#endif\r\n\r\n#ifdef GLOW_FILTER\r\nuniform vec4 u_color;\r\nuniform vec4 u_blurInfo1;\r\nuniform vec4 u_blurInfo2;\r\n#endif\r\n\r\n#ifdef COLOR_ADD\r\nuniform vec4 colorAdd;\r\n#endif\r\n\r\n#ifdef FILLTEXTURE\t\r\nuniform vec4 u_TexRange;//startu,startv,urange, vrange\r\n#endif\r\nvoid main() {\r\n\tif(cliped.x<0.) discard;\r\n\tif(cliped.x>1.) discard;\r\n\tif(cliped.y<0.) discard;\r\n\tif(cliped.y>1.) discard;\r\n\t\r\n#ifdef FILLTEXTURE\t\r\n   vec4 color= texture2D(texture, fract(v_texcoordAlpha.xy)*u_TexRange.zw + u_TexRange.xy);\r\n#else\r\n   vec4 color= texture2D(texture, v_texcoordAlpha.xy);\r\n#endif\r\n\r\n   if(v_useTex<=0.)color = vec4(1.,1.,1.,1.);\r\n   color.a*=v_color.w;\r\n   //color.rgb*=v_color.w;\r\n   color.rgb*=v_color.rgb;\r\n   gl_FragColor=color;\r\n   \r\n   #ifdef COLOR_ADD\r\n\tgl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\r\n\tgl_FragColor.xyz *= colorAdd.a;\r\n   #endif\r\n   \r\n   #ifdef BLUR_FILTER\r\n\tgl_FragColor =   blur();\r\n\tgl_FragColor.w*=v_color.w;   \r\n   #endif\r\n   \r\n   #ifdef COLOR_FILTER\r\n\tmat4 alphaMat =colorMat;\r\n\r\n\talphaMat[0][3] *= gl_FragColor.a;\r\n\talphaMat[1][3] *= gl_FragColor.a;\r\n\talphaMat[2][3] *= gl_FragColor.a;\r\n\r\n\tgl_FragColor = gl_FragColor * alphaMat;\r\n\tgl_FragColor += colorAlpha/255.0*gl_FragColor.a;\r\n   #endif\r\n   \r\n   #ifdef GLOW_FILTER\r\n\tconst float c_IterationTime = 10.0;\r\n\tfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\r\n\tvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\r\n\tvec2 vec2FilterDir = vec2(-(u_blurInfo1.z)/u_blurInfo2.x,-(u_blurInfo1.w)/u_blurInfo2.y);\r\n\tvec2 vec2FilterOff = vec2(u_blurInfo1.x/u_blurInfo2.x/c_IterationTime * 2.0,u_blurInfo1.y/u_blurInfo2.y/c_IterationTime * 2.0);\r\n\tfloat maxNum = u_blurInfo1.x * u_blurInfo1.y;\r\n\tvec2 vec2Off = vec2(0.0,0.0);\r\n\tfloat floatOff = c_IterationTime/2.0;\r\n\tfor(float i = 0.0;i<=c_IterationTime; ++i){\r\n\t\tfor(float j = 0.0;j<=c_IterationTime; ++j){\r\n\t\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\r\n\t\t\tvec4Color += texture2D(texture, v_texcoordAlpha.xy + vec2FilterDir + vec2Off)/floatIterationTotalTime;\r\n\t\t}\r\n\t}\r\n\tgl_FragColor = vec4(u_color.rgb,vec4Color.a * u_blurInfo2.z);\r\n\tgl_FragColor.rgb *= gl_FragColor.a;   \r\n   #endif\r\n   \r\n}",null),me.preCompile2D(0,ge.PRIMITIVE,"attribute vec4 position;\r\nattribute vec4 attribColor;\r\n//attribute vec4 clipDir;\r\n//attribute vec2 clipRect;\r\nuniform vec4 clipMatDir;\r\nuniform vec2 clipMatPos;\r\n#ifdef WORLDMAT\r\n\tuniform mat4 mmat;\r\n#endif\r\nuniform mat4 u_mmat2;\r\n//uniform vec2 u_pos;\r\nuniform vec2 size;\r\nvarying vec4 color;\r\n//vec4 dirxy=vec4(0.9,0.1, -0.1,0.9);\r\n//vec4 clip=vec4(100.,30.,300.,600.);\r\nvarying vec2 cliped;\r\nvoid main(){\r\n\t\r\n#ifdef WORLDMAT\r\n\tvec4 pos=mmat*vec4(position.xy,0.,1.);\r\n\tgl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\r\n#else\r\n\tgl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\r\n#endif\t\r\n\tfloat clipw = length(clipMatDir.xy);\r\n\tfloat cliph = length(clipMatDir.zw);\r\n\tvec2 clippos = position.xy - clipMatPos.xy;\t//pos已经应用矩阵了，为了减的有意义，clip的位置也要缩放\r\n\tif(clipw>20000. && cliph>20000.)\r\n\t\tcliped = vec2(0.5,0.5);\r\n\telse {\r\n\t\t//clipdir是带缩放的方向，由于上面clippos是在缩放后的空间计算的，所以需要把方向先normalize一下\r\n\t\tcliped=vec2( dot(clippos,clipMatDir.xy)/clipw/clipw, dot(clippos,clipMatDir.zw)/cliph/cliph);\r\n\t}\r\n  //pos2d.x = dot(clippos,dirx);\r\n  color=attribColor/255.;\r\n}","precision mediump float;\r\n//precision mediump float;\r\nvarying vec4 color;\r\n//uniform float alpha;\r\nvarying vec2 cliped;\r\nvoid main(){\r\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\r\n\t//a.a*=alpha;\r\n    gl_FragColor= color;// vec4(color.r, color.g, color.b, alpha);\r\n\tgl_FragColor.rgb*=color.a;\r\n\tif(cliped.x<0.) discard;\r\n\tif(cliped.x>1.) discard;\r\n\tif(cliped.y<0.) discard;\r\n\tif(cliped.y>1.) discard;\r\n}",null),me.preCompile2D(0,ge.SKINMESH,"attribute vec2 position;\r\nattribute vec2 texcoord;\r\nattribute vec4 color;\r\nuniform vec2 size;\r\nuniform float offsetX;\r\nuniform float offsetY;\r\nuniform mat4 mmat;\r\nuniform mat4 u_mmat2;\r\nvarying vec2 v_texcoord;\r\nvarying vec4 v_color;\r\nvoid main() {\r\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\r\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\r\n  v_color = color;\r\n  v_color.rgb *= v_color.a;\r\n  v_texcoord = texcoord;  \r\n}","precision mediump float;\r\nvarying vec2 v_texcoord;\r\nvarying vec4 v_color;\r\nuniform sampler2D texture;\r\nuniform float alpha;\r\nvoid main() {\r\n\tvec4 t_color = texture2D(texture, v_texcoord);\r\n\tgl_FragColor = t_color.rgba * v_color;\r\n\tgl_FragColor *= alpha;\r\n}",null)}}]),e}()),rt=function(){function t(){b(this,t);var e=S.instance;this.ib=Je.create(e.DYNAMIC_DRAW),this.vb=$e.create(8)}return y(t,[{key:"addSkinMesh",value:function(e){e.getData2(this.vb,this.ib,this.vb._byteLength/32)}},{key:"reset",value:function(){this.vb.clear(),this.ib.clear()}}],[{key:"getInstance",value:function(){return t.instance=t.instance||new t}}]),t}(),ot=function(){function T(){b(this,T)}return y(T,null,[{key:"createLine2",value:function(e,t,i,n,a,s){if(e.length<4)return null;for(var r=T.tempData.length>e.length+2?T.tempData:new Array(e.length+2),o=(r[0]=e[0],r[1]=e[1],2),h=0,l=e.length,h=2;h<l;h+=2).01<Math.abs(e[h]-e[h-2])+Math.abs(e[h+1]-e[h-1])&&(r[o++]=e[h],r[o++]=e[h+1]);s&&.01<Math.abs(e[0]-r[o-2])+Math.abs(e[1]-r[o-1])&&(r[o++]=e[0],r[o++]=e[1]);var u,c,_,f,d,p,y,g=a,l=o/2,m=i/2,v=r[0],x=r[1],k=r[2],w=r[3],b=-(x-w),S=v-k,I=Math.sqrt(b*b+S*S);for(g.push(v-(b=b/I*m),x-(S=S/I*m),v+b,x+S),h=1;h<l-1;h++)v=r[2*(h-1)],x=r[2*(h-1)+1],k=r[2*h],w=r[2*h+1],f=r[2*(h+1)],c=r[2*(h+1)+1],S=v-k,y=k-f,_=(-(b=(b=-(x-w))/(I=Math.sqrt(b*b+S*S))*m)+v)*(-(S=S/I*m)+w)-(-b+k)*(-S+x),p=(-(d=(d=-(w-c))/(I=Math.sqrt(d*d+y*y))*m)+f)*(-(y=y/I*m)+w)-(-d+k)*(-y+c),y=(u=-S+x-(-S+w))*(d=-d+k-(-d+f))-(f=-y+c-(-y+w))*(c=-b+k-(-b+v)),Math.abs(y)<.1?(y+=10.1,g.push(k-b,w-S,k+b,w+S)):g.push(c=(c*p-d*_)/y,d=(f*_-u*p)/y,k-(c-k),w-(d-w));for(v=r[o-4],x=r[o-3],k=r[o-2],b=-(x-(w=r[o-1])),S=v-k,I=Math.sqrt(b*b+S*S),g.push(k-(b=b/I*m),w-(S=S/I*m),k+b,w+S),h=1;h<l;h++)t.push(n+2*(h-1),n+2*(h-1)+1,n+2*h+1,n+2*h+1,n+2*h,n+2*(h-1));return g}},{key:"createLineTriangle",value:function(e,t,i,n,a,s,r){var o=e.slice(),e=o.length,h=o[0],l=o[1],u=o[2],c=(o[2],0),_=0,f=0,d=0,p=e/2;if(!(p<=1)&&2!=p){for(var y=new Array(4*p),g=0,m=0,v=0;v<p-1;v++)h=o[m++],l=o[m++],u=o[m++],d=o[m++]-l,0!=(f=u-h)&&0!=d&&.001<(c=Math.sqrt(f*f+d*d))&&(y[_=4*g]=h,y[_+1]=l,y[_+2]=f/c,y[_+3]=d/c,g++);for(n?(h=o[e-2],l=o[e-1],u=o[0],d=o[1]-l,0!=(f=u-h)&&0!=d&&.001<(c=Math.sqrt(f*f+d*d))&&(y[_=4*g]=h,y[_+1]=l,y[_+2]=f/c,y[_+3]=d/c,g++)):(y[_=4*g]=h,y[_+1]=l,y[_+2]=f/c,y[_+3]=d/c,g++),v=m=0;v<p;v++)h=o[m],l=o[m+1],u=o[m+2],o[m+3]}}}]),T}(),ht=(ot.tempData=new Array(256),y(function e(t,i,n){b(this,e),this.i=t,this.x=i,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1})),lt=function(){function p(){b(this,p)}return y(p,null,[{key:"earcut",value:function(e,t,i){i=i||2;var n,a,s,r,o,h=t&&t.length,l=h?t[0]*i:e.length,u=p.linkedList(e,0,l,i,!0),c=[];if(!u)return c;if(h&&(u=p.eliminateHoles(e,t,u,i)),e.length>80*i){for(var _=n=e[0],f=a=e[1],d=i;d<l;d+=i)(s=e[d])<_&&(_=s),(r=e[d+1])<f&&(f=r),n<s&&(n=s),a<r&&(a=r);o=0!==(o=Math.max(n-_,a-f))?1/o:0}return p.earcutLinked(u,c,i,_,f,o),c}},{key:"linkedList",value:function(e,t,i,n,a){var s,r;if(a===0<p.signedArea(e,t,i,n))for(s=t;s<i;s+=n)r=p.insertNode(s,e[s],e[s+1],r);else for(s=i-n;t<=s;s-=n)r=p.insertNode(s,e[s],e[s+1],r);return r&&p.equals(r,r.next)&&(p.removeNode(r),r=r.next),r}},{key:"filterPoints",value:function(e,t){if(!e)return e;t=t||e;var i,n=e;do{if(i=!1,n.steiner||!p.equals(n,n.next)&&0!==p.area(n.prev,n,n.next))n=n.next;else{if(p.removeNode(n),(n=t=n.prev)===n.next)break;i=!0}}while(i||n!==t);return t}},{key:"earcutLinked",value:function(e,t,i,n,a,s){var r=6<arguments.length&&void 0!==arguments[6]?arguments[6]:null;if(e){!r&&s&&p.indexCurve(e,n,a,s);for(var o,h,l=e;e.prev!==e.next;)if(o=e.prev,h=e.next,s?p.isEarHashed(e,n,a,s):p.isEar(e))t.push(o.i/i),t.push(e.i/i),t.push(h.i/i),p.removeNode(e),e=h.next,l=h.next;else if((e=h)===l){r?1===r?(e=p.cureLocalIntersections(e,t,i),p.earcutLinked(e,t,i,n,a,s,2)):2===r&&p.splitEarcut(e,t,i,n,a,s):p.earcutLinked(p.filterPoints(e,null),t,i,n,a,s,1);break}}}},{key:"isEar",value:function(e){var t=e.prev,i=e,n=e.next;if(0<=p.area(t,i,n))return!1;for(var a=e.next.next;a!==e.prev;){if(p.pointInTriangle(t.x,t.y,i.x,i.y,n.x,n.y,a.x,a.y)&&0<=p.area(a.prev,a,a.next))return!1;a=a.next}return!0}},{key:"isEarHashed",value:function(e,t,i,n){var a=e.prev,s=e,r=e.next;if(0<=p.area(a,s,r))return!1;for(var o=(a.x<s.x?a.x<r.x?a:r:s.x<r.x?s:r).x,h=(a.y<s.y?a.y<r.y?a:r:s.y<r.y?s:r).y,l=(a.x>s.x?a.x>r.x?a:r:s.x>r.x?s:r).x,u=(a.y>s.y?a.y>r.y?a:r:s.y>r.y?s:r).y,c=p.zOrder(o,h,t,i,n),_=p.zOrder(l,u,t,i,n),f=e.nextZ;f&&f.z<=_;){if(f!==e.prev&&f!==e.next&&p.pointInTriangle(a.x,a.y,s.x,s.y,r.x,r.y,f.x,f.y)&&0<=p.area(f.prev,f,f.next))return!1;f=f.nextZ}for(f=e.prevZ;f&&f.z>=c;){if(f!==e.prev&&f!==e.next&&p.pointInTriangle(a.x,a.y,s.x,s.y,r.x,r.y,f.x,f.y)&&0<=p.area(f.prev,f,f.next))return!1;f=f.prevZ}return!0}},{key:"cureLocalIntersections",value:function(e,t,i){var n=e;do{var a=n.prev,s=n.next.next}while(!p.equals(a,s)&&p.intersects(a,n,n.next,s)&&p.locallyInside(a,s)&&p.locallyInside(s,a)&&(t.push(a.i/i),t.push(n.i/i),t.push(s.i/i),p.removeNode(n),p.removeNode(n.next),n=e=s),(n=n.next)!==e);return n}},{key:"splitEarcut",value:function(e,t,i,n,a,s){var r=e;do{for(var o,h=r.next.next;h!==r.prev;){if(r.i!==h.i&&p.isValidDiagonal(r,h))return o=p.splitPolygon(r,h),r=p.filterPoints(r,r.next),o=p.filterPoints(o,o.next),p.earcutLinked(r,t,i,n,a,s),void p.earcutLinked(o,t,i,n,a,s);h=h.next}}while((r=r.next)!==e)}},{key:"eliminateHoles",value:function(e,t,i,n){for(var a,s,r=[],o=0,h=t.length;o<h;o++)s=t[o]*n,a=o<h-1?t[o+1]*n:e.length,(s=p.linkedList(e,s,a,n,!1))===s.next&&(s.steiner=!0),r.push(p.getLeftmost(s));for(r.sort(p.compareX),o=0;o<r.length;o++)p.eliminateHole(r[o],i),i=p.filterPoints(i,i.next);return i}},{key:"compareX",value:function(e,t){return e.x-t.x}},{key:"eliminateHole",value:function(e,t){(t=p.findHoleBridge(e,t))&&(t=p.splitPolygon(t,e),p.filterPoints(t,t.next))}},{key:"findHoleBridge",value:function(e,t){var i,n=t,a=e.x,s=e.y,r=-1/0;do{if(s<=n.y&&s>=n.next.y&&n.next.y!==n.y){var o=n.x+(s-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(o<=a&&r<o){if((r=o)===a){if(s===n.y)return n;if(s===n.next.y)return n.next}i=n.x<n.next.x?n:n.next}}}while((n=n.next)!==t);if(!i)return null;if(a===r)return i.prev;for(var h,l=i,u=i.x,c=i.y,_=1/0,n=i.next;n!==l;)a>=n.x&&n.x>=u&&a!==n.x&&p.pointInTriangle(s<c?a:r,s,u,c,s<c?r:a,s,n.x,n.y)&&((h=Math.abs(s-n.y)/(a-n.x))<_||h===_&&n.x>i.x)&&p.locallyInside(n,e)&&(i=n,_=h),n=n.next;return i}},{key:"indexCurve",value:function(e,t,i,n){for(var a=e;null===a.z&&(a.z=p.zOrder(a.x,a.y,t,i,n)),a.prevZ=a.prev,a.nextZ=a.next,(a=a.next)!==e;);a.prevZ.nextZ=null,a.prevZ=null,p.sortLinked(a)}},{key:"sortLinked",value:function(e){var t,i,n,a,s,r,o,h,l=1;do{for(i=e,s=e=null,r=0;i;){for(r++,n=i,t=o=0;t<l&&(o++,n=n.nextZ);t++);for(h=l;0<o||0<h&&n;)0!==o&&(0===h||!n||i.z<=n.z)?(i=(a=i).nextZ,o--):(n=(a=n).nextZ,h--),s?s.nextZ=a:e=a,a.prevZ=s,s=a;i=n}}while(s.nextZ=null,l*=2,1<r);return e}},{key:"zOrder",value:function(e,t,i,n,a){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*a)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*a)|t<<8))|t<<4))|t<<2))|t<<1))<<1}},{key:"getLeftmost",value:function(e){for(var t=e,i=e;t.x<i.x&&(i=t),(t=t.next)!==e;);return i}},{key:"pointInTriangle",value:function(e,t,i,n,a,s,r,o){return 0<=(a-r)*(t-o)-(e-r)*(s-o)&&0<=(e-r)*(n-o)-(i-r)*(t-o)&&0<=(i-r)*(s-o)-(a-r)*(n-o)}},{key:"isValidDiagonal",value:function(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!p.intersectsPolygon(e,t)&&p.locallyInside(e,t)&&p.locallyInside(t,e)&&p.middleInside(e,t)}},{key:"area",value:function(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}},{key:"equals",value:function(e,t){return e.x===t.x&&e.y===t.y}},{key:"intersects",value:function(e,t,i,n){return!!(p.equals(e,t)&&p.equals(i,n)||p.equals(e,n)&&p.equals(i,t))||0<p.area(e,t,i)!=0<p.area(e,t,n)&&0<p.area(i,n,e)!=0<p.area(i,n,t)}},{key:"intersectsPolygon",value:function(e,t){var i=e;do{if(i.i!==e.i&&i.next.i!==e.i&&i.i!==t.i&&i.next.i!==t.i&&p.intersects(i,i.next,e,t))return!0}while((i=i.next)!==e);return!1}},{key:"locallyInside",value:function(e,t){return p.area(e.prev,e,e.next)<0?0<=p.area(e,t,e.next)&&0<=p.area(e,e.prev,t):p.area(e,t,e.prev)<0||p.area(e,e.next,t)<0}},{key:"middleInside",value:function(e,t){for(var i=e,n=!1,a=(e.x+t.x)/2,s=(e.y+t.y)/2;i.y>s!=i.next.y>s&&i.next.y!==i.y&&a<(i.next.x-i.x)*(s-i.y)/(i.next.y-i.y)+i.x&&(n=!n),(i=i.next)!==e;);return n}},{key:"splitPolygon",value:function(e,t){var i=new ht(e.i,e.x,e.y),n=new ht(t.i,t.x,t.y),a=e.next,s=t.prev;return(e.next=t).prev=e,(i.next=a).prev=i,(n.next=i).prev=n,(s.next=n).prev=s,n}},{key:"insertNode",value:function(e,t,i,n){e=new ht(e,t,i);return n?(e.next=n.next,(e.prev=n).next.prev=e,n.next=e):(e.prev=e).next=e,e}},{key:"removeNode",value:function(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}},{key:"signedArea",value:function(e,t,i,n){for(var a=0,s=t,r=i-n;s<i;s+=n)a+=(e[r]-e[s])*(e[s+1]+e[r+1]),r=s;return a}}]),p}(),ut=y(function e(){b(this,e)}),ct=(ut.BYTES_PE=4,ut.BYTES_PIDX=2,ut.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],ut.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],ut.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],ut._TMPARRAY=[],ut._OFFSETX=0,ut._OFFSETY=0,function(){f(s,w);var t=T(s);function s(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:w.TYPE_2D;return b(this,s),t.call(this,e)}return y(s,[{key:"renderSubmit",value:function(){if(0===this._numEle||!this._mesh||0==this._numEle)return 1;var e=this.shaderValue.textureHost;if(e){e=e._getSource();if(!e)return 1;this.shaderValue.texture=e}e=v.mainContext;return this._mesh.useMesh(e),this.shaderValue.upload(),pe.activeBlendFunction!==this._blendFn&&(v.setBlend(e,!0),this._blendFn(e),pe.activeBlendFunction=this._blendFn),e.drawElements(e.TRIANGLES,this._numEle,e.UNSIGNED_SHORT,this._startIdx),k.renderBatches++,k.trianglesFaces+=this._numEle/3,1}},{key:"releaseRender",value:function(){w.RENDERBASE!=this&&--this._ref<1&&((s.POOL[s._poolSize++]=this).shaderValue.release(),this.shaderValue=null,this._mesh=null,this._parent&&(this._parent.releaseRender(),this._parent=null))}}],[{key:"create",value:function(e,t,i){var n=s._poolSize?s.POOL[--s._poolSize]:new s,t=(n._ref=1,n._mesh=t,n._key.clear(),n._startIdx=t.indexNum*ut.BYTES_PIDX,n._numEle=0,e._nBlendType),t=(n._blendFn=(e._targets?pe.targetFns:pe.fns)[t],n.shaderValue=i,n.shaderValue.setValue(e._shader2D),e._shader2D.filters);return t&&n.shaderValue.setFilters(t),n}},{key:"createShape",value:function(e,t,i,n){var a=s._poolSize?s.POOL[--s._poolSize]:new s,i=(a._mesh=t,a._numEle=i,a._startIdx=2*t.indexNum,a._ref=1,a.shaderValue=n,a.shaderValue.setValue(e._shader2D),e._nBlendType);return a._key.blendShader=i,a._blendFn=(e._targets?pe.targetFns:pe.fns)[i],a}}]),s}()),_t=(ct._poolSize=0,ct.POOL=[],function(){f(a,w);var t=T(a);function a(){var e;return b(this,a),(e=t.call(this,w.TYPE_2D))._matrix=new Ce,e._matrix4=ut.defaultMatrix4.concat(),e.shaderValue=new xe(0,0),e}return y(a,[{key:"renderSubmit",value:function(){var e=_e.worldAlpha,t=_e.worldMatrix4,i=_e.worldMatrix,n=_e.worldFilters,a=_e.worldShaderDefines,s=this.shaderValue,r=this._matrix,o=this._matrix4,h=Ce.TEMP;return Ce.mul(r,i,h),o[0]=h.a,o[1]=h.b,o[4]=h.c,o[5]=h.d,o[12]=h.tx,o[13]=h.ty,_e.worldMatrix=h.clone(),_e.worldMatrix4=o,_e.worldAlpha=_e.worldAlpha*s.alpha,s.filters&&s.filters.length&&(_e.worldFilters=s.filters,_e.worldShaderDefines=s.defines),this.canv.flushsubmit(),_e.worldAlpha=e,_e.worldMatrix4=t,_e.worldMatrix.destroy(),_e.worldMatrix=i,_e.worldFilters=n,_e.worldShaderDefines=a,1}},{key:"releaseRender",value:function(){var e;--this._ref<1&&(e=a.POOL,this._mesh=null,e[e._length++]=this)}},{key:"getRenderType",value:function(){return w.TYPE_CANVAS}}],[{key:"create",value:function(e,t,i){var n=a.POOL._length?a.POOL[--a.POOL._length]:new a,e=(n.canv=e,n._ref=1,n._numEle=0,n.shaderValue);return e.alpha=t,e.defines.setValue(0),i&&i.length&&e.setFilters(i),n}}]),a}()),ft=(_t.POOL=[],_t.POOL._length=0,function(){function s(){b(this,s),this.blendType=0,this._ref=1,this._key=new ke}return y(s,[{key:"renderSubmit",value:function(){var e=v.mainContext,t=(this._mesh.useMesh(e),this.srcRT);return t&&(this.shaderValue.texture=t._getSource(),this.shaderValue.upload(),this.blend(),k.renderBatches++,k.trianglesFaces+=this._numEle/3,e.drawElements(e.TRIANGLES,this._numEle,e.UNSIGNED_SHORT,this._startIdx)),1}},{key:"blend",value:function(){var e;pe.activeBlendFunction!==pe.fns[this.blendType]&&((e=v.mainContext).enable(e.BLEND),pe.fns[this.blendType](e),pe.activeBlendFunction=pe.fns[this.blendType])}},{key:"getRenderType",value:function(){return 0}},{key:"releaseRender",value:function(){var e;--this._ref<1&&((e=s.POOL)[e._length++]=this)}}],[{key:"create",value:function(e,t,i,n){var a=s.POOL._length?s.POOL[--s.POOL._length]:new s;return a._mesh=t,a.srcRT=n,a._startIdx=t.indexNum*ut.BYTES_PIDX,a._ref=1,a._key.clear(),a._numEle=0,a.blendType=e._nBlendType,a._key.blendShader=a.blendType,a.shaderValue=i,a.shaderValue.setValue(e._shader2D),e._colorFiler&&(n=e._colorFiler,i.defines.add(n.type),i.colorMat=n._mat,i.colorAlpha=n._alpha),a}}]),s}()),dt=(ft.POOL=[],ft.POOL._length=0,function(){f(a,w);var t=T(a);function a(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:w.TYPE_2D;return b(this,a),t.call(this,e)}return y(a,[{key:"releaseRender",value:function(){--this._ref<1&&((a.POOL[a._poolSize++]=this).shaderValue.release(),this._mesh=null,this._parent&&(this._parent.releaseRender(),this._parent=null))}},{key:"renderSubmit",value:function(){if(0===this._numEle)return 1;var e=this.shaderValue.textureHost;if(e){var t=e?e._getSource():null;if(!t)return 1}var e=v.mainContext,i=(this._mesh.useMesh(e),w.preRender),n=w.preRender._key;return 0===this._key.blendShader&&this._key.submitType===n.submitType&&this._key.blendShader===n.blendShader&&ce.activeShader&&w.preRender.clipInfoID==this.clipInfoID&&i.shaderValue.defines._value===this.shaderValue.defines._value&&0==(this.shaderValue.defines._value&ge.NOOPTMASK)?ce.activeShader.uploadTexture2D(t):(pe.activeBlendFunction!==this._blendFn&&(v.setBlend(e,!0),this._blendFn(e),pe.activeBlendFunction=this._blendFn),this.shaderValue.texture=t,this.shaderValue.upload()),e.drawElements(e.TRIANGLES,this._numEle,e.UNSIGNED_SHORT,this._startIdx),k.renderBatches++,k.trianglesFaces+=this._numEle/3,1}}],[{key:"create",value:function(e,t,i){var n=a._poolSize?a.POOL[--a._poolSize]:new a(w.TYPE_TEXTURE),t=(n._mesh=t,n._key.clear(),n._key.submitType=w.KEY_DRAWTEXTURE,n._ref=1,n._startIdx=t.indexNum*ut.BYTES_PIDX,n._numEle=0,e._nBlendType);return n._key.blendShader=t,n._blendFn=(e._targets?pe.targetFns:pe.fns)[t],n.shaderValue=i,e._colorFiler&&(t=e._colorFiler,i.defines.add(t.type),i.colorMat=t._mat,i.colorAlpha=t._alpha),n}}]),a}()),pt=(dt._poolSize=0,dt.POOL=[],function(){function r(){b(this,r),this._data=[],this._ndata=0,this._clipid=-1,this._clipMatrix=new Ce,this._enable=!1}return y(r,[{key:"clear",value:function(){this._tex=null,this._imgId=-1,this._ndata=0,this._enable=!1,this._colorFiler=null}},{key:"destroy",value:function(){this.clear(),this._data.length=0,this._data=null}},{key:"add",value:function(e,t,i,n,a,s){0<this._ndata&&(this._tex!=t||this._imgId!=i||0<=this._clipid&&this._clipid!=e._clipInfoID)&&this.submit(e),this._clipid=e._clipInfoID,e._globalClipMatrix.copyTo(this._clipMatrix),this._tex=t,this._imgId=i,this._colorFiler=e._colorFiler,this._data[this._ndata]=n,this._data[this._ndata+1]=a,this._data[this._ndata+2]=s,this._ndata+=3}},{key:"getPos",value:function(){return 0==r.__nPosPool?new Array(8):r.__posPool[--r.__nPosPool]}},{key:"enable",value:function(e,t){e!==this._enable&&(this._enable=e,this._enable||this.submit(t))}},{key:"submit",value:function(e){var t=this._ndata;if(t){var i=e._mesh,n=e._colorFiler,a=(e._colorFiler=this._colorFiler,dt.create(e,i,xe.create(ge.TEXTURE2D,0)));(e._submits[e._submits._length++]=e._curSubmit=a).shaderValue.textureHost=this._tex,a._key.other=this._imgId,e._colorFiler=n,e._copyClipInfo(a,this._clipMatrix),a.clipInfoID=this._clipid;for(var s=0;s<t;s+=3)i.addQuad(this._data[s],this._data[s+1],this._data[s+2],!0),r.__posPool[r.__nPosPool++]=this._data[s];a._numEle+=6*(t/=3),i.indexNum+=6*t,i.vertNum+=4*t,e._drawCount+=t,this._ndata=0,Qe.loopCount%100==0&&(this._data.length=0)}}}]),r}()),yt=(pt.__posPool=[],pt.__nPosPool=0,function(){function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;b(this,n),this.atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._used=0,this._cells=null,this._rowInfo=null,this.atlasID=i,this._init(e,t)}return y(n,[{key:"addRect",value:function(e,t,i,n){return!!this._get(t,i,n)&&(this._fill(n.x,n.y,t,i,e),this._texCount++,!0)}},{key:"_release",value:function(){this._cells=null,this._rowInfo=null}},{key:"_init",value:function(e,t){return this._width=e,this._height=t,this._release(),0!=this._width&&(this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=new Uint8Array(this._height),this._used=0,this._clear(),!0)}},{key:"_get",value:function(e,t,i){if(e>this._width||t>this._height)return!1;for(var n=-1,a=this._width,s=this._height,r=this._cells,o=0;o<s;o++)if(!(this._rowInfo[o]<e))for(var h=0;h<a;){var l=3*(o*a+h);if(0!=r[l]||r[1+l]<e||r[2+l]<t)h+=r[1+l];else{for(var n=h,u=o,c=0;c<e;c++)if(r[3*c+l+2]<t){n=-1;break}if(!(n<0))return i.x=n,i.y=u,!0;h+=r[1+l]}}return!1}},{key:"_fill",value:function(e,t,i,n,a){var s=this._width,r=this._height;this._check(e+i<=s&&t+n<=r);for(var o=t;o<n+t;++o){this._check(this._rowInfo[o]>=i),this._rowInfo[o]-=i;for(var h=0;h<i;h++){var l=3*(e+o*s+h);this._check(0==this._cells[l]),this._cells[l]=a,this._cells[1+l]=i,this._cells[2+l]=n}}if(0<e)for(o=0;o<n;++o){for(var u=0,h=e-1;0<=h&&0==this._cells[3*((t+o)*s+h)];--h,++u);for(h=u;0<h;--h)this._cells[3*((t+o)*s+e-h)+1]=h,this._check(0<h)}if(0<t)for(h=e;h<e+i;++h){for(u=0,o=t-1;0<=o&&0==this._cells[3*(h+o*s)];--o,u++);for(o=u;0<o;--o)this._cells[3*(h+(t-o)*s)+2]=o,this._check(0<o)}this._used+=i*n/(this._width*this._height)}},{key:"_check",value:function(e){0==e&&console.log("xtexMerger 错误啦")}},{key:"_clear",value:function(){for(var e=this._texCount=0;e<this._height;e++)this._rowInfo[e]=this._width;for(var t=0;t<this._height;t++)for(var i=0;i<this._width;i++){var n=3*(t*this._width+i);this._cells[n]=0,this._cells[1+n]=this._width-i,this._cells[2+n]=this._width-t}}}]),n}()),gt=function(){f(r,oe);var n=T(r);function r(e,t){var i;return b(this,r),(i=n.call(this))._texW=0,i._texH=0,i.__destroyed=!1,i._discardTm=0,i.genID=0,i.bitmap={id:0,_glTexture:null},i.curUsedCovRate=0,i.curUsedCovRateAtlas=0,i.lastTouchTm=0,i.ri=null,i._texW=e||r.gTextRender.atlasWidth,i._texH=t||r.gTextRender.atlasWidth,i.bitmap.id=i.id,i.lock=!0,i}return y(r,[{key:"recreateResource",value:function(){var e,t;this._source||(e=S.instance,t=this._source=e.createTexture(),this.bitmap._glTexture=t,v.bindTexture(e,e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this._texW,this._texH,0,e.RGBA,e.UNSIGNED_BYTE,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),r.gTextRender.debugUV&&this.fillWhite())}},{key:"addChar",value:function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;if(r.gTextRender.isWan1Wan)return this.addCharCanvas(e,t,i,n);this._source||this.recreateResource();var a=S.instance,s=(v.bindTexture(a,a.TEXTURE_2D,this._source),L.Render.isConchApp||a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),e.data);return e.data instanceof Uint8ClampedArray&&(s=new Uint8Array(s.buffer)),a.texSubImage2D(a.TEXTURE_2D,0,t,i,e.width,e.height,a.RGBA,a.UNSIGNED_BYTE,s),L.Render.isConchApp||a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),s=t/this._texW,a=i/this._texH,t=(t+e.width)/this._texW,i=(i+e.height)/this._texH,(n=n||new Array(8))[0]=s,n[1]=a,n[2]=t,n[3]=a,n[4]=t,n[5]=i,n[6]=s,n[7]=i,n}},{key:"addCharCanvas",value:function(e,t,i){var n,a,s,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,o=(this._source||this.recreateResource(),S.instance);return v.bindTexture(o,o.TEXTURE_2D,this._source),L.Render.isConchApp||o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),o.texSubImage2D(o.TEXTURE_2D,0,t,i,o.RGBA,o.UNSIGNED_BYTE,e),L.Render.isConchApp||o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),o=L.Render.isConchApp?(n=t/this._texW,a=i/this._texH,s=(t+e.width)/this._texW,(i+e.height)/this._texH):(n=(t+1)/this._texW,a=(i+1)/this._texH,s=(t+e.width-1)/this._texW,(i+e.height-1)/this._texH),(r=r||new Array(8))[0]=n,r[1]=a,r[2]=s,r[3]=a,r[4]=s,r[5]=o,r[6]=n,r[7]=o,r}},{key:"fillWhite",value:function(){this._source||this.recreateResource();var e=S.instance,t=new Uint8Array(this._texW*this._texH*4);t.fill(255),e.texSubImage2D(e.TEXTURE_2D,0,0,0,this._texW,this._texH,e.RGBA,e.UNSIGNED_BYTE,t)}},{key:"discard",value:function(){L.stage.setGlobalRepaint(),this.destroy()}},{key:"destroy",value:function(){this.__destroyed=!0;var e=S.instance;this._source&&e.deleteTexture(this._source),this._source=null}},{key:"touchRect",value:function(e,t){this.lastTouchTm!=t&&(this.curUsedCovRate=0,this.curUsedCovRateAtlas=0,this.lastTouchTm=t);var t=r.gTextRender.atlasWidth*r.gTextRender.atlasWidth,i=L.TextAtlas.atlasGridW*L.TextAtlas.atlasGridW;this.curUsedCovRate+=e.bmpWidth*e.bmpHeight/t,this.curUsedCovRateAtlas+=Math.ceil(e.bmpWidth/L.TextAtlas.atlasGridW)*Math.ceil(e.bmpHeight/L.TextAtlas.atlasGridW)/(t/i)}},{key:"texture",get:function(){return this}},{key:"_getSource",value:function(){return this._source}},{key:"drawOnScreen",value:function(e,t){}}],[{key:"getTextTexture",value:function(e,t){return new r(e,t)}},{key:"clean",value:function(){var e=Qe.loopStTm;if(e-(r.cleanTm=0===r.cleanTm?e:r.cleanTm)>=r.gTextRender.checkCleanTextureDt){for(var t=0;t<r.poolLen;t++){var i=r.pool[t];e-i._discardTm>=r.gTextRender.destroyUnusedTextureDt&&(i.destroy(),r.pool[t]=r.pool[r.poolLen-1],r.poolLen--,t--)}r.cleanTm=e}}}]),r}(),mt=(gt.gTextRender=null,gt.pool=new Array(10),gt.poolLen=0,gt.cleanTm=0,function(){function n(){b(this,n),this.texWidth=1024,this.texHeight=1024,this.texture=null,this.charMaps={},this.texHeight=this.texWidth=L.TextRender.atlasWidth,this.texture=gt.getTextTexture(this.texWidth,this.texHeight),256<this.texWidth/n.atlasGridW&&(n.atlasGridW=Math.ceil(this.texWidth/256)),this.atlasgrid=new yt(this.texWidth/n.atlasGridW,this.texHeight/n.atlasGridW,this.texture.id)}return y(n,[{key:"setProtecteDist",value:function(e){}},{key:"getAEmpty",value:function(e,t,i){e=this.atlasgrid.addRect(1,Math.ceil(e/n.atlasGridW),Math.ceil(t/n.atlasGridW),i);return e&&(i.x*=n.atlasGridW,i.y*=n.atlasGridW),e}},{key:"usedRate",get:function(){return this.atlasgrid._used}},{key:"destroy",value:function(){for(var e in this.charMaps)this.charMaps[e].deleted=!0;this.texture.discard()}},{key:"printDebugInfo",value:function(){}}]),n}()),Me=(mt.atlasGridW=16,function(){function e(){b(this,e)}return y(e,[{key:"setTo",value:function(e,t,i){return this.type=e,this.currentTarget=t,this.target=i,this}},{key:"stopPropagation",value:function(){this._stoped=!0}},{key:"touches",get:function(){if(!this.nativeEvent)return null;var e=this.nativeEvent.touches;if(e)for(var t=L.stage,i=0,n=e.length;i<n;i++){var a=e[i],s=ie.TEMP;s.setTo(a.clientX,a.clientY),t._canvasTransform.invertTransformPoint(s),t.transform.invertTransformPoint(s),a.stageX=s.x,a.stageY=s.y}return e}},{key:"altKey",get:function(){return this.nativeEvent.altKey}},{key:"ctrlKey",get:function(){return this.nativeEvent.ctrlKey}},{key:"shiftKey",get:function(){return this.nativeEvent.shiftKey}},{key:"charCode",get:function(){return this.nativeEvent.charCode}},{key:"keyLocation",get:function(){return this.nativeEvent.location||this.nativeEvent.keyLocation}},{key:"stageX",get:function(){return L.stage.mouseX}},{key:"stageY",get:function(){return L.stage.mouseY}}]),e}()),vt=(Me.EMPTY=new Me,Me.MOUSE_DOWN="mousedown",Me.MOUSE_UP="mouseup",Me.CLICK="click",Me.RIGHT_MOUSE_DOWN="rightmousedown",Me.RIGHT_MOUSE_UP="rightmouseup",Me.RIGHT_CLICK="rightclick",Me.MOUSE_MOVE="mousemove",Me.MOUSE_OVER="mouseover",Me.MOUSE_OUT="mouseout",Me.MOUSE_WHEEL="mousewheel",Me.ROLL_OVER="mouseover",Me.ROLL_OUT="mouseout",Me.DOUBLE_CLICK="doubleclick",Me.CHANGE="change",Me.CHANGED="changed",Me.RESIZE="resize",Me.ADDED="added",Me.REMOVED="removed",Me.DISPLAY="display",Me.UNDISPLAY="undisplay",Me.ERROR="error",Me.COMPLETE="complete",Me.LOADED="loaded",Me.READY="ready",Me.PROGRESS="progress",Me.INPUT="input",Me.RENDER="render",Me.OPEN="open",Me.MESSAGE="message",Me.CLOSE="close",Me.KEY_DOWN="keydown",Me.KEY_PRESS="keypress",Me.KEY_UP="keyup",Me.FRAME="enterframe",Me.DRAG_START="dragstart",Me.DRAG_MOVE="dragmove",Me.DRAG_END="dragend",Me.ENTER="enter",Me.SELECT="select",Me.BLUR="blur",Me.FOCUS="focus",Me.VISIBILITY_CHANGE="visibilitychange",Me.FOCUS_CHANGE="focuschange",Me.PLAYED="played",Me.PAUSED="paused",Me.STOPPED="stopped",Me.START="start",Me.END="end",Me.COMPONENT_ADDED="componentadded",Me.COMPONENT_REMOVED="componentremoved",Me.RELEASED="released",Me.LINK="link",Me.LABEL="label",Me.FULL_SCREEN_CHANGE="fullscreenchange",Me.DEVICE_LOST="devicelost",Me.TRANSFORM_CHANGED="transformchanged",Me.ANIMATION_CHANGED="animationchanged",Me.TRAIL_FILTER_CHANGE="trailfilterchange",Me.TRIGGER_ENTER="triggerenter",Me.TRIGGER_STAY="triggerstay",Me.TRIGGER_EXIT="triggerexit",function(){f(p,ae);var s=T(p);function p(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;return b(this,p),(e=s.call(this)).uvrect=[0,0,1,1],e._destroyed=!1,e._referenceCount=0,e.$_GID=0,e.offsetX=0,e.offsetY=0,e._w=0,e._h=0,e.sourceWidth=0,e.sourceHeight=0,e.url=null,e.scaleRate=1,e.setTo(t,i,n,a),e}return y(p,[{key:"uv",get:function(){return this._uv},set:function(e){this.uvrect[0]=Math.min(e[0],e[2],e[4],e[6]),this.uvrect[1]=Math.min(e[1],e[3],e[5],e[7]),this.uvrect[2]=Math.max(e[0],e[2],e[4],e[6])-this.uvrect[0],this.uvrect[3]=Math.max(e[1],e[3],e[5],e[7])-this.uvrect[1],this._uv=e}},{key:"width",get:function(){return this._w||(this.bitmap?this.uv&&this.uv!==p.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width:0)},set:function(e){this._w=e,this.sourceWidth||(this.sourceWidth=e)}},{key:"height",get:function(){return this._h||(this.bitmap?this.uv&&this.uv!==p.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height:0)},set:function(e){this._h=e,this.sourceHeight||(this.sourceHeight=e)}},{key:"bitmap",get:function(){return this._bitmap},set:function(e){this._bitmap&&this._bitmap._removeReference(this._referenceCount),(this._bitmap=e)&&e._addReference(this._referenceCount)}},{key:"destroyed",get:function(){return this._destroyed}},{key:"_addReference",value:function(){this._bitmap&&this._bitmap._addReference(),this._referenceCount++}},{key:"_removeReference",value:function(){this._bitmap&&this._bitmap._removeReference(),this._referenceCount--}},{key:"_getSource",value:function(){return this._destroyed||!this._bitmap?null:(this.recoverBitmap(0<arguments.length&&void 0!==arguments[0]?arguments[0]:null),this._bitmap.destroyed?null:this.bitmap._getSource())}},{key:"_onLoaded",value:function(e,t){t&&t!=this&&(t instanceof p?p._create(t,0,0,t.width,t.height,0,0,t.sourceWidth,t.sourceHeight,this):(this.bitmap=t,this.sourceWidth=this._w=t.width,this.sourceHeight=this._h=t.height)),e&&e.run(),this.event(Me.READY,this)}},{key:"getIsReady",value:function(){return!this._destroyed&&!!this._bitmap}},{key:"setTo",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;this.bitmap=e,this.sourceWidth=i,this.sourceHeight=n,e&&(this._w=e.width,this._h=e.height,this.sourceWidth=this.sourceWidth||e.width,this.sourceHeight=this.sourceHeight||e.height),this.uv=t||p.DEF_UV}},{key:"load",value:function(e){this._destroyed||L.loader.load(e,x.create(this,this._onLoaded,[1<arguments.length&&void 0!==arguments[1]?arguments[1]:null]),null,"htmlimage",1,!0)}},{key:"getTexturePixels",value:function(e,t,i,n){var a=this.bitmap,s=a.width,r=a.height;if(s<e+i&&(i-=e+i-s),r<t+n&&(n-=t+n-r),i<=0||n<=0)return null;var o=4*i,h=null;try{h=a.getPixels()}catch(e){}if(h){if(0==e&&0==t&&i==s&&n==r)return h;for(var l=new Uint8Array(i*n*4),u=4*e,c=(t+n-1)*(o=4*s)+4*e,_=n-1;0<=_;_--)l.set(p.slice(c,c+4*i),u),u+=o,c-=o;return l}var f,d,a=new L.Context,h=(a.size(i,n),a.asBitmap=!0,null),p=(0==e&&0==t&&i==s&&n==r||(f=(h=this._uv.slice())[0],d=h[1],h=[f+e*(s=(h[2]-f)/s),d+t*(r=(h[7]-d)/r),f+(e+i)*s,d+t*r,f+(e+i)*s,d+(t+n)*r,f+e*s,d+(t+n)*r]),a._drawTextureM(this,0,0,i,n,null,1,h),a._targets.start(),a.flush(),a._targets.end(),a._targets.restore(),a._targets.getData(0,0,i,n));for(a.destroy(),l=new Uint8Array(i*n*4),u=0,c=(n-1)*o,_=n-1;0<=_;_--)l.set(p.slice(c,c+o),u),u+=o,c-=o;return l}},{key:"getPixels",value:function(e,t,i,n){return window.conch?this._nativeObj.getImageData(e,t,i,n):this.getTexturePixels(e,t,i,n)}},{key:"recoverBitmap",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,e=this._bitmap.url;this._destroyed||this._bitmap&&!this._bitmap.destroyed||!e||L.loader.load(e,x.create(this,function(e){this.bitmap=e,t&&t()}),null,"htmlimage",1,!0)}},{key:"disposeBitmap",value:function(){!this._destroyed&&this._bitmap&&this._bitmap.destroy()}},{key:"destroy",value:function(){var e,t=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this._destroyed||(this._destroyed=!0,(e=this._bitmap)&&(e._removeReference(this._referenceCount),0!==e.referenceCount&&!t||e.destroy(),e=null),this.url&&this===L.loader.getRes(this.url)&&L.Loader.clearRes(this.url))}}],[{key:"moveUV",value:function(e,t,i){for(var n=0;n<8;n+=2)i[n]+=e,i[n+1]+=t;return i}},{key:"create",value:function(e,t,i,n,a){return p._create(e,t,i,n,a,5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,6<arguments.length&&void 0!==arguments[6]?arguments[6]:0,7<arguments.length&&void 0!==arguments[7]?arguments[7]:0,8<arguments.length&&void 0!==arguments[8]?arguments[8]:0)}},{key:"_create",value:function(e,t,i,n,a){var s,r=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,o=6<arguments.length&&void 0!==arguments[6]?arguments[6]:0,h=7<arguments.length&&void 0!==arguments[7]?arguments[7]:0,l=8<arguments.length&&void 0!==arguments[8]?arguments[8]:0,u=9<arguments.length&&void 0!==arguments[9]?arguments[9]:null,c=e instanceof p,_=c?e.uv:p.DEF_UV,c=c?e.bitmap:e,e=(c.width&&t+n>c.width&&(n=c.width-t),c.height&&i+a>c.height&&(a=c.height-i),u?(s=u).setTo(c,null,h||n,l||a):s=new p(c,null,h||n,l||a),s.width=n,s.height=a,s.offsetX=r,s.offsetY=o,1/c.width),u=1/c.height,h=s.uv[0],l=s.uv[1],r=s.uv[4],o=s.uv[5],f=r-h,d=o-l,_=p.moveUV(_[0],_[1],[t*=e,i*=u,t+(n*=e),i,t+n,i+(a*=u),t,i+a]),e=(s.uv=new Float32Array([h+_[0]*f,l+_[1]*d,r-(1-_[2])*f,l+_[3]*d,r-(1-_[4])*f,o-(1-_[5])*d,h+_[6]*f,o-(1-_[7])*d]),c.scaleRate);return e&&1!=e?(s.sourceWidth/=e,s.sourceHeight/=e,s.width/=e,s.height/=e,s.scaleRate=e):s.scaleRate=1,s}},{key:"createFromTexture",value:function(e,t,i,n,a){var s=e.scaleRate,s=(1!=s&&(t*=s,i*=s,n*=s,a*=s),ne.TEMP.setTo(t-e.offsetX,i-e.offsetY,n,a)),t=s.intersection(p._rect1.setTo(0,0,e.width,e.height),p._rect2);return t?p.create(e,t.x,t.y,t.width,t.height,t.x-s.x,t.y-s.y,n,a):null}}]),p}()),xt=(vt.DEF_UV=new Float32Array([0,0,1,0,1,1,0,1]),vt.NO_UV=new Float32Array([0,0,0,0,0,0,0,0]),vt.INV_UV=new Float32Array([0,1,1,1,1,0,0,0]),vt._rect1=new ne,vt._rect2=new ne,function(){function i(e){b(this,i),this._font="14px Arial",this._family="Arial",this._size=14,this._italic=!1,this._bold=!1,this._id=i._gfontID++,this.setFont(e||this._font)}return y(i,[{key:"setFont",value:function(e){var t=(this._font=e).split(" "),i=t.length;if(i<2)1==i&&0<t[0].indexOf("px")&&(this._size=parseInt(t[0]));else{for(var n=-1,a=0;a<i;a++)if(0<t[a].indexOf("px")||0<t[a].indexOf("pt")){n=a,this._size=parseInt(t[a]),this._size<=0&&(console.error("font parse error:"+e),this._size=14);break}var s=n+1,r=t[s];for(s++;s<i;s++)r+=" "+t[s];this._family=r.split(",")[0],this._italic=0<=t.indexOf("italic"),this._bold=0<=t.indexOf("bold")}}}],[{key:"Parse",value:function(e){if(e===i._lastFont)return i._lastFontInfo;var t=(t=i._cache[e])||(i._cache[e]=new i(e));return i._lastFont=e,i._lastFontInfo=t}}]),i}()),kt=(xt.EMPTY=new xt(null),xt._cache={},xt._gfontID=0,xt._lastFont="",function(){function e(){b(this,e),this.save=[],this.toUpperCase=null,this.width=-1,this.pageChars=[],this.startID=0,this.startIDStroke=0,this.lastGCCnt=0,this.splitRender=!1}return y(e,[{key:"setText",value:function(e){this.changed=!0,this._text=e,this.width=-1,this.cleanCache()}},{key:"toString",value:function(){return this._text}},{key:"length",get:function(){return this._text?this._text.length:0}},{key:"charCodeAt",value:function(e){return this._text?this._text.charCodeAt(e):NaN}},{key:"charAt",value:function(e){return this._text?this._text.charAt(e):null}},{key:"cleanCache",value:function(){this.pageChars.forEach(function(e){var t=e.tex;e.words;1==e.words.length&&t&&t.ri&&t.destroy()}),this.pageChars=[],this.startID=0}}]),e}()),wt=function(){function e(){b(this,e),this.char="",this.deleted=!1,this.uv=new Array(8),this.pos=0,this.orix=0,this.oriy=0,this.touchTick=0,this.isSpace=!1}return y(e,[{key:"touch",value:function(){var e=Qe.loopCount;this.touchTick!=e&&this.tex.touchRect(this,e),this.touchTick=e}}]),e}(),bt=function(){function e(){b(this,e),this.fontsz=16}return y(e,[{key:"getWidth",value:function(e,t){return 0}},{key:"scale",value:function(e,t){}},{key:"canvasWidth",get:function(){return 0},set:function(e){}},{key:"getCharBmp",value:function(e,t,i,n,a,s,r,o,h,l){return null}}]),e}(),I=function(){function c(){b(this,c)}return y(c,null,[{key:"__init__",value:function(){var e=window.Laya||L.Laya;if(c._window)return c._window;for(var t=c._window=window,i=c._document=t.document,n=c.userAgent=t.navigator.userAgent,a=t.navigator.maxTouchPoints||0,s=t.navigator.platform,e=(-1<n.indexOf("AlipayMiniGame")&&"my"in c.window&&(window.aliPayMiniGame(e,e),e.ALIMiniAdapter?e.ALIMiniAdapter.enable():console.error("请先添加阿里小游戏适配库")),-1==n.indexOf("OPPO")&&-1<n.indexOf("MiniGame")&&"wx"in c.window&&("qq"in c.window?(window.qqMiniGame(e,e),e.QQMiniAdapter?e.QQMiniAdapter.enable():console.error("请引入手机QQ小游戏的适配库：https://ldc2.layabox.com/doc/?nav=zh-ts-5-0-0")):(window.wxMiniGame(e,e),e.MiniAdpter?e.MiniAdpter.enable():console.error("请先添加小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?nav=zh-ts-5-0-0"))),-1<n.indexOf("MiniGame")&&"qq"in c.window&&(window.qqMiniGame(e,e),e.QQMiniAdapter?e.QQMiniAdapter.enable():console.error("请先添加小游戏适配库,详细教程")),-1<n.indexOf("SwanGame")&&(window.bdMiniGame(e,e),e.BMiniAdapter?e.BMiniAdapter.enable():console.error("请先添加百度小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?nav=zh-ts-5-0-0")),-1<n.indexOf("QuickGame")&&(window.miMiniGame(e,e),e.KGMiniAdapter?e.KGMiniAdapter.enable():console.error("请先添加小米小游戏适配库,详细教程：https://ldc2.layabox.com/doc/?nav=zh-ts-5-0-0")),-1<n.indexOf("OPPO")&&-1<n.indexOf("MiniGame")&&(window.qgMiniGame(e,e),e.QGMiniAdapter?e.QGMiniAdapter.enable():console.error("请先添加OPPO小游戏适配库")),-1<n.indexOf("VVGame")&&(window.vvMiniGame(e,e),e.VVMiniAdapter?e.VVMiniAdapter.enable():console.error("请先添加VIVO小游戏适配库")),t.trace=console.log,t.requestAnimationFrame=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame||function(e){return t.setTimeout(e,1e3/60)},i.body.style),r=(e.margin=0,e.overflow="hidden",e["-webkit-user-select"]="none",e["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",i.getElementsByTagName("meta")),o=0,h=!1,l="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no";o<r.length;){var u=r[o];if("viewport"==u.name){u.content=l,h=!0;break}o++}return h||((u=i.createElement("meta")).name="viewport",u.content=l,i.getElementsByTagName("head")[0].appendChild(u)),c.onMobile=!!window.isConchApp||-1<n.indexOf("Mobile"),c.onIOS=!!n.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),c.onIPhone=-1<n.indexOf("iPhone"),c.onMac=-1<n.indexOf("Mac OS X"),c.onIPad=-1<n.indexOf("iPad")||"MacIntel"===s&&1<a,c.onAndroid=-1<n.indexOf("Android")||-1<n.indexOf("Adr"),c.onWP=-1<n.indexOf("Windows Phone"),c.onQQBrowser=-1<n.indexOf("QQBrowser"),c.onMQQBrowser=-1<n.indexOf("MQQBrowser")||-1<n.indexOf("Mobile")&&-1<n.indexOf("QQ"),c.onIE=!!t.ActiveXObject||"ActiveXObject"in t,c.onWeiXin=-1<n.indexOf("MicroMessenger"),c.onSafari=-1<n.indexOf("Safari"),c.onPC=!c.onMobile,c.onMiniGame=-1<n.indexOf("MiniGame"),c.onBDMiniGame=-1<n.indexOf("SwanGame"),c.onLayaRuntime=!!c.window.conch,-1<n.indexOf("OPPO")&&-1<n.indexOf("MiniGame")?(c.onQGMiniGame=!0,c.onMiniGame=!1):"qq"in c.window&&-1<n.indexOf("MiniGame")&&(c.onQQMiniGame=!0,c.onMiniGame=!1),c.onVVMiniGame=-1<n.indexOf("VVGame"),c.onKGMiniGame=-1<n.indexOf("QuickGame"),-1<n.indexOf("AlipayMiniGame")&&(c.onAlipayMiniGame=!0,c.onMiniGame=!1),t}},{key:"createElement",value:function(e){return c.__init__(),c._document.createElement(e)}},{key:"getElementById",value:function(e){return c.__init__(),c._document.getElementById(e)}},{key:"removeElement",value:function(e){e&&e.parentNode&&e.parentNode.removeChild(e)}},{key:"now",value:function(){return Date.now()}},{key:"clientWidth",get:function(){return c.__init__(),c._window.innerWidth||c._document.body.clientWidth}},{key:"clientHeight",get:function(){return c.__init__(),c._window.innerHeight||c._document.body.clientHeight||c._document.documentElement.clientHeight}},{key:"width",get:function(){return c.__init__(),(L.stage&&L.stage.canvasRotation?c.clientHeight:c.clientWidth)*c.pixelRatio}},{key:"height",get:function(){return c.__init__(),(L.stage&&L.stage.canvasRotation?c.clientWidth:c.clientHeight)*c.pixelRatio}},{key:"pixelRatio",get:function(){return c._pixelRatio<0&&(c.__init__(),-1<c.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?c._pixelRatio=2:(c._pixelRatio=c._window.devicePixelRatio||1)<1&&(c._pixelRatio=1)),c._pixelRatio}},{key:"container",get:function(){return c._container||(c.__init__(),(c._container=c.createElement("div")).id="layaContainer",c._document.body.appendChild(c._container)),c._container},set:function(e){c._container=e}},{key:"window",get:function(){return c._window||c.__init__()}},{key:"document",get:function(){return c.__init__(),c._document}}]),c}(),St=(I._pixelRatio=-1,I.mainCanvas=null,I.hanzi=new RegExp("^[一-龥]$"),I.fontMap=[],I.measureText=function(e,t){var i=I.hanzi.test(e);if(i&&I.fontMap[t])return I.fontMap[t];var n=I.context,n=(n.font=t,n.measureText(e));return i&&(I.fontMap[t]=n),n},function(){f(d,bt);var r=T(d);function d(e,t){var i,n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],a=!(3<arguments.length&&void 0!==arguments[3])||arguments[3],s=4<arguments.length&&void 0!==arguments[4]&&arguments[4];return b(this,d),(i=r.call(this)).ctx=null,i.lastScaleX=1,i.lastScaleY=1,i.maxTexW=0,i.maxTexH=0,i.scaleFontSize=!0,i.showDbgInfo=!1,i.supportImageData=!0,i.maxTexW=e,i.maxTexH=t,i.scaleFontSize=n,i.supportImageData=a,i.showDbgInfo=s,d.canvas||(d.canvas=I.createElement("canvas"),d.canvas.width=1024,d.canvas.height=512,d.canvas.style.left="-10000px",d.canvas.style.position="absolute",document.body.appendChild(d.canvas),i.ctx=d.canvas.getContext("2d")),i}return y(d,[{key:"canvasWidth",get:function(){return d.canvas.width},set:function(e){d.canvas.width!=e&&(2048<(d.canvas.width=e)&&console.warn("画文字设置的宽度太大，超过2048了"),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.scale(this.lastScaleX,this.lastScaleY))}},{key:"getWidth",value:function(e,t){return this.ctx?(this.ctx._lastFont!=e&&(this.ctx.font=e,this.ctx._lastFont=e),this.ctx.measureText(t).width):0}},{key:"scale",value:function(e,t){if(!this.supportImageData)return this.lastScaleX=e,void(this.lastScaleY=t);this.lastScaleX==e&&this.lastScaleY==t||(this.ctx.setTransform(e,0,0,t,0,0),this.lastScaleX=e,this.lastScaleY=t)}},{key:"getCharBmp",value:function(e,t,i,n,a,s,r,o,h,l){var u=10<arguments.length&&void 0!==arguments[10]?arguments[10]:null;if(!this.supportImageData)return this.getCharCanvas(e,t,i,n,a,s,r,o,h,l);var c=this.ctx,_=this.fontsz,t=(c.font!=t&&(c.font=t,c._lastFont=t),s.width=c.measureText(e).width,s.width*this.lastScaleX),f=s.height*this.lastScaleY,h=(t+=(r+h)*this.lastScaleX,f+=(o+l)*this.lastScaleY,t=Math.ceil(t),f=Math.ceil(f),(t=Math.min(t,d.canvas.width))+2*i+1),l=(f=Math.min(f,d.canvas.height))+2*i+1,h=(u&&(h=Math.max(h,u[0]+u[2]+1),l=Math.max(l,u[1]+u[3]+1)),c.clearRect(0,0,h/this.lastScaleX+1,l/this.lastScaleY+1),c.save(),c.textBaseline="middle",0<i&&(c.strokeStyle=a,c.lineWidth=i,c.strokeText(e,r,o+_/2)),n&&(c.fillStyle=n,c.fillText(e,r,o+_/2)),this.showDbgInfo&&(c.strokeStyle="#ff0000",c.strokeRect(1,1,t-2,f-2),c.strokeStyle="#00ff00",c.strokeRect(r,o,s.width,s.height)),u&&-1==u[2]&&(u[2]=Math.ceil((s.width+2*i)*this.lastScaleX)),u?c.getImageData(u[0],u[1],u[2],u[3]+1):c.getImageData(0,0,t,f+1));return c.restore(),s.bmpWidth=h.width,s.bmpHeight=h.height,h}},{key:"getCharCanvas",value:function(e,t,i,n,a,s,r,o,h,l){var u=this.ctx,c=(u.font!=t&&(u.font=t,u._lastFont=t),s.width=u.measureText(e).width,s.width*this.lastScaleX),_=s.height*this.lastScaleY,h=(c+=(r+h)*this.lastScaleX,_+=(o+l)*this.lastScaleY+1,c=Math.min(c,this.maxTexW),_=Math.min(_,this.maxTexH),d.canvas.width=Math.min(c+1,this.maxTexW),d.canvas.height=Math.min(_+1,this.maxTexH),u.font=t,u.clearRect(0,0,c+1+i,_+1+i),u.setTransform(1,0,0,1,0,0),u.save(),this.scaleFontSize&&u.scale(this.lastScaleX,this.lastScaleY),u.translate(r,o),u.textAlign="left",this.fontsz);return u.textBaseline="middle",0<i?(u.strokeStyle=a,u.fillStyle=n,u.lineWidth=i,u.fillAndStrokeText?u.fillAndStrokeText(e,0,h/2):(u.strokeText(e,0,h/2),u.fillText(e,0,h/2))):n&&(u.fillStyle=n,u.fillText(e,0,h/2)),this.showDbgInfo&&(u.strokeStyle="#ff0000",u.strokeRect(0,0,c,_),u.strokeStyle="#00ff00",u.strokeRect(0,0,s.width,s.height)),u.restore(),s.bmpWidth=d.canvas.width,s.bmpHeight=d.canvas.height,d.canvas}}]),d}()),It=(St.canvas=null,function(){f(i,bt);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).lastFont="",e.lastScaleX=1,e.lastScaleY=1,e}return y(i,[{key:"getWidth",value:function(e,t){return window.conchTextCanvas?(window.conchTextCanvas.font=e,this.lastFont=e,window.conchTextCanvas.measureText(t).width):0}},{key:"scale",value:function(e,t){this.lastScaleX=e,this.lastScaleY=t}},{key:"getCharBmp",value:function(e,t,i,n,a,s,r,o,h,l){if(!window.conchTextCanvas)return null;window.conchTextCanvas.font=t,this.lastFont=t;s.width=window.conchTextCanvas.measureText(e).width,s.height;window.conchTextCanvas.scale&&window.conchTextCanvas.scale(this.lastScaleX,this.lastScaleY);t=Ie.create(a).numColor,a=Ie.create(n).numColor,n=window.conchTextCanvas.getTextBitmapData(e,a,2<i?2:i,t);return s.bmpWidth=n.width,s.bmpHeight=n.height,n}}]),i}()),Tt=function(){function k(){b(this,k),this.fontSizeInfo={},this.mapFont={},this.fontID=0,this.mapColor=[],this.colorID=0,this.fontScaleX=1,this.fontScaleY=1,this._curStrPos=0,this.textAtlases=[],this.isoTextures=[],this.lastFont=null,this.fontSizeW=0,this.fontSizeH=0,this.fontSizeOffX=0,this.fontSizeOffY=0,this.renderPerChar=!0,this.tmpAtlasPos=new ie,this.textureMem=0,L.TextAtlas=mt;var e=!1,t=L.Laya.MiniAdpter;t&&t.systemInfo&&t.systemInfo.system&&(e="ios 10.1.1"===t.systemInfo.system.toLowerCase()),L.Browser.onMiniGame&&!e&&(k.isWan1Wan=!0),this.charRender=L.Render.isConchApp?new It:new St(k.atlasWidth,k.atlasWidth,k.scaleFontWithCtx,!k.isWan1Wan,!1),k.textRenderInst=this,L.Laya.textRender=this,k.atlasWidth2=k.atlasWidth*k.atlasWidth}return y(k,[{key:"setFont",value:function(e){var t,i,n,a,s;this.lastFont!=e&&(this.lastFont=e,i=(t=this.getFontSizeInfo(e._family))>>16&255,n=t>>8&255,a=255&t,s=e._size/k.standardFontSize,this.fontSizeOffX=Math.ceil((t>>24)*s),this.fontSizeOffY=Math.ceil(i*s),this.fontSizeW=Math.ceil(n*s),this.fontSizeH=Math.ceil(a*s),0<=e._font.indexOf("italic")?this.fontStr=e._font.replace("italic",""):this.fontStr=e._font)}},{key:"getNextChar",value:function(e){var t=e.length,i=this._curStrPos;if(t<=i)return null;for(var n=i,a=0;n<t;n++){var s=e.charCodeAt(n);if(s>>>11==27){if(1==a)break;a=1,n++}else if(65038!==s&&65039!==s)if(8205==s)a=2;else if(0==a)a=1;else if(1==a)break}return this._curStrPos=n,e.substring(i,n)}},{key:"filltext",value:function(e,t,i,n,a,s,r,o,h){var l=9<arguments.length&&void 0!==arguments[9]?arguments[9]:0;if(!(t.length<=0)){var a=xt.Parse(a),u=0;switch(h){case"center":u=L.Context.ENUM_TEXTALIGN_CENTER;break;case"right":u=L.Context.ENUM_TEXTALIGN_RIGHT}this._fast_filltext(e,t,null,i,n,a,s,r,o,u,l)}}},{key:"fillWords",value:function(e,t,i,n,a,s,r,o){!t||t.length<=0||(a="string"==typeof a?xt.Parse(a):a,this._fast_filltext(e,null,t,i,n,a,s,r,o,0,0))}},{key:"_fast_filltext",value:function(e,t,i,n,a,s,r,o,h,l){if(!(t&&t.length<1||i&&i.length<1)){if(h<0&&(h=0),this.setFont(s),this.fontScaleX=this.fontScaleY=1,k.scaleFontWithCtx){var u=1,c=1;if(L.Render.isConchApp&&!window.conchTextCanvas.scale||(u=e.getMatScaleX(),c=e.getMatScaleY()),u<1e-4||c<.1)return;1<u&&(this.fontScaleX=u),1<c&&(this.fontScaleY=c)}s._italic&&(e._italicDeg=13);var u=t,c=!i&&t instanceof kt,_=t,t=!!i,f=c?u.pageChars:[],d=0;switch(c?(_=u._text,(d=u.width)<0&&(d=u.width=this.charRender.getWidth(this.fontStr,_))):d=_?this.charRender.getWidth(this.fontStr,_):0,l){case L.Context.ENUM_TEXTALIGN_CENTER:n-=d/2;break;case L.Context.ENUM_TEXTALIGN_RIGHT:n-=d}u&&f&&this.hasFreedText(f)&&(f=u.pageChars=[]);var p=null,l=this.renderPerChar=!c||k.forceSplitRender||t||c&&u.splitRender;if(!f||f.length<1)if(l){var y,g,m,v=0,x=0;for(this._curStrPos=0;;){if(i?(m=i[this._curStrPos++])?(y=m.char,v=m.x,x=m.y):y=null:y=this.getNextChar(_),!y)break;if(!(p=this.getCharRenderInfo(y,s,r,o,h,!1)))break;p.isSpace||((m=(m=f[p.tex.id])?m.words:(g={texgen:p.tex.genID,tex:p.tex,words:[]},(f[p.tex.id]=g).words)).push({ri:p,x:v,y:x,w:p.bmpWidth/this.fontScaleX,h:p.bmpHeight/this.fontScaleY}),v+=p.width)}}else{t=k.noAtlas||d*this.fontScaleX>k.atlasWidth,p=this.getCharRenderInfo(_,s,r,o,h,t);f[0]={texgen:p.tex.genID,tex:p.tex,words:[{ri:p,x:0,y:0,w:p.bmpWidth/this.fontScaleX,h:p.bmpHeight/this.fontScaleY}]}}this._drawResortedWords(e,n,a,f),e._italicDeg=0}}},{key:"_drawResortedWords",value:function(e,t,i,n){var a,s=!!e._charSubmitCache&&e._charSubmitCache._enable,r=e._curMat;n.length;for(a in n){var o=n[a];if(o){var h=o.words,l=h.length;if(!(l<=0))for(var u=n[a].tex,c=0;c<l;c++){var _=h[c],f=_.ri;f.isSpace||(f.touch(),e.drawTexAlign=!0,L.Render.isConchApp?e._drawTextureM(u.texture,t+_.x-f.orix,i+_.y-f.oriy,_.w,_.h,null,1,f.uv):e._inner_drawTexture(u.texture,u.id,t+_.x-f.orix,i+_.y-f.oriy,_.w,_.h,r,f.uv,1,s),e.touches&&e.touches.push(f))}}}}},{key:"hasFreedText",value:function(e){for(var t=e.length,i=0;i<t;i++){var n=e[i];if(n){var a=n.tex;if(a.__destroyed||a.genID!=n.texgen)return!0}}return!1}},{key:"getCharRenderInfo",value:function(e,t,i,n,a){var s,r,o=5<arguments.length&&void 0!==arguments[5]&&arguments[5],h=this.mapFont[t._family],l=(null==h&&(this.mapFont[t._family]=h=this.fontID++),e+"_"+h+"_"+t._size+"_"+i),u=(0<a&&(l+="_"+n+a),t._bold&&(l+="P"),1==this.fontScaleX&&1==this.fontScaleY||(l+=(20*this.fontScaleX|0)+"_"+(20*this.fontScaleY|0)),0),c=this.textAtlases.length;if(!o)for(u=0;u<c;u++)if(s=(r=this.textAtlases[u]).charMaps[l])return s.touch(),s;s=new wt,this.charRender.scale(this.fontScaleX,this.fontScaleY),s.char=e,s.height=t._size;var _,f,d,h=L.Render.isConchApp?0:t._size/3|0,p=null,y=(a=a||0,Math.ceil((this.charRender.getWidth(this.fontStr,e)+2*a)*this.fontScaleX));return y>this.charRender.canvasWidth&&(this.charRender.canvasWidth=Math.min(2048,y+2*h)),o?(this.charRender.fontsz=t._size,(p=this.charRender.getCharBmp(e,this.fontStr,a,i,n,s,h,h,h,h,null))&&((o=gt.getTextTexture(p.width,p.height)).addChar(p,0,0,s.uv),s.tex=o,s.orix=h,s.oriy=h,o.ri=s,this.isoTextures.push(o))):(o=e.length,_=+a,f=Math.ceil((this.fontSizeW+2*_)*this.fontScaleX),d=Math.ceil((this.fontSizeH+2*_)*this.fontScaleY),k.imgdtRect[0]=(h-this.fontSizeOffX-_)*this.fontScaleX|0,k.imgdtRect[1]=(h-this.fontSizeOffY-_)*this.fontScaleY|0,this.renderPerChar||1==o?(k.imgdtRect[2]=Math.max(y,f),k.imgdtRect[3]=Math.max(y,d)):(k.imgdtRect[2]=-1,k.imgdtRect[3]=d),this.charRender.fontsz=t._size,(p=this.charRender.getCharBmp(e,this.fontStr,a,i,n,s,h,h,h,h,k.imgdtRect))&&(r=this.addBmpData(p,s),k.isWan1Wan?(s.orix=h,s.oriy=h):(s.orix=this.fontSizeOffX+_,s.oriy=this.fontSizeOffY+_),r.charMaps[l]=s)),s}},{key:"addBmpData",value:function(e,t){for(var i,n=e.width,a=e.height,s=this.textAtlases.length,r=!1,o=0;o<s&&!(r=(i=this.textAtlases[o]).getAEmpty(n,a,this.tmpAtlasPos));o++);if(!r){if(i=new mt,this.textAtlases.push(i),!(r=i.getAEmpty(n,a,this.tmpAtlasPos)))throw"err1";this.cleanAtlases()}return r&&(i.texture.addChar(e,this.tmpAtlasPos.x,this.tmpAtlasPos.y,t.uv),t.tex=i.texture),i}},{key:"GC",value:function(){for(var e,t=0,i=this.textAtlases.length,n=k.destroyAtlasDt,a=0,s=Qe.loopCount,r=-1,o=0,h=null,l=null;t<i;t++)(h=(l=this.textAtlases[t]).texture)&&(h.curUsedCovRate,a+=h.curUsedCovRateAtlas,o<(e=l.usedRate-h.curUsedCovRateAtlas)&&(o=e,r=t)),n<s-l.texture.lastTouchTm&&(k.showLog&&console.log(l.texture.id),l.destroy(),this.textAtlases[t]=this.textAtlases[i-1],i--,t--,r=-1);for(this.textAtlases.length=i,i=this.isoTextures.length,t=0;t<i;t++)s-(h=this.isoTextures[t]).lastTouchTm>k.destroyUnusedTextureDt&&(h.ri.deleted=!0,h.ri.tex=null,h.destroy(),this.isoTextures[t]=this.isoTextures[i-1],i--,t--);this.isoTextures.length=i;var u=1<this.textAtlases.length&&2<=this.textAtlases.length-a;(k.atlasWidth*k.atlasWidth*4*this.textAtlases.length>k.cleanMem||u||k.simClean)&&(k.simClean=!1,k.showLog&&console.log("清理使用率低的贴图。总使用率:",a,":",this.textAtlases.length,"最差贴图:"+r),0<=r&&((l=this.textAtlases[r]).destroy(),this.textAtlases[r]=this.textAtlases[this.textAtlases.length-1],this.textAtlases.length=this.textAtlases.length-1)),gt.clean()}},{key:"cleanAtlases",value:function(){}},{key:"getCharBmp",value:function(e){}},{key:"checkBmpLine",value:function(e,t,i,n){this.bmpData32.buffer!=e.data.buffer&&(this.bmpData32=new Uint32Array(e.data.buffer));for(var a=e.width*t+i,s=i;s<n;s++)if(0!=this.bmpData32[a++])return!0;return!1}},{key:"updateBbx",value:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]&&arguments[2],n=e.width,a=e.height,s=0,r=t[1],o=0,h=r;if(this.checkBmpLine(e,r,0,n))for(;;){if(r<=(h=(r+o)/2|0)+1){t[1]=h;break}this.checkBmpLine(e,h,0,n)?r=h:o=h}if(t[3]>a)t[3]=a;else if(h=r=t[3],o=a,this.checkBmpLine(e,r,0,n))for(;;){if((h=(r+o)/2|0)-1<=r){t[3]=h;break}this.checkBmpLine(e,h,0,n)?r=h:o=h}if(!i){for(var l=t[0],u=n*t[1],h=t[1];h<t[3];h++){for(s=0;s<l;s++)if(0!=this.bmpData32[u+s]){l=s;break}u+=n}t[0]=l;var c=t[2],u=n*t[1];for(h=t[1];h<t[3];h++){for(s=c;s<n;s++)if(0!=this.bmpData32[u+s]){c=s;break}u+=n}t[2]=c}}},{key:"getFontSizeInfo",value:function(e){var t=this.fontSizeInfo[e];if(null!=t)return t;t="bold "+k.standardFontSize+"px "+e;if(k.isWan1Wan)return this.fontSizeW=1.5*this.charRender.getWidth(t,"有"),this.fontSizeH=1.5*k.standardFontSize,i=this.fontSizeW<<8|this.fontSizeH,this.fontSizeInfo[e]=i;k.pixelBBX[0]=k.standardFontSize/2,k.pixelBBX[1]=k.standardFontSize/2,k.pixelBBX[2]=k.standardFontSize,k.pixelBBX[3]=k.standardFontSize;var i=16,n=16,a=(this.charRender.scale(1,1),k.tmpRI.height=k.standardFontSize,this.charRender.fontsz=k.standardFontSize,this.charRender.getCharBmp("g",t,0,"red",null,k.tmpRI,i,n,16,16));L.Render.isConchApp&&(a.data=new Uint8ClampedArray(a.data)),this.bmpData32=new Uint32Array(a.data.buffer),this.updateBbx(a,k.pixelBBX,!1),a=this.charRender.getCharBmp("有",t,0,"red",null,k.tmpRI,n,n,16,16),L.Render.isConchApp&&(a.data=new Uint8ClampedArray(a.data)),this.bmpData32=new Uint32Array(a.data.buffer),k.pixelBBX[2]<i+k.tmpRI.width&&(k.pixelBBX[2]=i+k.tmpRI.width),this.updateBbx(a,k.pixelBBX,!1),L.Render.isConchApp&&(n=i=0);t=Math.max(i-k.pixelBBX[0],0)<<24|Math.max(n-k.pixelBBX[1],0)<<16|k.pixelBBX[2]-k.pixelBBX[0]<<8|k.pixelBBX[3]-k.pixelBBX[1];return this.fontSizeInfo[e]=t}},{key:"printDbgInfo",value:function(){for(var e in console.log("图集个数:"+this.textAtlases.length+",每个图集大小:"+k.atlasWidth+"x"+k.atlasWidth," 用canvas:",k.isWan1Wan),console.log("图集占用空间:"+k.atlasWidth*k.atlasWidth*4/1024/1024*this.textAtlases.length+"M"),console.log("缓存用到的字体:"),this.mapFont){var t=this.getFontSizeInfo(e);console.log("    "+e," off:",t>>24,t>>16&255," size:",t>>8&255,255&t)}var s=0,r=(console.log("缓存数据:"),0),o=0;this.textAtlases.forEach(function(e){var t,i=e.texture.id,n=Qe.loopCount-e.texture.lastTouchTm;for(t in r+=e.texture.curUsedCovRate,o+=e.texture.curUsedCovRateAtlas,console.log("--图集(id:"+i+",当前使用率:"+(1e3*e.texture.curUsedCovRate|0)+"‰","当前图集使用率:",(100*e.texture.curUsedCovRateAtlas|0)+"%","图集使用率:",100*e.usedRate|0,"%, 使用于:"+(0<n?n+"帧以前":"当前帧")+")--:"),e.charMaps){var a=e.charMaps[t];console.log("     off:",a.orix,a.oriy," bmp宽高:",a.bmpWidth,a.bmpHeight,"无效:",a.deleted,"touchdt:",Qe.loopCount-a.touchTick,"位置:",a.uv[0]*k.atlasWidth|0,a.uv[1]*k.atlasWidth|0,"字符:",a.char,"key:",t),s++}}),console.log("独立贴图文字("+this.isoTextures.length+"个):"),this.isoTextures.forEach(function(e){console.log("    size:",e._texW,e._texH,"touch间隔:",Qe.loopCount-e.lastTouchTm,"char:",e.ri.char)}),console.log("总缓存:",s,"总使用率:",r,"总当前图集使用率:",o)}},{key:"showAtlas",value:function(e,i,t,n,a,s){if(!this.textAtlases[e])return console.log("没有这个图集"),null;var r=new L.Sprite,o=this.textAtlases[e].texture,h={width:k.atlasWidth,height:k.atlasWidth,sourceWidth:k.atlasWidth,sourceHeight:k.atlasWidth,offsetX:0,offsetY:0,getIsReady:function(){return!0},_addReference:function(){},_removeReference:function(){},_getSource:function(){return o._getSource()},bitmap:{id:o.id},_uv:vt.DEF_UV};return r.size=function(e,t){return this.width=e,this.height=t,r.graphics.clear(),r.graphics.drawRect(0,0,r.width,r.height,i),r.graphics.drawTexture(h,0,0,r.width,r.height),this},r.graphics.drawRect(0,0,a,s,i),r.graphics.drawTexture(h,0,0,a,s),r.pos(t,n),L.stage.addChild(r),r}},{key:"filltext_native",value:function(e,t,i,n,a,s,r,o,h,l){var u=10<arguments.length&&void 0!==arguments[10]?arguments[10]:0;if(!(t&&t.length<=0||i&&i.length<1)){var s=xt.Parse(s),c=0;switch(l){case"center":c=L.Context.ENUM_TEXTALIGN_CENTER;break;case"right":c=L.Context.ENUM_TEXTALIGN_RIGHT}return this._fast_filltext(e,t,i,n,a,s,r,o,h,c,u)}}}]),k}(),Ct=(Tt.useOldCharBook=!1,Tt.atlasWidth=1024,Tt.noAtlas=!1,Tt.forceSplitRender=!1,Tt.forceWholeRender=!1,Tt.scaleFontWithCtx=!0,Tt.standardFontSize=32,Tt.destroyAtlasDt=10,Tt.checkCleanTextureDt=2e3,Tt.destroyUnusedTextureDt=3e3,Tt.cleanMem=104857600,Tt.isWan1Wan=!1,Tt.showLog=!1,Tt.debugUV=!1,Tt.tmpRI=new wt,Tt.pixelBBX=[0,0,0,0],Tt.imgdtRect=[0,0,0,0],Tt.simClean=!1,gt.gTextRender=Tt,function(){function T(){var e;b(this,T),this._tmpMatrix=new Ce,this._drawTexToDrawTri_Vert=new Float32Array(8),this._drawTexToDrawTri_Index=new Uint16Array([0,1,2,0,2,3]),this._tempUV=new Float32Array(8),this._drawTriUseAbsMatrix=!1,this._id=++T._COUNT,this._other=null,this._renderNextSubmitIndex=0,this._path=null,this._drawCount=1,this._width=T._MAXSIZE,this._height=T._MAXSIZE,this._renderCount=0,this._submits=null,this._curSubmit=null,this._submitKey=new ke,this._mesh=null,this._pathMesh=null,this._triangleMesh=null,this.meshlist=[],this._transedPoints=new Array(8),this._temp4Points=new Array(8),this._clipRect=T.MAXCLIPRECT,this._globalClipMatrix=new Ce(T._MAXSIZE,0,0,T._MAXSIZE,0,0),this._clipInCache=!1,this._clipInfoID=0,this._clipID_Gen=0,this._lastMatScaleX=1,this._lastMatScaleY=1,this._lastMat_a=1,this._lastMat_b=0,this._lastMat_c=0,this._lastMat_d=1,this._nBlendType=0,this._save=null,this._targets=null,this._charSubmitCache=null,this._saveMark=null,this._shader2D=new st,this.sprite=null,this._italicDeg=0,this._lastTex=null,this._fillColor=0,this._flushCnt=0,this.defTexture=null,this._colorFiler=null,this.drawTexAlign=!1,this._incache=!1,this.isMain=!1,T._contextcount++,T._textRender=T._textRender||new Tt,this.defTexture||((e=new ue(2,2)).setPixels(new Uint8Array(16)),e.lock=!0,this.defTexture=new vt(e)),this._lastTex=this.defTexture,this.clear()}return y(T,[{key:"drawImage",value:function(){}},{key:"getImageData",value:function(){}},{key:"measureText",value:function(e){return null}},{key:"setTransform",value:function(){}},{key:"$transform",value:function(e,t,i,n,a,s){}},{key:"lineJoin",get:function(){return""},set:function(e){}},{key:"lineCap",get:function(){return""},set:function(e){}},{key:"miterLimit",get:function(){return""},set:function(e){}},{key:"clearRect",value:function(e,t,i,n){}},{key:"_drawRect",value:function(e,t,i,n,a){k.renderBatches++,a&&(this.fillStyle=a),this.fillRect(e,t,i,n,null)}},{key:"drawTexture2",value:function(e,t,i,n,a,s){}},{key:"transformByMatrix",value:function(e,t,i){this.transform(e.a,e.b,e.c,e.d,e.tx+t,e.ty+i)}},{key:"saveTransform",value:function(e){this.save()}},{key:"restoreTransform",value:function(e){this.restore()}},{key:"drawRect",value:function(e,t,i,n,a,s,r){null!=a&&(this.fillStyle=a,this.fillRect(e,t,i,n)),null!=s&&(this.strokeStyle=s,this.lineWidth=r,this.strokeRect(e,t,i,n))}},{key:"alpha",value:function(e){this.globalAlpha*=e}},{key:"_transform",value:function(e,t,i){this.translate(t,i),this.transform(e.a,e.b,e.c,e.d,e.tx,e.ty),this.translate(-t,-i)}},{key:"_rotate",value:function(e,t,i){this.translate(t,i),this.rotate(e),this.translate(-t,-i)}},{key:"_scale",value:function(e,t,i,n){this.translate(i,n),this.scale(e,t),this.translate(-i,-n)}},{key:"_drawLine",value:function(e,t,i,n,a,s,r,o,h){this.beginPath(),this.strokeStyle=r,this.lineWidth=o,this.moveTo(e+i,t+n),this.lineTo(e+a,t+s),this.stroke()}},{key:"_drawLines",value:function(e,t,i,n,a,s){this.beginPath(),this.strokeStyle=n,this.lineWidth=a,this.addPath(i.slice(),!1,!1,e,t),this.stroke()}},{key:"drawCurves",value:function(e,t,i,n,a){this.beginPath(),this.strokeStyle=n,this.lineWidth=a,this.moveTo(e+i[0],t+i[1]);for(var s=2,r=i.length;s<r;)this.quadraticCurveTo(e+i[s++],t+i[s++],e+i[s++],t+i[s++]);this.stroke()}},{key:"_fillAndStroke",value:function(e,t,i){null!=e&&(this.fillStyle=e,this.fill()),null!=t&&0<i&&(this.strokeStyle=t,this.lineWidth=i,this.stroke())}},{key:"_drawCircle",value:function(e,t,i,n,a,s,r){k.renderBatches++,this.beginPath(!0),this.arc(e,t,i,0,T.PI2),this.closePath(),this._fillAndStroke(n,a,s)}},{key:"_drawPie",value:function(e,t,i,n,a,s,r,o,h){this.beginPath(),this.moveTo(e,t),this.arc(e,t,i,n,a),this.closePath(),this._fillAndStroke(s,r,o)}},{key:"_drawPoly",value:function(e,t,i,n,a,s,r,o){this.beginPath(),this.addPath(i.slice(),!0,r,e,t),this.closePath(),this._fillAndStroke(n,a,s,r)}},{key:"_drawPath",value:function(e,t,i,n,a){this.beginPath();for(var s=0,r=i.length;s<r;s++){var o=i[s];switch(o[0]){case"moveTo":this.moveTo(e+o[1],t+o[2]);break;case"lineTo":this.lineTo(e+o[1],t+o[2]);break;case"arcTo":this.arcTo(e+o[1],t+o[2],e+o[3],t+o[4],o[5]);break;case"closePath":this.closePath()}}null!=n&&(this.fillStyle=n.fillStyle,this.fill()),null!=a&&(this.strokeStyle=a.strokeStyle,this.lineWidth=a.lineWidth||1,this.lineJoin=a.lineJoin,this.lineCap=a.lineCap,this.miterLimit=a.miterLimit,this.stroke())}},{key:"clearBG",value:function(e,t,i,n){var a=v.mainContext;a.clearColor(e,t,i,n),a.clear(a.COLOR_BUFFER_BIT)}},{key:"_getSubmits",value:function(){return this._submits}},{key:"_releaseMem",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(this._submits){this._curMat&&this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null,this._charSubmitCache.clear();for(var t,i=0,n=this._submits._length;i<n;i++)this._submits[i].releaseRender();for(this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path=null,this._save=null,i=0,t=this.meshlist.length;i<t;i++)this.meshlist[i].destroy();this.meshlist.length=0,this.sprite=null,e||(this._targets&&this._targets.destroy(),this._targets=null)}}},{key:"destroy",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];--T._contextcount,this.sprite=null,this._releaseMem(e),this._charSubmitCache.destroy(),this._mesh.destroy(),e||(this._targets&&this._targets.destroy(),this._targets=null)}},{key:"clear",value:function(){this._submits||(this._other=Mt.DEFAULT,this._curMat=Ce.create(),this._charSubmitCache=new pt,this._mesh=tt.getAMesh(this.isMain),this.meshlist.push(this._mesh),this._pathMesh=nt.getAMesh(this.isMain),this.meshlist.push(this._pathMesh),this._triangleMesh=it.getAMesh(this.isMain),this.meshlist.push(this._triangleMesh),this._submits=[],this._save=[Xe.Create(this)],this._save.length=10,this._shader2D=new st),this._submitKey.clear(),this._mesh.clearVB(),this._drawCount=1,this._other=Mt.DEFAULT,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=T.MAXCLIPRECT,this._curSubmit=w.RENDERBASE,w.RENDERBASE._ref=16777215,w.RENDERBASE._numEle=0,this._shader2D.fillStyle=this._shader2D.strokeStyle=Ve.DEFAULT;for(var e=0,t=this._submits._length;e<t;e++)this._submits[e].releaseRender();this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1}},{key:"size",value:function(e,t){this._width==e&&this._height==t||(this._width=e,this._height=t,this._targets&&(this._targets.destroy(),this._targets=new fe(e,t,X.R8G8B8A8,-1)),this.isMain&&(v.mainContext.viewport(0,0,e,t),_e.width=e,_e.height=t)),0===e&&0===t&&this._releaseMem()}},{key:"asBitmap",set:function(e){if(e){e=this._targets;if(!this._width||!this._height)throw Error("asBitmap no size!");e&&e.width==this._width&&e.height==this._height||(this._targets=new fe(this._width,this._height,X.R8G8B8A8,-1))}else this._targets&&this._targets.destroy(),this._targets=null}},{key:"getMatScaleX",value:function(){return this._lastMat_a==this._curMat.a&&this._lastMat_b==this._curMat.b||(this._lastMatScaleX=this._curMat.getScaleX(),this._lastMat_a=this._curMat.a,this._lastMat_b=this._curMat.b),this._lastMatScaleX}},{key:"getMatScaleY",value:function(){return this._lastMat_c==this._curMat.c&&this._lastMat_d==this._curMat.d||(this._lastMatScaleY=this._curMat.getScaleY(),this._lastMat_c=this._curMat.c,this._lastMat_d=this._curMat.d),this._lastMatScaleY}},{key:"setFillColor",value:function(e){this._fillColor=e}},{key:"getFillColor",value:function(){return this._fillColor}},{key:"fillStyle",get:function(){return this._shader2D.fillStyle},set:function(e){this._shader2D.fillStyle.equal(e)||(Ye.save(this,Ye.TYPE_FILESTYLE,this._shader2D,!1),this._shader2D.fillStyle=Ve.create(e),this._submitKey.other=-this._shader2D.fillStyle.toInt())}},{key:"globalAlpha",get:function(){return this._shader2D.ALPHA},set:function(e){(e=Math.floor(1e3*e)/1e3)!=this._shader2D.ALPHA&&(Ye.save(this,Ye.TYPE_ALPHA,this._shader2D,!1),this._shader2D.ALPHA=e)}},{key:"textAlign",get:function(){return this._other.textAlign},set:function(e){this._other.textAlign!==e&&(this._other=this._other.make(),Ye.save(this,Ye.TYPE_TEXTALIGN,this._other,!1),this._other.textAlign=e)}},{key:"textBaseline",get:function(){return this._other.textBaseline},set:function(e){this._other.textBaseline!==e&&(this._other=this._other.make(),Ye.save(this,Ye.TYPE_TEXTBASELINE,this._other,!1),this._other.textBaseline=e)}},{key:"globalCompositeOperation",get:function(){return pe.NAMES[this._nBlendType]},set:function(e){e=pe.TOINT[e];null!=e&&this._nBlendType!==e&&(Ye.save(this,Ye.TYPE_GLOBALCOMPOSITEOPERATION,this,!0),this._curSubmit=w.RENDERBASE,this._nBlendType=e)}},{key:"strokeStyle",get:function(){return this._shader2D.strokeStyle},set:function(e){this._shader2D.strokeStyle.equal(e)||(Ye.save(this,Ye.TYPE_STROKESTYLE,this._shader2D,!1),this._shader2D.strokeStyle=Ve.create(e),this._submitKey.other=-this._shader2D.strokeStyle.toInt())}},{key:"translate",value:function(e,t){0===e&&0===t||(He.save(this),this._curMat._bTransform?(We.save(this),this._curMat.tx+=e*this._curMat.a+t*this._curMat.c,this._curMat.ty+=e*this._curMat.b+t*this._curMat.d):(this._curMat.tx=e,this._curMat.ty=t))}},{key:"lineWidth",get:function(){return this._other.lineWidth},set:function(e){this._other.lineWidth!==e&&(this._other=this._other.make(),Ye.save(this,Ye.TYPE_LINEWIDTH,this._other,!1),this._other.lineWidth=e)}},{key:"save",value:function(){this._save[this._save._length++]=Xe.Create(this)}},{key:"restore",value:function(){var e=this._save._length,t=this._nBlendType;if(!(e<1)){for(var i=e-1;0<=i;i--){var n=this._save[i];if(n.restore(this),n.isSaveMark())return void(this._save._length=i)}t!=this._nBlendType&&(this._curSubmit=w.RENDERBASE)}}},{key:"font",set:function(e){this._other=this._other.make(),Ye.save(this,Ye.TYPE_FONT,this._other,!1)}},{key:"fillText",value:function(e,t,i,n,a,s){var r=6<arguments.length&&void 0!==arguments[6]?arguments[6]:0;T._textRender.filltext(this,e,t,i,n,a,7<arguments.length&&void 0!==arguments[7]?arguments[7]:"",r,s)}},{key:"drawText",value:function(e,t,i,n,a,s){T._textRender.filltext(this,e,t,i,n,a,null,0,s)}},{key:"fillWords",value:function(e,t,i,n,a){T._textRender.fillWords(this,e,t,i,n,a,null,0)}},{key:"strokeWord",value:function(e,t,i,n,a,s,r){T._textRender.filltext(this,e,t,i,n,null,a,s,r)}},{key:"fillBorderText",value:function(e,t,i,n,a,s,r,o){T._textRender.filltext(this,e,t,i,n,a,s,r,o)}},{key:"fillBorderWords",value:function(e,t,i,n,a,s,r){T._textRender.fillWords(this,e,t,i,n,a,s,r)}},{key:"_fast_filltext",value:function(e,t,i,n,a,s,r,o){T._textRender._fast_filltext(this,e,null,t,i,n,a,s,r,o,8<arguments.length&&void 0!==arguments[8]?arguments[8]:0)}},{key:"_fillRect",value:function(e,t,i,n,a){var s=this._curSubmit,r=s&&s._key.submitType===w.KEY_DRAWTEXTURE&&s._key.blendShader===this._nBlendType;this._mesh.vertNum+4>T._MAXVERTNUM&&(this._mesh=tt.getAMesh(this.isMain),this.meshlist.push(this._mesh),r=!1),r=r&&(r&&this.isSameClipInfo(s)),this.transformQuad(e,t,i,n,0,this._curMat,this._transedPoints),this.clipedOff(this._transedPoints)||(this._mesh.addQuad(this._transedPoints,vt.NO_UV,a,!1),r||(s=this._curSubmit=dt.create(this,this._mesh,xe.create(ge.TEXTURE2D,0)),this._submits[this._submits._length++]=s,this._copyClipInfo(s,this._globalClipMatrix),s.shaderValue.textureHost=this._lastTex,s._key.other=this._lastTex&&this._lastTex.bitmap?this._lastTex.bitmap.id:-1,s._renderType=w.TYPE_TEXTURE),this._curSubmit._numEle+=6,this._mesh.indexNum+=6,this._mesh.vertNum+=4)}},{key:"fillRect",value:function(e,t,i,n,a){a=a?Ve.create(a):this._shader2D.fillStyle,a=this.mixRGBandAlpha(a.toInt());this._fillRect(e,t,i,n,a)}},{key:"fillTexture",value:function(e,t,i,n,a,s,r,o){e._getSource()?this._fillTexture(e,e.width,e.height,e.uvrect,t,i,n,a,s,r.x,r.y):this.sprite&&L.systemTimer.callLater(this,this._repaintSprite)}},{key:"_fillTexture",value:function(e,t,i,n,a,s,r,o,h,l,u){var c=this._curSubmit,_=(this._mesh.vertNum+4>T._MAXVERTNUM&&(this._mesh=tt.getAMesh(this.isMain),this.meshlist.push(this._mesh)),!0),f=!0;switch(h){case"repeat":break;case"repeat-x":f=!1;break;case"repeat-y":_=!1;break;case"no-repeat":_=f=!1}var h=this._temp4Points,d=0,p=0,y=0,g=0,m=0,v=0;l<0?(y=a,d=-l%t/t):y=a+l,u<0?(g=s,p=-u%i/i):g=s+u,m=a+r,v=s+o,_||(m=Math.min(m,a+l+t)),f||(v=Math.min(v,s+u+i)),m<a||v<s||m<y||v<g||(r=(m-a-l)/t,o=(v-s-u)/i,this.transformQuad(y,g,m-y,v-g,0,this._curMat,this._transedPoints),h[0]=d,h[1]=p,h[2]=r,h[3]=p,h[4]=r,h[5]=o,h[6]=d,h[7]=o,this.clipedOff(this._transedPoints)||(a=this._mixRGBandAlpha(4294967295,this._shader2D.ALPHA),this._mesh.addQuad(this._transedPoints,h,a,!0),(l=xe.create(ge.TEXTURE2D,0)).defines.add(ge.FILLTEXTURE),l.u_TexRange=n.concat(),c=this._curSubmit=dt.create(this,this._mesh,l),this._submits[this._submits._length++]=c,this._copyClipInfo(c,this._globalClipMatrix),c.shaderValue.textureHost=e,c._renderType=w.TYPE_TEXTURE,this._curSubmit._numEle+=6,this._mesh.indexNum+=6,this._mesh.vertNum+=4),this.breakNextMerge())}},{key:"setColorFilter",value:function(e){Ye.save(this,Ye.TYPE_COLORFILTER,this,!0),this._colorFiler=e,this._curSubmit=w.RENDERBASE}},{key:"drawTexture",value:function(e,t,i,n,a){this._drawTextureM(e,t,i,n,a,null,1,null)}},{key:"drawTextures",value:function(e,t,i,n){if(e._getSource())for(var a=t.length/2,s=0,r=e.bitmap.id,o=0;o<a;o++)this._inner_drawTexture(e,r,t[s++]+i,t[s++]+n,0,0,null,null,1,!1);else this.sprite&&L.systemTimer.callLater(this,this._repaintSprite)}},{key:"_drawTextureAddSubmit",value:function(e,t){var i=null,i=dt.create(this,this._mesh,xe.create(ge.TEXTURE2D,0));(this._submits[this._submits._length++]=i).shaderValue.textureHost=t,i._key.other=e,i._renderType=w.TYPE_TEXTURE,this._curSubmit=i}},{key:"_drawTextureM",value:function(e,t,i,n,a,s,r,o){var h=this.sprite;return!!e._getSource(function(){h&&h.repaint()})&&this._inner_drawTexture(e,e.bitmap.id,t,i,n,a,s,o,r,!1)}},{key:"_drawRenderTexture",value:function(e,t,i,n,a,s,r,o){return this._inner_drawTexture(e,-1,t,i,n,a,s,o,1,!1)}},{key:"submitDebugger",value:function(){this._submits[this._submits._length++]=we.create([],function(){},this)}},{key:"_copyClipInfo",value:function(e,t){var i=e.shaderValue.clipMatDir,i=(i[0]=t.a,i[1]=t.b,i[2]=t.c,i[3]=t.d,e.shaderValue.clipMatPos);i[0]=t.tx,i[1]=t.ty,e.clipInfoID=this._clipInfoID,this._clipInCache&&(e.shaderValue.clipOff[0]=1)}},{key:"isSameClipInfo",value:function(e){return e.clipInfoID===this._clipInfoID}},{key:"_useNewTex2DSubmit",value:function(e,t){this._mesh.vertNum+t>T._MAXVERTNUM&&(this._mesh=tt.getAMesh(this.isMain),this.meshlist.push(this._mesh));t=dt.create(this,this._mesh,xe.create(ge.TEXTURE2D,0));(this._submits[this._submits._length++]=this._curSubmit=t).shaderValue.textureHost=e,this._copyClipInfo(t,this._globalClipMatrix)}},{key:"_drawTexRect",value:function(e,t,i,n,a){this.transformQuad(e,t,i,n,this._italicDeg,this._curMat,this._transedPoints);e=this._transedPoints;e[0]=e[0]+.5|0,e[1]=e[1]+.5|0,e[2]=e[2]+.5|0,e[3]=e[3]+.5|0,e[4]=e[4]+.5|0,e[5]=e[5]+.5|0,e[6]=e[6]+.5|0,e[7]=e[7]+.5|0,this.clipedOff(this._transedPoints)||(this._mesh.addQuad(this._transedPoints,a,this._fillColor,!0),this._curSubmit._numEle+=6,this._mesh.indexNum+=6,this._mesh.vertNum+=4)}},{key:"drawCallOptimize",value:function(e){return this._charSubmitCache.enable(e,this),e}},{key:"_inner_drawTexture",value:function(e,t,i,n,a,s,r,o,h,l){var u=this._curSubmit._key;if(o=o||e._uv,u.submitType===w.KEY_TRIANGLES&&u.other===t)return(c=this._drawTexToDrawTri_Vert)[0]=i,c[1]=n,c[2]=i+a,c[3]=n,c[4]=i+a,c[5]=n+s,c[6]=i,c[7]=n+s,this._drawTriUseAbsMatrix=!0,(_=this._tempUV)[0]=o[0],_[1]=o[1],_[2]=o[2],_[3]=o[3],_[4]=o[4],_[5]=o[5],_[6]=o[6],_[7]=o[7],this.drawTriangles(e,0,0,c,_,this._drawTexToDrawTri_Index,r,h,null,null),!(this._drawTriUseAbsMatrix=!1);var c=this._mesh,_=this._curSubmit,f=l?this._charSubmitCache.getPos():this._transedPoints,n=(this.transformQuad(i,n,a||e.width,s||e.height,this._italicDeg,r||this._curMat,f),this.drawTexAlign&&(i=Math.round,f[0]=i(f[0]),f[1]=i(f[1]),f[2]=i(f[2]),f[3]=i(f[3]),f[4]=i(f[4]),f[5]=i(f[5]),f[6]=i(f[6]),f[7]=i(f[7]),this.drawTexAlign=!1),this._mixRGBandAlpha(4294967295,this._shader2D.ALPHA*h));if(l)return this._charSubmitCache.add(this,e,t,f,o,n),!0;this._drawCount++;a=(a=0<=t&&u.submitType===w.KEY_DRAWTEXTURE&&u.other===t)&&a&&this.isSameClipInfo(_);return this._lastTex=e,c.vertNum+4>T._MAXVERTNUM&&(c=this._mesh=tt.getAMesh(this.isMain),this.meshlist.push(c),a=!1),c.addQuad(f,o,n,!0),a||(this._submits[this._submits._length++]=this._curSubmit=_=dt.create(this,c,xe.create(ge.TEXTURE2D,0)),_.shaderValue.textureHost=e,_._key.other=t,this._copyClipInfo(_,this._globalClipMatrix)),_._numEle+=6,c.indexNum+=6,c.vertNum+=4,!0}},{key:"transform4Points",value:function(e,t,i){var n=t.tx,a=t.ty,s=t.a,r=t.b,o=t.c,h=t.d,l=e[0],u=e[1],c=e[2],_=e[3],f=e[4],d=e[5],p=e[6],e=e[7];t._bTransform?(i[0]=l*s+u*o+n,i[1]=l*r+u*h+a,i[2]=c*s+_*o+n,i[3]=c*r+_*h+a,i[4]=f*s+d*o+n,i[5]=f*r+d*h+a,i[6]=p*s+e*o+n,i[7]=p*r+e*h+a):(i[0]=l+n,i[1]=u+a,i[2]=c+n,i[3]=_+a,i[4]=f+n,i[5]=d+a,i[6]=p+n,i[7]=e+a)}},{key:"clipedOff",value:function(e){return this._clipRect.width<=0||this._clipRect.height<=0}},{key:"transformQuad",value:function(e,t,i,n,a,s,r){var o=0,a=(0!=a&&(o=Math.tan(a*Math.PI/180)*n),e+i),i=t+n,n=s.tx,h=s.ty,l=s.a,u=s.b,c=s.c,_=s.d,f=e+o,d=t,o=a+o,p=i;s._bTransform?(r[0]=f*l+d*c+n,r[1]=f*u+d*_+h,r[2]=o*l+t*c+n,r[3]=o*u+t*_+h,r[4]=a*l+p*c+n,r[5]=a*u+p*_+h,r[6]=e*l+i*c+n,r[7]=e*u+i*_+h):(r[0]=f+n,r[1]=d+h,r[2]=o+n,r[3]=t+h,r[4]=a+n,r[5]=p+h,r[6]=e+n,r[7]=i+h)}},{key:"pushRT",value:function(){this.addRenderObject(we.create(null,fe.pushRT,this))}},{key:"popRT",value:function(){this.addRenderObject(we.create(null,fe.popRT,this)),this.breakNextMerge()}},{key:"useRT",value:function(e){this.addRenderObject(we.create([e],function(e){if(!e)throw"error useRT";e.start(),e.clear(0,0,0,0)},this)),this.breakNextMerge()}},{key:"RTRestore",value:function(e){this.addRenderObject(we.create([e],function(e){e.restore()},this)),this.breakNextMerge()}},{key:"breakNextMerge",value:function(){this._curSubmit=w.RENDERBASE}},{key:"_repaintSprite",value:function(){this.sprite&&this.sprite.repaint()}},{key:"drawTextureWithTransform",value:function(e,t,i,n,a,s,r,o,h,l){var u,c=10<arguments.length&&void 0!==arguments[10]?arguments[10]:null,_=11<arguments.length?arguments[11]:void 0,f=this._curMat,d=(l&&(u=this.globalCompositeOperation,this.globalCompositeOperation=l),this._colorFiler);if(c&&this.setColorFilter(c),!s)return this._drawTextureM(e,t+r,i+o,n,a,f,h,_),l&&(this.globalCompositeOperation=u),void(c&&this.setColorFilter(d));var p=this._tmpMatrix;p.a=s.a,p.b=s.b,p.c=s.c,p.d=s.d,p.tx=s.tx+r,p.ty=s.ty+o,p._bTransform=s._bTransform,s&&f._bTransform?(Ce.mul(p,f,p),(s=p)._bTransform=!0):(p.tx+=f.tx,p.ty+=f.ty,s=p),this._drawTextureM(e,t,i,n,a,s,h,_),l&&(this.globalCompositeOperation=u),c&&this.setColorFilter(d)}},{key:"_flushToTarget",value:function(e,t){_e.worldScissorTest=!1;var i=S.instance,i=(i.disable(i.SCISSOR_TEST),_e.worldAlpha),n=_e.worldMatrix4,a=_e.worldMatrix;_e.worldMatrix=Ce.EMPTY,_e.restoreTempArray(),_e.worldMatrix4=_e.TEMPMAT4_ARRAY,_e.worldAlpha=1,ce.activeShader=null,t.start(),0<e._submits._length&&t.clear(0,0,0,0),e._curSubmit=w.RENDERBASE,e.flush(),e.clear(),t.restore(),e._curSubmit=w.RENDERBASE,ce.activeShader=null,_e.worldAlpha=i,_e.worldMatrix4=n,_e.worldMatrix=a}},{key:"drawCanvas",value:function(e,t,i,n,a){var s,r;e&&((r=e.context)._targets?(0<r._submits._length&&(s=we.create([r,r._targets],this._flushToTarget,this),this._submits[this._submits._length++]=s),this._drawRenderTexture(r._targets,t,i,n,a,null,1,fe.flipyuv)):((r=e).touches&&r.touches.forEach(function(e){e.touch()}),s=_t.create(e,this._shader2D.ALPHA,this._shader2D.filters),(this._submits[this._submits._length++]=s)._key.clear(),n=s._matrix,this._curMat.copyTo(n),a=n.tx,e=n.ty,n.tx=n.ty=0,n.transformPoint(ie.TEMP.setTo(t,i)),n.translate(ie.TEMP.x+a,ie.TEMP.y+e),Ce.mul(r.invMat,n,n)),this._curSubmit=w.RENDERBASE)}},{key:"drawTarget",value:function(e,t,i,n,a,s,r){var o=7<arguments.length&&void 0!==arguments[7]?arguments[7]:null,h=8<arguments.length&&void 0!==arguments[8]?arguments[8]:-1;return this._drawCount++,this._mesh.vertNum+4>T._MAXVERTNUM&&(this._mesh=tt.getAMesh(this.isMain),this.meshlist.push(this._mesh)),this.transformQuad(t,i,n,a,0,s||this._curMat,this._transedPoints),this.clipedOff(this._transedPoints)?(this._curSubmit=w.RENDERBASE,!1):(this._mesh.addQuad(this._transedPoints,o||vt.DEF_UV,4294967295,!0),(t=this._curSubmit=ft.create(this,this._mesh,r,e)).blendType=-1==h?this._nBlendType:h,this._copyClipInfo(t,this._globalClipMatrix),t._numEle=6,this._mesh.indexNum+=6,this._mesh.vertNum+=4,this._submits[this._submits._length++]=t,this._curSubmit=w.RENDERBASE,!0)}},{key:"drawTriangles",value:function(e,t,i,n,a,s,r,o,h,l){var u,c,_,f,d,p=10<arguments.length&&void 0!==arguments[10]?arguments[10]:4294967295,y=null;l&&(y=this.globalCompositeOperation,this.globalCompositeOperation=l),e._getSource()?(this._drawCount++,u=this._tmpMatrix,c=this._triangleMesh,_=null,f=!1,h&&(_=this._colorFiler,this._colorFiler=h,this._curSubmit=w.RENDERBASE,f=_!=h),h=e.bitmap,d=(d=this._curSubmit._key).submitType===w.KEY_TRIANGLES&&d.other===h.id&&d.blendShader==this._nBlendType,c.vertNum+n.length/2>T._MAXVERTNUM&&(c=this._triangleMesh=it.getAMesh(this.isMain),this.meshlist.push(c),d=!1),d||((d=this._curSubmit=dt.create(this,c,xe.create(ge.TEXTURE2D,0))).shaderValue.textureHost=e,d._renderType=w.TYPE_TEXTURE,d._key.submitType=w.KEY_TRIANGLES,d._key.other=h.id,this._copyClipInfo(d,this._globalClipMatrix),this._submits[this._submits._length++]=d),e=this._mixRGBandAlpha(p,this._shader2D.ALPHA*o),this._drawTriUseAbsMatrix?c.addData(n,a,s,r,e):(r?(u.a=r.a,u.b=r.b,u.c=r.c,u.d=r.d,u.tx=r.tx+t,u.ty=r.ty+i):(u.a=1,u.b=0,u.c=0,u.d=1,u.tx=t,u.ty=i),Ce.mul(u,this._curMat,u),c.addData(n,a,s,u||this._curMat,e)),this._curSubmit._numEle+=s.length,f&&(this._colorFiler=_,this._curSubmit=w.RENDERBASE),l&&(this.globalCompositeOperation=y)):this.sprite&&L.systemTimer.callLater(this,this._repaintSprite)}},{key:"transform",value:function(e,t,i,n,a,s){We.save(this),Ce.mul(Ce.TEMP.setTo(e,t,i,n,a,s),this._curMat,this._curMat),this._curMat._checkTransform()}},{key:"_transformByMatrix",value:function(e,t,i){e.setTranslate(t,i),Ce.mul(e,this._curMat,this._curMat),e.setTranslate(0,0),this._curMat._bTransform=!0}},{key:"setTransformByMatrix",value:function(e){e.copyTo(this._curMat)}},{key:"rotate",value:function(e){We.save(this),this._curMat.rotateEx(e)}},{key:"scale",value:function(e,t){We.save(this),this._curMat.scaleEx(e,t)}},{key:"clipRect",value:function(e,t,i,n){Ge.save(this),this._clipRect==T.MAXCLIPRECT?this._clipRect=new ne(e,t,i,n):(this._clipRect.width=i,this._clipRect.height=n,this._clipRect.x=e,this._clipRect.y=t),this._clipID_Gen++,this._clipID_Gen%=1e4,this._clipInfoID=this._clipID_Gen;var a,s,i=this._globalClipMatrix,n=i.tx,e=i.ty,t=n+i.a,r=e+i.d;this._clipRect.width>=T._MAXSIZE?(i.a=i.d=T._MAXSIZE,i.b=i.c=i.tx=i.ty=0):(this._curMat._bTransform?(i.tx=this._clipRect.x*this._curMat.a+this._clipRect.y*this._curMat.c+this._curMat.tx,i.ty=this._clipRect.x*this._curMat.b+this._clipRect.y*this._curMat.d+this._curMat.ty,i.a=this._clipRect.width*this._curMat.a,i.b=this._clipRect.width*this._curMat.b,i.c=this._clipRect.height*this._curMat.c,i.d=this._clipRect.height*this._curMat.d):(i.tx=this._clipRect.x+this._curMat.tx,i.ty=this._clipRect.y+this._curMat.ty,i.a=this._clipRect.width,i.b=i.c=0,i.d=this._clipRect.height),this._incache&&(this._clipInCache=!0)),0<i.a&&0<i.d&&(a=i.tx+i.a,s=i.ty+i.d,a<=n||s<=e||i.tx>=t||i.ty>=r?(i.a=-.1,i.d=-.1):(i.tx<n&&(i.a-=n-i.tx,i.tx=n),t<a&&(i.a-=a-t),i.ty<e&&(i.d-=e-i.ty,i.ty=e),r<s&&(i.d-=s-r),i.a<=0&&(i.a=-.1),i.d<=0&&(i.d=-.1)))}},{key:"drawMesh",value:function(e,t,i,n,a,s,r,o){}},{key:"addRenderObject",value:function(e){this._submits[this._submits._length++]=e}},{key:"submitElement",value:function(e,t){this.isMain;for(var i=this._submits,n=i._length,a=(t<0&&(t=i._length),w.RENDERBASE);e<t;)this._renderNextSubmitIndex=e+1,i[e]===w.RENDERBASE?e++:(w.preRender=a,e+=(a=i[e]).renderSubmit());return n}},{key:"flush",value:function(){this._clipID_Gen=0;var e=this.submitElement(0,this._submits._length);this._path&&this._path.reset(),rt.instance&&rt.getInstance().reset(),this._curSubmit=w.RENDERBASE;for(var t=0,i=this.meshlist.length;t<i;t++){var n=this.meshlist[t];n.canReuse?n.releaseMesh():n.destroy()}return this.meshlist.length=0,this._mesh=tt.getAMesh(this.isMain),this._pathMesh=nt.getAMesh(this.isMain),this._triangleMesh=it.getAMesh(this.isMain),this.meshlist.push(this._mesh,this._pathMesh,this._triangleMesh),this._flushCnt++,this._flushCnt%60==0&&this.isMain&&Tt.textRenderInst&&Tt.textRenderInst.GC(),e}},{key:"beginPath",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this._getPath().beginPath(e)}},{key:"closePath",value:function(){this._path.closePath()}},{key:"addPath",value:function(e,t,i,n,a){for(var s=0,r=0,o=e.length/2;r<o;r++){var h=e[s]+n,l=e[s+1]+a;e[s]=h,e[s+1]=l,s+=2}this._getPath().push(e,i)}},{key:"fill",value:function(){var e=this._curMat,t=this._getPath(),i=this._curSubmit,n=i._key.submitType===w.KEY_VG&&i._key.blendShader===this._nBlendType;(n=n&&(n&&this.isSameClipInfo(i)))||(this._curSubmit=this.addVGSubmit(this._pathMesh));for(var a=this.mixRGBandAlpha(this.fillStyle.toInt()),s=0,r=0,o=t.paths.length;r<o;r++){var h=t.paths[r],l=h.path.length/2;if(!(l<3||3==l&&!h.convex)){var u,c,_,f,d=h.path.concat(),p=0;if(e._bTransform)for(p=0;p<l;p++)_=d[u=p<<1],f=d[c=u+1],d[u]=e.a*_+e.c*f+e.tx,d[c]=e.b*_+e.d*f+e.ty;else for(p=0;p<l;p++)_=d[u=p<<1],f=d[c=u+1],d[u]=_+e.tx,d[c]=f+e.ty;this._pathMesh.vertNum+l>T._MAXVERTNUM&&(this._curSubmit._numEle+=s,s=0,this._pathMesh=nt.getAMesh(this.isMain),this._curSubmit=this.addVGSubmit(this._pathMesh));var y=this._pathMesh.vertNum;if(h.convex)for(var g=l-2,m=new Array(3*g),v=0,x=0;x<g;x++)m[v++]=y,m[v++]=x+1+y,m[v++]=x+2+y;else if(m=lt.earcut(d,null,2),0<y)for(var k=0;k<m.length;k++)m[k]+=y;this._pathMesh.addVertAndIBToMesh(this,d,a,m),s+=m.length}}this._curSubmit._numEle+=s}},{key:"addVGSubmit",value:function(e){e=ct.createShape(this,e,0,xe.create(ge.PRIMITIVE,0));return e._key.submitType=w.KEY_VG,this._submits[this._submits._length++]=e,this._copyClipInfo(e,this._globalClipMatrix),e}},{key:"stroke",value:function(){if(0<this.lineWidth){var e=this.mixRGBandAlpha(this.strokeStyle._color.numColor),t=this._getPath(),i=this._curSubmit,n=i._key.submitType===w.KEY_VG&&i._key.blendShader===this._nBlendType;(n=n&&(n&&this.isSameClipInfo(i)))||(this._curSubmit=this.addVGSubmit(this._pathMesh));for(var a=0,s=0,r=t.paths.length;s<r;s++){var o=t.paths[s];if(!(o.path.length<=0)){var h=[],l=[],u=2*o.path.length;if(!(u<2)){this._pathMesh.vertNum+u>T._MAXVERTNUM&&(this._curSubmit._numEle+=a,a=0,this._pathMesh=nt.getAMesh(this.isMain),this.meshlist.push(this._pathMesh),this._curSubmit=this.addVGSubmit(this._pathMesh)),ot.createLine2(o.path,h,this.lineWidth,this._pathMesh.vertNum,l,o.loop);var c,_,f,d,p=l.length/2,y=this._curMat,g=0;if(y._bTransform)for(g=0;g<p;g++)f=l[c=g<<1],d=l[_=c+1],l[c]=y.a*f+y.c*d+y.tx,l[_]=y.b*f+y.d*d+y.ty;else for(g=0;g<p;g++)f=l[c=g<<1],d=l[_=c+1],l[c]=f+y.tx,l[_]=d+y.ty;this._pathMesh.addVertAndIBToMesh(this,l,e,h),a+=h.length}}}this._curSubmit._numEle+=a}}},{key:"moveTo",value:function(e,t){var i=this._getPath();i.newPath(),i._lastOriX=e,i._lastOriY=t,i.addPoint(e,t)}},{key:"lineTo",value:function(e,t){var i=this._getPath();Math.abs(e-i._lastOriX)<.001&&Math.abs(t-i._lastOriY)<.001||(i._lastOriX=e,i._lastOriY=t,i.addPoint(e,t))}},{key:"arcTo",value:function(e,t,i,n,a){var s=0,r=0,o=0,h=this._path._lastOriX-e,l=this._path._lastOriY-t,u=Math.sqrt(h*h+l*l);if(!(u<=1e-6)){var h=h/u,l=l/u,i=i-e,n=n-t,c=Math.sqrt(i*i+n*n);if(!(c<=1e-6)){var i=i/c,n=n/c,c=h+i,_=l+n,f=Math.sqrt(c*c+_*_);if(!(f<=1e-6))for(var c=c/f,_=_/f,f=Math.acos(c*h+_*l),f=Math.PI/2-f,d=(u=a/Math.tan(f))*h+e,p=u*l+t,u=Math.sqrt(u*u+a*a),y=e+c*u,g=t+_*u,m=0,v=0,x=(v=(m=(a=0<=h*n-l*i?2*f/T.SEGNUM:2*-f/T.SEGNUM,Math.sin(a)),Math.cos(a)),this._path._lastOriX),k=this._path._lastOriY,e=d,c=p,w=((.1<Math.abs(e-this._path._lastOriX)||.1<Math.abs(c-this._path._lastOriY))&&(x=r=e,k=o=c,this._path._lastOriX=r,this._path._lastOriY=o,this._path.addPoint(r,o)),d-y),b=p-g,s=0;s<T.SEGNUM;s++){var S=w*v+b*m,I=-w*m+b*v,r=S+y,o=I+g;(.1<Math.abs(x-r)||.1<Math.abs(k-o))&&(this._path._lastOriX=r,this._path._lastOriY=o,this._path.addPoint(r,o),x=r,k=o),w=S,b=I}}}}},{key:"arc",value:function(e,t,i,n,a){var s,r=0,o=0,h=0,l=0,r=a-n;if(5<arguments.length&&void 0!==arguments[5]&&arguments[5])if(Math.abs(r)>=2*Math.PI)r=2*-Math.PI;else for(;0<r;)r-=2*Math.PI;else if(Math.abs(r)>=2*Math.PI)r=2*Math.PI;else for(;r<0;)r+=2*Math.PI;for(var u=this.getMatScaleX(),c=this.getMatScaleY(),u=2*Math.PI*(i*(c<u?u:c)),_=0|Math.max(u/10,10),f=this._getPath(),d=0;d<=_;d++)s=n+r*(d/_),o=Math.cos(s),l=t+Math.sin(s)*i,(h=e+o*i)==this._path._lastOriX&&l==this._path._lastOriY||f.addPoint(h,l);o=Math.cos(a),l=t+Math.sin(a)*i,(h=e+o*i)==this._path._lastOriX&&l==this._path._lastOriY||f.addPoint(h,l)}},{key:"quadraticCurveTo",value:function(e,t,i,n){for(var a=De.I.getBezierPoints([this._path._lastOriX,this._path._lastOriY,e,t,i,n],30,2),s=0,r=a.length/2;s<r;s++)this.lineTo(a[2*s],a[2*s+1]);this.lineTo(i,n)}},{key:"mixRGBandAlpha",value:function(e){return this._mixRGBandAlpha(e,this._shader2D.ALPHA)}},{key:"_mixRGBandAlpha",value:function(e,t){if(1<=t)return e;var i=(4278190080&e)>>>24;return 0!=i?i*=t:i=255*t,16777215&e|i<<24}},{key:"strokeRect",value:function(e,t,i,n,a){var s,r;0<this.lineWidth&&(s=this.mixRGBandAlpha(this.strokeStyle._color.numColor),r=this.lineWidth/2,this._fillRect(e-r,t-r,i+this.lineWidth,this.lineWidth,s),this._fillRect(e-r,t-r+n,i+this.lineWidth,this.lineWidth,s),this._fillRect(e-r,t+r,this.lineWidth,n-this.lineWidth,s),this._fillRect(e-r+i,t+r,this.lineWidth,n-this.lineWidth,s))}},{key:"clip",value:function(){}},{key:"drawParticle",value:function(e,t,i){i.x=e,i.y=t,this._submits[this._submits._length++]=i}},{key:"_getPath",value:function(){return this._path||(this._path=new Ue)}},{key:"canvas",get:function(){return this._canvas}},{key:"_fillTexture_h",value:function(e,t,i,n,a,s,r,o){n<=0&&console.error("_fillTexture_h error: oriw must>0");for(var h,l=s,u=Math.floor(o/n),s=o%n,c=0;c<u;c++)this._inner_drawTexture(e,t,l,r,n,a,this._curMat,i,1,!1),l+=n;0<s&&(o=i[2]-i[0],o=i[0]+s/n*o,(h=T.tmpuv1)[0]=i[0],h[1]=i[1],h[2]=o,h[3]=i[3],h[4]=o,h[5]=i[5],h[6]=i[6],h[7]=i[7],this._inner_drawTexture(e,t,l,r,s,a,this._curMat,h,1,!1))}},{key:"_fillTexture_v",value:function(e,t,i,n,a,s,r,o){a<=0&&console.error("_fillTexture_v error: orih must>0");for(var h,l=r,u=Math.floor(o/a),r=o%a,c=0;c<u;c++)this._inner_drawTexture(e,t,s,l,n,a,this._curMat,i,1,!1),l+=a;0<r&&(o=i[7]-i[1],o=i[1]+r/a*o,(h=T.tmpuv1)[0]=i[0],h[1]=i[1],h[2]=i[2],h[3]=i[3],h[4]=i[4],h[5]=o,h[6]=i[6],h[7]=o,this._inner_drawTexture(e,t,s,l,n,r,this._curMat,h,1,!1))}},{key:"drawTextureWithSizeGrid",value:function(e,t,i,n,a,s,r,o){var h,l,u,c,_,f,d,p,y,g,m,v,x,k,w,b,S,I;e._getSource()&&(t+=r,i+=o,r=e.uv,o=e.bitmap.width,g=e.bitmap.height,u=(h=s[0])/g,c=(l=s[3])/o,d=(_=s[1])/o,p=(f=s[2])/g,s=s[4],y=!1,a==g&&(h=f=0),n<(l=n==o?_=0:l)+_&&(g=n,y=!0,n=l+_,this.save(),this.clipRect(0+t,0+i,g,a)),o=e.bitmap.id,g=this._curMat,m=this._tempUV,k=v=r[0],w=I=r[1],b=x=r[4],S=r=r[5],l&&h&&(b=v+c,S=I+u,m[0]=v,m[1]=I,m[2]=b,m[3]=I,m[4]=b,m[5]=S,m[6]=v,m[7]=S,this._inner_drawTexture(e,o,t,i,l,h,g,m,1,!1)),_&&h&&(S=(w=I)+u,m[0]=k=(b=x)-d,m[1]=w,m[2]=b,m[3]=w,m[4]=b,m[5]=S,m[6]=k,m[7]=S,this._inner_drawTexture(e,o,n-_+t,0+i,_,h,g,m,1,!1)),l&&f&&(w=r-p,b=(k=v)+c,S=r,m[0]=k,m[1]=w,m[2]=b,m[3]=w,m[4]=b,m[5]=S,m[6]=k,m[7]=S,this._inner_drawTexture(e,o,0+t,a-f+i,l,f,g,m,1,!1)),_&&f&&(w=r-p,S=r,m[0]=k=(b=x)-d,m[1]=w,m[2]=b,m[3]=w,m[4]=b,m[5]=S,m[6]=k,m[7]=S,this._inner_drawTexture(e,o,n-_+t,a-f+i,_,f,g,m,1,!1)),h&&(b=x-d,S=(w=I)+u,m[0]=k=v+c,m[1]=w,m[2]=b,m[3]=w,m[4]=b,m[5]=S,m[6]=k,m[7]=S,s?this._fillTexture_h(e,o,m,e.width-l-_,h,l+t,i,n-l-_):this._inner_drawTexture(e,o,l+t,i,n-l-_,h,g,m,1,!1)),f&&(w=r-p,b=x-d,S=r,m[0]=k=v+c,m[1]=w,m[2]=b,m[3]=w,m[4]=b,m[5]=S,m[6]=k,m[7]=S,s?this._fillTexture_h(e,o,m,e.width-l-_,f,l+t,a-f+i,n-l-_):this._inner_drawTexture(e,o,l+t,a-f+i,n-l-_,f,g,m,1,!1)),l&&(w=I+u,b=(k=v)+c,S=r-p,m[0]=k,m[1]=w,m[2]=b,m[3]=w,m[4]=b,m[5]=S,m[6]=k,m[7]=S,s?this._fillTexture_v(e,o,m,l,e.height-h-f,t,h+i,a-h-f):this._inner_drawTexture(e,o,t,h+i,l,a-h-f,g,m,1,!1)),_&&(w=I+u,S=r-p,m[0]=k=(b=x)-d,m[1]=w,m[2]=b,m[3]=w,m[4]=b,m[5]=S,m[6]=k,m[7]=S,s?this._fillTexture_v(e,o,m,_,e.height-h-f,n-_+t,h+i,a-h-f):this._inner_drawTexture(e,o,n-_+t,h+i,_,a-h-f,g,m,1,!1)),w=I+u,b=x-d,S=r-p,m[0]=k=v+c,m[1]=w,m[2]=b,m[3]=w,m[4]=b,m[5]=S,m[6]=k,m[7]=S,s?((I=T.tmpUVRect)[0]=k,I[1]=w,I[2]=b-k,I[3]=S-w,this._fillTexture(e,e.width-l-_,e.height-h-f,I,l+t,h+i,n-l-_,a-h-f,"repeat",0,0)):this._inner_drawTexture(e,o,l+t,h+i,n-l-_,a-h-f,g,m,1,!1),y&&this.restore())}}],[{key:"__init__",value:function(){T.MAXCLIPRECT=new ne(0,0,T._MAXSIZE,T._MAXSIZE),Mt.DEFAULT=new Mt}},{key:"set2DRenderConfig",value:function(){var e=S.instance;v.setBlend(e,!0),v.setBlendEquation(e,e.FUNC_ADD),pe.activeBlendFunction=null,v.setBlendFunc(e,e.ONE,e.ONE_MINUS_SRC_ALPHA),v.setDepthTest(e,!1),v.setCullFace(e,!1),v.setDepthMask(e,!0),v.setFrontFace(e,e.CCW),e.viewport(0,0,_e.width,_e.height)}}]),T}()),Mt=(Ct.ENUM_TEXTALIGN_DEFAULT=0,Ct.ENUM_TEXTALIGN_CENTER=1,Ct.ENUM_TEXTALIGN_RIGHT=2,Ct._SUBMITVBSIZE=32e3,Ct._MAXSIZE=99999999,Ct._MAXVERTNUM=65535,Ct.MAXCLIPRECT=null,Ct._COUNT=0,Ct.SEGNUM=32,Ct._contextcount=0,Ct.PI2=2*Math.PI,Ct._textRender=null,Ct.tmpuv1=[0,0,0,0,0,0,0,0],Ct.tmpUV=[0,0,0,0,0,0,0,0],Ct.tmpUVRect=[0,0,0,0],function(){function e(){b(this,e),this.lineWidth=1}return y(e,[{key:"clear",value:function(){this.lineWidth=1,this.textAlign=this.textBaseline=null}},{key:"make",value:function(){return this===e.DEFAULT?new e:this}}]),e}()),Et=function(){function e(){b(this,e)}return y(e,null,[{key:"_uint8ArraySlice",value:function(){for(var e=this.length,t=new Uint8Array(this.length),i=0;i<e;i++)t[i]=this[i];return t}},{key:"_float32ArraySlice",value:function(){for(var e=this.length,t=new Float32Array(this.length),i=0;i<e;i++)t[i]=this[i];return t}},{key:"_uint16ArraySlice",value:function(){var e,t,i;if(0===arguments.length)for(e=this.length,t=new Uint16Array(e),i=0;i<e;i++)t[i]=this[i];else if(2===arguments.length){var n=arguments.length<=0?void 0:arguments[0],a=arguments.length<=1?void 0:arguments[1];if(n<a)for(e=a-n,t=new Uint16Array(e),i=n;i<a;i++)t[i-n]=this[i];else t=new Uint16Array(0)}return t}},{key:"_nativeRender_enable",value:function(){}},{key:"enable",value:function(){return!0}},{key:"inner_enable",value:function(){return Float32Array.prototype.slice||(Float32Array.prototype.slice=e._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=e._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=e._uint8ArraySlice),!0}},{key:"onStageResize",value:function(e,t){null!=v.mainContext&&(v.mainContext.viewport(0,0,e,t),_e.width=e,_e.height=t)}}]),e}(),Rt=(Et._isWebGL2=!1,Et.isNativeRender_enable=!1,{});function At(e,t){Rt[e]=!0,void 0!==t&&(e=t,window.console&&window.console.error&&window.console.error(e))}function Lt(e){var t=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(var i=0;i<this.attribs.length;i++){var n=new Lt.VertexAttrib(t);this.attribs[i]=n}this.maxAttrib=0}function Nt(n){var i,a,o=this,h=(this.gl=n,a=(i=n).getError,i.getError=function(){for(var e,t;(e=a.apply(i))!=i.NO_ERROR&&(Rt[e]=!0),e!=i.NO_ERROR;);for(t in Rt)if(Rt[t])return delete Rt[t],parseInt(t);return i.NO_ERROR},this.original={getParameter:n.getParameter,enableVertexAttribArray:n.enableVertexAttribArray,disableVertexAttribArray:n.disableVertexAttribArray,bindBuffer:n.bindBuffer,getVertexAttrib:n.getVertexAttrib,vertexAttribPointer:n.vertexAttribPointer});n.getParameter=function(e){return e==o.VERTEX_ARRAY_BINDING_OES?o.currentVertexArrayObject==o.defaultVertexArrayObject?null:o.currentVertexArrayObject:h.getParameter.apply(this,arguments)},n.enableVertexAttribArray=function(e){var t=o.currentVertexArrayObject;return t.maxAttrib=Math.max(t.maxAttrib,e),t.attribs[e].enabled=!0,h.enableVertexAttribArray.apply(this,arguments)},n.disableVertexAttribArray=function(e){var t=o.currentVertexArrayObject;return t.maxAttrib=Math.max(t.maxAttrib,e),t.attribs[e].enabled=!1,h.disableVertexAttribArray.apply(this,arguments)},n.bindBuffer=function(e,t){switch(e){case n.ARRAY_BUFFER:o.currentArrayBuffer=t;break;case n.ELEMENT_ARRAY_BUFFER:o.currentVertexArrayObject.elementArrayBuffer=t}return h.bindBuffer.apply(this,arguments)},n.getVertexAttrib=function(e,t){var i=o.currentVertexArrayObject.attribs[e];switch(t){case n.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:return i.buffer;case n.VERTEX_ATTRIB_ARRAY_ENABLED:return i.enabled;case n.VERTEX_ATTRIB_ARRAY_SIZE:return i.size;case n.VERTEX_ATTRIB_ARRAY_STRIDE:return i.stride;case n.VERTEX_ATTRIB_ARRAY_TYPE:return i.type;case n.VERTEX_ATTRIB_ARRAY_NORMALIZED:return i.normalized;default:return h.getVertexAttrib.apply(this,arguments)}},n.vertexAttribPointer=function(e,t,i,n,a,s){var r=o.currentVertexArrayObject,r=(r.maxAttrib=Math.max(r.maxAttrib,e),r.attribs[e]);return r.buffer=o.currentArrayBuffer,r.size=t,r.type=i,r.normalized=n,r.stride=a,r.offset=s,r.recache(),h.vertexAttribPointer.apply(this,arguments)},n.instrumentExtension&&n.instrumentExtension(this,"OES_vertex_array_object"),n.canvas.addEventListener("webglcontextrestored",function(){window.console&&window.console.log&&window.console.log("OESVertexArrayObject emulation library context restored"),o.reset_()},!0),this.reset_()}(Lt.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=e.FLOAT,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()}).prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")},Nt.prototype.VERTEX_ARRAY_BINDING_OES=34229,Nt.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(var e=0;e<this.vertexArrayObjects.length;++e)this.vertexArrayObjects.isAlive=!1;var t=this.gl;this.maxVertexAttribs=t.getParameter(t.MAX_VERTEX_ATTRIBS),this.defaultVertexArrayObject=new Lt(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},Nt.prototype.createVertexArrayOES=function(){var e=new Lt(this);return this.vertexArrayObjects.push(e),e},Nt.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject==e&&this.bindVertexArrayOES(null)},Nt.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof Lt&&e.hasBeenBound&&e.ext==this)},Nt.prototype.bindVertexArrayOES=function(e){var t=this.gl;if(e&&!e.isAlive)At(t.INVALID_OPERATION,"bindVertexArrayOES: attempt to bind deleted arrayObject");else{var i=this.original,n=this.currentVertexArrayObject,a=(this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0,this.currentVertexArrayObject);if(n!=a){n&&a.elementArrayBuffer==n.elementArrayBuffer||i.bindBuffer.call(t,t.ELEMENT_ARRAY_BUFFER,a.elementArrayBuffer);for(var s=this.currentArrayBuffer,r=Math.max(n?n.maxAttrib:0,a.maxAttrib),o=0;o<=r;o++){var h,l=a.attribs[o],u=n?n.attribs[o]:null;n&&l.enabled==u.enabled||(l.enabled?i.enableVertexAttribArray:i.disableVertexAttribArray).call(t,o),l.enabled&&(h=!1,n&&l.buffer==u.buffer||(s!=l.buffer&&(i.bindBuffer.call(t,t.ARRAY_BUFFER,l.buffer),s=l.buffer),h=!0),!h&&l.cached==u.cached||i.vertexAttribPointer.call(t,o,l.size,l.type,l.normalized,l.stride,l.offset))}this.currentArrayBuffer!=s&&i.bindBuffer.call(t,t.ARRAY_BUFFER,this.currentArrayBuffer)}}},window._setupVertexArrayObject=function(e){var t=e.getSupportedExtensions,i=(e.getSupportedExtensions=function(){var e=t.call(this)||[];return e.indexOf("OES_vertex_array_object")<0&&e.push("OES_vertex_array_object"),e},e.getExtension);e.getExtension=function(e){var t=i.call(this,e);return t||("OES_vertex_array_object"!==e?null:(this.__OESVertexArrayObject||(console.log("Setup OES_vertex_array_object polyfill"),this.__OESVertexArrayObject=new Nt(this)),this.__OESVertexArrayObject))}},window._forceSetupVertexArrayObject=function(e){var t=e.getSupportedExtensions,i=(e.getSupportedExtensions=function(){var e=t.call(this)||[];return e.indexOf("OES_vertex_array_object")<0&&e.push("OES_vertex_array_object"),e},e.getExtension);e.getExtension=function(e){return"OES_vertex_array_object"===e?(this.__OESVertexArrayObject||(console.log("Setup OES_vertex_array_object polyfill"),this.__OESVertexArrayObject=new Nt(this)),this.__OESVertexArrayObject):i.call(this,e)||null}};var Pt=function(){function a(e,t){b(this,a),this._gl=null,this._vaoExt=null,this._angleInstancedArrays=null,this._isWebGL2=!1,this._oesTextureHalfFloat=null,this._oes_element_index_uint=null,this._oesTextureHalfFloatLinear=null,this._oesTextureFloat=null,this._extTextureFilterAnisotropic=null,this._compressedTextureS3tc=null,this._compressedTexturePvrtc=null,this._compressedTextureEtc1=null,this._gl=e,(this._isWebGL2=t)?this._getExtension("EXT_color_buffer_float"):(t=a._forceSupportVAOPlatform(),L.Render.isConchApp||window._setupVertexArrayObject&&(t?window._forceSetupVertexArrayObject(e):window._setupVertexArrayObject(e)),this._vaoExt=this._getExtension("OES_vertex_array_object"),t||(this._angleInstancedArrays=this._getExtension("ANGLE_instanced_arrays")),this._oesTextureHalfFloat=this._getExtension("OES_texture_half_float"),this._oesTextureHalfFloatLinear=this._getExtension("OES_texture_half_float_linear"),this._oesTextureFloat=this._getExtension("OES_texture_float"),this._oes_element_index_uint=this._getExtension("OES_element_index_uint")),this._extTextureFilterAnisotropic=this._getExtension("EXT_texture_filter_anisotropic"),this._compressedTextureS3tc=this._getExtension("WEBGL_compressed_texture_s3tc"),this._compressedTexturePvrtc=this._getExtension("WEBGL_compressed_texture_pvrtc"),this._compressedTextureEtc1=this._getExtension("WEBGL_compressed_texture_etc1")}return y(a,[{key:"_getExtension",value:function(e){var t,i=a._extentionVendorPrefixes;for(t in i){var n=this._gl.getExtension(i[t]+e);if(n)return n}return null}},{key:"createVertexArray",value:function(){return this._isWebGL2?this._gl.createVertexArray():this._vaoExt.createVertexArrayOES()}},{key:"bindVertexArray",value:function(e){this._isWebGL2?this._gl.bindVertexArray(e):this._vaoExt.bindVertexArrayOES(e)}},{key:"deleteVertexArray",value:function(e){this._isWebGL2?this._gl.deleteVertexArray(e):this._vaoExt.deleteVertexArrayOES(e)}},{key:"isVertexArray",value:function(e){this._isWebGL2?this._gl.isVertexArray(e):this._vaoExt.isVertexArrayOES(e)}},{key:"drawElementsInstanced",value:function(e,t,i,n,a){this._isWebGL2?this._gl.drawElementsInstanced(e,t,i,n,a):this._angleInstancedArrays.drawElementsInstancedANGLE(e,t,i,n,a)}},{key:"drawArraysInstanced",value:function(e,t,i,n){this._isWebGL2?this._gl.drawArraysInstanced(e,t,i,n):this._angleInstancedArrays.drawArraysInstancedANGLE(e,t,i,n)}},{key:"vertexAttribDivisor",value:function(e,t){this._isWebGL2?this._gl.vertexAttribDivisor(e,t):this._angleInstancedArrays.vertexAttribDivisorANGLE(e,t)}},{key:"supportInstance",value:function(){return!(!this._isWebGL2&&!this._angleInstancedArrays)}},{key:"supportElementIndexUint32",value:function(){return!(!this._isWebGL2&&!this._oes_element_index_uint)}}],[{key:"_forceSupportVAOPlatform",value:function(){var e=L.Browser;return e.onBDMiniGame||e.onQGMiniGame}}]),a}(),Bt=(Pt._extentionVendorPrefixes=["","WEBKIT_","MOZ_"],function(){function a(e,t,i){b(this,a),this._timeId=0;i=(a._mainCanvas=i).source;i.id="layaCanvas",i.width=e,i.height=t,a.isConchApp&&document.body.appendChild(i),this.initRender(a._mainCanvas,e,t),window.requestAnimationFrame(function e(t){L.stage._loop();window.requestAnimationFrame(e)}),L.stage.on("visibilitychange",this,this._onVisibilitychange)}return y(a,[{key:"_onVisibilitychange",value:function(){L.stage.isVisibility?0!=this._timeId&&window.clearInterval(this._timeId):this._timeId=window.setInterval(this._enterFrame,1e3)}},{key:"initRender",value:function(e,t,i){var n=S.instance=v.mainContext=function(e){var t,i=["webgl2","webgl","experimental-webgl","webkit-3d","moz-webgl"];Fe.useWebGL2&&!I.onBDMiniGame||i.shift();for(var n=0;n<i.length;n++){try{t=e.getContext(i[n],{stencil:Fe.isStencil,alpha:Fe.isAlpha,antialias:Fe.isAntialias,premultipliedAlpha:Fe.premultipliedAlpha,preserveDrawingBuffer:Fe.preserveDrawingBuffer})}catch(e){}if(t)return"webgl2"===i[n]&&(Et._isWebGL2=!0),new S,t}return null}(a._mainCanvas.source);if(!n)return!1;S.instance=n,S.layaGPUInstance=new Pt(n,Et._isWebGL2),e.size(t,i),Ct.__init__(),w.__init__();t=new Ct;return t.isMain=!0,a._context=t,e._setContext(t),ge.__init__(),xe.__init__(),st.__init__(),Ze.__int__(n),pe._init_(n),!0}},{key:"_enterFrame",value:function(){L.stage._loop()}}],[{key:"context",get:function(){return a._context}},{key:"canvas",get:function(){return a._mainCanvas.source}}]),a}()),Dt=(Bt.supportWebGLPlusCulling=!1,Bt.supportWebGLPlusAnimation=!1,Bt.supportWebGLPlusRendering=!1,Bt.isConchApp=!1,Bt.isConchApp=null!=window.conch,(Bt.isConchApp||null!=window.qq&&null!=window.qq.webglPlus)&&(Bt.supportWebGLPlusCulling=!1,Bt.supportWebGLPlusAnimation=!1,Bt.supportWebGLPlusRendering=!1),function(){function _(){b(this,_)}return y(_,[{key:"recover",value:function(){this.texture=null,this.vertices=null,this.uvs=null,this.indices=null,this.matrix=null,p.recover("DrawTrianglesCmd",this)}},{key:"run",value:function(e,t,i){e.drawTriangles(this.texture,this.x+t,this.y+i,this.vertices,this.uvs,this.indices,this.matrix,this.alpha,this.color,this.blendMode,this.colorNum)}},{key:"cmdID",get:function(){return _.ID}}],[{key:"create",value:function(e,t,i,n,a,s,r,o,h,l,u){var c=p.getItemByClass("DrawTrianglesCmd",_);return c.texture=e,c.x=t,c.y=i,c.vertices=n,c.uvs=a,c.indices=s,c.matrix=r,c.alpha=o,h&&(c.color=new Te,e=Ie.create(h).arrColor,c.color.color(255*e[0],255*e[1],255*e[2],255*e[3])),c.blendMode=l,c.colorNum=u,c}}]),_}()),Ot=(Dt.ID="DrawTriangles",function(){function o(){b(this,o)}return y(o,[{key:"recover",value:function(){this.texture._removeReference(),p.recover("Draw9GridTexture",this)}},{key:"run",value:function(e,t,i){e.drawTextureWithSizeGrid(this.texture,this.x,this.y,this.width,this.height,this.sizeGrid,t,i)}},{key:"cmdID",get:function(){return o.ID}}],[{key:"create",value:function(e,t,i,n,a,s){var r=p.getItemByClass("Draw9GridTexture",o);return(r.texture=e)._addReference(),r.x=t,r.y=i,r.width=n,r.height=a,r.sizeGrid=s,r}}]),o}()),Ft=(Ot.ID="Draw9GridTexture",function(){function g(){b(this,g),this._cacheBoundsType=!1}return y(g,[{key:"destroy",value:function(){this._graphics=null,this._cacheBoundsType=!1,this._temp&&(this._temp.length=0),this._rstBoundPoints&&(this._rstBoundPoints.length=0),this._bounds&&this._bounds.recover(),this._bounds=null,p.recover("GraphicsBounds",this)}},{key:"reset",value:function(){this._temp&&(this._temp.length=0)}},{key:"getBounds",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return this._bounds&&this._temp&&!(this._temp.length<1)&&e==this._cacheBoundsType||(this._bounds=ne._getWrapRec(this.getBoundPoints(e),this._bounds)),this._cacheBoundsType=e,this._bounds}},{key:"getBoundPoints",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return(!this._temp||this._temp.length<1||e!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints(e)),this._cacheBoundsType=e,this._rstBoundPoints=Se.copyArray(this._rstBoundPoints,this._temp)}},{key:"_getCmdPoints",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=this._graphics.cmds,i=this._temp||(this._temp=[]);if(i.length=0,t||null==this._graphics._one||(g._tempCmds.length=0,g._tempCmds.push(this._graphics._one),t=g._tempCmds),!t)return i;for(var n,a=g._tempMatrixArrays,s=(a.length=0,g._initMatrix),r=(s.identity(),g._tempMatrix),o=0,h=t.length;o<h;o++)switch((n=t[o]).cmdID){case H.ID:a.push(s),s=s.clone();break;case Ae.ID:s=a.pop();break;case Ne.ID:r.identity(),r.translate(-n.pivotX,-n.pivotY),r.scale(n.scaleX,n.scaleY),r.translate(n.pivotX,n.pivotY),this._switchMatrix(s,r);break;case Le.ID:r.identity(),r.translate(-n.pivotX,-n.pivotY),r.rotate(n.angle),r.translate(n.pivotX,n.pivotY),this._switchMatrix(s,r);break;case Be.ID:r.identity(),r.translate(n.tx,n.ty),this._switchMatrix(s,r);break;case Pe.ID:r.identity(),r.translate(-n.pivotX,-n.pivotY),r.concat(n.matrix),r.translate(n.pivotX,n.pivotY),this._switchMatrix(s,r);break;case K.ID:case Re.ID:g._addPointArrToRst(i,ne._getBoundPointS(n.x,n.y,n.width,n.height),s);break;case Ee.ID:s.copyTo(r),n.matrix&&r.concat(n.matrix),g._addPointArrToRst(i,ne._getBoundPointS(n.x,n.y,n.width,n.height),r);break;case K.ID:var l,u,c,_,f,d,p=n.texture;e?n.width&&n.height?g._addPointArrToRst(i,ne._getBoundPointS(n.x,n.y,n.width,n.height),s):g._addPointArrToRst(i,ne._getBoundPointS(n.x,n.y,p.width,p.height),s):(l=(n.width||p.sourceWidth)/p.width,u=(n.height||p.sourceHeight)/p.height,c=l*p.sourceWidth,_=u*p.sourceHeight,f=0<p.offsetX?p.offsetX:0,d=0<p.offsetY?p.offsetY:0,f*=l,d*=u,g._addPointArrToRst(i,ne._getBoundPointS(n.x-f,n.y-d,c,_),s));break;case Re.ID:n.width&&n.height?g._addPointArrToRst(i,ne._getBoundPointS(n.x,n.y,n.width,n.height),s):(p=n.texture,g._addPointArrToRst(i,ne._getBoundPointS(n.x,n.y,p.width,p.height),s));break;case Ee.ID:var y=n.matrix?(s.copyTo(r),r.concat(n.matrix),r):s;e?n.width&&n.height?g._addPointArrToRst(i,ne._getBoundPointS(n.x,n.y,n.width,n.height),y):(p=n.texture,g._addPointArrToRst(i,ne._getBoundPointS(n.x,n.y,p.width,p.height),y)):(p=n.texture,l=(n.width||p.sourceWidth)/p.width,u=(n.height||p.sourceHeight)/p.height,c=l*p.sourceWidth,_=u*p.sourceHeight,f=0<p.offsetX?p.offsetX:0,d=0<p.offsetY?p.offsetY:0,f*=l,d*=u,g._addPointArrToRst(i,ne._getBoundPointS(n.x-f,n.y-d,c,_),y));break;case te.ID:g._addPointArrToRst(i,ne._getBoundPointS(n.x,n.y,n.width,n.height),s);break;case j.ID:g._addPointArrToRst(i,ne._getBoundPointS(n.x-n.radius,n.y-n.radius,n.radius+n.radius,n.radius+n.radius),s);break;case Q.ID:g._tempPoints.length=0,y=.5*n.lineWidth,n.fromX==n.toX?g._tempPoints.push(n.fromX+y,n.fromY,n.toX+y,n.toY,n.fromX-y,n.fromY,n.toX-y,n.toY):n.fromY==n.toY?g._tempPoints.push(n.fromX,n.fromY+y,n.toX,n.toY+y,n.fromX,n.fromY-y,n.toX,n.toY-y):g._tempPoints.push(n.fromX,n.fromY,n.toX,n.toY),g._addPointArrToRst(i,g._tempPoints,s);break;case q.ID:g._addPointArrToRst(i,De.I.getBezierPoints(n.points),s,n.x,n.y);break;case Z.ID:case ee.ID:g._addPointArrToRst(i,n.points,s,n.x,n.y);break;case J.ID:g._addPointArrToRst(i,this._getPathPoints(n.paths),s,n.x,n.y);break;case $.ID:g._addPointArrToRst(i,this._getPiePoints(n.x,n.y,n.radius,n.startAngle,n.endAngle),s);break;case Dt.ID:g._addPointArrToRst(i,this._getTriAngBBXPoints(n.vertices),s);break;case Ot.ID:g._addPointArrToRst(i,this._getDraw9GridBBXPoints(n),s)}return 200<i.length?i=Se.copyArray(i,ne._getWrapRec(i)._getBoundPoints()):8<i.length&&(i=Oe.scanPList(i)),i}},{key:"_switchMatrix",value:function(e,t){t.concat(e),t.copyTo(e)}},{key:"_getPiePoints",value:function(e,t,i,n,a){var s=g._tempPoints,r=(g._tempPoints.length=0,Math.PI/180),a=a-n;if(360<=a||a<=-360)return s.push(e-i,t-i),s.push(e+i,t-i),s.push(e+i,t+i),s.push(e-i,t+i),s;s.push(e,t);for(var a=a%360,a=(a<0&&(a+=360),n+a),o=n*r,h=a*r,o=(s.push(e+i*Math.cos(o),t+i*Math.sin(o)),s.push(e+i*Math.cos(h),t+i*Math.sin(h)),90*Math.ceil(n/90)),l=90*Math.floor(a/90),u=o;u<=l;u+=90){var c=u*r;s.push(e+i*Math.cos(c),t+i*Math.sin(c))}return s}},{key:"_getTriAngBBXPoints",value:function(e){var t=e.length;if(t<2)return[];for(var i=e[0],n=e[1],a=i,s=n,r=2;r<t;){var o=e[r++],h=e[r++];o<i&&(i=o),h<n&&(n=h),a<o&&(a=o),s<h&&(s=h)}return[i,n,a,n,a,s,i,s]}},{key:"_getDraw9GridBBXPoints",value:function(e){var t=e.width,e=e.height;return[0,0,t,0,t,e,0,e]}},{key:"_getPathPoints",value:function(e){var t,i,n,a=g._tempPoints;for(a.length=0,i=e.length,t=0;t<i;t++)1<(n=e[t]).length&&(a.push(n[1],n[2]),3<n.length&&a.push(n[3],n[4]));return a}}],[{key:"create",value:function(){return p.getItemByClass("GraphicsBounds",g)}},{key:"_addPointArrToRst",value:function(e,t,i){for(var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,s=t.length,r=0;r<s;r+=2)g._addPointToRst(e,t[r]+n,t[r+1]+a,i)}},{key:"_addPointToRst",value:function(e,t,i,n){var a=ie.TEMP;a.setTo(t||0,i||0),n.transformPoint(a),e.push(a.x,a.y)}}]),g}()),C=(Ft._tempMatrix=new Ce,Ft._initMatrix=new Ce,Ft._tempPoints=[],Ft._tempMatrixArrays=[],Ft._tempCmds=[],y(function e(){b(this,e)})),Vt=(C.ALPHA=1,C.TRANSFORM=2,C.BLEND=4,C.CANVAS=8,C.FILTERS=16,C.MASK=32,C.CLIP=64,C.STYLE=128,C.TEXTURE=256,C.GRAPHICS=512,C.LAYAGL3D=1024,C.CUSTOM=2048,C.ONECHILD=4096,C.CHILDS=8192,C.REPAINT_NONE=0,C.REPAINT_NODE=1,C.REPAINT_CACHE=2,C.REPAINT_ALL=3,function(){function s(){b(this,s)}return y(s,[{key:"recover",value:function(){p.recover("ClipRectCmd",this)}},{key:"run",value:function(e,t,i){e.clipRect(this.x+t,this.y+i,this.width,this.height)}},{key:"cmdID",get:function(){return s.ID}}],[{key:"create",value:function(e,t,i,n){var a=p.getItemByClass("ClipRectCmd",s);return a.x=e,a.y=t,a.width=i,a.height=n,a}}]),s}()),Ut=(Vt.ID="ClipRect",function(){function n(){b(this,n)}return y(n,[{key:"recover",value:function(){this.texture._removeReference(),this.texture=null,this.pos=null,p.recover("DrawTexturesCmd",this)}},{key:"run",value:function(e,t,i){e.drawTextures(this.texture,this.pos,t,i)}},{key:"cmdID",get:function(){return n.ID}}],[{key:"create",value:function(e,t){var i=p.getItemByClass("DrawTexturesCmd",n);return(i.texture=e)._addReference(),i.pos=t,i}}]),n}()),zt=(Ut.ID="DrawTextures",function(){function u(){b(this,u),this._textIsWorldText=!1,this._fontColor=4294967295,this._strokeColor=0,this._fontObj=u._defFontObj,this._nTexAlign=0}return y(u,[{key:"recover",value:function(){p.recover("FillTextCmd",this)}},{key:"run",value:function(e,t,i){L.stage.isGlobalRepaint()&&this._textIsWorldText&&this._text.cleanCache(),this._words?Ct._textRender.fillWords(e,this._words,this.x+t,this.y+i,this._fontObj,this._color,this._borderColor,this._lineWidth):this._textIsWorldText?e._fast_filltext(this._text,this.x+t,this.y+i,this._fontObj,this._color,this._borderColor,this._lineWidth,this._nTexAlign,0):Ct._textRender.filltext(e,this._text,this.x+t,this.y+i,this.font,this.color,this._borderColor,this._lineWidth,this._textAlign)}},{key:"cmdID",get:function(){return u.ID}},{key:"text",get:function(){return this._text},set:function(e){this._text=e,this._textIsWorldText=e instanceof kt,this._textIsWorldText&&this._text.cleanCache()}},{key:"font",get:function(){return this._font},set:function(e){this._font=e,this._fontObj=xt.Parse(e),this._textIsWorldText&&this._text.cleanCache()}},{key:"color",get:function(){return this._color},set:function(e){this._color=e,this._fontColor=Ie.create(e).numColor,this._textIsWorldText&&this._text.cleanCache()}},{key:"textAlign",get:function(){return this._textAlign},set:function(e){switch(this._textAlign=e){case"center":this._nTexAlign=L.Context.ENUM_TEXTALIGN_CENTER;break;case"right":this._nTexAlign=L.Context.ENUM_TEXTALIGN_RIGHT;break;default:this._nTexAlign=L.Context.ENUM_TEXTALIGN_DEFAULT}this._textIsWorldText&&this._text.cleanCache()}}],[{key:"create",value:function(e,t,i,n,a,s,r,o,h){var l=p.getItemByClass("FillTextCmd",u);return l.text=e,l._textIsWorldText=e instanceof kt,l._words=t,l.x=i,l.y=n,l.font=a,l.color=s,l.textAlign=r,l._lineWidth=o,l._borderColor=h,l}}]),u}()),Yt=(zt.ID="FillText",zt._defFontObj=new xt(null),function(){function e(){b(this,e)}return y(e,[{key:"recover",value:function(){p.recover("SaveCmd",this)}},{key:"run",value:function(e,t,i){e.save()}},{key:"cmdID",get:function(){return e.ID}}],[{key:"create",value:function(){return p.getItemByClass("SaveCmd",e)}}]),e}()),Gt=(Yt.ID="Save",function(){function a(){b(this,a)}return y(a,null,[{key:"regCacheByFunction",value:function(e,t){a.unRegCacheByFunction(e,t),a._cacheList.push({tryDispose:e,getCacheList:t})}},{key:"unRegCacheByFunction",value:function(e,t){for(var i=a._cacheList.length,n=0;n<i;n++)if(a._cacheList[n].tryDispose==e&&a._cacheList[n].getCacheList==t)return void a._cacheList.splice(n,1)}},{key:"forceDispose",value:function(){for(var e=a._cacheList.length,t=0;t<e;t++)a._cacheList[t].tryDispose(!0)}},{key:"beginCheck",value:function(){L.systemTimer.loop(0<arguments.length&&void 0!==arguments[0]?arguments[0]:15e3,null,a._checkLoop)}},{key:"stopCheck",value:function(){L.systemTimer.clear(null,a._checkLoop)}},{key:"_checkLoop",value:function(){var e=a._cacheList;if(!(e.length<1))for(var t,i=L.Browser.now(),n=t=e.length;0<t&&(e[a._index=++a._index%n].tryDispose(!1),!(L.Browser.now()-i>a.loopTimeLimit));)t--}}]),a}()),Xt=(Gt.loopTimeLimit=2,Gt._cacheList=[],Gt._index=0,function(){function e(){b(this,e),this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],Gt.regCacheByFunction(this.startDispose.bind(this),this.getCacheList.bind(this))}return y(e,[{key:"getId",value:function(){return this._id++}},{key:"addShape",value:function(e,t){this.shapeDic[e]=t,this.useDic[e]||(this.useDic[e]=!0)}},{key:"addLine",value:function(e,t){this.shapeLineDic[e]=t,this.shapeLineDic[e]||(this.shapeLineDic[e]=!0)}},{key:"getShape",value:function(e){this._checkKey&&null!=this.useDic[e]&&(this.useDic[e]=!0)}},{key:"deleteShape",value:function(e){this.shapeDic[e]&&(this.shapeDic[e]=null,delete this.shapeDic[e]),this.shapeLineDic[e]&&(this.shapeLineDic[e]=null,delete this.shapeLineDic[e]),null!=this.useDic[e]&&delete this.useDic[e]}},{key:"getCacheList",value:function(){var e,t=[];for(e in this.shapeDic)t.push(this.shapeDic[e]);for(e in this.shapeLineDic)t.push(this.shapeLineDic[e]);return t}},{key:"startDispose",value:function(e){for(var t in this.useDic)this.useDic[t]=!1;this._checkKey=!0}},{key:"endDispose",value:function(){if(this._checkKey){for(var e in this.useDic)this.useDic[e]||this.deleteShape(e);this._checkKey=!1}}}],[{key:"getInstance",value:function(){return e.instance=e.instance||new e}}]),e}()),Wt=function(){function e(){b(this,e),this._sp=null,this._one=null,this._render=this._renderEmpty,this._cmds=null,this._vectorgraphArray=null,this._graphicBounds=null,this.autoDestroy=!1,this._createData()}return y(e,[{key:"_createData",value:function(){}},{key:"_clearData",value:function(){}},{key:"_destroyData",value:function(){}},{key:"destroy",value:function(){this.clear(!0),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0,this._sp._setRenderType(0),this._sp=null),this._destroyData()}},{key:"clear",value:function(){if(!(0<arguments.length&&void 0!==arguments[0])||arguments[0]){var e=this._one;if(this._cmds){for(var t=this._cmds.length,i=0;i<t;i++)(e=this._cmds[i]).recover();this._cmds.length=0}else e&&e.recover()}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._clearData(),this._sp&&(this._sp._renderType&=~C.GRAPHICS,this._sp._setRenderType(this._sp._renderType)),this._repaint(),this._vectorgraphArray){for(i=0,t=this._vectorgraphArray.length;i<t;i++)Xt.getInstance().deleteShape(this._vectorgraphArray[i]);this._vectorgraphArray.length=0}}},{key:"_clearBoundsCache",value:function(){this._graphicBounds&&this._graphicBounds.reset()}},{key:"_initGraphicBounds",value:function(){this._graphicBounds||(this._graphicBounds=Ft.create(),this._graphicBounds._graphics=this)}},{key:"_repaint",value:function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()}},{key:"_isOnlyOne",value:function(){return!this._cmds||0===this._cmds.length}},{key:"cmds",get:function(){return this._cmds},set:function(e){this._sp&&(this._sp._renderType|=C.GRAPHICS,this._sp._setRenderType(this._sp._renderType)),this._cmds=e,this._render=this._renderAll,this._repaint()}},{key:"getBounds",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return this._initGraphicBounds(),this._graphicBounds.getBounds(e)}},{key:"getBoundPoints",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return this._initGraphicBounds(),this._graphicBounds.getBoundPoints(e)}},{key:"drawImage",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0;if(!e)return null;if(n=n||e.sourceWidth,a=a||e.sourceHeight,e.getIsReady()){var s=n/e.sourceWidth,r=a/e.sourceHeight,n=e.width*s,a=e.height*r;if(n<=0||a<=0)return null;t+=e.offsetX*s,i+=e.offsetY*r}this._sp&&(this._sp._renderType|=C.GRAPHICS,this._sp._setRenderType(this._sp._renderType));s=K.create.call(this,e,t,i,n,a);return null==this._one?(this._one=s,this._render=this._renderOneImg):this._saveToCmd(null,s),this._repaint(),s}},{key:"drawTexture",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:null,r=6<arguments.length&&void 0!==arguments[6]?arguments[6]:1,o=7<arguments.length&&void 0!==arguments[7]?arguments[7]:null,h=8<arguments.length&&void 0!==arguments[8]?arguments[8]:null,l=9<arguments.length?arguments[9]:void 0;if(!e||r<.01)return null;if(!e.getIsReady())return null;if(n=n||e.sourceWidth,a=a||e.sourceHeight,e.getIsReady()){var u=n/e.sourceWidth,c=a/e.sourceHeight,n=e.width*u,a=e.height*c;if(n<=0||a<=0)return null;t+=e.offsetX*u,i+=e.offsetY*c}this._sp&&(this._sp._renderType|=C.GRAPHICS,this._sp._setRenderType(this._sp._renderType));u=Ee.create.call(this,e,t,i,n,a,s,r,o,h,l);return this._repaint(),this._saveToCmd(null,u)}},{key:"drawTextures",value:function(e,t){return e?this._saveToCmd(Bt._context.drawTextures,Ut.create.call(this,e,t)):null}},{key:"drawTriangles",value:function(e,t,i,n,a,s){return this._saveToCmd(Bt._context.drawTriangles,Dt.create.call(this,e,t,i,n,a,s,6<arguments.length&&void 0!==arguments[6]?arguments[6]:null,7<arguments.length&&void 0!==arguments[7]?arguments[7]:1,8<arguments.length&&void 0!==arguments[8]?arguments[8]:null,9<arguments.length&&void 0!==arguments[9]?arguments[9]:null,10<arguments.length&&void 0!==arguments[10]?arguments[10]:void 0))}},{key:"fillTexture",value:function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:"repeat",r=6<arguments.length&&void 0!==arguments[6]?arguments[6]:null;return e&&e.getIsReady()?this._saveToCmd(Bt._context._fillTexture,Re.create.call(this,e,t,i,n,a,s,r||ie.EMPTY,{})):null}},{key:"_saveToCmd",value:function(e,t){return this._sp&&(this._sp._renderType|=C.GRAPHICS,this._sp._setRenderType(this._sp._renderType)),null==this._one?(this._one=t,this._render=this._renderOne):(this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(t)),this._repaint(),t}},{key:"clipRect",value:function(e,t,i,n){return this._saveToCmd(Bt._context.clipRect,Vt.create.call(this,e,t,i,n))}},{key:"fillText",value:function(e,t,i,n,a,s){return this._saveToCmd(Bt._context.fillText,zt.create.call(this,e,null,t,i,n||L.Text.defaultFontStr(),a,s,0,""))}},{key:"fillBorderText",value:function(e,t,i,n,a,s,r,o){return this._saveToCmd(Bt._context.fillText,zt.create.call(this,e,null,t,i,n||L.Text.defaultFontStr(),a,o,r,s))}},{key:"fillWords",value:function(e,t,i,n,a){return this._saveToCmd(Bt._context.fillText,zt.create.call(this,null,e,t,i,n||L.Text.defaultFontStr(),a))}},{key:"fillBorderWords",value:function(e,t,i,n,a,s,r){return this._saveToCmd(Bt._context.fillText,zt.create.call(this,null,e,t,i,n||L.Text.defaultFontStr(),a,"",r,s))}},{key:"strokeText",value:function(e,t,i,n,a,s,r){return this._saveToCmd(Bt._context.fillText,zt.create.call(this,e,null,t,i,n||L.Text.defaultFontStr(),null,r,s,a))}},{key:"alpha",value:function(e){return this._saveToCmd(Bt._context.alpha,H.create.call(this,e))}},{key:"transform",value:function(e){return this._saveToCmd(Bt._context._transform,Pe.create.call(this,e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,2<arguments.length&&void 0!==arguments[2]?arguments[2]:0))}},{key:"rotate",value:function(e){return this._saveToCmd(Bt._context._rotate,Le.create.call(this,e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,2<arguments.length&&void 0!==arguments[2]?arguments[2]:0))}},{key:"scale",value:function(e,t){return this._saveToCmd(Bt._context._scale,Ne.create.call(this,e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,3<arguments.length&&void 0!==arguments[3]?arguments[3]:0))}},{key:"translate",value:function(e,t){return this._saveToCmd(Bt._context.translate,Be.create.call(this,e,t))}},{key:"save",value:function(){return this._saveToCmd(Bt._context._save,Yt.create.call(this))}},{key:"restore",value:function(){return this._saveToCmd(Bt._context.restore,Ae.create.call(this))}},{key:"replaceText",value:function(e){this._repaint();var t=this._cmds;if(t){for(var i=t.length-1;-1<i;i--)if(this._isTextCmd(t[i]))return t[i].text=e,!0}else if(this._one&&this._isTextCmd(this._one))return this._one.text=e,!0;return!1}},{key:"_isTextCmd",value:function(e){return e.cmdID==zt.ID}},{key:"replaceTextColor",value:function(e){this._repaint();var t=this._cmds;if(t)for(var i=t.length-1;-1<i;i--)this._isTextCmd(t[i])&&this._setTextCmdColor(t[i],e);else this._one&&this._isTextCmd(this._one)&&this._setTextCmdColor(this._one,e)}},{key:"_setTextCmdColor",value:function(e,t){e.cmdID===zt.ID&&(e.color=t)}},{key:"loadImage",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:null,r=L.Loader.getRes(e);r?r.getIsReady()?this.drawImage(r,t,i,n,a):r.once(Me.READY,this,this.drawImage,[r,t,i,n,a]):((r=new vt).load(e),L.Loader.cacheTexture(e,r),r.once(Me.READY,this,this.drawImage,[r,t,i,n,a])),null!=s&&(r.getIsReady()?s.call(this._sp):r.on(Me.READY,this._sp,s))}},{key:"_renderEmpty",value:function(e,t,i,n){}},{key:"_renderAll",value:function(e,t,i,n){for(var a=this._cmds,s=0,r=a.length;s<r;s++)a[s].run(t,i,n)}},{key:"_renderOne",value:function(e,t,i,n){t.sprite=e,this._one.run(t,i,n)}},{key:"_renderOneImg",value:function(e,t,i,n){t.sprite=e,this._one.run(t,i,n)}},{key:"drawLine",value:function(e,t,i,n,a){var s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:1,r=s<1||s%2==0?0:.5;return this._saveToCmd(Bt._context._drawLine,Q.create.call(this,e+r,t+r,i+r,n+r,a,s,0))}},{key:"drawLines",value:function(e,t,i,n){var a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:1;if(!i||i.length<4)return null;var s=a<1||a%2==0?0:.5;return this._saveToCmd(Bt._context._drawLines,Z.create.call(this,e+s,t+s,i,n,a,0))}},{key:"drawCurves",value:function(e,t,i,n){return this._saveToCmd(Bt._context.drawCurves,q.create.call(this,e,t,i,n,4<arguments.length&&void 0!==arguments[4]?arguments[4]:1))}},{key:"drawRect",value:function(e,t,i,n,a){var s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:null,r=6<arguments.length&&void 0!==arguments[6]?arguments[6]:1,o=1<=r&&s?r/2:0,h=s?r:0;return this._saveToCmd(Bt._context.drawRect,te.create.call(this,e+o,t+o,i-h,n-h,a,s,r))}},{key:"drawCircle",value:function(e,t,i,n){var a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null,s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:1;return this._saveToCmd(Bt._context._drawCircle,j.create.call(this,e,t,i-(1<=s&&a?s/2:0),n,a,s,0))}},{key:"drawPie",value:function(e,t,i,n,a,s){var r=6<arguments.length&&void 0!==arguments[6]?arguments[6]:null,o=7<arguments.length&&void 0!==arguments[7]?arguments[7]:1,h=1<=o&&r?o/2:0;return this._saveToCmd(Bt._context._drawPie,$.create.call(this,e+h,t+h,i-(r?o:0),Se.toRadian(n),Se.toRadian(a),s,r,o,0))}},{key:"drawPoly",value:function(e,t,i,n){var a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null,s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:1,r=!1,r=!(6<i.length),o=!(1<=s&&a)||s%2==0?0:.5;return this._saveToCmd(Bt._context._drawPoly,ee.create.call(this,e+o,t+o,i,n,a,s,r,0))}},{key:"drawPath",value:function(e,t,i){return this._saveToCmd(Bt._context._drawPath,J.create.call(this,e,t,i,3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,4<arguments.length&&void 0!==arguments[4]?arguments[4]:null))}},{key:"draw9Grid",value:function(e){this._saveToCmd(null,Ot.create(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,5<arguments.length&&void 0!==arguments[5]?arguments[5]:null))}}]),e}(),Ht=y(function e(){b(this,e)}),jt=(Ht.NOT_ACTIVE=1,Ht.ACTIVE_INHIERARCHY=2,Ht.AWAKED=4,Ht.NOT_READY=8,Ht.DISPLAY=16,Ht.HAS_ZORDER=32,Ht.HAS_MOUSE=64,Ht.DISPLAYED_INSTAGE=128,Ht.DRAWCALL_OPTIMIZE=256,function(){function p(){b(this,p)}return y(p,null,[{key:"__init__",value:function(){p.map[C.ALPHA|C.TRANSFORM|C.GRAPHICS]=p.alpha_transform_drawLayaGL,p.map[C.ALPHA|C.GRAPHICS]=p.alpha_drawLayaGL,p.map[C.TRANSFORM|C.GRAPHICS]=p.transform_drawLayaGL,p.map[C.TRANSFORM|C.CHILDS]=p.transform_drawNodes,p.map[C.ALPHA|C.TRANSFORM|C.TEXTURE]=p.alpha_transform_drawTexture,p.map[C.ALPHA|C.TEXTURE]=p.alpha_drawTexture,p.map[C.TRANSFORM|C.TEXTURE]=p.transform_drawTexture,p.map[C.GRAPHICS|C.CHILDS]=p.drawLayaGL_drawNodes}},{key:"transform_drawTexture",value:function(e,t,i,n){e._style;var a=e.texture;t.saveTransform(p.curMat),t.transformByMatrix(e.transform,i,n),t.drawTexture(a,-e.pivotX,-e.pivotY,e._width||a.width,e._height||a.height),t.restoreTransform(p.curMat)}},{key:"alpha_drawTexture",value:function(e,t,i,n){var a,s,r=e._style,o=e.texture;(.01<(a=r.alpha)||e._needRepaint())&&(s=t.globalAlpha,t.globalAlpha*=a,t.drawTexture(o,i-r.pivotX+o.offsetX,n-r.pivotY+o.offsetY,e._width||o.width,e._height||o.height),t.globalAlpha=s)}},{key:"alpha_transform_drawTexture",value:function(e,t,i,n){var a,s,r=e._style,o=e.texture;(.01<(a=r.alpha)||e._needRepaint())&&(s=t.globalAlpha,t.globalAlpha*=a,t.saveTransform(p.curMat),t.transformByMatrix(e.transform,i,n),t.drawTexture(o,-r.pivotX+o.offsetX,-r.pivotY+o.offsetY,e._width||o.width,e._height||o.height),t.restoreTransform(p.curMat),t.globalAlpha=s)}},{key:"alpha_transform_drawLayaGL",value:function(e,t,i,n){var a,s,r=e._style;(.01<(a=r.alpha)||e._needRepaint())&&(s=t.globalAlpha,t.globalAlpha*=a,t.saveTransform(p.curMat),t.transformByMatrix(e.transform,i,n),e._graphics&&e._graphics._render(e,t,-r.pivotX,-r.pivotY),t.restoreTransform(p.curMat),t.globalAlpha=s)}},{key:"alpha_drawLayaGL",value:function(e,t,i,n){var a,s,r=e._style;(.01<(a=r.alpha)||e._needRepaint())&&(s=t.globalAlpha,t.globalAlpha*=a,e._graphics&&e._graphics._render(e,t,i-r.pivotX,n-r.pivotY),t.globalAlpha=s)}},{key:"transform_drawLayaGL",value:function(e,t,i,n){var a=e._style;t.saveTransform(p.curMat),t.transformByMatrix(e.transform,i,n),e._graphics&&e._graphics._render(e,t,-a.pivotX,-a.pivotY),t.restoreTransform(p.curMat)}},{key:"transform_drawNodes",value:function(e,t,i,n){var a,s=e._getBit(Ht.DRAWCALL_OPTIMIZE)&&t.drawCallOptimize(!0),r=e._style,o=(t.saveTransform(p.curMat),t.transformByMatrix(e.transform,i,n),i=-r.pivotX,n=-r.pivotY,e._children),h=o.length;if(r.viewport)for(var l,e=r.viewport,u=e.x,c=e.y,_=e.right,f=e.bottom,d=0;d<h;++d)(a=o[d])._visible&&(l=a._x)<_&&l+a.width>u&&(l=a._y)<f&&l+a.height>c&&a.render(t,i,n);else for(var d=0;d<h;++d)(a=o[d])._visible&&a.render(t,i,n);t.restoreTransform(p.curMat),s&&t.drawCallOptimize(!1)}},{key:"drawLayaGL_drawNodes",value:function(e,t,i,n){var a,s=e._getBit(Ht.DRAWCALL_OPTIMIZE)&&t.drawCallOptimize(!0),r=e._style,o=(i-=r.pivotX,n-=r.pivotY,e._graphics&&e._graphics._render(e,t,i,n),e._children),h=o.length;if(r.viewport)for(var l,e=r.viewport,u=e.x,c=e.y,_=e.right,f=e.bottom,d=0;d<h;++d)(a=o[d])._visible&&(l=a._x)<_&&l+a.width>u&&(l=a._y)<f&&l+a.height>c&&a.render(t,i,n);else for(var d=0;d<h;++d)(a=o[d])._visible&&a.render(t,i,n);s&&t.drawCallOptimize(!1)}}]),p}()),qt=(jt.map={},jt.curMat=new Ce,function(){function f(e,t){if(b(this,f),jt.map[e])return this._fun=jt.map[e],void(this._next=f.NORENDER);switch(this._next=t||f.NORENDER,e){case 0:return void(this._fun=this._no);case C.ALPHA:return void(this._fun=this._alpha);case C.TRANSFORM:return void(this._fun=this._transform);case C.BLEND:return void(this._fun=this._blend);case C.CANVAS:return void(this._fun=this._canvas);case C.MASK:return void(this._fun=this._mask);case C.CLIP:return void(this._fun=this._clip);case C.STYLE:return void(this._fun=this._style);case C.GRAPHICS:return void(this._fun=this._graphics);case C.CHILDS:return void(this._fun=this._children);case C.CUSTOM:return void(this._fun=this._custom);case C.TEXTURE:return void(this._fun=this._texture);case C.FILTERS:return void(this._fun=be._filter);case f.INIT:return void(this._fun=f._initRenderFun)}this.onCreate(e)}return y(f,[{key:"onCreate",value:function(e){}},{key:"_style",value:function(e,t,i,n){var a=e._style,a=(null!=a.render&&a.render(e,t,i,n),this._next);a._fun.call(a,e,t,i,n)}},{key:"_no",value:function(e,t,i,n){}},{key:"_custom",value:function(e,t,i,n){e.customRender(t,i,n),this._next._fun.call(this._next,e,t,i-e.pivotX,n-e.pivotY)}},{key:"_clip",value:function(e,t,i,n){var a,s=this._next;s!=f.NORENDER&&(a=e._style.scrollRect,t.save(),t.clipRect(i,n,a.width,a.height),s._fun.call(s,e,t,i-a.x,n-a.y),t.restore())}},{key:"_texture",value:function(e,t,i,n){var a=e.texture,a=(a._getSource()&&t.drawTexture(a,i-e.pivotX+a.offsetX,n-e.pivotY+a.offsetY,e._width||a.width,e._height||a.height),this._next);a!=f.NORENDER&&a._fun.call(a,e,t,i,n)}},{key:"_graphics",value:function(e,t,i,n){var a=e._style,s=e._graphics,s=(s&&s._render(e,t,i-a.pivotX,n-a.pivotY),this._next);s!=f.NORENDER&&s._fun.call(s,e,t,i,n)}},{key:"_image",value:function(e,t,i,n){var a=e._style;t.drawTexture2(i,n,a.pivotX,a.pivotY,e.transform,e._graphics._one)}},{key:"_image2",value:function(e,t,i,n){var a=e._style;t.drawTexture2(i,n,a.pivotX,a.pivotY,e.transform,e._graphics._one)}},{key:"_alpha",value:function(e,t,i,n){var a,s;(.01<(s=e._style.alpha)||e._needRepaint())&&(a=t.globalAlpha,t.globalAlpha*=s,(s=this._next)._fun.call(s,e,t,i,n),t.globalAlpha=a)}},{key:"_transform",value:function(e,t,i,n){var a=e.transform,s=this._next;e._style;a&&s!=f.NORENDER?(t.save(),t.transform(a.a,a.b,a.c,a.d,a.tx+i,a.ty+n),s._fun.call(s,e,t,0,0),t.restore()):s!=f.NORENDER&&s._fun.call(s,e,t,i,n)}},{key:"_children",value:function(e,t,i,n){var a,s=e._style,r=e._children,o=r.length,e=(i-=e.pivotX,n-=e.pivotY,e._getBit(Ht.DRAWCALL_OPTIMIZE)&&t.drawCallOptimize(!0));if(s.viewport)for(var h,s=s.viewport,l=s.x,u=s.y,c=s.right,_=s.bottom,f=0;f<o;++f)(a=r[f])._visible&&(h=a._x)<c&&h+a.width>l&&(h=a._y)<_&&h+a.height>u&&a.render(t,i,n);else for(var f=0;f<o;++f)(a=r[f])._visible&&a.render(t,i,n);e&&t.drawCallOptimize(!1)}},{key:"_canvas",value:function(e,t,i,n){var a=e._cacheStyle,s=this._next;if(a.enableCanvasRender){"bitmap"===a.cacheAs?k.canvasBitmap++:k.canvasNormal++;var r=!1,o=!1;if(a.canvas){var h=a.canvas,l=(h.context,h.touches);if(l)for(var u=0;u<l.length;u++)if(l[u].deleted){o=!0;break}r=h.isCacheValid&&!h.isCacheValid()}if(e._needRepaint()||!a.canvas||o||r||L.stage.isGlobalRepaint())if("normal"===a.cacheAs){if(t._targets)return void s._fun.call(s,e,t,i,n);this._canvas_webgl_normal_repaint(e,t)}else this._canvas_repaint(e,t,i,n);h=a.cacheRect;t.drawCanvas(a.canvas,i+h.x,n+h.y,h.width,h.height)}else s._fun.call(s,e,t,i,n)}},{key:"_canvas_repaint",value:function(e,t,i,n){var a,s=e._cacheStyle,r=this._next,o=s.canvas,h=s.cacheAs,l=s._calculateCacheRect(e,h,i,n),u=l.x,l=l.y,c=s.cacheRect,_=c.width*u,f=c.height*l,d=c.x,c=c.y;if("bitmap"===h&&(2048<_||2048<f))return console.warn("cache bitmap size larger than 2048,cache ignored"),s.releaseContext(),void r._fun.call(r,e,t,i,n);o||(s.createContext(),o=s.canvas),(t=o.context).sprite=e,o.width==_&&o.height==f||o.size(_,f),"bitmap"===h?t.asBitmap=!0:"normal"===h&&(t.asBitmap=!1),t.clear(),1!=u||1!=l?((a=t).save(),a.scale(u,l),r._fun.call(r,e,t,-d,-c),a.restore()):(a=t,r._fun.call(r,e,t,-d,-c)),e._applyFilters(),s.staticCache&&(s.reCache=!1),k.canvasReCache++}},{key:"_canvas_webgl_normal_repaint",value:function(e,t){var i=e._cacheStyle,n=this._next,a=i.canvas,s=i.cacheAs,s=(i._calculateCacheRect(e,s,0,0),(a=a||(i.canvas=new at(t,e))).context);a.startRec(),n._fun.call(n,e,s,e.pivotX,e.pivotY),e._applyFilters(),k.canvasReCache++,a.endRec()}},{key:"_blend",value:function(e,t,i,n){var a=e._style,s=this._next;a.blendMode?(t.save(),t.globalCompositeOperation=a.blendMode,s._fun.call(s,e,t,i,n),t.restore()):s._fun.call(s,e,t,i,n)}},{key:"_mask",value:function(e,t,i,n){var a,s,r,o,h,l,u=this._next,c=e.mask,_=t;c?(_.save(),a=_.globalCompositeOperation,(s=new ne).copyFrom(c.getBounds()),s.width=Math.round(s.width),s.height=Math.round(s.height),s.x=Math.round(s.x),s.y=Math.round(s.y),0<s.width&&0<s.height&&(r=s.width,o=s.height,h=de.getRT(r,o),_.breakNextMerge(),_.pushRT(),_.addRenderObject(we.create([_,h,r,o],f.tmpTarget,this)),c.render(_,-s.x,-s.y),_.breakNextMerge(),_.popRT(),_.save(),_.clipRect(i+s.x-e.getStyle().pivotX,n+s.y-e.getStyle().pivotY,r,o),u._fun.call(u,e,_,i,n),_.restore(),a=_.globalCompositeOperation,_.addRenderObject(we.create(["mask"],f.setBlendMode,this)),c=xe.create(ge.TEXTURE2D,0),l=vt.INV_UV,_.drawTarget(h,i+s.x-e.getStyle().pivotX,n+s.y-e.getStyle().pivotY,r,o,Ce.TEMP.identity(),c,l,6),_.addRenderObject(we.create([h],f.recycleTarget,this)),_.addRenderObject(we.create([a],f.setBlendMode,this))),_.restore()):u._fun.call(u,e,t,i,n)}}],[{key:"__init__",value:function(){var e,t,i;for(jt.__init__(),i=new f(f.INIT,null),t=f.renders.length=2*C.CHILDS,e=0;e<t;e++)f.renders[e]=i;f.renders[0]=new f(0,null)}},{key:"_initRenderFun",value:function(e,t,i,n){var a=e._renderType;(f.renders[a]=f._getTypeRender(a))._fun(e,t,i,n)}},{key:"_getTypeRender",value:function(e){if(jt.map[e])return new f(e,null);for(var t=null,i=C.CHILDS;0<i;)i&e&&(t=new f(i,t)),i>>=1;return t}},{key:"tmpTarget",value:function(e,t,i,n){t.start(),t.clear(0,0,0,0)}},{key:"recycleTarget",value:function(e){de.releaseRT(e)}},{key:"setBlendMode",value:function(e){var t=v.mainContext;pe.targetFns[pe.TOINT[e]](t)}}]),f}()),Kt=(qt.INIT=69905,qt.renders=[],qt.NORENDER=new qt(0,null),qt.tempUV=new Array(8),function(){f(n,he);var i=T(n);function n(){var e,t=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return b(this,n),(e=i.call(this))._source=t?I.createElement("canvas"):O(e),e.lock=!0,e}return y(n,[{key:"source",get:function(){return this._source}},{key:"_getSource",value:function(){return this._source}},{key:"clear",value:function(){this._ctx&&this._ctx.clear&&this._ctx.clear(),this._texture&&(this._texture.destroy(),this._texture=null)}},{key:"destroy",value:function(){m(g(n.prototype),"destroy",this).call(this),this._setCPUMemory(0),this._ctx&&this._ctx.destroy&&this._ctx.destroy(),this._ctx=null}},{key:"release",value:function(){}},{key:"context",get:function(){return this._ctx||(this._source==this?this._ctx=new L.Context:this._ctx=this._source.getContext(L.Render.isConchApp?"layagl":"2d"),(this._ctx._canvas=this)._ctx)}},{key:"_setContext",value:function(e){this._ctx=e}},{key:"getContext",value:function(e){return this.context}},{key:"getMemSize",value:function(){return 0}},{key:"size",value:function(e,t){this._width==e&&this._height==t&&(!this._source||this._source.width==e&&this._source.height==t)||(this._width=e,this._height=t,this._setCPUMemory(e*t*4),this._ctx&&this._ctx.size&&this._ctx.size(e,t),this._source&&(this._source.height=t,this._source.width=e),this._texture&&(this._texture.destroy(),this._texture=null))}},{key:"getTexture",value:function(){var e;return this._texture||((e=new ue).loadImageSource(this.source),this._texture=new vt(e)),this._texture}},{key:"toBase64",value:function(e,t){if(this._source){if(L.Render.isConchApp){var i=window;if(2==i.conchConfig.threadMode)throw"native 2 thread mode use toBase64Async";var n=this._ctx._targets.sourceWidth,a=this._ctx._targets.sourceHeight,s=this._ctx._targets.getData(0,0,n,a);return i.conchToBase64FlipY?i.conchToBase64FlipY(e,t,s.buffer,n,a):i.conchToBase64(e,t,s.buffer,n,a)}return this._source.toDataURL(e,t)}return null}},{key:"toBase64Async",value:function(i,n,a){var s=this._ctx._targets.sourceWidth,r=this._ctx._targets.sourceHeight;this._ctx._targets.getDataAsync(0,0,s,r,function(e){var t=window,t=t.conchToBase64FlipY?t.conchToBase64FlipY(i,n,e.buffer,s,r):t.conchToBase64(i,n,e.buffer,s,r);a(t)})}}]),n}()),Qt=function(){function c(){b(this,c)}return y(c,[{key:"contains",value:function(e,t){return!!c._isHitGraphic(e,t,this.hit)&&!c._isHitGraphic(e,t,this.unHit)}},{key:"hit",get:function(){return this._hit||(this._hit=new L.Graphics),this._hit},set:function(e){this._hit=e}},{key:"unHit",get:function(){return this._unHit||(this._unHit=new L.Graphics),this._unHit},set:function(e){this._unHit=e}}],[{key:"_isHitGraphic",value:function(e,t,i){if(!i)return!1;var n,a,s,r=i.cmds;if(!r&&i._one&&((r=c._cmds).length=1,r[0]=i._one),!r)return!1;for(a=r.length,n=0;n<a;n++)if((s=r[n])&&("Translate"===s.cmdID&&(e-=s.tx,t-=s.ty),c._isHitCmd(e,t,s)))return!0;return!1}},{key:"_isHitCmd",value:function(e,t,i){if(!i)return!1;var n=!1;switch(i.cmdID){case"DrawRect":c._rect.setTo(i.x,i.y,i.width,i.height),n=c._rect.contains(e,t);break;case"DrawCircle":n=(e-=i.x)*e+(t-=i.y)*t<i.radius*i.radius;break;case"DrawPoly":e-=i.x,t-=i.y,n=c._ptInPolygon(e,t,i.points)}return n}},{key:"_ptInPolygon",value:function(e,t,i){for(var n=c._ptPoint,a=(n.setTo(e,t),0),s=i.length,r=0;r<s;r+=2){var o,h=i[r],l=i[r+1],u=i[(r+2)%s];l==(o=i[(r+3)%s])||n.y<Math.min(l,o)||n.y>=Math.max(l,o)||(n.y-l)*(u-h)/(o-l)+h>n.x&&a++}return a%2==1}}]),c}(),M=(Qt._cmds=[],Qt._rect=new ne,Qt._ptPoint=new ie,function(){function f(){b(this,f)}return y(f,null,[{key:"regClass",value:function(e,t){f._classMap[e]=t}},{key:"regShortClassName",value:function(e){for(var t=0;t<e.length;t++){var i=e[t],n=i.name;f._classMap[n]=i}}},{key:"getRegClass",value:function(e){return f._classMap[e]}},{key:"getClass",value:function(e){var t=f._classMap[e]||f._classMap["Laya."+e]||e,i=L.Laya;return"string"==typeof t?L.__classMap[t]||i[e]:t}},{key:"getInstance",value:function(e){var t=f.getClass(e);return t?new t:(console.warn("[error] Undefined class:",e),null)}},{key:"createByJson",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null,s=(e="string"==typeof e?JSON.parse(e):e).props;if(!t&&!(t=a?a.runWith(e):f.getInstance(s.runtime||e.type)))return null;var r=e.child;if(r)for(var o=0,h=r.length;o<h;o++){var l,u=r[o];"render"!==u.props.name&&"render"!==u.props.renderType||!t._$set_itemRender?"Graphic"==u.type?f._addGraphicsToSprite(u,t):f._isDrawType(u.type)?f._addGraphicToSprite(u,t,!0):(l=f.createByJson(u,null,i,n,a),"Script"===u.type?"owner"in l?l.owner=t:"target"in l&&(l.target=t):"mask"==u.props.renderType?t.mask=l:t.addChild(l)):t.itemRender=u}if(s)for(var c in s){var _=s[c];"var"===c&&i?i[_]=t:_ instanceof Array&&t[c]instanceof Function?t[c].apply(t,_):t[c]=_}return n&&e.customProps&&n.runWith([t,e]),t.created&&t.created(),t}},{key:"_addGraphicsToSprite",value:function(e,t){var i=e.child;if(i&&!(i.length<1)){var n,a,s=f._getGraphicsFromSprite(e,t),t=0,r=0;for(e.props&&(t=f._getObjVar(e.props,"x",0),r=f._getObjVar(e.props,"y",0)),0!=t&&0!=r&&s.translate(t,r),a=i.length,n=0;n<a;n++)f._addGraphicToGraphics(i[n],s);0!=t&&0!=r&&s.translate(-t,-r)}}},{key:"_addGraphicToSprite",value:function(e,t){t=2<arguments.length&&void 0!==arguments[2]&&arguments[2]?f._getGraphicsFromSprite(e,t):t.graphics;f._addGraphicToGraphics(e,t)}},{key:"_getGraphicsFromSprite",value:function(e,t){if(!e||!e.props)return t.graphics;var i,e=e.props.renderType;return"hit"!==e&&"unHit"!==e||((i=t._style.hitArea||(t.hitArea=new Qt))[e]||(i[e]=new Wt),i=i[e]),i=i||t.graphics}},{key:"_getTransformData",value:function(e){("pivotX"in e||"pivotY"in e)&&(t=t||new Ce).translate(-f._getObjVar(e,"pivotX",0),-f._getObjVar(e,"pivotY",0));var t,i=f._getObjVar(e,"scaleX",1),n=f._getObjVar(e,"scaleY",1),a=f._getObjVar(e,"rotation",0);f._getObjVar(e,"skewX",0),f._getObjVar(e,"skewY",0);return 1==i&&1==n&&0==a||((t=t||new Ce).scale(i,n),t.rotate(.0174532922222222*a)),t}},{key:"_addGraphicToGraphics",value:function(e,t){var i,n=e.props;!n||(e=f.DrawTypeDic[e.type])&&(t=t,n=f._getParams(n,e[1],e[2],e[3]),!(i=f._tM)&&1==f._alpha||(t.save(),i&&t.transform(i),1!=f._alpha&&t.alpha(f._alpha)),t[e[0]].apply(t,n),!i&&1==f._alpha||t.restore())}},{key:"_adptLineData",value:function(e){return e[2]=parseFloat(e[0])+parseFloat(e[2]),e[3]=parseFloat(e[1])+parseFloat(e[3]),e}},{key:"_adptTextureData",value:function(e){return e[0]=L.Loader.getRes(e[0]),e}},{key:"_adptLinesData",value:function(e){return e[2]=f._getPointListByStr(e[2]),e}},{key:"_isDrawType",value:function(e){return"Image"!==e&&e in f.DrawTypeDic}},{key:"_getParams",value:function(e,t){var i,n,a,s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,o=f._temParam;for(o.length=t.length,n=t.length,i=0;i<n;i++)o[i]=f._getObjVar(e,t[i][0],t[i][1]);return f._alpha=f._getObjVar(e,"alpha",1),(a=f._getTransformData(e))?(a.translate(o[s=s||0],o[s+1]),o[s]=o[s+1]=0,f._tM=a):f._tM=null,o=r&&f[r]?f[r](o):o}},{key:"_getPointListByStr",value:function(e){for(var t=e.split(","),i=t.length,n=0;n<i;n++)t[n]=parseFloat(t[n]);return t}},{key:"_getObjVar",value:function(e,t,i){return t in e?e[t]:i}}]),f}()),Zt=(M.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]},M._temParam=[],M._classMap={},function(){function e(){b(this,e)}return y(e,[{key:"reset",value:function(){return this.bounds&&this.bounds.recover(),this.userBounds&&this.userBounds.recover(),this.bounds=null,this.userBounds=null,this.temBM=null,this}},{key:"recover",value:function(){p.recover("BoundsStyle",this.reset())}}],[{key:"create",value:function(){return p.getItemByClass("BoundsStyle",e)}}]),e}()),Jt=function(){function r(){b(this,r),this.reset()}return y(r,[{key:"needBitmapCache",value:function(){return this.cacheForFilters||!!this.mask}},{key:"needEnableCanvasRender",value:function(){return"none"!=this.userSetCache||this.cacheForFilters||!!this.mask}},{key:"releaseContext",value:function(){if(this.canvas&&this.canvas.size){p.recover("CacheCanvas",this.canvas),this.canvas.size(0,0);try{this.canvas.width=0,this.canvas.height=0}catch(e){}}this.canvas=null}},{key:"createContext",value:function(){this.canvas||(this.canvas=p.getItem("CacheCanvas")||new Kt(!1),this.canvas.context||this.canvas.getContext("2d"))}},{key:"releaseFilterCache",value:function(){var e=this.filterCache;e&&(e.destroy(),e.recycle(),this.filterCache=null)}},{key:"recover",value:function(){this!==r.EMPTY&&p.recover("SpriteCache",this.reset())}},{key:"reset",value:function(){return this.releaseContext(),this.releaseFilterCache(),this.cacheAs="none",this.enableCanvasRender=!1,this.userSetCache="none",this.cacheForFilters=!1,this.staticCache=!1,this.reCache=!0,this.mask=null,this.maskParent=null,this.filterCache=null,this.filters=null,this.hasGlowFilter=!1,this.cacheRect&&this.cacheRect.recover(),this.cacheRect=null,this}},{key:"_calculateCacheRect",value:function(e,t,i,n){var a,s=e._cacheStyle;return s.cacheRect||(s.cacheRect=ne.create()),"bitmap"===t?((a=e.getSelfBounds()).width=a.width+2*r.CANVAS_EXTEND_EDGE,a.height=a.height+2*r.CANVAS_EXTEND_EDGE,a.x=a.x-e.pivotX,a.y=a.y-e.pivotY,a.x=a.x-r.CANVAS_EXTEND_EDGE,a.y=a.y-r.CANVAS_EXTEND_EDGE,a.x=Math.floor(a.x+i)-i,a.y=Math.floor(a.y+n)-n,a.width=Math.floor(a.width),a.height=Math.floor(a.height),s.cacheRect.copyFrom(a)):s.cacheRect.setTo(-e._style.pivotX,-e._style.pivotY,1,1),a=s.cacheRect,e._style.scrollRect&&(t=e._style.scrollRect,a.x-=t.x,a.y-=t.y),r._scaleInfo.setTo(1,1),r._scaleInfo}}],[{key:"create",value:function(){return p.getItemByClass("SpriteCache",r)}}]),r}(),$t=(Jt.EMPTY=new Jt,Jt._scaleInfo=new ie,Jt.CANVAS_EXTEND_EDGE=16,function(){function e(){b(this,e),this.reset()}return y(e,[{key:"reset",value:function(){return this.scaleX=this.scaleY=1,this.skewX=this.skewY=0,this.pivotX=this.pivotY=this.rotation=0,this.alpha=1,this.scrollRect&&this.scrollRect.recover(),this.scrollRect=null,this.viewport&&this.viewport.recover(),this.viewport=null,this.hitArea=null,this.dragging=null,this.blendMode=null,this}},{key:"recover",value:function(){this!==e.EMPTY&&p.recover("SpriteStyle",this.reset())}}],[{key:"create",value:function(){return p.getItemByClass("SpriteStyle",e)}}]),e}()),ei=($t.EMPTY=new $t,function(){f(r,ae);var t=T(r);function r(){var e;return b(this,r),(e=t.call(this))._bits=0,e._children=r.ARRAY_EMPTY,e._extUIChild=r.ARRAY_EMPTY,e._parent=null,e.name="",e.destroyed=!1,e.createGLBuffer(),e}return y(r,[{key:"createGLBuffer",value:function(){}},{key:"_setBit",value:function(e,t){e===Ht.DISPLAY&&this._getBit(e)!=t&&this._updateDisplayedInstage(),t?this._bits|=e:this._bits&=~e}},{key:"_getBit",value:function(e){return 0!=(this._bits&e)}},{key:"_setUpNoticeChain",value:function(){this._getBit(Ht.DISPLAY)&&this._setBitUp(Ht.DISPLAY)}},{key:"_setBitUp",value:function(e){var t=this;for(t._setBit(e,!0),t=t._parent;t;){if(t._getBit(e))return;t._setBit(e,!0),t=t._parent}}},{key:"on",value:function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return e!==Me.DISPLAY&&e!==Me.UNDISPLAY||this._getBit(Ht.DISPLAY)||this._setBitUp(Ht.DISPLAY),this._createListener(e,t,i,n,!1)}},{key:"once",value:function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return e!==Me.DISPLAY&&e!==Me.UNDISPLAY||this._getBit(Ht.DISPLAY)||this._setBitUp(Ht.DISPLAY),this._createListener(e,t,i,n,!0)}},{key:"destroy",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this.destroyed=!0,this._destroyAllComponent(),this._parent&&this._parent.removeChild(this),this._children&&(e?this.destroyChildren():this.removeChildren()),this.onDestroy(),this._children=null,this.offAll()}},{key:"onDestroy",value:function(){}},{key:"destroyChildren",value:function(){if(this._children)for(var e=0,t=this._children.length;e<t;e++)this._children[0].destroy(!0)}},{key:"addChild",value:function(e){return!e||this.destroyed||e===this||(e._zOrder&&this._setBit(Ht.HAS_ZORDER,!0),e._parent===this?(t=this.getChildIndex(e))!==this._children.length-1&&(this._children.splice(t,1),this._children.push(e),this._childChanged()):(e._parent&&e._parent.removeChild(e),this._children===r.ARRAY_EMPTY&&(this._children=[]),this._children.push(e),e._setParent(this),this._childChanged())),e;var t}},{key:"addInputChild",value:function(e){if(this._extUIChild==r.ARRAY_EMPTY)this._extUIChild=[e];else{if(0<=this._extUIChild.indexOf(e))return null;this._extUIChild.push(e)}return null}},{key:"removeInputChild",value:function(e){e=this._extUIChild.indexOf(e);0<=e&&this._extUIChild.splice(e,1)}},{key:"addChildren",value:function(){for(var e,t=0,i=arguments.length;t<i;)this.addChild((e=t++)<0||arguments.length<=e?void 0:arguments[e])}},{key:"addChildAt",value:function(e,t){if(!e||this.destroyed||e===this)return e;var i;if(e._zOrder&&this._setBit(Ht.HAS_ZORDER,!0),0<=t&&t<=this._children.length)return e._parent===this?(i=this.getChildIndex(e),this._children.splice(i,1),this._children.splice(t,0,e),this._childChanged()):(e._parent&&e._parent.removeChild(e),this._children===r.ARRAY_EMPTY&&(this._children=[]),this._children.splice(t,0,e),e._setParent(this)),e;throw new Error("appendChildAt:The index is out of bounds")}},{key:"getChildIndex",value:function(e){return this._children.indexOf(e)}},{key:"getChildByName",value:function(e){var t=this._children;if(t)for(var i=0,n=t.length;i<n;i++){var a=t[i];if(a.name===e)return a}return null}},{key:"getChildAt",value:function(e){return this._children[e]||null}},{key:"setChildIndex",value:function(e,t){var i=this._children;if(t<0||t>=i.length)throw new Error("setChildIndex:The index is out of bounds.");var n=this.getChildIndex(e);if(n<0)throw new Error("setChildIndex:node is must child of this object.");return i.splice(n,1),i.splice(t,0,e),this._childChanged(),e}},{key:"_childChanged",value:function(){}},{key:"removeChild",value:function(e){if(!this._children)return e;e=this._children.indexOf(e);return this.removeChildAt(e)}},{key:"removeSelf",value:function(){return this._parent&&this._parent.removeChild(this),this}},{key:"removeChildByName",value:function(e){e=this.getChildByName(e);return e&&this.removeChild(e),e}},{key:"removeChildAt",value:function(e){var t=this.getChildAt(e);return t&&(this._children.splice(e,1),t._setParent(null)),t}},{key:"removeChildren",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:2147483647;if(this._children&&0<this._children.length){var i,n=this._children;0===e&&t>=n.length-1?(i=n,this._children=r.ARRAY_EMPTY):i=n.splice(e,t-e);for(var a=0,s=i.length;a<s;a++)i[a]._setParent(null)}return this}},{key:"replaceChild",value:function(e,t){var i=this._children.indexOf(t);return-1<i?(this._children.splice(i,1,e),t._setParent(null),e._setParent(this),e):null}},{key:"numChildren",get:function(){return this._children.length}},{key:"parent",get:function(){return this._parent}},{key:"_setParent",value:function(e){this._parent!==e&&(e?(this._parent=e,this._onAdded(),this.event(Me.ADDED),this._getBit(Ht.DISPLAY)&&(this._setUpNoticeChain(),e.displayedInStage&&this._displayChild(this,!0)),e._childChanged(this)):(this._onRemoved(),this.event(Me.REMOVED),this._parent._childChanged(),this._getBit(Ht.DISPLAY)&&this._displayChild(this,!1),this._parent=e))}},{key:"displayedInStage",get:function(){return this._getBit(Ht.DISPLAY)||this._setBitUp(Ht.DISPLAY),this._getBit(Ht.DISPLAYED_INSTAGE)}},{key:"_updateDisplayedInstage",value:function(){for(var e=this,t=L.stage,i=!1;e;){if(e._getBit(Ht.DISPLAY)){i=e._getBit(Ht.DISPLAYED_INSTAGE);break}if(e===t||e._getBit(Ht.DISPLAYED_INSTAGE)){i=!0;break}e=e._parent}this._setBit(Ht.DISPLAYED_INSTAGE,i)}},{key:"_setDisplay",value:function(e){this._getBit(Ht.DISPLAYED_INSTAGE)!==e&&(this._setBit(Ht.DISPLAYED_INSTAGE,e),e?this.event(Me.DISPLAY):this.event(Me.UNDISPLAY))}},{key:"_displayChild",value:function(e,t){var i=e._children;if(i)for(var n=0,a=i.length;n<a;n++){var s=i[n];s._getBit(Ht.DISPLAY)&&(0<s._children.length?this._displayChild(s,t):s._setDisplay(t))}e._setDisplay(t)}},{key:"contains",value:function(e){if(e===this)return!0;for(;e;){if(e._parent===this)return!0;e=e._parent}return!1}},{key:"timerLoop",value:function(e,t,i){(this.scene||L).timer.loop(e,t,i,3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,!(4<arguments.length&&void 0!==arguments[4])||arguments[4],5<arguments.length&&void 0!==arguments[5]&&arguments[5])}},{key:"timerOnce",value:function(e,t,i){(this.scene||L).timer._create(!1,!1,e,t,i,3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,!(4<arguments.length&&void 0!==arguments[4])||arguments[4])}},{key:"frameLoop",value:function(e,t,i){(this.scene||L).timer._create(!0,!0,e,t,i,3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,!(4<arguments.length&&void 0!==arguments[4])||arguments[4])}},{key:"frameOnce",value:function(e,t,i){(this.scene||L).timer._create(!0,!1,e,t,i,3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,!(4<arguments.length&&void 0!==arguments[4])||arguments[4])}},{key:"clearTimer",value:function(e,t){(this.scene||L).timer.clear(e,t)}},{key:"callLater",value:function(e){(this.scene||L).timer.callLater(this,e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:null)}},{key:"runCallLater",value:function(e){(this.scene||L).timer.runCallLater(this,e)}},{key:"scene",get:function(){return this._scene}},{key:"active",get:function(){return!this._getBit(Ht.NOT_READY)&&!this._getBit(Ht.NOT_ACTIVE)},set:function(e){if(e=!!e,!this._getBit(Ht.NOT_ACTIVE)!==e){if(this._activeChangeScripts&&0!==this._activeChangeScripts.length)throw e?"Node: can't set the main inActive node active in hierarchy,if the operate is in main inActive node or it's children script's onDisable Event.":"Node: can't set the main active node inActive in hierarchy,if the operate is in main active node or it's children script's onEnable Event.";this._setBit(Ht.NOT_ACTIVE,!e),this._parent&&this._parent.activeInHierarchy&&(e?this._processActive():this._processInActive())}}},{key:"activeInHierarchy",get:function(){return this._getBit(Ht.ACTIVE_INHIERARCHY)}},{key:"_onActive",value:function(){k.spriteCount++}},{key:"_onInActive",value:function(){k.spriteCount--}},{key:"_onActiveInScene",value:function(){}},{key:"_onInActiveInScene",value:function(){}},{key:"_parse",value:function(e,t){}},{key:"_setBelongScene",value:function(e){if(!this._scene){this._scene=e,this._onActiveInScene();for(var t=0,i=this._children.length;t<i;t++)this._children[t]._setBelongScene(e)}}},{key:"_setUnBelongScene",value:function(){if(this._scene!==this){this._onInActiveInScene(),this._scene=null;for(var e=0,t=this._children.length;e<t;e++)this._children[e]._setUnBelongScene()}}},{key:"onAwake",value:function(){}},{key:"onEnable",value:function(){}},{key:"_processActive",value:function(){this._activeChangeScripts||(this._activeChangeScripts=[]),this._activeHierarchy(this._activeChangeScripts),this._activeScripts()}},{key:"_activeHierarchy",value:function(e){if(this._setBit(Ht.ACTIVE_INHIERARCHY,!0),this._components)for(var t=0,i=this._components.length;t<i;t++){var n=this._components[t];n._setActive(!0),n._isScript()&&n._enabled&&e.push(n)}for(this._onActive(),t=0,i=this._children.length;t<i;t++){var a=this._children[t];a._getBit(Ht.NOT_ACTIVE)||a._activeHierarchy(e)}this._getBit(Ht.AWAKED)||(this._setBit(Ht.AWAKED,!0),this.onAwake()),this.onEnable()}},{key:"_activeScripts",value:function(){for(var e=0,t=this._activeChangeScripts.length;e<t;e++)this._activeChangeScripts[e].onEnable();this._activeChangeScripts.length=0}},{key:"_processInActive",value:function(){this._activeChangeScripts||(this._activeChangeScripts=[]),this._inActiveHierarchy(this._activeChangeScripts),this._inActiveScripts()}},{key:"_inActiveHierarchy",value:function(e){if(this._onInActive(),this._components)for(var t=0,i=this._components.length;t<i;t++){var n=this._components[t];n._setActive(!1),n._isScript()&&n._enabled&&e.push(n)}for(this._setBit(Ht.ACTIVE_INHIERARCHY,!1),t=0,i=this._children.length;t<i;t++){var a=this._children[t];a&&!a._getBit(Ht.NOT_ACTIVE)&&a._inActiveHierarchy(e)}this.onDisable()}},{key:"_inActiveScripts",value:function(){for(var e=0,t=this._activeChangeScripts.length;e<t;e++)this._activeChangeScripts[e].onDisable();this._activeChangeScripts.length=0}},{key:"onDisable",value:function(){}},{key:"_onAdded",value:function(){if(this._activeChangeScripts&&0!==this._activeChangeScripts.length)throw"Node: can't set the main inActive node active in hierarchy,if the operate is in main inActive node or it's children script's onDisable Event.";var e=this._parent.scene;e&&this._setBelongScene(e),this._parent.activeInHierarchy&&this.active&&this._processActive()}},{key:"_onRemoved",value:function(){if(this._activeChangeScripts&&0!==this._activeChangeScripts.length)throw"Node: can't set the main active node inActive in hierarchy,if the operate is in main active node or it's children script's onEnable Event.";this._parent.activeInHierarchy&&this.active&&this._processInActive(),this._parent.scene&&this._setUnBelongScene()}},{key:"_addComponentInstance",value:function(e){this._components=this._components||[],this._components.push(e),e.owner=this,e._onAdded(),this.activeInHierarchy&&e._setActive(!0)}},{key:"_destroyComponent",value:function(e){if(this._components)for(var t=0,i=this._components.length;t<i;t++){var n=this._components[t];if(n===e){n._destroy(),this._components.splice(t,1);break}}}},{key:"_destroyAllComponent",value:function(){if(this._components){for(var e=0,t=this._components.length;e<t;e++)this._components[e]._destroy();this._components.length=0}}},{key:"_cloneTo",value:function(e,t,i){var n=e;if(this._components)for(var a=0,s=this._components.length;a<s;a++){var r=n.addComponent(this._components[a].constructor);this._components[a]._cloneTo(r)}}},{key:"addComponentIntance",value:function(e){if(e.owner)throw"Node:the component has belong to other node.";if(e.isSingleton&&this.getComponent(e.constructor))throw"Node:the component is singleton,can't add the second one.";return this._addComponentInstance(e),e}},{key:"addComponent",value:function(e){var t=p.createByClass(e);if(t._destroyed=!1,t.isSingleton&&this.getComponent(e))throw"无法实例"+e+"组件，"+e+"组件已存在！";return this._addComponentInstance(t),t}},{key:"getComponent",value:function(e){if(this._components)for(var t=0,i=this._components.length;t<i;t++){var n=this._components[t];if(n instanceof e)return n}return null}},{key:"getComponents",value:function(e){var t;if(this._components)for(var i=0,n=this._components.length;i<n;i++){var a=this._components[i];a instanceof e&&(t=t||[]).push(a)}return t}},{key:"timer",get:function(){return(this.scene||L).timer}}]),r}()),N=(ei.ARRAY_EMPTY=[],M.regClass("laya.display.Node",ei),M.regClass("Laya.Node",ei),function(){f(h,ei);var t=T(h);function h(){var e;return b(this,h),(e=t.call(this))._x=0,e._y=0,e._width=0,e._height=0,e._visible=!0,e._mouseState=0,e._zOrder=0,e._renderType=0,e._transform=null,e._tfChanged=!1,e._repaint=C.REPAINT_NONE,e._texture=null,e._style=$t.EMPTY,e._cacheStyle=Jt.EMPTY,e._boundStyle=null,e._graphics=null,e.mouseThrough=!1,e.autoSize=!1,e.hitTestPrior=!1,e}return y(h,[{key:"destroy",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];m(g(h.prototype),"destroy",this).call(this,e),this._style&&this._style.recover(),this._cacheStyle&&this._cacheStyle.recover(),this._boundStyle&&this._boundStyle.recover(),this._style=null,this._cacheStyle=null,this._boundStyle=null,this._transform=null,this._graphics&&this._graphics.autoDestroy&&this._graphics.destroy(),this._graphics=null,this.texture=null}},{key:"updateZOrder",value:function(){Se.updateOrder(this._children)&&this.repaint()}},{key:"_getBoundsStyle",value:function(){return this._boundStyle||(this._boundStyle=Zt.create()),this._boundStyle}},{key:"_setCustomRender",value:function(){}},{key:"customRenderEnable",set:function(e){e&&(this._renderType|=C.CUSTOM,this._setRenderType(this._renderType),this._setCustomRender())}},{key:"cacheAs",get:function(){return this._cacheStyle.cacheAs},set:function(e){e===this._cacheStyle.userSetCache||this.mask&&"normal"===e||(this._setCacheAs(e),this._getCacheStyle().userSetCache=e,this._checkCanvasEnable(),this.repaint())}},{key:"_setCacheAs",value:function(e){}},{key:"_checkCanvasEnable",value:function(){var e=this._cacheStyle.needEnableCanvasRender();(this._getCacheStyle().enableCanvasRender=e)?(this._cacheStyle.needBitmapCache()?this._cacheStyle.cacheAs="bitmap":this._cacheStyle.cacheAs=this._cacheStyle.userSetCache,this._cacheStyle.reCache=!0,this._renderType|=C.CANVAS):(this._cacheStyle.cacheAs="none",this._cacheStyle.releaseContext(),this._renderType&=~C.CANVAS),this._setCacheAs(this._cacheStyle.cacheAs),this._setRenderType(this._renderType)}},{key:"staticCache",get:function(){return this._cacheStyle.staticCache},set:function(e){(this._getCacheStyle().staticCache=e)||this.reCache()}},{key:"reCache",value:function(){this._cacheStyle.reCache=!0,this._repaint|=C.REPAINT_CACHE}},{key:"getRepaint",value:function(){return this._repaint}},{key:"_setX",value:function(e){this._x=e}},{key:"_setY",value:function(e){this._y=e}},{key:"_setWidth",value:function(e,t){}},{key:"_setHeight",value:function(e,t){}},{key:"x",get:function(){return this._x},set:function(e){this.destroyed||this._x!==e&&(this._setX(e),this.parentRepaint(C.REPAINT_CACHE),(e=this._cacheStyle.maskParent)&&e.repaint(C.REPAINT_CACHE))}},{key:"y",get:function(){return this._y},set:function(e){this.destroyed||this._y!==e&&(this._setY(e),this.parentRepaint(C.REPAINT_CACHE),(e=this._cacheStyle.maskParent)&&e.repaint(C.REPAINT_CACHE))}},{key:"width",get:function(){return this.get_width()},set:function(e){this.set_width(e)}},{key:"set_width",value:function(e){this._width!==e&&(this._width=e,this._setWidth(this.texture,e),this._setTranformChange())}},{key:"get_width",value:function(){return this.autoSize?this.texture?this.texture.width:this._graphics||0!==this._children.length?this.getSelfBounds().width:0:this._width||(this.texture?this.texture.width:0)}},{key:"height",get:function(){return this.get_height()},set:function(e){this.set_height(e)}},{key:"set_height",value:function(e){this._height!==e&&(this._height=e,this._setHeight(this.texture,e),this._setTranformChange())}},{key:"get_height",value:function(){return this.autoSize?this.texture?this.texture.height:this._graphics||0!==this._children.length?this.getSelfBounds().height:0:this._height||(this.texture?this.texture.height:0)}},{key:"displayWidth",get:function(){return this.width*this.scaleX}},{key:"displayHeight",get:function(){return this.height*this.scaleY}},{key:"setSelfBounds",value:function(e){this._getBoundsStyle().userBounds=e}},{key:"getBounds",value:function(){return this._getBoundsStyle().bounds=ne._getWrapRec(this._boundPointsToParent())}},{key:"getSelfBounds",value:function(){return this._boundStyle&&this._boundStyle.userBounds?this._boundStyle.userBounds:this._graphics||0!==this._children.length||this._texture?this._getBoundsStyle().bounds=ne._getWrapRec(this._getBoundPointsM(!1)):ne.TEMP.setTo(0,0,this.width,this.height)}},{key:"_boundPointsToParent",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=0,i=0,n=(this._style&&(t=this.pivotX,i=this.pivotY,e=e||0!==this._style.rotation,this._style.scrollRect&&(t+=this._style.scrollRect.x,i+=this._style.scrollRect.y)),this._getBoundPointsM(e));if(!n||n.length<1)return n;if(8!=n.length&&(n=e?Oe.scanPList(n):ne._getWrapRec(n,ne.TEMP)._getBoundPoints()),!this.transform)return Se.transPointList(n,this._x-t,this._y-i),n;for(var a=ie.TEMP,s=n.length,r=0;r<s;r+=2)a.x=n[r],a.y=n[r+1],this.toParentPoint(a),n[r]=a.x,n[r+1]=a.y;return n}},{key:"getGraphicBounds",value:function(){return this._graphics?this._graphics.getBounds(0<arguments.length&&void 0!==arguments[0]&&arguments[0]):ne.TEMP.setTo(0,0,0,0)}},{key:"_getBoundPointsM",value:function(){var e,t,i,n,a=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(this._boundStyle&&this._boundStyle.userBounds)return this._boundStyle.userBounds._getBoundPoints();if(this._boundStyle||this._getBoundsStyle(),this._boundStyle.temBM||(this._boundStyle.temBM=[]),this._style.scrollRect)return e=Se.clearArray(this._boundStyle.temBM),(t=ne.TEMP).copyFrom(this._style.scrollRect),Se.concatArray(e,t._getBoundPoints()),e;this._graphics?i=this._graphics.getBoundPoints():(i=Se.clearArray(this._boundStyle.temBM),this._texture&&((t=ne.TEMP).setTo(0,0,this.width||this._texture.width,this.height||this._texture.height),Se.concatArray(i,t._getBoundPoints())));for(var s,r=0,o=(s=this._children).length;r<o;r++)(n=s[r])instanceof h&&!0===n._visible&&(n=n._boundPointsToParent(a))&&(i=i?Se.concatArray(i,n):n);return i}},{key:"_getCacheStyle",value:function(){return this._cacheStyle===Jt.EMPTY&&(this._cacheStyle=Jt.create()),this._cacheStyle}},{key:"getStyle",value:function(){return this._style===$t.EMPTY&&(this._style=$t.create()),this._style}},{key:"setStyle",value:function(e){this._style=e}},{key:"scaleX",get:function(){return this._style.scaleX},set:function(e){this.set_scaleX(e)}},{key:"_setScaleX",value:function(e){this._style.scaleX=e}},{key:"scaleY",get:function(){return this._style.scaleY},set:function(e){this.set_scaleY(e)}},{key:"_setScaleY",value:function(e){this._style.scaleY=e}},{key:"set_scaleX",value:function(e){this.getStyle().scaleX!==e&&(this._setScaleX(e),this._setTranformChange())}},{key:"get_scaleX",value:function(){return this._style.scaleX}},{key:"set_scaleY",value:function(e){this.getStyle().scaleY!==e&&(this._setScaleY(e),this._setTranformChange())}},{key:"get_scaleY",value:function(){return this._style.scaleY}},{key:"rotation",get:function(){return this._style.rotation},set:function(e){this.getStyle().rotation!==e&&(this._setRotation(e),this._setTranformChange())}},{key:"_setRotation",value:function(e){this._style.rotation=e}},{key:"skewX",get:function(){return this._style.skewX},set:function(e){this.getStyle().skewX!==e&&(this._setSkewX(e),this._setTranformChange())}},{key:"_setSkewX",value:function(e){this._style.skewX=e}},{key:"skewY",get:function(){return this._style.skewY},set:function(e){this.getStyle().skewY!==e&&(this._setSkewY(e),this._setTranformChange())}},{key:"_setSkewY",value:function(e){this._style.skewY=e}},{key:"_createTransform",value:function(){return Ce.create()}},{key:"_adjustTransform",value:function(){this._tfChanged=!1;var e,t=this._style,i=t.scaleX,n=t.scaleY,a=t.skewX,s=t.skewY,t=t.rotation,r=this._transform||(this._transform=this._createTransform());return t||1!==i||1!==n||0!==a||0!==s?(r._bTransform=!0,a=.0174532922222222*(t-a),t=.0174532922222222*(t+s),s=Math.cos(t),t=Math.sin(t),e=Math.sin(a),a=Math.cos(a),r.a=i*s,r.b=i*t,r.c=-n*e,r.d=n*a,r.tx=r.ty=0):(r.identity(),this._renderType&=~C.TRANSFORM,this._setRenderType(this._renderType)),r}},{key:"_setTransform",value:function(e){}},{key:"transform",get:function(){return this._tfChanged?this._adjustTransform():this._transform},set:function(e){this.set_transform(e)}},{key:"get_transform",value:function(){return this._tfChanged?this._adjustTransform():this._transform}},{key:"set_transform",value:function(e){this._tfChanged=!1;var t=this._transform||(this._transform=this._createTransform());e.copyTo(t),this._setTransform(t),e&&(this._x=t.tx,this._y=t.ty,t.tx=t.ty=0),e?this._renderType|=C.TRANSFORM:this._renderType&=~C.TRANSFORM,this._setRenderType(this._renderType),this.parentRepaint()}},{key:"_setPivotX",value:function(e){this.getStyle().pivotX=e}},{key:"_getPivotX",value:function(){return this._style.pivotX}},{key:"_setPivotY",value:function(e){this.getStyle().pivotY=e}},{key:"_getPivotY",value:function(){return this._style.pivotY}},{key:"pivotX",get:function(){return this._getPivotX()},set:function(e){this._setPivotX(e),this.repaint()}},{key:"pivotY",get:function(){return this._getPivotY()},set:function(e){this._setPivotY(e),this.repaint()}},{key:"_setAlpha",value:function(e){this._style.alpha!==e&&(1!==(this.getStyle().alpha=e)?this._renderType|=C.ALPHA:this._renderType&=~C.ALPHA,this._setRenderType(this._renderType),this.parentRepaint())}},{key:"_getAlpha",value:function(){return this._style.alpha}},{key:"alpha",get:function(){return this._getAlpha()},set:function(e){this._setAlpha(e=e<0?0:1<e?1:e)}},{key:"visible",get:function(){return this.get_visible()},set:function(e){this.set_visible(e)}},{key:"get_visible",value:function(){return this._visible}},{key:"set_visible",value:function(e){this._visible!==e&&(this._visible=e,this.parentRepaint(C.REPAINT_ALL))}},{key:"_setBlendMode",value:function(e){}},{key:"blendMode",get:function(){return this._style.blendMode},set:function(e){this._setBlendMode(e),(this.getStyle().blendMode=e)&&"source-over"!=e?this._renderType|=C.BLEND:this._renderType&=~C.BLEND,this._setRenderType(this._renderType),this.parentRepaint()}},{key:"graphics",get:function(){return this._graphics||(this.graphics=new Wt,this._graphics.autoDestroy=!0),this._graphics},set:function(e){this._graphics&&(this._graphics._sp=null),(this._graphics=e)?(this._setGraphics(e),this._renderType|=C.GRAPHICS,e._sp=this):this._renderType&=~C.GRAPHICS,this._setRenderType(this._renderType),this.repaint()}},{key:"_setGraphics",value:function(e){}},{key:"_setGraphicsCallBack",value:function(){}},{key:"scrollRect",get:function(){return this._style.scrollRect},set:function(e){this.getStyle().scrollRect=e,this._setScrollRect(e),this.repaint(),e?this._renderType|=C.CLIP:this._renderType&=~C.CLIP,this._setRenderType(this._renderType)}},{key:"_setScrollRect",value:function(e){}},{key:"pos",value:function(e,t){var i;if(this._x!==e||this._y!==t){if(this.destroyed)return this;2<arguments.length&&void 0!==arguments[2]&&arguments[2]?(this._setX(e),this._setY(t),this.parentRepaint(C.REPAINT_CACHE),(i=this._cacheStyle.maskParent)&&i.repaint(C.REPAINT_CACHE)):(this.x=e,this.y=t)}return this}},{key:"pivot",value:function(e,t){return this.pivotX=e,this.pivotY=t,this}},{key:"size",value:function(e,t){return this.width=e,this.height=t,this}},{key:"scale",value:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]&&arguments[2],n=this.getStyle();if(n.scaleX!=e||n.scaleY!=t){if(this.destroyed)return this;i?(this._setScaleX(e),this._setScaleY(t),this._setTranformChange()):(this.scaleX=e,this.scaleY=t)}return this}},{key:"skew",value:function(e,t){return this.skewX=e,this.skewY=t,this}},{key:"render",value:function(e,t,i){qt.renders[this._renderType]._fun(this,e,t+this._x,i+this._y),this._repaint=0}},{key:"drawToCanvas",value:function(e,t,i,n){return h.drawToCanvas(this,this._renderType,e,t,i,n)}},{key:"drawToTexture",value:function(e,t,i,n){return h.drawToTexture(this,this._renderType,e,t,i,n,4<arguments.length&&void 0!==arguments[4]?arguments[4]:null)}},{key:"drawToTexture3D",value:function(e,t,i){throw"not implement"}},{key:"customRender",value:function(e,t,i){this._repaint=C.REPAINT_ALL}},{key:"_applyFilters",value:function(){}},{key:"filters",get:function(){return this._cacheStyle.filters},set:function(e){e&&0===e.length&&(e=null),this._cacheStyle.filters!=e&&(this._getCacheStyle().filters=e?e.slice():null,e&&e.length?(this._setColorFilter(e[0]),this._renderType|=C.FILTERS):(this._setColorFilter(null),this._renderType&=~C.FILTERS),this._setRenderType(this._renderType),e&&0<e.length?(this._getBit(Ht.DISPLAY)||this._setBitUp(Ht.DISPLAY),1==e.length&&e[0]instanceof Te||(this._getCacheStyle().cacheForFilters=!0,this._checkCanvasEnable())):this._cacheStyle.cacheForFilters&&(this._cacheStyle.cacheForFilters=!1,this._checkCanvasEnable()),this._getCacheStyle().hasGlowFilter=this._isHaveGlowFilter(),this.repaint())}},{key:"_setColorFilter",value:function(e){}},{key:"_isHaveGlowFilter",value:function(){var e,t;if(this.filters)for(e=0;e<this.filters.length;e++)if(this.filters[e].type==be.GLOW)return!0;for(e=0,t=this._children.length;e<t;e++)if(this._children[e]._isHaveGlowFilter())return!0;return!1}},{key:"localToGlobal",value:function(e){for(var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=(!0===t&&(e=new ie(e.x,e.y)),this),i=i||L.stage;n&&!n.destroyed&&n!=i;)e=n.toParentPoint(e),n=n.parent;return e}},{key:"globalToLocal",value:function(e){for(var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=(t&&(e=new ie(e.x,e.y)),this),a=[],i=i||L.stage;n&&!n.destroyed&&n!=i;)a.push(n),n=n.parent;for(var s=a.length-1;0<=s;)e=(n=a[s]).fromParentPoint(e),s--;return e}},{key:"toParentPoint",value:function(e){if(!e)return e;e.x-=this.pivotX,e.y-=this.pivotY,this.transform&&this._transform.transformPoint(e),e.x+=this._x,e.y+=this._y;var t=this._style.scrollRect;return t&&(e.x-=t.x,e.y-=t.y),e}},{key:"fromParentPoint",value:function(e){if(!e)return e;e.x-=this._x,e.y-=this._y;var t=this._style.scrollRect;return t&&(e.x+=t.x,e.y+=t.y),this.transform&&this._transform.invertTransformPoint(e),e.x+=this.pivotX,e.y+=this.pivotY,e}},{key:"fromStagePoint",value:function(e){return e}},{key:"on",value:function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return 1!==this._mouseState&&this.isMouseEvent(e)?(this.mouseEnabled=!0,this._setBit(Ht.HAS_MOUSE,!0),this._parent&&this._onDisplay(),this._createListener(e,t,i,n,!1)):m(g(h.prototype),"on",this).call(this,e,t,i,n)}},{key:"once",value:function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return 1!==this._mouseState&&this.isMouseEvent(e)?(this.mouseEnabled=!0,this._setBit(Ht.HAS_MOUSE,!0),this._parent&&this._onDisplay(),this._createListener(e,t,i,n,!0)):m(g(h.prototype),"once",this).call(this,e,t,i,n)}},{key:"_onDisplay",value:function(e){if(1!==this._mouseState)for(var t=(t=this).parent;t&&1!==t._mouseState&&!t._getBit(Ht.HAS_MOUSE);)t.mouseEnabled=!0,t._setBit(Ht.HAS_MOUSE,!0),t=t.parent}},{key:"_setParent",value:function(e){m(g(h.prototype),"_setParent",this).call(this,e),e&&this._getBit(Ht.HAS_MOUSE)&&this._onDisplay()}},{key:"loadImage",value:function(e){var t,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;function n(){this.repaint(C.REPAINT_ALL),i&&i.run()}return e?((t=L.Loader.textureMap[re.formatURL(e)])||((t=new vt).load(e),L.Loader.cacheTexture(e,t)),(this.texture=t).getIsReady()?n.call(this):t.once(Me.READY,this,n)):(this.texture=null,n.call(this)),this}},{key:"repaint",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:C.REPAINT_CACHE;this._repaint&e||(this._repaint|=e,this.parentRepaint(e)),this._cacheStyle&&this._cacheStyle.maskParent&&this._cacheStyle.maskParent.repaint(e)}},{key:"_needRepaint",value:function(){return this._repaint&C.REPAINT_CACHE&&this._cacheStyle.enableCanvasRender&&this._cacheStyle.reCache}},{key:"_childChanged",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;this._children.length?this._renderType|=C.CHILDS:this._renderType&=~C.CHILDS,this._setRenderType(this._renderType),e&&this._getBit(Ht.HAS_ZORDER)&&L.systemTimer.callLater(this,this.updateZOrder),this.repaint(C.REPAINT_ALL)}},{key:"parentRepaint",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:C.REPAINT_CACHE,t=this._parent;!t||t._repaint&e||(t._repaint|=e,t.parentRepaint(e))}},{key:"stage",get:function(){return L.stage}},{key:"hitArea",get:function(){return this._style.hitArea},set:function(e){this.getStyle().hitArea=e}},{key:"_setMask",value:function(e){}},{key:"mask",get:function(){return this._cacheStyle.mask},set:function(e){e&&this.mask&&this.mask._cacheStyle.maskParent||(this._getCacheStyle().mask=e,this._setMask(e),this._checkCanvasEnable(),e?e._getCacheStyle().maskParent=this:this.mask&&(this.mask._getCacheStyle().maskParent=null),this._renderType|=C.MASK,this._setRenderType(this._renderType),this.parentRepaint(C.REPAINT_ALL))}},{key:"mouseEnabled",get:function(){return 1<this._mouseState},set:function(e){this._mouseState=e?2:1}},{key:"startDrag",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:300,a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null,s=5<arguments.length&&void 0!==arguments[5]&&arguments[5],r=6<arguments.length&&void 0!==arguments[6]?arguments[6]:.92;this._style.dragging||(this.getStyle().dragging=new L.Dragging),this._style.dragging.start(this,e,t,i,n,a,s,r)}},{key:"stopDrag",value:function(){this._style.dragging&&this._style.dragging.stop()}},{key:"_setDisplay",value:function(e){e||this._cacheStyle&&(this._cacheStyle.releaseContext(),this._cacheStyle.releaseFilterCache(),this._cacheStyle.hasGlowFilter&&(this._cacheStyle.hasGlowFilter=!1)),m(g(h.prototype),"_setDisplay",this).call(this,e)}},{key:"hitTestPoint",value:function(e,t){var i=this.globalToLocal(ie.TEMP.setTo(e,t));return e=i.x,t=i.y,(this._style.hitArea||(0<this._width&&0<this._height?ne.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds())).contains(e,t)}},{key:"getMousePoint",value:function(){return this.globalToLocal(ie.TEMP.setTo(L.stage.mouseX,L.stage.mouseY))}},{key:"globalScaleX",get:function(){for(var e=1,t=this;t&&t!==L.stage;)e*=t.scaleX,t=t.parent;return e}},{key:"globalRotation",get:function(){for(var e=0,t=this;t&&t!==L.stage;)e+=t.rotation,t=t.parent;return e}},{key:"globalScaleY",get:function(){for(var e=1,t=this;t&&t!==L.stage;)e*=t.scaleY,t=t.parent;return e}},{key:"mouseX",get:function(){return this.getMousePoint().x}},{key:"mouseY",get:function(){return this.getMousePoint().y}},{key:"zOrder",get:function(){return this._zOrder},set:function(e){this._zOrder!=e&&(this._zOrder=e,this._parent&&(e&&this._parent._setBit(Ht.HAS_ZORDER,!0),L.systemTimer.callLater(this._parent,this.updateZOrder)))}},{key:"texture",get:function(){return this._texture},set:function(e){"string"==typeof e?this.loadImage(e):this._texture!=e&&(this._texture&&this._texture._removeReference(),(this._texture=e)&&e._addReference(),this._setTexture(e),this._setWidth(this._texture,this.width),this._setHeight(this._texture,this.height),e?this._renderType|=C.TEXTURE:this._renderType&=~C.TEXTURE,this._setRenderType(this._renderType),this.repaint())}},{key:"_setTexture",value:function(e){}},{key:"viewport",get:function(){return this._style.viewport},set:function(e){var t;"string"==typeof e&&3<(t=e.split(",")).length&&(e=new ne(parseFloat(t[0]),parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3]))),this.getStyle().viewport=e}},{key:"_setRenderType",value:function(e){}},{key:"_setTranformChange",value:function(){this._tfChanged=!0,this._renderType|=C.TRANSFORM,this.parentRepaint(C.REPAINT_CACHE)}},{key:"_setBgStyleColor",value:function(e,t,i,n,a){}},{key:"_setBorderStyleColor",value:function(e,t,i,n,a,s){}},{key:"captureMouseEvent",value:function(e){L.MouseManager.instance.setCapture(this,e)}},{key:"releaseMouseEvent",value:function(){L.MouseManager.instance.releaseCapture()}},{key:"drawCallOptimize",get:function(){return this._getBit(Ht.DRAWCALL_OPTIMIZE)},set:function(e){this._setBit(Ht.DRAWCALL_OPTIMIZE,e)}}],[{key:"drawToCanvas",value:function(e,t,i,n,a,s){a=a-e.x|0,s=s-e.y|0,i|=0,n|=0;for(var r=new Ct,o=(r.size(i,n),r.asBitmap=!0,r._targets.start(),r._targets.clear(0,0,0,0),qt.renders[t]._fun(e,r,a,s),r.flush(),r._targets.end(),r._targets.restore(),r._targets.getData(0,0,i,n)),t=(r.destroy(),new ImageData(i,n)),h=4*i,l=t.data,u=n-1,c=u*h,_=0;0<=u;u--)l.set(o.subarray(_,_+h),c),c-=h,_+=h;e=new Kt(!0);return e.size(i,n),e.getContext("2d").putImageData(t,0,0),e}},{key:"drawToTexture",value:function(e,t,i,n,a,s){var r=6<arguments.length&&void 0!==arguments[6]?arguments[6]:null,o=(h.drawtocanvCtx||(h.drawtocanvCtx=new Ct),a=a-e.x|0,s=s-e.y|0,i|=0,n|=0,r?h.drawtocanvCtx:new Ct);return o.clear(),o.size(i,n),r?o._targets=r:o.asBitmap=!0,o._targets.start(),o._targets.clear(0,0,0,0),qt.renders[t]._fun(e,o,a,s),o.flush(),o._targets.end(),o._targets.restore(),r||(i=new vt(o._targets,vt.INV_UV),o.destroy(!0),i)}},{key:"fromImage",value:function(e){return(new h).loadImage(e)}}]),h}()),ti=(M.regClass("laya.display.Sprite",N),M.regClass("Laya.Sprite",N),function(){f(i,$t);var t=T(i);function i(){var e;return b(this,i),(e=t.apply(this,arguments)).italic=!1,e}return y(i,[{key:"reset",value:function(){return m(g(i.prototype),"reset",this).call(this),this.italic=!1,this.align="left",this.wordWrap=!1,this.leading=0,this.padding=[0,0,0,0],this.bgColor=null,this.borderColor=null,this.asPassword=!1,this.stroke=0,this.strokeColor="#000000",this.bold=!1,this.underline=!1,this.underlineColor=null,this.currBitmapFont=null,this}},{key:"recover",value:function(){this!==i.EMPTY&&p.recover("TextStyle",this.reset())}},{key:"render",value:function(e,t,i,n){(this.bgColor||this.borderColor)&&t.drawRect(i,n,e.width,e.height,this.bgColor,this.borderColor,1)}}],[{key:"create",value:function(){return p.getItemByClass("TextStyle",i)}}]),i}()),ii=(ti.EMPTY=new ti,function(){f(S,N);var t=T(S);function S(){var e;return b(this,S),(e=t.call(this))._textWidth=0,e._textHeight=0,e._lines=[],e._lineWidths=[],e._startX=0,e._startY=0,e._charSize={},e._valign="top",e._fontSize=S.defaultFontSize,e._font=S.defaultFont,e._color="#000000",e._singleCharRender=!1,e.overflow=S.VISIBLE,e._style=ti.EMPTY,e}return y(S,[{key:"getStyle",value:function(){return this._style===ti.EMPTY&&(this._style=ti.create()),this._style}},{key:"_getTextStyle",value:function(){return this._style===ti.EMPTY&&(this._style=ti.create()),this._style}},{key:"destroy",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];m(g(S.prototype),"destroy",this).call(this,e),this._clipPoint=null,this._lines=null,this._lineWidths=null,this._words&&this._words.forEach(function(e){e.cleanCache()}),this._words=null,this._charSize=null}},{key:"_getBoundPointsM",value:function(){var e=ne.TEMP;return e.setTo(0,0,this.width,this.height),e._getBoundPoints()}},{key:"getGraphicBounds",value:function(){var e=ne.TEMP;return e.setTo(0,0,this.width,this.height),e}},{key:"width",get:function(){return this._width||this.textWidth+this.padding[1]+this.padding[3]},set:function(e){e!=this._width&&(m(g(S.prototype),"set_width",this).call(this,e),this.isChanged=!0,this.borderColor&&this._setBorderStyleColor(0,0,this.width,this.height,this.borderColor,1))}},{key:"_getCSSStyle",value:function(){return this._style}},{key:"height",get:function(){return this._height||this.textHeight},set:function(e){e!=this._height&&(m(g(S.prototype),"set_height",this).call(this,e),this.isChanged=!0,this.borderColor&&this._setBorderStyleColor(0,0,this.width,this.height,this.borderColor,1))}},{key:"textWidth",get:function(){return this._isChanged&&L.systemTimer.runCallLater(this,this.typeset),this._textWidth}},{key:"textHeight",get:function(){return this._isChanged&&L.systemTimer.runCallLater(this,this.typeset),this._textHeight}},{key:"text",get:function(){return this._text||""},set:function(e){this.set_text(e)}},{key:"get_text",value:function(){return this._text||""}},{key:"set_text",value:function(e){this._text!==e&&(this.lang(e+""),this.isChanged=!0,this.event(Me.CHANGE),this.borderColor&&this._setBorderStyleColor(0,0,this.width,this.height,this.borderColor,1))}},{key:"lang",value:function(e){if(e=S.langPacks&&S.langPacks[e]?S.langPacks[e]:e,arguments.length<2)this._text=e;else{for(var t=0,i=arguments.length;t<i;t++)e=e.replace("{"+t+"}",arguments[t+1]);this._text=e}}},{key:"font",get:function(){return this._font},set:function(e){this._style.currBitmapFont&&(this._getTextStyle().currBitmapFont=null,this.scale(1,1)),S._bitmapFonts&&S._bitmapFonts[e]&&(this._getTextStyle().currBitmapFont=S._bitmapFonts[e]),this._font=e,this.isChanged=!0}},{key:"fontSize",get:function(){return this._fontSize},set:function(e){this._fontSize!=e&&(this._fontSize=e,this.isChanged=!0)}},{key:"bold",get:function(){return this._style.bold},set:function(e){this._getTextStyle().bold=e,this.isChanged=!0}},{key:"color",get:function(){return this._color},set:function(e){this.set_color(e)}},{key:"get_color",value:function(){return this._color}},{key:"set_color",value:function(e){this._color!=e&&(this._color=e,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}},{key:"italic",get:function(){return this._style.italic},set:function(e){this._getTextStyle().italic=e,this.isChanged=!0}},{key:"align",get:function(){return this._style.align},set:function(e){this._getTextStyle().align=e,this.isChanged=!0}},{key:"valign",get:function(){return this._valign},set:function(e){this._valign=e,this.isChanged=!0}},{key:"wordWrap",get:function(){return this._style.wordWrap},set:function(e){this._getTextStyle().wordWrap=e,this.isChanged=!0}},{key:"leading",get:function(){return this._style.leading},set:function(e){this._getTextStyle().leading=e,this.isChanged=!0}},{key:"padding",get:function(){return this._style.padding},set:function(e){if("string"==typeof e){for(var t,i=e.split(","),n=i.length;i.length<4;)i.push(0);for(t=0;t<n;t++)i[t]=parseFloat(i[t])||0;e=i}this._getTextStyle().padding=e,this.isChanged=!0}},{key:"bgColor",get:function(){return this._style.bgColor},set:function(e){this.set_bgColor(e)}},{key:"set_bgColor",value:function(e){this._getTextStyle().bgColor=e,this._renderType|=C.STYLE,this._setBgStyleColor(0,0,this.width,this.height,e),this._setRenderType(this._renderType),this.isChanged=!0}},{key:"get_bgColor",value:function(){return this._style.bgColor}},{key:"borderColor",get:function(){return this._style.borderColor},set:function(e){this._getTextStyle().borderColor=e,this._renderType|=C.STYLE,this._setBorderStyleColor(0,0,this.width,this.height,e,1),this._setRenderType(this._renderType),this.isChanged=!0}},{key:"stroke",get:function(){return this._style.stroke},set:function(e){this._getTextStyle().stroke=e,this.isChanged=!0}},{key:"strokeColor",get:function(){return this._style.strokeColor},set:function(e){this._getTextStyle().strokeColor=e,this.isChanged=!0}},{key:"isChanged",set:function(e){this._isChanged!==e&&(this._isChanged=e)&&L.systemTimer.callLater(this,this.typeset)}},{key:"_getContextFont",value:function(){return(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(L.Browser.onIPhone&&S.fontFamilyMap[this.font]||this.font)}},{key:"_isPassWordMode",value:function(){var e=this._style.asPassword;return e="prompt"in this&&this.prompt==this._text?!1:e}},{key:"_getPassWordTxt",value:function(e){for(var t="",i=e.length;0<i;i--)t+="●";return t}},{key:"_renderText",value:function(){for(var e,t,i,n,a=this.padding,s=this._lines.length,r=(this.overflow!=S.VISIBLE&&(s=Math.min(s,Math.floor((this.height-a[0]-a[2])/(this.leading+this._charSize.height))+1)),this.scrollY/(this._charSize.height+this.leading)|0),o=this.graphics,h=(o.clear(!0),this._getContextFont()),l=(L.Browser.context.font=h,a[3]),u="left",c=this._lines,_=this.leading+this._charSize.height,f=this._style.currBitmapFont,d=(f&&(_=this.leading+f.getMaxHeight()),a[0]),p=(!f&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?(u="right",l=this._width-a[1]):"center"==this.align&&(u="center",l=.5*this._width+a[3]-a[1])),0<this._height&&("middle"===(n=this._textHeight>this._height?"top":this.valign)?d=.5*(this._height-s*_)+a[0]-a[2]:"bottom"===n&&(d=this._height-s*_-a[2])),this._style),y=(f&&f.autoScaleSize&&(e=f.fontSize/this.fontSize),this._clipPoint&&(o.save(),f&&f.autoScaleSize?(n=this._width?this._width-a[3]-a[1]:this._textWidth,t=this._height?this._height-a[0]-a[2]:this._textHeight,o.clipRect(a[3],a[0],n*=e,t*=e)):o.clipRect(a[3],a[0],this._width?this._width-a[3]-a[1]:this._textWidth,this._height?this._height-a[0]-a[2]:this._textHeight),this.repaint()),p.asPassword),g=("prompt"in this&&this.prompt==this._text&&(y=!1),Math.min(this._lines.length,s+r)||1),m=r;m<g;m++){var v,x,k=c[m];if(y)for(var w=k.length,k="",b=w;0<b;b--)k+="●";null==k&&(k=""),w=l-(this._clipPoint?this._clipPoint.x:0),i=d+_*m-(this._clipPoint?this._clipPoint.y:0),this.underline&&this._drawUnderline(u,w,i,m),f?(x=this.width,f.autoScaleSize&&(x=this.width*e),f._drawText(k,this,w,i,this.align,x)):(this._words||(this._words=[]),this._words.length>m-r?v=this._words[m-r]:(v=new kt,this._words.push(v)),v.setText(k),v.splitRender=this._singleCharRender,p.stroke?o.fillBorderText(v,w,i,h,this.color,p.strokeColor,p.stroke,u):o.fillText(v,w,i,h,this.color,u))}f&&f.autoScaleSize&&this.scale(n=1/e,n),this._clipPoint&&o.restore(),this._startX=l,this._startY=d}},{key:"_drawUnderline",value:function(e,t,i,n){var a=this._lineWidths[n];switch(e){case"center":t-=a/2;break;case"right":t-=a}i+=this._charSize.height,this._graphics.drawLine(t,i,t+a,i,this.underlineColor||this.color,1)}},{key:"typeset",value:function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);L.Render.isConchApp?window.conchTextCanvas.font=this._getContextFont():L.Browser.context.font=this._getContextFont(),this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this._parseLines(this._getPassWordTxt(this._text)):this._parseLines(this._text),this._evalTextSize(),this._checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new ie(0,0)):this._clipPoint=null,this._renderText()}},{key:"_evalTextSize",value:function(){var e=Math.max.apply(this,this._lineWidths),t=this._style.currBitmapFont?this._lines.length*(this._style.currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2];e==this._textWidth&&t==this._textHeight||(this._textWidth=e,this._textHeight=t)}},{key:"_checkEnabledViewportOrNot",value:function(){return this.overflow==S.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)}},{key:"changeText",value:function(e){this._text!==e&&(this.lang(e+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())}},{key:"_parseLines",value:function(e){for(var t,i=this.wordWrap||this.overflow==S.HIDDEN,n=(i&&(t=this._getWordWrapWidth()),this._style.currBitmapFont),a=(n?(this._charSize.width=n.getMaxWidth(),this._charSize.height=n.getMaxHeight()):(n=null,n=(L.Render.isConchApp?window.conchTextCanvas:L.Browser.context).measureText(S._testWord),this._charSize.width=(n=n||{width:100}).width,this._charSize.height=n.height||this.fontSize),e.replace(/\r\n/g,"\n").split("\n")),s=0,r=a.length;s<r;s++){var o=a[s];i?this._parseLine(o,t):(this._lineWidths.push(this._getTextWidth(o)),this._lines.push(o))}}},{key:"_parseLine",value:function(e,t){var i=this._lines,n=0,a=0,s=0,r=0;if((a=this._getTextWidth(e))<=t)return i.push(e),void this._lineWidths.push(a);a=this._charSize.width;for(var n=Math.floor(t/a),s=a=this._getTextWidth(e.substring(0,n=0==n?1:n)),o=n,h=e.length;o<h;o++)if(t<(s+=a=this._getTextWidth(e.charAt(o))))if(this.wordWrap){var l,u=e.substring(r,o);if(u.charCodeAt(u.length-1)<255&&((l=/(?:\w|-)+$/.exec(u))&&(o=l.index+r,0==l.index?o+=u.length:u=e.substring(r,o))),i.push(u),this._lineWidths.push(s-a),!((r=o)+n<h)){i.push(e.substring(r,h)),this._lineWidths.push(this._getTextWidth(i[i.length-1])),r=-1;break}o+=n,s=a=this._getTextWidth(e.substring(r,o)),o--}else if(this.overflow==S.HIDDEN)return i.push(e.substring(0,o)),void this._lineWidths.push(this._getTextWidth(i[i.length-1]));this.wordWrap&&-1!=r&&(i.push(e.substring(r,h)),this._lineWidths.push(this._getTextWidth(i[i.length-1])))}},{key:"_getTextWidth",value:function(e){var t=this._style.currBitmapFont;return t?t.getTextWidth(e):(L.Render.isConchApp?window.conchTextCanvas.measureText(e):L.Browser.context.measureText(e)||{width:100}).width}},{key:"_getWordWrapWidth",value:function(){var e=this.padding,t=this._style.currBitmapFont,t=t&&t.autoScaleSize?this._width*(t.fontSize/this.fontSize):this._width;return(t=(t=t<=0?this.wordWrap?100:L.Browser.width:t)<=0?100:t)-e[3]-e[1]}},{key:"getCharPoint",value:function(e){for(var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,i=(this._isChanged&&L.systemTimer.runCallLater(this,this.typeset),0),n=this._lines,a=0,s=0,r=n.length;s<r;s++){if(e<(i+=n[s].length)){var o=s;break}a=i}var h=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font,h=(L.Browser.context.font=h,this._getTextWidth(this._text.substring(a,e)));return(t||new ie).setTo(this._startX+h-(this._clipPoint?this._clipPoint.x:0),this._startY+o*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))}},{key:"scrollX",get:function(){return this._clipPoint?this._clipPoint.x:0},set:function(e){var t;this.overflow!=S.SCROLL||this.textWidth<this._width||!this._clipPoint||(e=e<this.padding[3]?this.padding[3]:e,t=this._textWidth-this._width,this._clipPoint.x=e=t<e?t:e,this._renderText())}},{key:"scrollY",get:function(){return this._clipPoint?this._clipPoint.y:0},set:function(e){var t;this.overflow!=S.SCROLL||this.textHeight<this._height||!this._clipPoint||(e=e<this.padding[0]?this.padding[0]:e,t=this._textHeight-this._height,this._clipPoint.y=e=t<e?t:e,this._renderText())}},{key:"maxScrollX",get:function(){return this.textWidth<this._width?0:this._textWidth-this._width}},{key:"maxScrollY",get:function(){return this.textHeight<this._height?0:this._textHeight-this._height}},{key:"lines",get:function(){return this._isChanged&&this.typeset(),this._lines}},{key:"underlineColor",get:function(){return this._style.underlineColor},set:function(e){this._getTextStyle().underlineColor=e,this._isChanged||this._renderText()}},{key:"underline",get:function(){return this._style.underline},set:function(e){this._getTextStyle().underline=e}},{key:"singleCharRender",get:function(){return this._singleCharRender},set:function(e){this._singleCharRender=e}}],[{key:"defaultFontStr",value:function(){return S.defaultFontSize+"px "+S.defaultFont}},{key:"registerBitmapFont",value:function(e,t){(S._bitmapFonts=S._bitmapFonts?S._bitmapFonts:{})[e]=t}},{key:"unregisterBitmapFont",value:function(e){var t;S._bitmapFonts&&S._bitmapFonts[e]&&(t=S._bitmapFonts[e],1<arguments.length&&void 0!==arguments[1]&&!arguments[1]||t.destroy(),delete S._bitmapFonts[e])}}]),S}()),ni=(ii.VISIBLE="visible",ii.SCROLL="scroll",ii.HIDDEN="hidden",ii.defaultFontSize=12,ii.defaultFont="Arial",ii.isComplexText=!1,ii.fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"},ii._testWord="游",ii.CharacterCache=!0,ii.RightToLeft=!1,L.regClass(ii),M.regClass("laya.display.Text",ii),M.regClass("Laya.Text",ii),function(){f(a,ii);var t=T(a);function a(){var e;return b(this,a),(e=t.call(this))._multiline=!1,e._editable=!0,e._maxChars=1e5,e._type="text",e._prompt="",e._promptColor="#A9A9A9",e._originColor="#000000",e._content="",a.IOS_IFRAME=L.Browser.onIOS&&L.Browser.window.top!=L.Browser.window.self,e._width=100,e._height=20,e.multiline=!1,e.overflow=ii.SCROLL,e.on(Me.MOUSE_DOWN,O(e),e._onMouseDown),e.on(Me.UNDISPLAY,O(e),e._onUnDisplay),e}return y(a,[{key:"setSelection",value:function(e,t){this.focus=!0,a.inputElement.selectionStart=e,a.inputElement.selectionEnd=t}},{key:"multiline",get:function(){return this._multiline},set:function(e){this._multiline=e,this.valign=e?"top":"middle"}},{key:"nativeInput",get:function(){return this._multiline?a.area:a.input}},{key:"_onUnDisplay",value:function(){this.focus=!1}},{key:"_onMouseDown",value:function(e){this.focus=!0}},{key:"_syncInputTransform",value:function(){var e=this.nativeInput,t=Se.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),i=this._width-this.padding[1]-this.padding[3],n=this._height-this.padding[0]-this.padding[2];L.Render.isConchApp?(e.setScale(t.scaleX,t.scaleY),e.setSize(i,n),e.setPos(t.x,t.y)):(a.inputContainer.style.transform=a.inputContainer.style.webkitTransform="scale("+t.scaleX+","+t.scaleY+") rotate("+L.stage.canvasDegree+"deg)",e.style.width=i+"px",e.style.height=n+"px",a.inputContainer.style.left=t.x+"px",a.inputContainer.style.top=t.y+"px")}},{key:"select",value:function(){this.nativeInput.select()}},{key:"focus",get:function(){return this._focus},set:function(e){var t=this.nativeInput;this._focus!==e&&(e?(t.target?t.target._focusOut():this._setInputMethod(),(t.target=this)._focusIn()):(t.target=null,this._focusOut(),L.Browser.document.body.scrollTop=0,t.blur(),L.Render.isConchApp?t.setPos(-1e4,-1e4):a.inputContainer.contains(t)&&a.inputContainer.removeChild(t)))}},{key:"_setInputMethod",value:function(){a.input.parentElement&&a.inputContainer.removeChild(a.input),a.area.parentElement&&a.inputContainer.removeChild(a.area),a.inputElement=this._multiline?a.area:a.input,a.inputContainer.appendChild(a.inputElement),ii.RightToLeft&&(a.inputElement.style.direction="rtl")}},{key:"_focusIn",value:function(){a.isInputting=!0;var e=this.nativeInput,t=(this._focus=!0,e.style);t.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),e.readOnly=!this._editable,L.Render.isConchApp&&(e.setType(this._type),e.setForbidEdit(!this._editable)),e.maxLength=this._maxChars,this.padding;e.value=this._content,e.placeholder=this._prompt,L.stage.off(Me.KEY_DOWN,this,this._onKeyDown),L.stage.on(Me.KEY_DOWN,this,this._onKeyDown),(L.stage.focus=this).event(Me.FOCUS),L.Browser.onPC&&e.focus(),L.Browser.onMiniGame||L.Browser.onBDMiniGame||L.Browser.onQGMiniGame||L.Browser.onKGMiniGame||L.Browser.onVVMiniGame||L.Browser.onAlipayMiniGame||L.Browser.onQQMiniGame||(this._text,this._text=null),this.typeset(),e.setColor(this._originColor),e.setFontSize(this.fontSize),e.setFontFace(L.Browser.onIPhone&&ii.fontFamilyMap[this.font]||this.font),L.Render.isConchApp&&e.setMultiAble&&e.setMultiAble(this._multiline),t.lineHeight=this.leading+this.fontSize+"px",t.fontStyle=this.italic?"italic":"normal",t.fontWeight=this.bold?"bold":"normal",t.textAlign=this.align,t.padding="0 0",this._syncInputTransform(),!L.Render.isConchApp&&L.Browser.onPC&&L.systemTimer.frameLoop(1,this,this._syncInputTransform)}},{key:"_setPromptColor",value:function(){(a.promptStyleDOM=L.Browser.getElementById("promptStyle"))||((a.promptStyleDOM=L.Browser.createElement("style")).setAttribute("id","promptStyle"),L.Browser.document.head.appendChild(a.promptStyleDOM)),a.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"}},{key:"_focusOut",value:function(){a.isInputting&&(a.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?(m(g(a.prototype),"set_text",this).call(this,this._content),m(g(a.prototype),"set_color",this).call(this,this._originColor)):(m(g(a.prototype),"set_text",this).call(this,this._prompt),m(g(a.prototype),"set_color",this).call(this,this._promptColor)),L.stage.off(Me.KEY_DOWN,this,this._onKeyDown),L.stage.focus=null,this.event(Me.BLUR),this.event(Me.CHANGE),L.Render.isConchApp&&this.nativeInput.blur(),L.Browser.onPC&&L.systemTimer.clear(this,this._syncInputTransform))}},{key:"_onKeyDown",value:function(e){13===e.keyCode&&(L.Browser.onMobile&&!this._multiline&&(this.focus=!1),this.event(Me.ENTER))}},{key:"text",get:function(){return this._focus?this.nativeInput.value:this._content||""},set:function(e){m(g(a.prototype),"set_color",this).call(this,this._originColor),e+="",this._focus?(this.nativeInput.value=e||"",this.event(Me.CHANGE)):(this._multiline||(e=e.replace(/\r?\n/g,"")),(this._content=e)?m(g(a.prototype),"set_text",this).call(this,e):(m(g(a.prototype),"set_text",this).call(this,this._prompt),m(g(a.prototype),"set_color",this).call(this,this.promptColor)))}},{key:"changeText",value:function(e){this._content=e,this._focus?(this.nativeInput.value=e||"",this.event(Me.CHANGE)):m(g(a.prototype),"changeText",this).call(this,e)}},{key:"color",get:function(){return m(g(a.prototype),"color",this)},set:function(e){this._focus&&this.nativeInput.setColor(e),m(g(a.prototype),"set_color",this).call(this,this._content?e:this._promptColor),this._originColor=e}},{key:"bgColor",get:function(){return m(g(a.prototype),"bgColor",this)},set:function(e){m(g(a.prototype),"set_bgColor",this).call(this,e),L.Render.isConchApp&&this.nativeInput.setBgColor(e)}},{key:"restrict",get:function(){return this._restrictPattern?this._restrictPattern.source:""},set:function(e){e?(-1<(e="[^"+e+"]").indexOf("^^")&&(e=e.replace("^^","")),this._restrictPattern=new RegExp(e,"g")):this._restrictPattern=null}},{key:"editable",get:function(){return this._editable},set:function(e){this._editable=e,L.Render.isConchApp&&a.input.setForbidEdit(!e)}},{key:"maxChars",get:function(){return this._maxChars},set:function(e){this._maxChars=e=e<=0?1e5:e}},{key:"prompt",get:function(){return this._prompt},set:function(e){!this._text&&e&&m(g(a.prototype),"set_color",this).call(this,this._promptColor),this.promptColor=this._promptColor,this._text?m(g(a.prototype),"set_text",this).call(this,this._text==this._prompt?e:this._text):m(g(a.prototype),"set_text",this).call(this,e),this._prompt=ii.langPacks&&ii.langPacks[e]?ii.langPacks[e]:e}},{key:"promptColor",get:function(){return this._promptColor},set:function(e){this._promptColor=e,this._content||m(g(a.prototype),"set_color",this).call(this,e)}},{key:"type",get:function(){return this._type},set:function(e){this._getTextStyle().asPassword="password"===e,this._type=e}}],[{key:"__init__",value:function(){var e;a._createInputElement(),L.Browser.onMobile&&(e=!1,(L.Browser.onMiniGame||L.Browser.onBDMiniGame||L.Browser.onQGMiniGame||L.Browser.onKGMiniGame||L.Browser.onVVMiniGame||L.Browser.onAlipayMiniGame||L.Browser.onQQMiniGame)&&(e=!0),L.Render.canvas.addEventListener(!a.IOS_IFRAME||e?"touchend":"click",a._popupInputMethod))}},{key:"_popupInputMethod",value:function(e){a.isInputting&&a.inputElement.focus()}},{key:"_createInputElement",value:function(){a._initInput(a.area=L.Browser.createElement("textarea")),a._initInput(a.input=L.Browser.createElement("input")),(a.inputContainer=L.Browser.createElement("div")).style.position="absolute",a.inputContainer.style.zIndex=1e5,L.Browser.container.appendChild(a.inputContainer),a.inputContainer.setPos=function(e,t){a.inputContainer.style.left=e+"px",a.inputContainer.style.top=t+"px"}}},{key:"_initInput",value:function(t){var e=t.style;e.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",e.resize="none",e.backgroundColor="transparent",e.border="none",e.outline="none",e.zIndex=1,t.addEventListener("input",a._processInputting),t.addEventListener("mousemove",a._stopEvent),t.addEventListener("mousedown",a._stopEvent),t.addEventListener("touchmove",a._stopEvent),t.setFontFace=function(e){t.style.fontFamily=e},L.Render.isConchApp||(t.setColor=function(e){t.style.color=e},t.setFontSize=function(e){t.style.fontSize=e+"px"})}},{key:"_processInputting",value:function(e){var t,i=a.inputElement.target;i&&(t=a.inputElement.value,i._restrictPattern&&(t=t.replace(/\u2006|\x27/g,""),i._restrictPattern.test(t)&&(t=t.replace(i._restrictPattern,""),a.inputElement.value=t)),i._text=t,i.event(Me.INPUT))}},{key:"_stopEvent",value:function(e){"touchmove"==e.type&&e.preventDefault(),e.stopPropagation&&e.stopPropagation()}}]),a}()),ai=(ni.TYPE_TEXT="text",ni.TYPE_PASSWORD="password",ni.TYPE_EMAIL="email",ni.TYPE_URL="url",ni.TYPE_NUMBER="number",ni.TYPE_RANGE="range",ni.TYPE_DATE="date",ni.TYPE_MONTH="month",ni.TYPE_WEEK="week",ni.TYPE_TIME="time",ni.TYPE_DATE_TIME="datetime",ni.TYPE_DATE_TIME_LOCAL="datetime-local",ni.TYPE_SEARCH="search",ni.IOS_IFRAME=!1,ni.inputHeight=45,ni.isInputting=!1,M.regClass("laya.display.Input",ni),M.regClass("Laya.Input",ni),function(){function d(){b(this,d),this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._event=new Me,this._lastClickTime=0}return y(d,[{key:"_clearTempArrs",value:function(){d._oldArr.length=0,d._newArr.length=0,d._tEleArr.length=0}},{key:"getTouchFromArr",value:function(e,t){for(var i,n=t.length,a=0;a<n;a++)if((i=t[a]).id==e)return i;return null}},{key:"removeTouchFromArr",value:function(e,t){for(var i=t.length-1;0<=i;i--)t[i].id==e&&t.splice(i,1)}},{key:"createTouchO",value:function(e,t){var i=p.getItem("TouchData")||{};return i.id=t,i.tar=e,i}},{key:"onMouseDown",value:function(e,t){var i,n,a,s,r=2<arguments.length&&void 0!==arguments[2]&&arguments[2];this.enable&&(a=this.getTouchFromArr(t,this.preOvers),s=this.getEles(e,null,d._tEleArr),a?a.tar=e:(i=this.createTouchO(e,t),this.preOvers.push(i)),I.onMobile&&this.sendEvents(s,Me.MOUSE_OVER),n=r?this.preDowns:this.preRightDowns,(a=this.getTouchFromArr(t,n))?a.tar=e:(i=this.createTouchO(e,t),n.push(i)),this.sendEvents(s,r?Me.MOUSE_DOWN:Me.RIGHT_MOUSE_DOWN),this._clearTempArrs())}},{key:"sendEvents",value:function(e,t){var i,n,a=e.length;for(this._event._stoped=!1,n=e[0],i=0;i<a;i++){var s=e[i];if(s.destroyed)return;if(s.event(t,this._event.setTo(t,s,n)),this._event._stoped)break}}},{key:"getEles",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;for(i?i.length=0:i=[];e&&e!=t;)i.push(e),e=e.parent;return i}},{key:"checkMouseOutAndOverOfMove",value:function(e,t){var i,n,a,s,r,o,h;if(t!=e)if(t.contains(e))h=this.getEles(e,t,d._tEleArr),this.sendEvents(h,Me.MOUSE_OVER);else if(e.contains(t))h=this.getEles(t,e,d._tEleArr),this.sendEvents(h,Me.MOUSE_OUT);else{for((h=d._tEleArr).length=0,s=this.getEles(t,null,d._oldArr),r=this.getEles(e,null,d._newArr),a=s.length,n=0;n<a;n++){if(i=s[n],0<=(o=r.indexOf(i))){r.splice(o,r.length-o);break}h.push(i)}0<h.length&&this.sendEvents(h,Me.MOUSE_OUT),0<r.length&&this.sendEvents(r,Me.MOUSE_OVER)}}},{key:"onMouseMove",value:function(e,t){var i,n;this.enable&&((n=this.getTouchFromArr(t,this.preOvers))?(this.checkMouseOutAndOverOfMove(e,n.tar),n.tar=e,i=this.getEles(e,null,d._tEleArr)):(i=this.getEles(e,null,d._tEleArr),this.sendEvents(i,Me.MOUSE_OVER),this.preOvers.push(this.createTouchO(e,t))),this.sendEvents(i,Me.MOUSE_MOVE),this._clearTempArrs())}},{key:"getLastOvers",value:function(){return(d._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,d._tEleArr):(d._tEleArr.push(L.stage),d._tEleArr)}},{key:"stageMouseOut",value:function(){var e=this.getLastOvers();this.preOvers.length=0,this.sendEvents(e,Me.MOUSE_OUT)}},{key:"onMouseUp",value:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]&&arguments[2];if(this.enable){var n,a,s,r,o,h,l,u=I.onMobile,c=this.getEles(e,null,d._tEleArr);if(this.sendEvents(c,i?Me.MOUSE_UP:Me.RIGHT_MOUSE_UP),l=i?this.preDowns:this.preRightDowns,n=this.getTouchFromArr(t,l)){var _=I.now(),f=_-this._lastClickTime<300;if(this._lastClickTime=_,e==n.tar)h=c;else for(a=this.getEles(n.tar,null,d._oldArr),(h=d._newArr).length=0,r=a.length,s=0;s<r;s++)o=a[s],0<=c.indexOf(o)&&h.push(o);0<h.length&&this.sendEvents(h,i?Me.CLICK:Me.RIGHT_CLICK),i&&f&&this.sendEvents(h,Me.DOUBLE_CLICK),this.removeTouchFromArr(t,l),n.tar=null,p.recover("TouchData",n)}(n=this.getTouchFromArr(t,this.preOvers))&&u&&((h=this.getEles(n.tar,null,h))&&0<h.length&&this.sendEvents(h,Me.MOUSE_OUT),this.removeTouchFromArr(t,this.preOvers),n.tar=null,p.recover("TouchData",n)),this._clearTempArrs()}}}]),d}()),si=(ai.I=new ai,ai._oldArr=[],ai._newArr=[],ai._tEleArr=[],function(){function o(){b(this,o),this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseMoveAccuracy=2,this._event=new Me,this._captureSp=null,this._captureChain=[],this._captureExlusiveMode=!1,this._hitCaputreSp=!1,this._point=new ie,this._rect=new ne,this._lastMoveTimer=0,this._prePoint=new ie,this._touchIDs={},this._curTouchID=NaN,this._id=1}return y(o,[{key:"__init__",value:function(e,t){this._stage=e;var i=this;t.oncontextmenu=function(e){if(o.enabled)return!1},t.addEventListener("mousedown",function(e){o.enabled&&(I.onIE||e.cancelable&&e.preventDefault(),i.mouseDownTime=I.now(),i.runEvent(e))}),t.addEventListener("mouseup",function(e){o.enabled&&(e.cancelable&&e.preventDefault(),i.mouseDownTime=-I.now(),i.runEvent(e))},!0),t.addEventListener("mousemove",function(e){var t;o.enabled&&(e.cancelable&&e.preventDefault(),(t=I.now())-i._lastMoveTimer<10||(i._lastMoveTimer=t,i.runEvent(e)))},!0),t.addEventListener("mouseout",function(e){o.enabled&&i.runEvent(e)}),t.addEventListener("mouseover",function(e){o.enabled&&i.runEvent(e)}),t.addEventListener("touchstart",function(e){o.enabled&&(o._isFirstTouch||ni.isInputting||e.cancelable&&e.preventDefault(),i.mouseDownTime=I.now(),i.runEvent(e))}),t.addEventListener("touchend",function(e){o.enabled?(o._isFirstTouch||ni.isInputting||e.cancelable&&e.preventDefault(),o._isFirstTouch=!1,i.mouseDownTime=-I.now(),i.runEvent(e)):i._curTouchID=NaN},!0),t.addEventListener("touchmove",function(e){o.enabled&&(e.cancelable&&e.preventDefault(),i.runEvent(e))},!0),t.addEventListener("touchcancel",function(e){o.enabled?(e.cancelable&&e.preventDefault(),i.runEvent(e)):i._curTouchID=NaN},!0),t.addEventListener("mousewheel",function(e){o.enabled&&i.runEvent(e)}),t.addEventListener("DOMMouseScroll",function(e){o.enabled&&i.runEvent(e)})}},{key:"initEvent",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;this._event._stoped=!1,this._event.nativeEvent=t||e,this._target=null,this._point.setTo(e.pageX||e.clientX,e.pageY||e.clientY),this._stage._canvasTransform&&(this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y),this._event.touchId=e.identifier||0,this._tTouchID=this._event.touchId,(t=ai.I._event)._stoped=!1,t.nativeEvent=this._event.nativeEvent,t.touchId=this._event.touchId}},{key:"checkMouseWheel",value:function(e){this._event.delta=e.wheelDelta?.025*e.wheelDelta:-e.detail;for(var t=ai.I.getLastOvers(),i=0,n=t.length;i<n;i++){var a=t[i];a.event(Me.MOUSE_WHEEL,this._event.setTo(Me.MOUSE_WHEEL,a,this._target))}}},{key:"onMouseMove",value:function(e){ai.I.onMouseMove(e,this._tTouchID)}},{key:"onMouseDown",value:function(e){var t,i;ni.isInputting&&L.stage.focus&&L.stage.focus.focus&&!L.stage.focus.contains(this._target)&&(t=L.stage.focus._tf||L.stage.focus,(i=e._tf||e)instanceof ni&&i.multiline==t.multiline?t._focusOut():t.focus=!1),ai.I.onMouseDown(e,this._tTouchID,this._isLeftMouse)}},{key:"onMouseUp",value:function(e){ai.I.onMouseUp(e,this._tTouchID,this._isLeftMouse)}},{key:"check",value:function(e,t,i,n){this._point.setTo(t,i),e.fromParentPoint(this._point),t=this._point.x,i=this._point.y;var a=e._style.scrollRect;if(a&&(this._rect.setTo(a.x,a.y,a.width,a.height),!this._rect.contains(t,i)))return!1;if(!this.disableMouseEvent){if(e.hitTestPrior&&!e.mouseThrough&&!this.hitTest(e,t,i))return!1;for(var s=e._children.length-1;-1<s;s--){var r=e._children[s];if(!r.destroyed&&1<r._mouseState&&r._visible&&this.check(r,t,i,n))return!0}for(s=e._extUIChild.length-1;0<=s;s--){var o=e._extUIChild[s];if(!o.destroyed&&1<o._mouseState&&o._visible&&this.check(o,t,i,n))return!0}}a=!(!e.hitTestPrior||e.mouseThrough||this.disableMouseEvent)||this.hitTest(e,t,i);return a?(this._target=e,n.call(this,e),this._target==this._hitCaputreSp&&(this._hitCaputreSp=!0)):n===this.onMouseUp&&e===this._stage&&(this._target=this._stage,n.call(this,this._target)),a}},{key:"hitTest",value:function(e,t,i){var n=!1,a=(e.scrollRect&&(t-=e._style.scrollRect.x,i-=e._style.scrollRect.y),e._style.hitArea);return a&&a._hit?a.contains(t,i):0<e.width&&0<e.height||e.mouseThrough||a?(e.mouseThrough?e.getGraphicBounds():a||this._rect.setTo(0,0,e.width,e.height)).contains(t,i):n}},{key:"_checkAllBaseUI",value:function(e,t,i){var n;return!!this.handleExclusiveCapture(this.mouseX,this.mouseY,i)||(n=this.check(this._stage,this.mouseX,this.mouseY,i),this.handleCapture(this.mouseX,this.mouseY,i)||n)}},{key:"check3DUI",value:function(e,t,i){for(var n=this._stage._3dUI,a=0,s=!1;a<n.length;a++){var r=n[a];!(this._stage._curUIBase=r).destroyed&&1<r._mouseState&&r._visible&&(s=s||this.check(r,this.mouseX,this.mouseY,i))}return this._stage._curUIBase=this._stage,s}},{key:"handleExclusiveCapture",value:function(e,t,i){if(this._captureExlusiveMode&&this._captureSp&&0<this._captureChain.length){var n;this._point.setTo(e,t);for(var a=0;a<this._captureChain.length;a++)(n=this._captureChain[a]).fromParentPoint(this._point);return this._target=n,i.call(this,n),!0}return!1}},{key:"handleCapture",value:function(e,t,i){if(!this._hitCaputreSp&&this._captureSp&&0<this._captureChain.length){var n;this._point.setTo(e,t);for(var a=0;a<this._captureChain.length;a++)(n=this._captureChain[a]).fromParentPoint(this._point);return this._target=n,i.call(this,n),!0}return!1}},{key:"runEvent",value:function(e){switch("mousemove"!==e.type&&(this._prePoint.x=this._prePoint.y=-1e6),e.type){case"mousedown":this._touchIDs[0]=this._id++,o._isTouchRespond?o._isTouchRespond=!1:(this._isLeftMouse=0===e.button,this.initEvent(e),this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseDown));break;case"mouseup":this._isLeftMouse=0===e.button,this.initEvent(e),this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-e.clientX)+Math.abs(this._prePoint.y-e.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=e.clientX,this._prePoint.y=e.clientY,this.initEvent(e),this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseMove));break;case"touchstart":o._isTouchRespond=!0,this._isLeftMouse=!0;for(var t=e.changedTouches,i=0,n=t.length;i<n;i++)s=t[i],(o.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=s.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[s.identifier]=this._id++,this.initEvent(s,e),this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseDown));break;case"touchend":case"touchcancel":o._isTouchRespond=!0,this._isLeftMouse=!0;var a=e.changedTouches;for(i=0,n=a.length;i<n;i++){var s=a[i];!o.multiTouchEnabled&&s.identifier!=this._curTouchID||(this._curTouchID=NaN,this.initEvent(s,e),this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseUp)||this.onMouseUp(null))}break;case"touchmove":var r=e.changedTouches;for(i=0,n=r.length;i<n;i++)s=r[i],!o.multiTouchEnabled&&s.identifier!=this._curTouchID||(this.initEvent(s,e),this._checkAllBaseUI(this.mouseX,this.mouseY,this.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":this.checkMouseWheel(e);break;case"mouseout":ai.I.stageMouseOut();break;case"mouseover":this._stage.event(Me.MOUSE_OVER,this._event.setTo(Me.MOUSE_OVER,this._stage,this._stage))}}},{key:"setCapture",value:function(e){for(var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=(this._captureSp=e,this._captureExlusiveMode=t,this._captureChain.length=0,this._captureChain.push(e),e);i!=L.stage&&i!=L.stage._curUIBase&&(i=i.parent);)this._captureChain.splice(0,0,i)}},{key:"releaseCapture",value:function(){console.log("release capture"),this._captureSp=null}}]),o}()),ri=(si.instance=new si,si.enabled=!0,si.multiTouchEnabled=!0,si._isFirstTouch=!0,function(){function e(){b(this,e),this._pool=[],this._map={},this._laters=[]}return y(e,[{key:"_update",value:function(){var e=this._laters,t=e.length;if(0<t){for(var i=0,n=t-1;i<=n;i++){var a=e[i];(this._map[a.key]=null)!==a.method&&(a.run(),a.clear()),this._pool.push(a),i===n&&(n=e.length-1)}e.length=0}}},{key:"_getHandler",value:function(e,t){e=e?e.$_GID||(e.$_GID=L.Utils.getGID()):0,t=t.$_TID||(t.$_TID=L.Timer._mid++);return this._map[e+"."+t]}},{key:"callLater",value:function(e,t){var i,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;null==this._getHandler(e,t)&&((i=this._pool.length?this._pool.pop():new oi).caller=e,i.method=t,i.args=n,n=e?e.$_GID:0,e=t.$_TID,i.key=n+"."+e,this._map[i.key]=i,this._laters.push(i))}},{key:"runCallLater",value:function(e,t){e=this._getHandler(e,t);e&&null!=e.method&&(this._map[e.key]=null,e.run(),e.clear())}}]),e}()),oi=(ri.I=new ri,function(){function e(){b(this,e)}return y(e,[{key:"clear",value:function(){this.caller=null,this.method=null,this.args=null}},{key:"run",value:function(){var e=this.caller;if(e&&e.destroyed)return this.clear();var t=this.method,i=this.args;null!=t&&(i?t.apply(e,i):t.call(e))}}]),e}()),hi=y(function e(){b(this,e)}),li=(hi.createShaderCondition=function(e){return window.Laya._runScript("(function() {return "+e+";})")},hi.changeWebGLSize=function(e,t){Et.onStageResize(e,t)},function(){f(d,N);var s=T(d);function d(){b(this,d),(t=s.call(this)).offset=new ie,t._frameRate="fast",t.designWidth=0,t.designHeight=0,t.canvasRotation=!1,t.canvasDegree=0,t.renderingEnabled=!0,t.screenAdaptationEnabled=!0,t._canvasTransform=new Ce,t._screenMode="none",t._scaleMode="noscale",t._alignV="top",t._alignH="left",t._bgColor="black",t._mouseMoveTime=0,t._renderCount=0,t._safariOffsetY=0,t._frameStartTime=0,t._previousOrientation=I.window.orientation,t._wgColor=[0,0,0,1],t._scene3Ds=[],t._globalRepaintSet=!1,t._globalRepaintGet=!1,t._3dUI=[],t._curUIBase=null,t.useRetinalCanvas=!1,m((e=O(t),g(d.prototype)),"set_transform",e).call(e,t._createTransform()),t.mouseEnabled=!0,t.hitTestPrior=!0,t.autoSize=!1,t._setBit(Ht.DISPLAYED_INSTAGE,!0),t._setBit(Ht.ACTIVE_INHIERARCHY,!0),t._isFocused=!0,t._isVisibility=!0,t.useRetinalCanvas=Fe.useRetinalCanvas;var t,e=I.window,i=(e.addEventListener("focus",function(){t._isFocused=!0,t.event(Me.FOCUS),t.event(Me.FOCUS_CHANGE)}),e.addEventListener("blur",function(){t._isFocused=!1,t.event(Me.BLUR),t.event(Me.FOCUS_CHANGE),t._isInputting()&&(ni.inputElement.target.focus=!1)}),"visibilityState"),n="visibilitychange",a=e.document;return void 0!==a.hidden?(n="visibilitychange",i="visibilityState"):void 0!==a.mozHidden?(n="mozvisibilitychange",i="mozVisibilityState"):void 0!==a.msHidden?(n="msvisibilitychange",i="msVisibilityState"):void 0!==a.webkitHidden&&(n="webkitvisibilitychange",i="webkitVisibilityState"),e.document.addEventListener(n,function(){"hidden"==I.document[i]?(t._isVisibility=!1,t._isInputting()&&(ni.inputElement.target.focus=!1)):t._isVisibility=!0,t.renderingEnabled=t._isVisibility,t.event(Me.VISIBILITY_CHANGE)}),e.addEventListener("resize",function(){var e=I.window.orientation;null!=e&&e!=t._previousOrientation&&t._isInputting()&&(ni.inputElement.target.focus=!1),t._previousOrientation=e,t._isInputting()||(I.onSafari&&(t._safariOffsetY=(I.window.__innerHeight||I.document.body.clientHeight||I.document.documentElement.clientHeight)-I.window.innerHeight),t._resetCanvas())}),e.addEventListener("orientationchange",function(e){t._resetCanvas()}),t.on(Me.MOUSE_MOVE,O(t),t._onmouseMove),I.onMobile&&t.on(Me.MOUSE_DOWN,O(t),t._onmouseMove),t}return y(d,[{key:"_isInputting",value:function(){return I.onMobile&&ni.isInputting}},{key:"width",get:function(){return m(g(d.prototype),"get_width",this).call(this)},set:function(e){this.designWidth=e,m(g(d.prototype),"set_width",this).call(this,e),L.systemTimer.callLater(this,this._changeCanvasSize)}},{key:"height",get:function(){return m(g(d.prototype),"get_height",this).call(this)},set:function(e){this.designHeight=e,m(g(d.prototype),"set_height",this).call(this,e),L.systemTimer.callLater(this,this._changeCanvasSize)}},{key:"transform",get:function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||this._createTransform()},set:function(e){m(g(d.prototype),"set_transform",this).call(this,e)}},{key:"isFocused",get:function(){return this._isFocused}},{key:"isVisibility",get:function(){return this._isVisibility}},{key:"_changeCanvasSize",value:function(){this.setScreenSize(I.clientWidth*I.pixelRatio,I.clientHeight*I.pixelRatio)}},{key:"_resetCanvas",value:function(){this.screenAdaptationEnabled&&this._changeCanvasSize()}},{key:"setScreenSize",value:function(e,t){var i=!1,n=(this._screenMode!==d.SCREEN_NONE&&(i=(e/t<1?d.SCREEN_VERTICAL:d.SCREEN_HORIZONTAL)!==this._screenMode)&&(n=t,t=e,e=n),this.canvasRotation=i,Bt._mainCanvas),a=n.source.style,s=this._canvasTransform.identity(),r=this._scaleMode,o=e/this.designWidth,h=t/this.designHeight,l=this.useRetinalCanvas?e:this.designWidth,u=this.useRetinalCanvas?t:this.designHeight,c=e,_=t,f=I.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,r){case d.SCALE_NOSCALE:o=h=1,c=this.designWidth,_=this.designHeight;break;case d.SCALE_SHOWALL:o=h=Math.min(o,h),l=c=Math.round(this.designWidth*o),u=_=Math.round(this.designHeight*h);break;case d.SCALE_NOBORDER:o=h=Math.max(o,h),c=Math.round(this.designWidth*o),_=Math.round(this.designHeight*h);break;case d.SCALE_FULL:o=h=1,this._width=l=e,this._height=u=t;break;case d.SCALE_FIXED_WIDTH:h=o,this._height=u=Math.round(t/o);break;case d.SCALE_FIXED_HEIGHT:o=h,this._width=l=Math.round(e/h);break;case d.SCALE_FIXED_AUTO:e/t<this.designWidth/this.designHeight?(h=o,this._height=u=Math.round(t/o)):(o=h,this._width=l=Math.round(e/h))}this.useRetinalCanvas&&(l=e,u=t),o*=this.scaleX,h*=this.scaleY,1===o&&1===h?this.transform.identity():(this.transform.a=this._formatData(o/(c/l)),this.transform.d=this._formatData(h/(_/u))),n.size(l,u),hi.changeWebGLSize(l,u),s.scale(c/l/f,_/u/f),this._alignH===d.ALIGN_LEFT?this.offset.x=0:this._alignH===d.ALIGN_RIGHT?this.offset.x=e-c:this.offset.x=.5*(e-c)/f,this._alignV===d.ALIGN_TOP?this.offset.y=0:this._alignV===d.ALIGN_BOTTOM?this.offset.y=t-_:this.offset.y=.5*(t-_)/f,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),s.translate(this.offset.x,this.offset.y),this._safariOffsetY&&s.translate(0,this._safariOffsetY),this.canvasDegree=0,i&&(this._screenMode===d.SCREEN_HORIZONTAL?(s.rotate(Math.PI/2),s.translate(t/f,0),this.canvasDegree=90):(s.rotate(-Math.PI/2),s.translate(0,e/f),this.canvasDegree=-90)),s.a=this._formatData(s.a),s.d=this._formatData(s.d),s.tx=this._formatData(s.tx),s.ty=this._formatData(s.ty),m(g(d.prototype),"set_transform",this).call(this,this.transform),a.transformOrigin=a.webkitTransformOrigin=a.msTransformOrigin=a.mozTransformOrigin=a.oTransformOrigin="0px 0px 0px",a.transform=a.webkitTransform=a.msTransform=a.mozTransform=a.oTransform="matrix("+s.toString()+")",this._safariOffsetY&&s.translate(0,-this._safariOffsetY),s.translate(parseInt(a.left)||0,parseInt(a.top)||0),this.visible=!0,this._repaint|=C.REPAINT_CACHE,this.event(Me.RESIZE)}},{key:"_formatData",value:function(e){return Math.abs(e)<1e-6?0:Math.abs(1-e)<.001?0<e?1:-1:e}},{key:"scaleMode",get:function(){return this._scaleMode},set:function(e){this._scaleMode=e,L.systemTimer.callLater(this,this._changeCanvasSize)}},{key:"alignH",get:function(){return this._alignH},set:function(e){this._alignH=e,L.systemTimer.callLater(this,this._changeCanvasSize)}},{key:"alignV",get:function(){return this._alignV},set:function(e){this._alignV=e,L.systemTimer.callLater(this,this._changeCanvasSize)}},{key:"bgColor",get:function(){return this._bgColor},set:function(e){this._bgColor=e,this._wgColor=e?Ie.create(e).arrColor:null,Bt.canvas.style.background=e||"none"}},{key:"mouseX",get:function(){return Math.round(si.instance.mouseX/this.clientScaleX)}},{key:"mouseY",get:function(){return Math.round(si.instance.mouseY/this.clientScaleY)}},{key:"getMousePoint",value:function(){return ie.TEMP.setTo(this.mouseX,this.mouseY)}},{key:"clientScaleX",get:function(){return this._transform?this._transform.getScaleX():1}},{key:"clientScaleY",get:function(){return this._transform?this._transform.getScaleY():1}},{key:"screenMode",get:function(){return this._screenMode},set:function(e){this._screenMode=e}},{key:"repaint",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:C.REPAINT_CACHE;this._repaint|=e}},{key:"parentRepaint",value:function(){0<arguments.length&&void 0!==arguments[0]||C.REPAINT_CACHE}},{key:"_loop",value:function(){return this._globalRepaintGet=this._globalRepaintSet,this._globalRepaintSet=!1,this.render(Bt._context,0,0),!0}},{key:"getFrameTm",value:function(){return this._frameStartTime}},{key:"_onmouseMove",value:function(e){this._mouseMoveTime=I.now()}},{key:"getTimeFromFrameStart",value:function(){return I.now()-this._frameStartTime}},{key:"visible",get:function(){return m(g(d.prototype),"visible",this)},set:function(e){this.visible!==e&&(m(g(d.prototype),"set_visible",this).call(this,e),Bt._mainCanvas.source.style.visibility=e?"visible":"hidden")}},{key:"render",value:function(e,t,i){if(window.conch)this.renderToNative(e,t,i);else{if(d._dbgSprite.graphics.clear(),this._frameRate===d.FRAME_SLEEP){var n=I.now();if(!(1e3<=n-this._frameStartTime))return;this._frameStartTime=n}else{if(!this._visible)return this._renderCount++,void(this._renderCount%5==0&&(ri.I._update(),k.loopCount++,Qe.loopCount=k.loopCount,this._updateTimers()));this._frameStartTime=I.now(),Qe.loopStTm=this._frameStartTime}this._renderCount++;var n=(this._frameRate===d.FRAME_MOUSE?this._frameStartTime-this._mouseMoveTime<2e3?d.FRAME_FAST:d.FRAME_SLOW:this._frameRate)!==d.FRAME_SLOW,a=this._renderCount%2==0;if(k.renderSlow=!n,n||a){if(ri.I._update(),k.loopCount++,Qe.loopCount=k.loopCount,this.renderingEnabled){for(var s=0,r=this._scene3Ds.length;s<r;s++)this._scene3Ds[s]._update();e.clear(),m(g(d.prototype),"render",this).call(this,e,t,i),k._StatRender.renderNotCanvas(e,t,i)}d._dbgSprite.render(e,0,0),this.renderingEnabled&&(d.clear(this._bgColor),e.flush(),Xt.instance&&Xt.getInstance().endDispose()),this._updateTimers()}}}},{key:"renderToNative",value:function(e,t,i){if(this._renderCount++,this._visible){if(ri.I._update(),k.loopCount++,Qe.loopCount=k.loopCount,this.renderingEnabled){for(var n=0,a=this._scene3Ds.length;n<a;n++)this._scene3Ds[n]._update();e.clear(),m(g(d.prototype),"render",this).call(this,e,t,i),k._StatRender.renderNotCanvas(e,t,i)}this.renderingEnabled&&(d.clear(this._bgColor),e.flush(),Xt.instance&&Xt.getInstance().endDispose()),this._updateTimers()}else this._renderCount%5==0&&(ri.I._update(),k.loopCount++,Qe.loopCount=k.loopCount,this._updateTimers())}},{key:"_updateTimers",value:function(){L.systemTimer._update(),L.startTimer._update(),L.physicsTimer._update(),L.updateTimer._update(),L.lateTimer._update(),L.timer._update()}},{key:"fullScreenEnabled",set:function(e){var t=I.document,i=Bt.canvas;e?(i.addEventListener("mousedown",this._requestFullscreen),i.addEventListener("touchstart",this._requestFullscreen),t.addEventListener("fullscreenchange",this._fullScreenChanged),t.addEventListener("mozfullscreenchange",this._fullScreenChanged),t.addEventListener("webkitfullscreenchange",this._fullScreenChanged),t.addEventListener("msfullscreenchange",this._fullScreenChanged)):(i.removeEventListener("mousedown",this._requestFullscreen),i.removeEventListener("touchstart",this._requestFullscreen),t.removeEventListener("fullscreenchange",this._fullScreenChanged),t.removeEventListener("mozfullscreenchange",this._fullScreenChanged),t.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),t.removeEventListener("msfullscreenchange",this._fullScreenChanged))}},{key:"frameRate",get:function(){return L.Render.isConchApp?this._frameRateNative:this._frameRate},set:function(e){if(L.Render.isConchApp){var t=window.conch;switch(e){case d.FRAME_FAST:t.config.setLimitFPS(60);break;case d.FRAME_MOUSE:t.config.setMouseFrame(2e3);break;case d.FRAME_SLOW:t.config.setSlowFrame(!0);break;case d.FRAME_SLEEP:t.config.setLimitFPS(1)}this._frameRateNative=e}else this._frameRate=e}},{key:"_requestFullscreen",value:function(){var e=I.document.documentElement;e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}},{key:"_fullScreenChanged",value:function(){L.stage.event(Me.FULL_SCREEN_CHANGE)}},{key:"exitFullscreen",value:function(){var e=I.document;e.exitFullscreen?e.exitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.webkitExitFullscreen&&e.webkitExitFullscreen()}},{key:"isGlobalRepaint",value:function(){return this._globalRepaintGet}},{key:"setGlobalRepaint",value:function(){this._globalRepaintSet=!0}},{key:"add3DUI",value:function(e){e=e.rootView;0<=this._3dUI.indexOf(e)||this._3dUI.push(e)}},{key:"remove3DUI",value:function(e){e=e.rootView,e=this._3dUI.indexOf(e);return 0<=e&&(this._3dUI.splice(e,1),!0)}}]),d}()),ui=(li.SCALE_NOSCALE="noscale",li.SCALE_EXACTFIT="exactfit",li.SCALE_SHOWALL="showall",li.SCALE_NOBORDER="noborder",li.SCALE_FULL="full",li.SCALE_FIXED_WIDTH="fixedwidth",li.SCALE_FIXED_HEIGHT="fixedheight",li.SCALE_FIXED_AUTO="fixedauto",li.ALIGN_LEFT="left",li.ALIGN_RIGHT="right",li.ALIGN_CENTER="center",li.ALIGN_TOP="top",li.ALIGN_MIDDLE="middle",li.ALIGN_BOTTOM="bottom",li.SCREEN_NONE="none",li.SCREEN_HORIZONTAL="horizontal",li.SCREEN_VERTICAL="vertical",li.FRAME_FAST="fast",li.FRAME_SLOW="slow",li.FRAME_MOUSE="mouse",li.FRAME_SLEEP="sleep",li._dbgSprite=new N,li.clear=function(e){Ct.set2DRenderConfig();var t=S.instance,t=(_e.worldScissorTest&&t.disable(t.SCISSOR_TEST),Bt.context),e=0==t._submits._length||Fe.preserveDrawingBuffer?Ie.create(e).arrColor:L.stage._wgColor;e?t.clearBG(e[0],e[1],e[2],e[3]):t.clearBG(0,0,0,0),_e.clear()},M.regClass("laya.display.Stage",li),M.regClass("Laya.Stage",li),function(){function a(){b(this,a)}return y(a,null,[{key:"__init__",value:function(){a._addEvent("keydown"),a._addEvent("keypress"),a._addEvent("keyup")}},{key:"_addEvent",value:function(t){L.Browser.document.addEventListener(t,function(e){a._dispatch(e,t)},!0)}},{key:"_dispatch",value:function(e,t){if(a.enabled){a._event._stoped=!1,a._event.nativeEvent=e,a._event.keyCode=e.keyCode||e.which||e.charCode,"keydown"===t?a._pressKeys[a._event.keyCode]=!0:"keyup"===t&&(a._pressKeys[a._event.keyCode]=null);for(var i=L.stage.focus&&null!=L.stage.focus.event&&L.stage.focus.displayedInStage?L.stage.focus:L.stage,n=i;n;)n.event(t,a._event.setTo(t,n,i)),n=n.parent}}},{key:"hasKeyDown",value:function(e){return a._pressKeys[e]}}]),a}()),ci=(ui._pressKeys={},ui.enabled=!0,ui._event=new Me,function(){f(i,ae);var t=T(i);function i(){var e;return b(this,i),(e=t.apply(this,arguments)).isStopped=!1,e}return y(i,[{key:"volume",get:function(){return 1},set:function(e){}},{key:"position",get:function(){return 0}},{key:"duration",get:function(){return 0}},{key:"play",value:function(){}},{key:"stop",value:function(){this.completeHandler&&this.completeHandler.run()}},{key:"pause",value:function(){}},{key:"resume",value:function(){}},{key:"__runComplete",value:function(e){e&&e.run()}}]),i}()),_i=function(){f(n,ci);var i=T(n);function n(e){var t;return b(this,n),(t=i.call(this))._audio=null,t._onEnd=t.__onEnd.bind(O(t)),t._resumePlay=t.__resumePlay.bind(O(t)),e.addEventListener("ended",t._onEnd),t._audio=e,t}return y(n,[{key:"__onEnd",value:function(e){if(1==this.loops)return this.completeHandler&&(L.systemTimer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event(Me.COMPLETE);0<this.loops&&this.loops--,this.startTime=0,this.play()}},{key:"__resumePlay",value:function(){if(this._audio&&this._audio.removeEventListener("canplay",this._resumePlay),!this.isStopped)try{this._audio.currentTime=this.startTime,I.container.appendChild(this._audio),this._audio.play()}catch(e){this.event(Me.ERROR)}}},{key:"play",value:function(){this.isStopped=!1;try{this._audio.playbackRate=L.SoundManager.playbackRate,this._audio.currentTime=this.startTime}catch(e){return void this._audio.addEventListener("canplay",this._resumePlay)}L.SoundManager.addChannel(this),I.container.appendChild(this._audio),"play"in this._audio&&this._audio.play()}},{key:"position",get:function(){return this._audio?this._audio.currentTime:0}},{key:"duration",get:function(){return this._audio?this._audio.duration:0}},{key:"stop",value:function(){m(g(n.prototype),"stop",this).call(this),this.isStopped=!0,L.SoundManager.removeChannel(this),this.completeHandler=null,this._audio&&("pause"in this._audio&&L.Render.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),L.Browser.onIE||this._audio!=L.AudioSound._musicAudio&&L.Pool.recover("audio:"+this.url,this._audio),I.removeElement(this._audio),this._audio=null,L.SoundManager.autoReleaseSound&&L.SoundManager.disposeSoundLater(this.url))}},{key:"pause",value:function(){this.isStopped=!0,L.SoundManager.removeChannel(this),"pause"in this._audio&&this._audio.pause(),L.SoundManager.autoReleaseSound&&L.SoundManager.disposeSoundLater(this.url)}},{key:"resume",value:function(){this._audio&&(this.isStopped=!1,L.SoundManager.addChannel(this),"play"in this._audio&&this._audio.play())}},{key:"volume",get:function(){return this._audio?this._audio.volume:1},set:function(e){this._audio&&(this._audio.volume=e)}}]),n}(),fi=function(){f(r,ae);var t=T(r);function r(){var e;return b(this,r),(e=t.apply(this,arguments)).loaded=!1,e}return y(r,[{key:"dispose",value:function(){var e=r._audioCache[this.url];p.clearBySign("audio:"+this.url),e&&(Bt.isConchApp||(e.src=""),delete r._audioCache[this.url])}},{key:"load",value:function(e){var t,i;function n(){s(),i.loaded=!0,i.event(Me.COMPLETE)}function a(){t.load=null,s(),i.event(Me.ERROR)}function s(){t.removeEventListener("canplaythrough",n),t.removeEventListener("error",a)}e=re.formatURL(e),(this.url=e)==L.SoundManager._bgMusic?(r._initMusicAudio(),(t=r._musicAudio).src!=e&&(r._audioCache[t.src]=null,t=null)):t=r._audioCache[e],t&&2<=t.readyState?this.event(Me.COMPLETE):(t||(t=e==L.SoundManager._bgMusic?(r._initMusicAudio(),r._musicAudio):I.createElement("audio"),(r._audioCache[e]=t).src=e),t.addEventListener("canplaythrough",n),t.addEventListener("error",a),((i=this).audio=t).load?t.load():a())}},{key:"play",value:function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(!this.url)return null;if(!(n=this.url==L.SoundManager._bgMusic?r._musicAudio:r._audioCache[this.url]))return null;e=p.getItem("audio:"+this.url),Bt.isConchApp?e||((e=I.createElement("audio")).src=this.url):this.url==L.SoundManager._bgMusic?(r._initMusicAudio(),(e=r._musicAudio).src=this.url):e=e||n.cloneNode(!0);var n=new _i(e);return n.url=this.url,n.loops=i,n.startTime=t,n.play(),L.SoundManager.addChannel(n),n}},{key:"duration",get:function(){var e=r._audioCache[this.url];return e?e.duration:0}}],[{key:"_initMusicAudio",value:function(){r._musicAudio||(r._musicAudio||(r._musicAudio=I.createElement("audio")),Bt.isConchApp||I.document.addEventListener("mousedown",r._makeMusicOK))}},{key:"_makeMusicOK",value:function(){I.document.removeEventListener("mousedown",r._makeMusicOK),r._musicAudio.src?r._musicAudio.play():(r._musicAudio.src="",r._musicAudio.load())}}]),r}(),di=(fi._audioCache={},function(){f(n,ci);var t=T(n);function n(){var e;return b(this,n),(e=t.call(this)).bufferSource=null,e._currentTime=0,e._volume=1,e._startTime=0,e._pauseTime=0,e.context=L.WebAudioSound.ctx,e._onPlayEnd=Se.bind(e.__onPlayEnd,O(e)),e.context.createGain?e.gain=e.context.createGain():e.gain=e.context.createGainNode(),e}return y(n,[{key:"play",value:function(){if(L.SoundManager.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){if(this.startTime>=this.duration)return stop();var e=this.context,t=this.gain,i=e.createBufferSource();(this.bufferSource=i).buffer=this.audioBuffer,i.connect(t),t&&t.disconnect(),t.connect(e.destination),i.onended=this._onPlayEnd,this._startTime=I.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,n.SetTargetDelay):this.gain.gain.value=this._volume,0==this.loops&&(i.loop=!0),i.playbackRate.setTargetAtTime?i.playbackRate.setTargetAtTime(L.SoundManager.playbackRate,this.context.currentTime,n.SetTargetDelay):i.playbackRate.value=L.SoundManager.playbackRate,i.start(0,this.startTime),this._currentTime=0}}},{key:"__onPlayEnd",value:function(){if(1==this.loops)return this.completeHandler&&(L.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event(Me.COMPLETE);0<this.loops&&this.loops--,this.startTime=0,this.play()}},{key:"position",get:function(){return this.bufferSource?(I.now()-this._startTime)/1e3+this.startTime:0}},{key:"duration",get:function(){return this.audioBuffer?this.audioBuffer.duration:0}},{key:"_clearBufferSource",value:function(){var e;this.bufferSource&&((e=this.bufferSource).stop?e.stop(0):e.noteOff(0),e.disconnect(0),e.onended=null,n._tryCleanFailed||this._tryClearBuffer(e),this.bufferSource=null)}},{key:"_tryClearBuffer",value:function(e){if(I.onMac)try{e.buffer=L.WebAudioSound._miniBuffer}catch(e){n._tryCleanFailed=!0}else try{e.buffer=null}catch(e){n._tryCleanFailed=!0}}},{key:"stop",value:function(){m(g(n.prototype),"stop",this).call(this),this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,L.SoundManager.removeChannel(this),this.completeHandler=null,L.SoundManager.autoReleaseSound&&L.SoundManager.disposeSoundLater(this.url)}},{key:"pause",value:function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,L.SoundManager.removeChannel(this),L.SoundManager.autoReleaseSound&&L.SoundManager.disposeSoundLater(this.url)}},{key:"resume",value:function(){this.startTime=this._pauseTime,this.play()}},{key:"volume",get:function(){return this._volume},set:function(e){this._volume=e,this.isStopped||(this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(e,this.context.currentTime,n.SetTargetDelay):this.gain.gain.value=e)}}]),n}()),pi=(di._tryCleanFailed=!1,di.SetTargetDelay=.001,function(){f(n,ae);var t=T(n);function n(){var e;return b(this,n),(e=t.apply(this,arguments)).loaded=!1,e._disposed=!1,e}return y(n,[{key:"load",value:function(e){var t,i=this;e=re.formatURL(e),this.url=e,this.audioBuffer=n._dataCache[e],this.audioBuffer?this._loaded(this.audioBuffer):(n.e.on("loaded:"+e,this,this._loaded),n.e.on("err:"+e,this,this._err),n.__loadingSound[e]||(n.__loadingSound[e]=!0,(t=new XMLHttpRequest).open("GET",e,!0),t.responseType="arraybuffer",t.onload=function(){i._disposed?i._removeLoadEvents():(i.data=t.response,n.buffs.push({buffer:i.data,url:i.url}),n.decode())},t.onerror=function(e){i._err()},t.send()))}},{key:"_err",value:function(){this._removeLoadEvents(),n.__loadingSound[this.url]=!1,this.event(Me.ERROR)}},{key:"_loaded",value:function(e){this._removeLoadEvents(),this._disposed||(this.audioBuffer=e,n._dataCache[this.url]=this.audioBuffer,this.loaded=!0,this.event(Me.COMPLETE))}},{key:"_removeLoadEvents",value:function(){n.e.off("loaded:"+this.url,this,this._loaded),n.e.off("err:"+this.url,this,this._err)}},{key:"__playAfterLoaded",value:function(){if(this.__toPlays){for(var e,t=this.__toPlays,i=t.length,n=0;n<i;n++)(e=t[n])[2]&&!e[2].isStopped&&this.play(e[0],e[1],e[2]);this.__toPlays.length=0}}},{key:"play",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=(i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)||new di;return this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([e,t,i]),this.once(Me.COMPLETE,this,this.__playAfterLoaded),this.load(this.url)),i.url=this.url,i.loops=t,i.audioBuffer=this.audioBuffer,i.startTime=e,i.play(),L.SoundManager.addChannel(i),i}},{key:"duration",get:function(){return this.audioBuffer?this.audioBuffer.duration:0}},{key:"dispose",value:function(){this._disposed=!0,delete n._dataCache[this.url],delete n.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]}}],[{key:"decode",value:function(){n.buffs.length<=0||n.isDecoding||(n.isDecoding=!0,n.tInfo=n.buffs.shift(),n.ctx.decodeAudioData(n.tInfo.buffer,n._done,n._fail))}},{key:"_done",value:function(e){n.e.event("loaded:"+n.tInfo.url,e),n.isDecoding=!1,n.decode()}},{key:"_fail",value:function(){n.e.event("err:"+n.tInfo.url,null),n.isDecoding=!1,n.decode()}},{key:"_playEmptySound",value:function(){var e;null!=n.ctx&&((e=n.ctx.createBufferSource()).buffer=n._miniBuffer,e.connect(n.ctx.destination),e.start(0,0,0))}},{key:"_unlock",value:function(){n._unlocked||(n._playEmptySound(),"running"==n.ctx.state&&(window.document.removeEventListener("mousedown",n._unlock,!0),window.document.removeEventListener("touchend",n._unlock,!0),window.document.removeEventListener("touchstart",n._unlock,!0),n._unlocked=!0))}},{key:"initWebAudio",value:function(){"running"!=n.ctx.state&&(n._unlock(),window.document.addEventListener("mousedown",n._unlock,!0),window.document.addEventListener("touchend",n._unlock,!0),window.document.addEventListener("touchstart",n._unlock,!0))}}]),n}()),yi=(pi._dataCache={},pi.webAudioEnabled=window.AudioContext||window.webkitAudioContext||window.mozAudioContext,pi.ctx=pi.webAudioEnabled?new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext):void 0,pi.buffs=[],pi.isDecoding=!1,pi._miniBuffer=pi.ctx?pi.ctx.createBuffer(1,1,22050):void 0,pi.e=new ae,pi._unlocked=!1,pi.__loadingSound={},function(){function o(){b(this,o)}return y(o,null,[{key:"__init__",value:function(){var e=L.Browser.window,e=!!(e.AudioContext||e.webkitAudioContext||e.mozAudioContext);return e&&pi.initWebAudio(),o._soundClass=e?pi:fi,fi._initMusicAudio(),o._musicClass=fi,e}},{key:"addChannel",value:function(e){0<=o._channels.indexOf(e)||o._channels.push(e)}},{key:"removeChannel",value:function(e){for(var t=o._channels.length-1;0<=t;t--)o._channels[t]==e&&o._channels.splice(t,1)}},{key:"disposeSoundLater",value:function(e){o._lastSoundUsedTimeDic[e]=L.Browser.now(),o._isCheckingDispose||(o._isCheckingDispose=!0,L.timer.loop(5e3,null,o._checkDisposeSound))}},{key:"_checkDisposeSound",value:function(){var e,t=L.Browser.now(),i=!1;for(e in o._lastSoundUsedTimeDic)3e4<t-o._lastSoundUsedTimeDic[e]?(delete o._lastSoundUsedTimeDic[e],o.disposeSoundIfNotUsed(e)):i=!0;i||(o._isCheckingDispose=!1,L.timer.clear(null,o._checkDisposeSound))}},{key:"disposeSoundIfNotUsed",value:function(e){for(var t=o._channels.length-1;0<=t;t--)if(o._channels[t].url==e)return;o.destroySound(e)}},{key:"autoStopMusic",get:function(){return o._autoStopMusic},set:function(e){L.stage.off(Me.BLUR,null,o._stageOnBlur),L.stage.off(Me.FOCUS,null,o._stageOnFocus),L.stage.off(Me.VISIBILITY_CHANGE,null,o._visibilityChange),(o._autoStopMusic=e)&&(L.stage.on(Me.BLUR,null,o._stageOnBlur),L.stage.on(Me.FOCUS,null,o._stageOnFocus),L.stage.on(Me.VISIBILITY_CHANGE,null,o._visibilityChange))}},{key:"_visibilityChange",value:function(){L.stage.isVisibility?o._stageOnFocus():o._stageOnBlur()}},{key:"_stageOnBlur",value:function(){o._isActive=!1,o._musicChannel&&!o._musicChannel.isStopped&&(o._blurPaused=!0,o._musicChannel.pause()),o.stopAllSound(),L.stage.once(Me.MOUSE_DOWN,null,o._stageOnFocus)}},{key:"_recoverWebAudio",value:function(){pi.ctx&&"running"!=pi.ctx.state&&pi.ctx.resume&&pi.ctx.resume()}},{key:"_stageOnFocus",value:function(){o._isActive=!0,o._recoverWebAudio(),L.stage.off(Me.MOUSE_DOWN,null,o._stageOnFocus),o._blurPaused&&o._musicChannel&&o._musicChannel.isStopped&&(o._blurPaused=!1,o._musicChannel.resume())}},{key:"muted",get:function(){return o._muted},set:function(e){e!=o._muted&&(e&&o.stopAllSound(),o.musicMuted=e,o._muted=e)}},{key:"soundMuted",get:function(){return o._soundMuted},set:function(e){o._soundMuted=e}},{key:"musicMuted",get:function(){return o._musicMuted},set:function(e){e!=o._musicMuted&&(e?(o._bgMusic&&o._musicChannel&&!o._musicChannel.isStopped?L.Render.isConchApp?o._musicChannel._audio&&(o._musicChannel._audio.muted=!0):o._musicChannel.pause():o._musicChannel=null,o._musicMuted=e):(o._musicMuted=e,o._bgMusic&&o._musicChannel&&(L.Render.isConchApp?o._musicChannel._audio&&(o._musicChannel._audio.muted=!1):o._musicChannel.resume())))}},{key:"musicPosition",get:function(){return o._musicChannel?o._musicChannel.position:0}},{key:"useAudioMusic",get:function(){return o._useAudioMusic},set:function(e){o._useAudioMusic=e,o._musicClass=e?fi:null}},{key:"playSound",value:function(e){var t,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0;if(!o._isActive||!e)return null;if(o._muted)return null;if(o._recoverWebAudio(),(e=re.formatURL(e))==o._bgMusic){if(o._musicMuted)return null}else{if(L.Render.isConchApp){var r=Se.getFileExtension(e);if("wav"!=r&&"ogg"!=r)return alert("The sound only supports wav or ogg format,for optimal performance reason,please refer to the official website document."),null}if(o._soundMuted)return null}return L.Browser.onBDMiniGame||L.Browser.onMiniGame||L.Browser.onKGMiniGame||L.Browser.onQGMiniGame||L.Browser.onVVMiniGame||L.Browser.onAlipayMiniGame||L.Browser.onQQMiniGame||(t=L.loader.getRes(e)),a=a||o._soundClass,t||((t=new a).load(e),L.Browser.onBDMiniGame||L.Browser.onMiniGame||L.Browser.onKGMiniGame||L.Browser.onQGMiniGame||L.Browser.onVVMiniGame||L.Browser.onAlipayMiniGame||L.Browser.onQQMiniGame||L.Loader.cacheRes(e,t)),(r=t.play(s,i))?(r.url=e,r.volume=e==o._bgMusic?o.musicVolume:o.soundVolume,r.completeHandler=n,r):null}},{key:"destroySound",value:function(e){var t=L.loader.getRes(e);t&&(L.Loader.clearRes(e),t.dispose())}},{key:"playMusic",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;return e=re.formatURL(e),o._bgMusic=e,o._musicChannel&&o._musicChannel.stop(),o._musicChannel=o.playSound(e,t,i,o._musicClass,n)}},{key:"stopSound",value:function(e){var t,i;for(e=re.formatURL(e),t=o._channels.length-1;0<=t;t--)(i=o._channels[t]).url==e&&i.stop()}},{key:"stopAll",value:function(){var e;for(o._bgMusic=null,e=o._channels.length-1;0<=e;e--)o._channels[e].stop()}},{key:"stopAllSound",value:function(){for(var e,t=o._channels.length-1;0<=t;t--)(e=o._channels[t]).url!=o._bgMusic&&e.stop()}},{key:"stopMusic",value:function(){o._musicChannel&&o._musicChannel.stop(),o._bgMusic=null}},{key:"setSoundVolume",value:function(e){var t,i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if(n)n=re.formatURL(n),o._setVolume(n,e);else for(o.soundVolume=e,t=o._channels.length-1;0<=t;t--)(i=o._channels[t]).url!=o._bgMusic&&(i.volume=e)}},{key:"setMusicVolume",value:function(e){o.musicVolume=e,o._setVolume(o._bgMusic,e)}},{key:"_setVolume",value:function(e,t){var i,n;for(e=re.formatURL(e),i=o._channels.length-1;0<=i;i--)(n=o._channels[i]).url==e&&(n.volume=t)}}]),o}()),gi=(yi.musicVolume=1,yi.soundVolume=1,yi.playbackRate=1,yi._useAudioMusic=!0,yi._muted=!1,yi._soundMuted=!1,yi._musicMuted=!1,yi._bgMusic=null,yi._musicChannel=null,yi._channels=[],yi._blurPaused=!1,yi._isActive=!0,yi._lastSoundUsedTimeDic={},yi._isCheckingDispose=!1,yi.autoReleaseSound=!0,function(){function e(){b(this,e)}return y(e,[{key:"create",value:function(){return this.json?L.SceneUtils.createByData(null,this.json):null}}]),e}()),mi=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;b(this,t),this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,e?(this._u8d_=new Uint8Array(e),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this._resizeBuffer(this._allocated_)}return y(t,[{key:"buffer",get:function(){var e=this._d_.buffer;return e.byteLength===this._length?e:e.slice(0,this._length)}},{key:"endian",get:function(){return this._xd_?t.LITTLE_ENDIAN:t.BIG_ENDIAN},set:function(e){this._xd_=e===t.LITTLE_ENDIAN}},{key:"length",get:function(){return this._length},set:function(e){this._allocated_<e?this._resizeBuffer(this._allocated_=Math.floor(Math.max(e,2*this._allocated_))):this._allocated_>e&&this._resizeBuffer(this._allocated_=e),this._length=e}},{key:"_resizeBuffer",value:function(t){try{var e=new Uint8Array(t);null!=this._u8d_&&(this._u8d_.length<=t?e.set(this._u8d_):e.set(this._u8d_.subarray(0,t))),this._u8d_=e,this._d_=new DataView(e.buffer)}catch(e){throw"Invalid typed array length:"+t}}},{key:"getString",value:function(){return this.readString()}},{key:"readString",value:function(){return this._rUTF(this.getUint16())}},{key:"getFloat32Array",value:function(e,t){return this.readFloat32Array(e,t)}},{key:"readFloat32Array",value:function(e,t){t=(t=e+t)>this._length?this._length:t,e=new Float32Array(this._d_.buffer.slice(e,t));return this._pos_=t,e}},{key:"getUint8Array",value:function(e,t){return this.readUint8Array(e,t)}},{key:"readUint8Array",value:function(e,t){t=(t=e+t)>this._length?this._length:t,e=new Uint8Array(this._d_.buffer.slice(e,t));return this._pos_=t,e}},{key:"getInt16Array",value:function(e,t){return this.readInt16Array(e,t)}},{key:"readInt16Array",value:function(e,t){t=(t=e+t)>this._length?this._length:t,e=new Int16Array(this._d_.buffer.slice(e,t));return this._pos_=t,e}},{key:"getFloat32",value:function(){return this.readFloat32()}},{key:"readFloat32",value:function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var e=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,e}},{key:"getFloat64",value:function(){return this.readFloat64()}},{key:"readFloat64",value:function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var e=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,e}},{key:"writeFloat32",value:function(e){this._ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,e,this._xd_),this._pos_+=4}},{key:"writeFloat64",value:function(e){this._ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,e,this._xd_),this._pos_+=8}},{key:"getInt32",value:function(){return this.readInt32()}},{key:"readInt32",value:function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var e=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,e}},{key:"getUint32",value:function(){return this.readUint32()}},{key:"readUint32",value:function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var e=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,e}},{key:"writeInt32",value:function(e){this._ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,e,this._xd_),this._pos_+=4}},{key:"writeUint32",value:function(e){this._ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,e,this._xd_),this._pos_+=4}},{key:"getInt16",value:function(){return this.readInt16()}},{key:"readInt16",value:function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var e=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,e}},{key:"getUint16",value:function(){return this.readUint16()}},{key:"readUint16",value:function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var e=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,e}},{key:"writeUint16",value:function(e){this._ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,e,this._xd_),this._pos_+=2}},{key:"writeInt16",value:function(e){this._ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,e,this._xd_),this._pos_+=2}},{key:"getUint8",value:function(){return this.readUint8()}},{key:"readUint8",value:function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._u8d_[this._pos_++]}},{key:"writeUint8",value:function(e){this._ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,e),this._pos_++}},{key:"_getUInt8",value:function(e){return this._readUInt8(e)}},{key:"_readUInt8",value:function(e){return this._d_.getUint8(e)}},{key:"_getUint16",value:function(e){return this._readUint16(e)}},{key:"_readUint16",value:function(e){return this._d_.getUint16(e,this._xd_)}},{key:"_getMatrix",value:function(){return this._readMatrix()}},{key:"_readMatrix",value:function(){return new Ce(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())}},{key:"_rUTF",value:function(e){var t,i,n,a,s=this._pos_+e,r=String.fromCharCode,o=this._u8d_,h=[],l=0;for(h.length=1e3;this._pos_<s;)(a=o[this._pos_++])<128?0!=a&&(h[l++]=r(a)):a<224?h[l++]=r((63&a)<<6|127&o[this._pos_++]):a<240?(t=o[this._pos_++],h[l++]=r((31&a)<<12|(127&t)<<6|127&o[this._pos_++])):65536<=(a=(15&a)<<18|(127&(t=o[this._pos_++]))<<12|(127&o[this._pos_++])<<6|127&o[this._pos_++])?(n=56320|1023&(i=a-65536),h[l++]=r(55296|i>>10),h[l++]=r(n)):h[l++]=r(a);return h.length=l,h.join("")}},{key:"getCustomString",value:function(e){return this.readCustomString(e)}},{key:"readCustomString",value:function(e){for(var t,i="",n=0,a=String.fromCharCode,s=this._u8d_;0<e;)if((t=s[this._pos_])<128)i+=a(t),this._pos_++,e--;else for(n=t-128,this._pos_++,e-=n;0<n;)t=s[this._pos_++],i+=a(s[this._pos_++]<<8|t),n--;return i}},{key:"pos",get:function(){return this._pos_},set:function(e){this._pos_=e}},{key:"bytesAvailable",get:function(){return this._length-this._pos_}},{key:"clear",value:function(){this._pos_=0,this.length=0}},{key:"__getBuffer",value:function(){return this._d_.buffer}},{key:"writeUTFBytes",value:function(e){for(var t=0,i=(e+="").length;t<i;t++){var n,a,s,r,o=e.charCodeAt(t);o<=127?this.writeByte(o):o<=2047?(this._ensureWrite(this._pos_+2),this._u8d_.set([192|o>>6,128|63&o],this._pos_),this._pos_+=2):55296<=o&&o<=56319?(t++,s=e.charCodeAt(t),!Number.isNaN(s)&&56320<=s&&s<=57343&&(n=240|(r=64+(1023&o))>>8&63,a=128|r>>2&63,s=128|(3&r)<<4|(r=1023&s)>>6&15,r=128|63&r,this._ensureWrite(this._pos_+4),this._u8d_.set([n,a,s,r],this._pos_),this._pos_+=4)):o<=65535?(this._ensureWrite(this._pos_+3),this._u8d_.set([224|o>>12,128|o>>6&63,128|63&o],this._pos_),this._pos_+=3):(this._ensureWrite(this._pos_+4),this._u8d_.set([240|o>>18,128|o>>12&63,128|o>>6&63,128|63&o],this._pos_),this._pos_+=4)}}},{key:"writeUTFString",value:function(e){var t=this.pos,e=(this.writeUint16(1),this.writeUTFBytes(e),this.pos-t-2);this._d_.setUint16(t,e,this._xd_)}},{key:"readUTFString",value:function(){return this.readUTFBytes(this.getUint16())}},{key:"getUTFString",value:function(){return this.readUTFString()}},{key:"readUTFBytes",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1;if(0===e)return"";var t=this.bytesAvailable;if(t<e)throw"readUTFBytes error - Out of bounds";return this._rUTF(e=0<e?e:t)}},{key:"getUTFBytes",value:function(){return this.readUTFBytes(0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1)}},{key:"writeByte",value:function(e){this._ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,e),this._pos_+=1}},{key:"readByte",value:function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)}},{key:"getByte",value:function(){return this.readByte()}},{key:"_ensureWrite",value:function(e){this._length<e&&(this._length=e),this._allocated_<e&&(this.length=e)}},{key:"writeArrayBuffer",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;if(t<0||i<0)throw"writeArrayBuffer error - Out of bounds";0==i&&(i=e.byteLength-t),this._ensureWrite(this._pos_+i);e=new Uint8Array(e);this._u8d_.set(e.subarray(t,t+i),this._pos_),this._pos_+=i}},{key:"readArrayBuffer",value:function(e){var t=this._u8d_.buffer.slice(this._pos_,this._pos_+e);return this._pos_=this._pos_+e,t}}],[{key:"getSystemEndian",value:function(){var e;return t._sysEndian||(e=new ArrayBuffer(2),new DataView(e).setInt16(0,256,!0),t._sysEndian=256===new Int16Array(e)[0]?t.LITTLE_ENDIAN:t.BIG_ENDIAN),t._sysEndian}}]),t}(),vi=(mi.BIG_ENDIAN="bigEndian",mi.LITTLE_ENDIAN="littleEndian",mi._sysEndian=null,function(){function e(){b(this,e),this._fontCharDic={},this._fontWidthMap={},this._maxWidth=0,this._spaceWidth=10,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}return y(e,[{key:"loadFont",value:function(e,t){this._path=e,this._complete=t,e&&-1!==e.indexOf(".fnt")?L.loader.load([{url:e,type:L.Loader.XML},{url:e.replace(".fnt",".png"),type:L.Loader.IMAGE}],x.create(this,this._onLoaded)):console.error('Bitmap font configuration information must be a ".fnt" file')}},{key:"_onLoaded",value:function(){this.parseFont(L.Loader.getRes(this._path),L.Loader.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.run()}},{key:"parseFont",value:function(e,t){if(null!=e&&null!=t){this._texture=t;var i=e.getElementsByTagName("info");if(!i[0].getAttributeNode)return this.parseFont2(e,t);this.fontSize=parseInt(i[0].getAttributeNode("size").nodeValue);for(var i=i[0].getAttributeNode("padding").nodeValue.split(","),n=(this._padding=[parseInt(i[0]),parseInt(i[1]),parseInt(i[2]),parseInt(i[3])],e.getElementsByTagName("char")),a=0,a=0;a<n.length;a++){var s=n[a],r=parseInt(s.getAttributeNode("id").nodeValue),o=+parseInt(s.getAttributeNode("xoffset").nodeValue),h=+parseInt(s.getAttributeNode("yoffset").nodeValue),l=+parseInt(s.getAttributeNode("xadvance").nodeValue),u=new ne,s=(u.x=parseInt(s.getAttributeNode("x").nodeValue),u.y=parseInt(s.getAttributeNode("y").nodeValue),u.width=parseInt(s.getAttributeNode("width").nodeValue),u.height=parseInt(s.getAttributeNode("height").nodeValue),vt.create(t,u.x,u.y,u.width,u.height,o,h));this._maxWidth=Math.max(this._maxWidth,l+this.letterSpacing),this._fontCharDic[r]=s,this._fontWidthMap[r]=l}}}},{key:"parseFont2",value:function(e,t){if(null!=e&&null!=t){this._texture=t;var i=e.getElementsByTagName("info");this.fontSize=parseInt(i[0].attributes.size.nodeValue);for(var i=i[0].attributes.padding.nodeValue.split(","),n=(this._padding=[parseInt(i[0]),parseInt(i[1]),parseInt(i[2]),parseInt(i[3])],e.getElementsByTagName("char")),a=0,a=0;a<n.length;a++){var s=n[a].attributes,r=parseInt(s.id.nodeValue),o=+parseInt(s.xoffset.nodeValue),h=+parseInt(s.yoffset.nodeValue),l=+parseInt(s.xadvance.nodeValue),u=new ne,s=(u.x=parseInt(s.x.nodeValue),u.y=parseInt(s.y.nodeValue),u.width=parseInt(s.width.nodeValue),u.height=parseInt(s.height.nodeValue),vt.create(t,u.x,u.y,u.width,u.height,o,h));this._maxWidth=Math.max(this._maxWidth,l+this.letterSpacing),this._fontCharDic[r]=s,this._fontWidthMap[r]=l}}}},{key:"getCharTexture",value:function(e){return this._fontCharDic[e.charCodeAt(0)]}},{key:"destroy",value:function(){if(this._texture){for(var e in this._fontCharDic){e=this._fontCharDic[e];e&&e.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null,this._complete=null,this._padding=null}}},{key:"setSpaceWidth",value:function(e){this._spaceWidth=e}},{key:"getCharWidth",value:function(e){var t=e.charCodeAt(0);return this._fontWidthMap[t]?this._fontWidthMap[t]+this.letterSpacing:" "===e?this._spaceWidth+this.letterSpacing:0}},{key:"getTextWidth",value:function(e){for(var t=0,i=0,n=e.length;i<n;i++)t+=this.getCharWidth(e.charAt(i));return t}},{key:"getMaxWidth",value:function(){return this._maxWidth}},{key:"getMaxHeight",value:function(){return this.fontSize}},{key:"_drawText",value:function(e,t,i,n,a,s){for(var r,o=this.getTextWidth(e),h="right"===a?s-o:"center"===a?(s-o)/2:0,l=0,u=0,c=e.length;u<c;u++)(r=this.getCharTexture(e.charAt(u)))&&(t.graphics.drawImage(r,i+l+h,n),l+=this.getCharWidth(e.charAt(u)))}}]),e}()),xi=(M.regClass("laya.display.BitmapFont",vi),M.regClass("Laya.BitmapFont",vi),function(){f(i,ae);var t=T(i);function i(){var e;return b(this,i),(e=t.apply(this,arguments))._http=new XMLHttpRequest,e}return y(i,[{key:"send",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"get",n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"text",a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null;if(I.window.merge){var s,r=window.location.href.slice(0,window.location.href.lastIndexOf("/")+1),o=e.replace(r,""),h=Y(I.window.merge);try{for(h.s();!(s=h.n()).done;){var l=s.value;if(l.config[o])return this.clear(),this._data=JSON.parse(l.config[o]),void this.event(Me.COMPLETE,this._data instanceof Array?[this._data]:this._data)}}catch(e){h.e(e)}finally{h.f()}}this._responseType=n,this._data=null,(I.onVVMiniGame||I.onQGMiniGame||I.onQQMiniGame)&&(e=encodeURI(e)),this._url=e;var u=this,c=this._http;if(e=re.getAdptedFilePath(e),c.open(i,e,!0),a)for(var _=0;_<a.length;_++)c.setRequestHeader(a[_++],a[_]);else window.conch||(t&&"string"!=typeof t?c.setRequestHeader("Content-Type","application/json"):c.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));r="arraybuffer"!==n?"text":"arraybuffer";c.responseType=r,c.dataType&&(c.dataType=r),c.onerror=function(e){u._onError(e)},c.onabort=function(e){u._onAbort(e)},c.onprogress=function(e){u._onProgress(e)},c.onload=function(e){u._onLoad(e)},c.send(t)}},{key:"_onProgress",value:function(e){e&&e.lengthComputable&&this.event(Me.PROGRESS,e.loaded/e.total)}},{key:"_onAbort",value:function(e){this.error("Request was aborted by user")}},{key:"_onError",value:function(e){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)}},{key:"_onLoad",value:function(e){var t=this._http,i=void 0!==t.status?t.status:200;200===i||204===i||0===i?this.complete():this.error("["+t.status+"]"+t.statusText+":"+t.responseURL)}},{key:"error",value:function(e){this.clear(),console.warn(this.url,e),this.event(Me.ERROR,e)}},{key:"complete",value:function(){this.clear();var t=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=Se.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(e){t=!1,this.error(e.message)}t&&this.event(Me.COMPLETE,this._data instanceof Array?[this._data]:this._data)}},{key:"clear",value:function(){var e=this._http;e.onerror=e.onabort=e.onprogress=e.onload=null}},{key:"url",get:function(){return this._url}},{key:"data",get:function(){return this._data}},{key:"http",get:function(){return this._http}}]),i}()),E=function(){f(v,ae);var t=T(v);function v(){var e;return b(this,v),(e=t.apply(this,arguments))._customParse=!1,e}return y(v,[{key:"load",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,i=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,a=4<arguments.length&&void 0!==arguments[4]&&arguments[4],s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:L.WorkerLoader.enable;{if(e)return v.setGroup(e,"666"),0===(this._url=e).indexOf("data:image")?t=v.IMAGE:e=re.formatURL(e),this._type=t=t||v.getTypeFromUrl(this._url),this._cache=i,this._useWorkerLoader=s,this._data=null,s&&L.WorkerLoader.enableWorkerLoader(),i=(t==v.IMAGE?v.textureMap:v.loadedMap)[e],!a&&i?(this._data=i,this.event(Me.PROGRESS,1),void this.event(Me.COMPLETE,this._data)):(n&&v.setGroup(e,n),null!=v.parserMap[t]?(this._customParse=!0,void(v.parserMap[t]instanceof x?v.parserMap[t].runWith(this):v.parserMap[t].call(null,this))):void this._loadResourceFilter(t,e));this.onLoaded(null)}}},{key:"_loadResourceFilter",value:function(e,t){this._loadResource(e,t)}},{key:"_loadResource",value:function(e,t){switch(e){case v.IMAGE:case"htmlimage":case"nativeimage":this._loadImage(t);break;case v.SOUND:this._loadSound(t);break;case v.TTF:this._loadTTF(t);break;case v.ATLAS:case v.PREFAB:case v.PLF:this._loadHttpRequestWhat(t,v.JSON);break;case v.FONT:this._loadHttpRequestWhat(t,v.XML);break;case v.PLFB:this._loadHttpRequestWhat(t,v.BUFFER);break;default:this._loadHttpRequestWhat(t,e)}}},{key:"_loadHttpRequest",value:function(e,t,i,n,a,s,r,o){!I.onVVMiniGame&&this._http||(this._http=new xi),s&&this._http.on(Me.PROGRESS,a,s),n&&this._http.on(Me.COMPLETE,i,n),this._http.on(Me.ERROR,r,o),this._http.send(e,null,"get",t)}},{key:"_loadHtmlImage",value:function(t,e,i,n,a){function s(){var e=r;e.onload=null,e.onerror=null,delete v._imgCache[t]}var r;(r=new I.window.Image).crossOrigin="",r.onload=function(){s(),i.call(e,r)},r.onerror=function(){s(),a.call(n)},r.src=t,v._imgCache[t]=r}},{key:"_loadHttpRequestWhat",value:function(e,t){v.preLoadedMap[e]?this.onLoaded(v.preLoadedMap[e]):this._loadHttpRequest(e,t,this,this.onLoaded,this,this.onProgress,this,this.onError)}},{key:"_loadTTF",value:function(e){e=re.formatURL(e);var t=new L.TTFLoader;t.complete=x.create(this,this.onLoaded),t.load(e)}},{key:"_loadImage",value:function(n){function e(){s.event(Me.ERROR,"Load image failed")}var a,t=this,s=this;1<arguments.length&&void 0!==arguments[1]&&!arguments[1]||(n=re.formatURL(n));"nativeimage"===this._type?this._loadHtmlImage(n,this,function(e){t.onLoaded(e)},this,e):"ktx"===(a=Se.getFileExtension(n))||"pvr"===a?this._loadHttpRequest(n,v.BUFFER,this,function(e){var t;switch(a){case"ktx":t=G.ETC1RGB;break;case"pvr":t=G.PVRTCRGBA_4BPPV;break;default:return void console.error("unknown format",a)}var i=new ue(0,0,t,!1,!1);i.wrapModeU=le.WARPMODE_CLAMP,i.wrapModeV=le.WARPMODE_CLAMP,i.setCompressData(e),i._setCreateURL(n),s.onLoaded(i)},null,null,this,e):this._loadHtmlImage(n,this,function(e){var t=new ue(e.width,e.height,1,!1,!1);t.wrapModeU=le.WARPMODE_CLAMP,t.wrapModeV=le.WARPMODE_CLAMP,t.loadImageSource(e,!0),t._setCreateURL(n),s.onLoaded(t)},this,e)}},{key:"_loadSound",value:function(e){var t=new yi._soundClass,i=this;function n(){t.offAll()}t.on(Me.COMPLETE,this,function(){n(),i.onLoaded(t)}),t.on(Me.ERROR,this,function(){n(),t.dispose(),i.event(Me.ERROR,"Load sound failed")}),t.load(e)}},{key:"onProgress",value:function(e){this._type===v.ATLAS?this.event(Me.PROGRESS,.3*e):this.event(Me.PROGRESS,e)}},{key:"onError",value:function(e){this.event(Me.ERROR,e)}},{key:"onLoaded",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=this._type;if(t==v.PLFB)this.parsePLFBData(e),this.complete(e);else if(t==v.PLF)this.parsePLFData(e),this.complete(e);else if(t===v.IMAGE){var i=new vt(e);i.url=this._url,this.complete(i)}else if(t===v.SOUND||"htmlimage"===t||"nativeimage"===t)this.complete(e);else if(t===v.ATLAS){if(!(e instanceof ue)){var n=[];if(!this._data){if((this._data=e).meta&&e.meta.image){var n=e.meta.image.split(","),i=0<=this._url.indexOf("/")?"/":"\\",i=this._url.lastIndexOf(i),a=0<=i?this._url.substr(0,i+1):"",s=null;I.onAndroid&&e.meta.compressTextureAndroid&&(s=".ktx"),I.onIOS&&e.meta.compressTextureIOS&&(s=".pvr");for(var r=0,o=n.length;r<o;r++)n[r]=s?a+n[r].replace(".png",s):a+n[r]}else n=[this._url.replace(".json",".png")];n.reverse(),e.toLoads=n,e.pics=[]}return this.event(Me.PROGRESS,.3+1/n.length*.6),this._loadResourceFilter(v.IMAGE,n.pop())}if(this._data.pics.push(e),0<this._data.toLoads.length)return this.event(Me.PROGRESS,.3+1/this._data.toLoads.length*.6),this._loadResourceFilter(v.IMAGE,this._data.toLoads.pop());var h,l=this._data.frames,i=this._url.split("?")[0],u=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:i.substring(0,i.lastIndexOf("."))+"/",c=this._data.pics,i=re.formatURL(this._url),_=v.atlasMap[i]||(v.atlasMap[i]=[]);_.dir=u;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var f in h=parseFloat(this._data.meta.scale),l){var d,p=l[f],y=c[p.frame.idx||0],g=re.formatURL(u+f);y.scaleRate=h,d=vt._create(y,p.frame.x,p.frame.y,p.frame.w,p.frame.h,p.spriteSourceSize.x,p.spriteSourceSize.y,p.sourceSize.w,p.sourceSize.h,v.getRes(g)),v.cacheTexture(g,d),d.url=g,_.push(g)}else for(f in l)y=c[(p=l[f]).frame.idx||0],g=re.formatURL(u+f),d=vt._create(y,p.frame.x,p.frame.y,p.frame.w,p.frame.h,p.spriteSourceSize.x,p.spriteSourceSize.y,p.sourceSize.w,p.sourceSize.h,v.getRes(g)),v.cacheTexture(g,d),d.url=g,_.push(g);delete this._data.pics,this.complete(this._data)}else if(t===v.FONT){if(!e._source)return this._data=e,this.event(Me.PROGRESS,.5),this._loadResourceFilter(v.IMAGE,this._url.replace(".fnt",".png"));var i=new vi,m=(i.parseFont(this._data,new vt(e)),this._url.split(".fnt")[0].split("/")),m=m[m.length-1];ii.registerBitmapFont(m,i),this._data=i,this.complete(this._data)}else t===v.PREFAB?((m=new gi).json=e,this.complete(m)):this.complete(e)}},{key:"parsePLFData",value:function(e){var t,i,n;for(t in e)for(i in t,n=e[t])v.preLoadedMap[re.formatURL(i)]=n[i]}},{key:"parsePLFBData",value:function(e){for(var t=new mi(e),i=t.getInt32(),n=0;n<i;n++)this.parseOnePLFBFile(t)}},{key:"parseOnePLFBFile",value:function(e){var t=e.getUTFString(),i=e.getInt32(),e=e.readArrayBuffer(i);v.preLoadedMap[re.formatURL(t)]=e}},{key:"complete",value:function(e){this._data=e,this._customParse?this.event(Me.LOADED,e instanceof Array?[e]:e):(v._loaders.push(this),v._isWorking||v.checkNext())}},{key:"endLoad",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;e&&(this._data=e),this._cache&&v.cacheRes(this._url,this._data),this.event(Me.PROGRESS,1),this.event(Me.COMPLETE,this.data instanceof Array?[this.data]:this.data)}},{key:"url",get:function(){return this._url}},{key:"type",get:function(){return this._type}},{key:"cache",get:function(){return this._cache}},{key:"data",get:function(){return this._data}}],[{key:"getTypeFromUrl",value:function(e){var t=Se.getFileExtension(e);return t?v.typeMap[t]:(console.warn("Not recognize the resources suffix",e),"text")}},{key:"checkNext",value:function(){v._isWorking=!0;for(var e=I.now();v._startIndex<v._loaders.length;)if(v._loaders[v._startIndex].endLoad(),v._startIndex++,I.now()-e>v.maxTimeOut)return console.warn("loader callback cost a long time:"+(I.now()-e)+" url="+v._loaders[v._startIndex-1].url),void L.systemTimer.frameOnce(1,null,v.checkNext);v._loaders.length=0,v._startIndex=0,v._isWorking=!1}},{key:"clearRes",value:function(e){e=re.formatURL(e);var t=v.getAtlas(e);if(t){for(var i=0,n=t.length;i<n;i++){var a=t[i],s=v.getRes(a);delete v.textureMap[a],s&&s.destroy()}t.length=0,delete v.atlasMap[e]}var r=v.textureMap[e];r&&(r.destroy(),delete v.textureMap[e]),v.loadedMap[e]&&delete v.loadedMap[e]}},{key:"clearTextureRes",value:function(e){e=re.formatURL(e);var t=v.getAtlas(e);t&&0<t.length?t.forEach(function(e){e=v.getRes(e);e instanceof vt&&e.disposeBitmap()}):(t=v.getRes(e))instanceof vt&&t.disposeBitmap()}},{key:"getRes",value:function(e){var t=v.textureMap[re.formatURL(e)];return t||v.loadedMap[re.formatURL(e)]}},{key:"getAtlas",value:function(e){return v.atlasMap[re.formatURL(e)]}},{key:"cacheRes",value:function(e,t){e=re.formatURL(e),null!=v.loadedMap[e]?console.warn("Resources already exist,is repeated loading:",e):t instanceof vt?(v.loadedMap[e]=t.bitmap,v.textureMap[e]=t):v.loadedMap[e]=t}},{key:"cacheTexture",value:function(e,t){e=re.formatURL(e),null==v.textureMap[e]&&(v.textureMap[e]=t)}},{key:"setGroup",value:function(e,t){v.groupMap[t]||(v.groupMap[t]=[]),v.groupMap[t].push(e)}},{key:"clearResByGroup",value:function(e){if(v.groupMap[e]){for(var t=v.groupMap[e],i=t.length,n=0;n<i;n++)v.clearRes(t[n]);t.length=0}}}]),v}(),ki=(E.TEXT="text",E.JSON="json",E.PREFAB="prefab",E.XML="xml",E.BUFFER="arraybuffer",E.IMAGE="image",E.SOUND="sound",E.ATLAS="atlas",E.FONT="font",E.TTF="ttf",E.PLF="plf",E.PLFB="plfb",E.HIERARCHY="HIERARCHY",E.MESH="MESH",E.MATERIAL="MATERIAL",E.TEXTURE2D="TEXTURE2D",E.TEXTURECUBE="TEXTURECUBE",E.ANIMATIONCLIP="ANIMATIONCLIP",E.AVATAR="AVATAR",E.TERRAINHEIGHTDATA="TERRAINHEIGHTDATA",E.TERRAINRES="TERRAIN",E.typeMap={ttf:"ttf",png:"image",jpg:"image",jpeg:"image",ktx:"image",pvr:"image",txt:"text",json:"json",prefab:"prefab",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",plf:"plf",plfb:"plfb",scene:"json",ani:"json",sk:"arraybuffer"},E.parserMap={},E.maxTimeOut=100,E.groupMap={},E.loadedMap={},E.atlasMap={},E.textureMap={},E.preLoadedMap={},E._imgCache={},E._loaders=[],E._isWorking=!1,E._startIndex=0,function(){function o(){b(this,o)}return y(o,null,[{key:"enable",value:function(e){L.loader.load(e,x.create(null,o._onInfoLoaded,[1<arguments.length&&void 0!==arguments[1]?arguments[1]:null]),null,E.JSON)}},{key:"_onInfoLoaded",value:function(e,t){var i,n,a,s,r;for(i in t)for(n=(a=t[i])[0],r=(a=a[1]).length,s=0;s<r;s++)o._fileLoadDic[n+a[s]]=i;e&&e.run()}},{key:"getFileLoadPath",value:function(e){return o._fileLoadDic[e]||e}}]),o}()),wi=(ki._fileLoadDic={},function(){f(_,ae);var i=T(_);function _(){var e;b(this,_),(e=i.call(this)).retryNum=1,e.retryDelay=0,e.maxLoader=5,e._loaders=[],e._loaderCount=0,e._resInfos=[],e._infoPool=[],e._maxPriority=5,e._failRes={},e._statInfo={count:1,loaded:1};for(var t=0;t<e._maxPriority;t++)e._resInfos[t]=[];return e}return y(_,[{key:"getProgress",value:function(){return this._statInfo.loaded/this._statInfo.count}},{key:"resetProgress",value:function(){this._statInfo.count=this._statInfo.loaded=1}},{key:"create",value:function(e){this._create(e,!0,1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,4<arguments.length&&void 0!==arguments[4]?arguments[4]:null,5<arguments.length&&void 0!==arguments[5]?arguments[5]:null,6<arguments.length&&void 0!==arguments[6]?arguments[6]:1,!(7<arguments.length&&void 0!==arguments[7])||arguments[7])}},{key:"_create",value:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null,s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:null,r=6<arguments.length&&void 0!==arguments[6]?arguments[6]:null,o=7<arguments.length&&void 0!==arguments[7]?arguments[7]:1,h=!(8<arguments.length&&void 0!==arguments[8])||arguments[8];if(e instanceof Array){var l,u=!0,c=e,_=c.length,f=0;n&&(l=x.create(n.caller,n?n.method:null,n.args,!1));for(var d=0;d<_;d++){var p=c[d];(p="string"==typeof p?c[d]={url:p}:p).progress=0}for(d=0;d<_;d++){var p=c[d],y=n?x.create(null,function(e,t){e.progress=t;for(var i=0,n=0;n<_;n++)i+=c[n].progress;l.runWith(i/_)},[p],!1):null,g=n||i?x.create(null,function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;f++,e.progress=1,t||(u=!1),f===_&&i&&i.runWith(u)},[p]):null;this._createOne(p.url,t,g,y,p.type||a,p.constructParams||s,p.propertyParams||r,p.priority||o,h)}}else this._createOne(e,t,i,n,a,s,r,o,h)}},{key:"_createOne",value:function(t,i){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null,s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:null,r=6<arguments.length&&void 0!==arguments[6]?arguments[6]:null,o=7<arguments.length&&void 0!==arguments[7]?arguments[7]:1,h=!(8<arguments.length&&void 0!==arguments[8])||arguments[8],l=this.getRes(t);l?(!i&&l instanceof oe&&l._addReference(),e&&e.runWith(1),n&&n.runWith(l)):(l=Se.getFileExtension(t),(a=a||(_.createMap[l]?_.createMap[l][0]:null))&&E.parserMap[a]?this._createLoad(t,x.create(null,function(e){e&&(!i&&e instanceof oe&&e._addReference(),e._setCreateURL(t)),n&&n.runWith(e),L.loader.event(t)}),e,a,s,r,o,h,!0):this.load(t,n,e,a,o,h))}},{key:"load",value:function(e){var t,i,n,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:1,h=!(5<arguments.length&&void 0!==arguments[5])||arguments[5],l=6<arguments.length&&void 0!==arguments[6]?arguments[6]:null,u=7<arguments.length&&void 0!==arguments[7]&&arguments[7],c=8<arguments.length&&void 0!==arguments[8]?arguments[8]:L.WorkerLoader.enable;return e instanceof Array?this._loadAssets(e,a,s,r,o,h,l):(t=(r===E.IMAGE?E.textureMap:E.loadedMap)[re.formatURL(e)],u||null==t?(i=e,(e=ki.getFileLoadPath(e))!=i&&"nativeimage"!==r?r=E.ATLAS:i=null,(n=_._resMap[e])?(a&&(i?a&&n._createListener(Me.COMPLETE,this,this._resInfoLoaded,[i,a],!1,!1):a&&n._createListener(Me.COMPLETE,a.caller,a.method,a.args,!1,!1)),s&&n._createListener(Me.PROGRESS,s.caller,s.method,s.args,!1,!1)):((n=this._infoPool.length?this._infoPool.pop():new bi).url=e,n.type=r,n.cache=h,n.group=l,n.ignoreCache=u,n.useWorkerLoader=c,n.originalUrl=i,a&&n.on(Me.COMPLETE,a.caller,a.method,a.args),s&&n.on(Me.PROGRESS,s.caller,s.method,s.args),_._resMap[e]=n,o=o<this._maxPriority?o:this._maxPriority-1,this._resInfos[o].push(n),this._statInfo.count++,this.event(Me.PROGRESS,this.getProgress()),this._next())):L.systemTimer.frameOnce(1,this,function(){s&&s.runWith(1),a&&a.runWith(t instanceof Array?[t]:t),this._loaderCount||this.event(Me.COMPLETE)}),this)}},{key:"_resInfoLoaded",value:function(e,t){t.runWith(E.getRes(e))}},{key:"_createLoad",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null,s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:null,r=6<arguments.length&&void 0!==arguments[6]?arguments[6]:1,o=!(7<arguments.length&&void 0!==arguments[7])||arguments[7],h=8<arguments.length&&void 0!==arguments[8]&&arguments[8];if(e instanceof Array)return this._loadAssets(e,t,i,n,r,o);var l,u=E.getRes(e);return null!=u?L.systemTimer.frameOnce(1,this,function(){i&&i.runWith(1),t&&t.runWith(u),this._loaderCount||this.event(Me.COMPLETE)}):(l=_._resMap[e])?(t&&l._createListener(Me.COMPLETE,t.caller,t.method,t.args,!1,!1),i&&l._createListener(Me.PROGRESS,i.caller,i.method,i.args,!1,!1)):((l=this._infoPool.length?this._infoPool.pop():new bi).url=e,l.type=n,l.cache=!1,l.ignoreCache=h,l.originalUrl=null,l.group=null,l.createCache=o,l.createConstructParams=a,l.createPropertyParams=s,t&&l.on(Me.COMPLETE,t.caller,t.method,t.args),i&&l.on(Me.PROGRESS,i.caller,i.method,i.args),_._resMap[e]=l,r=r<this._maxPriority?r:this._maxPriority-1,this._resInfos[r].push(l),this._statInfo.count++,this.event(Me.PROGRESS,this.getProgress()),this._next()),this}},{key:"_next",value:function(){if(!(this._loaderCount>=this.maxLoader)){for(var e=0;e<this._maxPriority;e++)for(var t=this._resInfos[e];0<t.length;){var i=t.shift();if(i)return this._doLoad(i)}this._loaderCount||this.event(Me.COMPLETE)}}},{key:"_doLoad",value:function(t){this._loaderCount++;var i=this._loaders.length?this._loaders.pop():new E,n=(i.on(Me.COMPLETE,null,a),i.on(Me.PROGRESS,null,function(e){t.event(Me.PROGRESS,e)}),i.on(Me.ERROR,null,function(e){a(null)}),this);function a(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;i.offAll(),i._data=null,i._customParse=!1,n._loaders.push(i),n._endLoad(t,e instanceof Array?[e]:e),n._loaderCount--,n._next()}i._constructParams=t.createConstructParams,i._propertyParams=t.createPropertyParams,i._createCache=t.createCache,i.load(t.url,t.type,t.cache,t.group,t.ignoreCache,t.useWorkerLoader)}},{key:"_endLoad",value:function(e,t){var i=e.url;if(null==t){var n=this._failRes[i]||0;if(n<this.retryNum)return console.warn("[warn]Retry to load:",i),this._failRes[i]=n+1,void L.systemTimer.once(this.retryDelay,this,this._addReTry,[e],!1);E.clearRes(i),console.warn("[error]Failed to load:",i),this.event(Me.ERROR,i)}this._failRes[i]&&(this._failRes[i]=0),delete _._resMap[i],e.originalUrl&&(t=E.getRes(e.originalUrl)),e.event(Me.COMPLETE,t),e.offAll(),this._infoPool.push(e),this._statInfo.loaded++,this.event(Me.PROGRESS,this.getProgress())}},{key:"_addReTry",value:function(e){this._resInfos[this._maxPriority-1].push(e),this._next()}},{key:"clearRes",value:function(e){E.clearRes(e)}},{key:"clearTextureRes",value:function(e){E.clearTextureRes(e)}},{key:"getRes",value:function(e){return E.getRes(e)}},{key:"cacheRes",value:function(e,t){E.cacheRes(e,t)}},{key:"setGroup",value:function(e,t){E.setGroup(e,t)}},{key:"clearResByGroup",value:function(e){E.clearResByGroup(e)}},{key:"clearUnLoaded",value:function(){for(var e=0;e<this._maxPriority;e++){for(var t=this._resInfos[e],i=t.length-1;-1<i;i--){var n=t[i];n&&(n.offAll(),this._infoPool.push(n))}t.length=0}this._loaderCount=0,_._resMap={}}},{key:"cancelLoadByUrls",value:function(e){if(e)for(var t=0,i=e.length;t<i;t++)this.cancelLoadByUrl(e[t])}},{key:"cancelLoadByUrl",value:function(e){for(var t=0;t<this._maxPriority;t++)for(var i=this._resInfos[t],n=i.length-1;-1<n;n--){var a=i[n];a&&a.url===e&&(i[n]=null,a.offAll(),this._infoPool.push(a))}_._resMap[e]&&delete _._resMap[e]}},{key:"_loadAssets",value:function(e){for(var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,t=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,n=4<arguments.length&&void 0!==arguments[4]?arguments[4]:1,a=!(5<arguments.length&&void 0!==arguments[5])||arguments[5],s=6<arguments.length&&void 0!==arguments[6]?arguments[6]:null,o=e.length,h=0,l=0,u=[],c=!0,_=0;_<o;_++){var f=e[_],d=void 0,f=((d="string"==typeof f?{url:f,type:t,size:1,priority:n}:f).size||(d.size=1),d.progress=0,l+=d.size,u.push(d),r?x.create(null,g,[d],!1):null),p=i||r?x.create(null,y,[d]):null;this.load(d.url,p,f,d.type,d.priority||1,a,d.group||s,!1,d.useWorkerLoader)}function y(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;h++,e.progress=1,t||(c=!1),h===o&&i&&i.runWith(c)}function g(e,t){if(null!=r){e.progress=t;for(var i=0,n=0;n<u.length;n++){var a,s=u[n];s&&(a=null==s.progress?0:s.progress,i+=null==s.size?0:s.size*a)}e=i/l;r.runWith(e)}}return this}},{key:"decodeBitmaps",value:function(e){for(var t=e.length,i=L.Render._context,n=0;n<t;n++){var a=E.getAtlas(e[n]);a?this._decodeTexture(a[0],i):(a=this.getRes(e[n]))&&a instanceof vt&&this._decodeTexture(a,i)}}},{key:"_decodeTexture",value:function(e,t){var i=e.bitmap;e&&i&&((e=i.source||i.image)&&e instanceof HTMLImageElement&&(t.drawImage(e,0,0,1,1),t.getImageData(0,0,1,1)))}}],[{key:"cacheRes",value:function(e,t){E.cacheRes(e,t)}}]),_}()),bi=(wi._resMap={},wi.createMap={atlas:[null,E.ATLAS]},function(){f(t,ae);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t)}()),Si=function(){function i(){b(this,i)}return y(i,null,[{key:"__init__",value:function(){return i._baseClass||(i._baseClass=Ii).init(),i.items=i._baseClass.items,i.support=i._baseClass.support}},{key:"setItem",value:function(e,t){i._baseClass.setItem(e,t)}},{key:"getItem",value:function(e){return i._baseClass.getItem(e)}},{key:"setJSON",value:function(e,t){i._baseClass.setJSON(e,t)}},{key:"getJSON",value:function(e){return i._baseClass.getJSON(e)}},{key:"removeItem",value:function(e){i._baseClass.removeItem(e)}},{key:"clear",value:function(){i._baseClass.clear()}}]),i}(),Ii=(Si.support=!1,function(){function i(){b(this,i)}return y(i,null,[{key:"init",value:function(){try{i.support=!0,i.items=window.localStorage,i.setItem("laya","1"),i.removeItem("laya")}catch(e){i.support=!1}i.support||console.log("LocalStorage is not supprot or browser is private mode.")}},{key:"setItem",value:function(e,t){try{i.support&&i.items.setItem(e,t)}catch(e){console.warn("set localStorage failed",e)}}},{key:"getItem",value:function(e){return i.support?i.items.getItem(e):null}},{key:"setJSON",value:function(e,t){try{i.support&&i.items.setItem(e,JSON.stringify(t))}catch(e){console.warn("set localStorage failed",e)}}},{key:"getJSON",value:function(t){try{return JSON.parse(i.support?i.items.getItem(t):null)}catch(e){return i.items.getItem(t)}}},{key:"removeItem",value:function(e){i.support&&i.items.removeItem(e)}},{key:"clear",value:function(){i.support&&i.items.clear()}}]),i}()),e=(Ii.support=!1,function(){function i(){b(this,i)}return y(i,[{key:"load",value:function(e){e=(this._url=e).split(".ttf")[0].split("/");this.fontName=e[e.length-1],L.Render.isConchApp?this._loadConch():window.FontFace?this._loadWithFontFace():this._loadWithCSS()}},{key:"_loadConch",value:function(){this._http=new xi,this._http.on(Me.ERROR,this,this._onErr),this._http.on(Me.COMPLETE,this,this._onHttpLoaded),this._http.send(this._url,null,"get",E.BUFFER)}},{key:"_onHttpLoaded",value:function(){window.conchTextCanvas.setFontFaceFromBuffer(this.fontName,0<arguments.length&&void 0!==arguments[0]?arguments[0]:null),this._clearHttp(),this._complete()}},{key:"_clearHttp",value:function(){this._http&&(this._http.off(Me.ERROR,this,this._onErr),this._http.off(Me.COMPLETE,this,this._onHttpLoaded),this._http=null)}},{key:"_onErr",value:function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)}},{key:"_complete",value:function(){L.systemTimer.clear(this,this._complete),L.systemTimer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)}},{key:"_checkComplete",value:function(){L.Browser.measureText(i._testString,this._fontTxt).width!=this._txtWidth&&this._complete()}},{key:"_loadWithFontFace",value:function(){var e=new window.FontFace(this.fontName,"url('"+this._url+"')"),t=(document.fonts.add(e),this);e.loaded.then(function(){t._complete()}),e.load()}},{key:"_createDiv",value:function(){this._div=I.createElement("div"),this._div.innerHTML="laya";var e=this._div.style;e.fontFamily=this.fontName,e.position="absolute",e.left="-100px",e.top="-100px",document.body.appendChild(this._div)}},{key:"_loadWithCSS",value:function(){var e=I.createElement("style"),t=(e.type="text/css",document.body.appendChild(e),e.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=I.measureText(i._testString,this._fontTxt).width,this);e.onload=function(){L.systemTimer.once(1e4,t,this._complete)},L.systemTimer.loop(20,this,this._checkComplete),this._createDiv()}}]),i}()),Ti=(e._testString="LayaTTFFont",function(){function o(){b(this,o)}return y(o,null,[{key:"linearNone",value:function(e,t,i,n){return i*e/n+t}},{key:"linearIn",value:function(e,t,i,n){return i*e/n+t}},{key:"linearInOut",value:function(e,t,i,n){return i*e/n+t}},{key:"linearOut",value:function(e,t,i,n){return i*e/n+t}},{key:"bounceIn",value:function(e,t,i,n){return i-o.bounceOut(n-e,0,i,n)+t}},{key:"bounceInOut",value:function(e,t,i,n){return e<.5*n?.5*o.bounceIn(2*e,0,i,n)+t:.5*o.bounceOut(2*e-n,0,i,n)+.5*i+t}},{key:"bounceOut",value:function(e,t,i,n){return(e/=n)<1/2.75?i*(7.5625*e*e)+t:e<2/2.75?i*(7.5625*(e-=1.5/2.75)*e+.75)+t:e<2.5/2.75?i*(7.5625*(e-=2.25/2.75)*e+.9375)+t:i*(7.5625*(e-=2.625/2.75)*e+.984375)+t}},{key:"backIn",value:function(e,t,i,n){var a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:1.70158;return i*(e/=n)*e*((a+1)*e-a)+t}},{key:"backInOut",value:function(e,t,i,n){var a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:1.70158;return(e/=.5*n)<1?.5*i*(e*e*((1+(a*=1.525))*e-a))+t:i/2*((e-=2)*e*((1+(a*=1.525))*e+a)+2)+t}},{key:"backOut",value:function(e,t,i,n){var a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:1.70158;return i*((e=e/n-1)*e*((a+1)*e+a)+1)+t}},{key:"elasticIn",value:function(e,t,i,n){var a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0;return 0==e?t:1==(e/=n)?t+i:(s=s||.3*n,i=!a||0<i&&a<i||i<0&&a<-i?(a=i,s/4):s/o.PI2*Math.asin(i/a),-(a*Math.pow(2,10*--e)*Math.sin((e*n-i)*o.PI2/s))+t)}},{key:"elasticInOut",value:function(e,t,i,n){var a,s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,r=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0;return 0==e?t:2==(e/=.5*n)?t+i:(r=r||n*(.3*1.5),a=!s||0<i&&s<i||i<0&&s<-i?(s=i,r/4):r/o.PI2*Math.asin(i/s),e<1?s*Math.pow(2,10*--e)*Math.sin((e*n-a)*o.PI2/r)*-.5+t:s*Math.pow(2,-10*--e)*Math.sin((e*n-a)*o.PI2/r)*.5+i+t)}},{key:"elasticOut",value:function(e,t,i,n){var a,s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,r=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0;return 0==e?t:1==(e/=n)?t+i:(r=r||.3*n,a=!s||0<i&&s<i||i<0&&s<-i?(s=i,r/4):r/o.PI2*Math.asin(i/s),s*Math.pow(2,-10*e)*Math.sin((e*n-a)*o.PI2/r)+i+t)}},{key:"strongIn",value:function(e,t,i,n){return i*(e/=n)*e*e*e*e+t}},{key:"strongInOut",value:function(e,t,i,n){return(e/=.5*n)<1?.5*i*e*e*e*e*e+t:.5*i*((e-=2)*e*e*e*e+2)+t}},{key:"strongOut",value:function(e,t,i,n){return i*((e=e/n-1)*e*e*e*e+1)+t}},{key:"sineInOut",value:function(e,t,i,n){return.5*-i*(Math.cos(Math.PI*e/n)-1)+t}},{key:"sineIn",value:function(e,t,i,n){return-i*Math.cos(e/n*o.HALF_PI)+i+t}},{key:"sineOut",value:function(e,t,i,n){return i*Math.sin(e/n*o.HALF_PI)+t}},{key:"quintIn",value:function(e,t,i,n){return i*(e/=n)*e*e*e*e+t}},{key:"quintInOut",value:function(e,t,i,n){return(e/=.5*n)<1?.5*i*e*e*e*e*e+t:.5*i*((e-=2)*e*e*e*e+2)+t}},{key:"quintOut",value:function(e,t,i,n){return i*((e=e/n-1)*e*e*e*e+1)+t}},{key:"quartIn",value:function(e,t,i,n){return i*(e/=n)*e*e*e+t}},{key:"quartInOut",value:function(e,t,i,n){return(e/=.5*n)<1?.5*i*e*e*e*e+t:.5*-i*((e-=2)*e*e*e-2)+t}},{key:"quartOut",value:function(e,t,i,n){return-i*((e=e/n-1)*e*e*e-1)+t}},{key:"cubicIn",value:function(e,t,i,n){return i*(e/=n)*e*e+t}},{key:"cubicInOut",value:function(e,t,i,n){return(e/=.5*n)<1?.5*i*e*e*e+t:.5*i*((e-=2)*e*e+2)+t}},{key:"cubicOut",value:function(e,t,i,n){return i*((e=e/n-1)*e*e+1)+t}},{key:"quadIn",value:function(e,t,i,n){return i*(e/=n)*e+t}},{key:"quadInOut",value:function(e,t,i,n){return(e/=.5*n)<1?.5*i*e*e+t:.5*-i*(--e*(e-2)-1)+t}},{key:"quadOut",value:function(e,t,i,n){return-i*(e/=n)*(e-2)+t}},{key:"expoIn",value:function(e,t,i,n){return 0==e?t:i*Math.pow(2,10*(e/n-1))+t-.001*i}},{key:"expoInOut",value:function(e,t,i,n){return 0==e?t:e==n?t+i:(e/=.5*n)<1?.5*i*Math.pow(2,10*(e-1))+t:.5*i*(2-Math.pow(2,-10*--e))+t}},{key:"expoOut",value:function(e,t,i,n){return e==n?t+i:i*(1-Math.pow(2,-10*e/n))+t}},{key:"circIn",value:function(e,t,i,n){return-i*(Math.sqrt(1-(e/=n)*e)-1)+t}},{key:"circInOut",value:function(e,t,i,n){return(e/=.5*n)<1?.5*-i*(Math.sqrt(1-e*e)-1)+t:.5*i*(Math.sqrt(1-(e-=2)*e)+1)+t}},{key:"circOut",value:function(e,t,i,n){return i*Math.sqrt(1-(e=e/n-1)*e)+t}}]),o}()),Ci=(Ti.HALF_PI=.5*Math.PI,Ti.PI2=2*Math.PI,function(){function u(){b(this,u),this.gid=0,this.repeat=1,this._count=0}return y(u,[{key:"to",value:function(e,t,i){return this._create(e,t,i,3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,4<arguments.length&&void 0!==arguments[4]?arguments[4]:null,5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,6<arguments.length&&void 0!==arguments[6]&&arguments[6],!0,!1,!0)}},{key:"from",value:function(e,t,i){return this._create(e,t,i,3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,4<arguments.length&&void 0!==arguments[4]?arguments[4]:null,5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,6<arguments.length&&void 0!==arguments[6]&&arguments[6],!1,!1,!0)}},{key:"_create",value:function(e,t,i,n,a,s,r,o,h,l){if(!e)throw new Error("Tween:target is null");this._target=e,this._duration=i,this._ease=n||t.ease||u.easeNone,this._complete=a||t.complete,this._delay=s,this._props=[],this._usedTimer=0,this._startTimer=I.now(),this._usedPool=h,this._delayParam=null,this.update=t.update;i=e.$_GID||(e.$_GID=Se.getGID());return u.tweenMap[i]?(r&&u.clearTween(e),u.tweenMap[i].push(this)):u.tweenMap[i]=[this],l?s<=0?this.firstStart(e,t,o):(this._delayParam=[e,t,o],L.timer.once(s,this,this.firstStart,this._delayParam)):this._initProps(e,t,o),this}},{key:"firstStart",value:function(e,t,i){this._delayParam=null,e.destroyed?this.clear():(this._initProps(e,t,i),this._beginLoop())}},{key:"_initProps",value:function(e,t,i){for(var n in t){var a,s;"number"==typeof e[n]&&(a=(i?e:t)[n],s=(i?t:e)[n],this._props.push([n,a,s-a]),i||(e[n]=a))}}},{key:"_beginLoop",value:function(){L.timer.frameLoop(1,this,this._doEase)}},{key:"_doEase",value:function(){this._updateEase(I.now())}},{key:"_updateEase",value:function(e){var t=this._target;if(t){if(t.destroyed)return u.clearTween(t);e=this._usedTimer=e-this._startTimer-this._delay;if(!(e<0)){if(e>=this._duration)return this.complete();for(var i=0<e?this._ease(e,0,1,this._duration):0,n=this._props,a=0,s=n.length;a<s;a++){var r=n[a];t[r[0]]=r[1]+i*r[2]}this.update&&this.update.run()}}}},{key:"progress",set:function(e){e*=this._duration;this._startTimer=I.now()-this._delay-e}},{key:"complete",value:function(){if(this._target){L.timer.runTimer(this,this.firstStart);for(var e=this._target,t=this._props,i=this._complete,n=0,a=t.length;n<a;n++){var s=t[n];e[s[0]]=s[1]+s[2]}this.update&&this.update.run(),this._count++,0!=this.repeat&&this._count>=this.repeat?(this.clear(),i&&i.run()):this.restart()}}},{key:"pause",value:function(){L.timer.clear(this,this._beginLoop),L.timer.clear(this,this._doEase),L.timer.clear(this,this.firstStart);var e=I.now()-this._startTimer-this._delay;e<0&&(this._usedTimer=e)}},{key:"setStartTime",value:function(e){this._startTimer=e}},{key:"clear",value:function(){this._target&&(this._remove(),this._clear())}},{key:"_clear",value:function(){this.pause(),L.timer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this.repeat=1,this._usedPool&&(this.update=null,p.recover("tween",this))}},{key:"recover",value:function(){this._usedPool=!0,this._clear()}},{key:"_remove",value:function(){var e=u.tweenMap[this._target.$_GID];if(e)for(var t=0,i=e.length;t<i;t++)if(e[t]===this){e.splice(t,1);break}}},{key:"restart",value:function(){if(this.pause(),this._usedTimer=0,this._startTimer=I.now(),this._delayParam)L.timer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var e=this._props,t=0,i=e.length;t<i;t++){var n=e[t];this._target[n[0]]=n[1]}L.timer.once(this._delay,this,this._beginLoop)}}},{key:"resume",value:function(){this._usedTimer>=this._duration||(this._startTimer=I.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?L.timer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())}}],[{key:"to",value:function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null,s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,r=6<arguments.length&&void 0!==arguments[6]&&arguments[6],o=!(7<arguments.length&&void 0!==arguments[7])||arguments[7];return p.getItemByClass("tween",u)._create(e,t,i,n,a,s,r,!0,o,!0)}},{key:"from",value:function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null,s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,r=6<arguments.length&&void 0!==arguments[6]&&arguments[6],o=!(7<arguments.length&&void 0!==arguments[7])||arguments[7];return p.getItemByClass("tween",u)._create(e,t,i,n,a,s,r,!1,o,!0)}},{key:"clearAll",value:function(e){if(e&&e.$_GID){var t=u.tweenMap[e.$_GID];if(t){for(var i=0,n=t.length;i<n;i++)t[i]._clear();t.length=0}}}},{key:"clear",value:function(e){e.clear()}},{key:"clearTween",value:function(e){u.clearAll(e)}},{key:"easeNone",value:function(e,t,i,n){return i*e/n+t}}]),u}()),t=(Ci.tweenMap=[],function(){function e(){b(this,e),this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}return y(e,[{key:"start",value:function(e,t,i,n,a,s,r){var o=7<arguments.length&&void 0!==arguments[7]?arguments[7]:.92;this.clearTimer(),this.target=e,this.area=t,this.hasInertia=i,this.elasticDistance=t?n:0,this.elasticBackTime=a,this.data=s,this._disableMouseEvent=r,this.ratio=o,this._parent=e.parent,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,L.stage.on(Me.MOUSE_UP,this,this.onStageMouseUp),L.stage.on(Me.MOUSE_OUT,this,this.onStageMouseUp),L.systemTimer.frameLoop(1,this,this.loop)}},{key:"clearTimer",value:function(){L.systemTimer.clear(this,this.loop),L.systemTimer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)}},{key:"stop",value:function(){this._dragging&&(si.instance.disableMouseEvent=!1,L.stage.off(Me.MOUSE_UP,this,this.onStageMouseUp),L.stage.off(Me.MOUSE_OUT,this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())}},{key:"loop",value:function(){var e=this._parent.getMousePoint(),t=e.x,e=e.y,i=t-this._lastX,n=e-this._lastY;if(this._clickOnly){if(!(1<Math.abs(i*L.stage._canvasTransform.getScaleX())||1<Math.abs(n*L.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event(Me.DRAG_START,this.data),si.instance.disableMouseEvent=this._disableMouseEvent}else this._offsets.push(i,n);0==i&&0==n||(this._lastX=t,this._lastY=e,this.target.x+=i*this._elasticRateX,this.target.y+=n*this._elasticRateY,this.area&&this.checkArea(),this.target.event(Me.DRAG_MOVE,this.data))}},{key:"checkArea",value:function(){var e;this.elasticDistance<=0?this.backToArea():(e=this.target._x<this.area.x?this.area.x-this.target._x:this.target._x>this.area.x+this.area.width?this.target._x-this.area.x-this.area.width:0,this._elasticRateX=Math.max(0,1-e/this.elasticDistance),e=this.target._y<this.area.y?this.area.y-this.target.y:this.target._y>this.area.y+this.area.height?this.target._y-this.area.y-this.area.height:0,this._elasticRateY=Math.max(0,1-e/this.elasticDistance))}},{key:"backToArea",value:function(){this.target.x=Math.min(Math.max(this.target._x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target._y,this.area.y),this.area.y+this.area.height)}},{key:"onStageMouseUp",value:function(e){if(si.instance.disableMouseEvent=!1,L.stage.off(Me.MOUSE_UP,this,this.onStageMouseUp),L.stage.off(Me.MOUSE_OUT,this,this.onStageMouseUp),L.systemTimer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var t=this._offsets.length,i=Math.min(t,6),n=this._offsets.length-i,a=t-1;n<a;a--)this._offsetY+=this._offsets[a--],this._offsetX+=this._offsets[a];this._offsetX=this._offsetX/i*2,this._offsetY=this._offsetY/i*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),L.systemTimer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()}},{key:"checkElastic",value:function(){var e,t=NaN,i=NaN;this.target.x<this.area.x?t=this.area.x:this.target._x>this.area.x+this.area.width&&(t=this.area.x+this.area.width),this.target.y<this.area.y?i=this.area.y:this.target._y>this.area.y+this.area.height&&(i=this.area.y+this.area.height),isNaN(t)&&isNaN(i)?this.clear():(e={},isNaN(t)||(e.x=t),isNaN(i)||(e.y=i),this._tween=Ci.to(this.target,e,this.elasticBackTime,Ti.sineOut,x.create(this,this.clear),0,!1,!1))}},{key:"tweenMove",value:function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event(Me.DRAG_MOVE,this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&(L.systemTimer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())}},{key:"clear",value:function(){var e;this.target&&(this.clearTimer(),e=this.target,this.target=null,this._parent=null,e.event(Me.DRAG_END,this.data))}}]),e}()),Mi=function(){function e(){b(this,e),this._id=Se.getGID(),this._resetComp()}return y(e,[{key:"id",get:function(){return this._id}},{key:"enabled",get:function(){return this._enabled},set:function(e){this._enabled!=e&&(this._enabled=e,this.owner&&(e?this.owner.activeInHierarchy&&this._onEnable():this.owner.activeInHierarchy&&this._onDisable()))}},{key:"isSingleton",get:function(){return!0}},{key:"destroyed",get:function(){return this._destroyed}},{key:"_isScript",value:function(){return!1}},{key:"_resetComp",value:function(){this._indexInList=-1,this._enabled=!0,this._awaked=!1,this.owner=null}},{key:"_getIndexInList",value:function(){return this._indexInList}},{key:"_setIndexInList",value:function(e){this._indexInList=e}},{key:"_onAdded",value:function(){}},{key:"_onAwake",value:function(){}},{key:"_onEnable",value:function(){}},{key:"_onDisable",value:function(){}},{key:"_onDestroy",value:function(){}},{key:"onReset",value:function(){}},{key:"_parse",value:function(e){}},{key:"_cloneTo",value:function(e){}},{key:"_setActive",value:function(e){e?(this._awaked||(this._awaked=!0,this._onAwake()),this._enabled&&this._onEnable()):this._enabled&&this._onDisable()}},{key:"destroy",value:function(){this.owner&&this.owner._destroyComponent(this)}},{key:"_destroy",value:function(){this.owner.activeInHierarchy&&this._enabled&&this._setActive(!1),this._onDestroy(),this._destroyed=!0,this.onReset!==e.prototype.onReset?(this.onReset(),this._resetComp(),p.recoverByClass(this)):this._resetComp()}}]),e}(),Ei=function(){f(n,N);var t=T(n);function n(){var e;return b(this,n),(e=t.call(this)).wrapMode=0,e._interval=Fe.animationInterval,e._isReverse=!1,e._frameRateChanged=!1,e._setBitUp(Ht.DISPLAY),e}return y(n,[{key:"play",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"";this._isPlaying=!0,this._actionName=i,this.index="string"==typeof e?this._getFrameByLabel(e):e,this.loop=t,this._isReverse=this.wrapMode===n.WRAP_REVERSE,0==this.index&&this._isReverse&&(this.index=this.count-1),0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)}},{key:"interval",get:function(){return this._interval},set:function(e){this._interval!=e&&(this._frameRateChanged=!0,this._interval=e,this._isPlaying&&0<e&&this.timerLoop(e,this,this._frameLoop,null,!0,!0))}},{key:"_getFrameByLabel",value:function(e){for(var t=0;t<this._count;t++){var i=this._labels[t];if(i&&-1<i.indexOf(e))return t}return 0}},{key:"_frameLoop",value:function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event(Me.COMPLETE);this.wrapMode==n.WRAP_PINGPONG?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event(Me.COMPLETE)}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event(Me.COMPLETE);this.wrapMode==n.WRAP_PINGPONG?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event(Me.COMPLETE)}this.index=this._index}},{key:"_setControlNode",value:function(e){this._controlNode&&(this._controlNode.off(Me.DISPLAY,this,this._resumePlay),this._controlNode.off(Me.UNDISPLAY,this,this._resumePlay)),(this._controlNode=e)&&e!=this&&(e.on(Me.DISPLAY,this,this._resumePlay),e.on(Me.UNDISPLAY,this,this._resumePlay))}},{key:"_setDisplay",value:function(e){m(g(n.prototype),"_setDisplay",this).call(this,e),this._resumePlay()}},{key:"_resumePlay",value:function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))}},{key:"stop",value:function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)}},{key:"isPlaying",get:function(){return this._isPlaying}},{key:"addLabel",value:function(e,t){this._labels||(this._labels={}),this._labels[t]||(this._labels[t]=[]),this._labels[t].push(e)}},{key:"removeLabel",value:function(e){if(e){if(this._labels)for(var t in this._labels)this._removeLabelFromList(this._labels[t],e)}else this._labels=null}},{key:"_removeLabelFromList",value:function(e,t){if(e)for(var i=e.length-1;0<=i;i--)e[i]==t&&e.splice(i,1)}},{key:"gotoAndStop",value:function(e){this.index="string"==typeof e?this._getFrameByLabel(e):e,this.stop()}},{key:"index",get:function(){return this._index},set:function(e){if(this._index=e,this._displayToIndex(e),this._labels&&this._labels[e])for(var t=this._labels[e],i=0,n=t.length;i<n;i++)this.event(Me.LABEL,t[i])}},{key:"_displayToIndex",value:function(e){}},{key:"count",get:function(){return this._count}},{key:"clear",value:function(){return this.stop(),this._labels=null,this}}]),n}(),Ri=(Ei.WRAP_POSITIVE=0,Ei.WRAP_REVERSE=1,Ei.WRAP_PINGPONG=2,M.regClass("laya.display.AnimationBase",Ei),M.regClass("Laya.AnimationBase",Ei),function(){function a(){b(this,a)}return y(a,null,[{key:"subtractVector3",value:function(e,t,i){i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2]}},{key:"lerp",value:function(e,t,i){return e*(1-i)+t*i}},{key:"scaleVector3",value:function(e,t,i){i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t}},{key:"lerpVector3",value:function(e,t,i,n){var a=e[0],s=e[1],e=e[2];n[0]=a+i*(t[0]-a),n[1]=s+i*(t[1]-s),n[2]=e+i*(t[2]-e)}},{key:"lerpVector4",value:function(e,t,i,n){var a=e[0],s=e[1],r=e[2],e=e[3];n[0]=a+i*(t[0]-a),n[1]=s+i*(t[1]-s),n[2]=r+i*(t[2]-r),n[3]=e+i*(t[3]-e)}},{key:"slerpQuaternionArray",value:function(e,t,i,n,a,s,r){var o,h,l=e[t+0],u=e[t+1],c=e[t+2],e=e[t+3],t=i[n+0],_=i[n+1],f=i[n+2],i=i[n+3],n=l*t+u*_+c*f+e*i;return n<0&&(n=-n,t=-t,_=-_,f=-f,i=-i),n=1e-6<1-n?(n=Math.acos(n),o=Math.sin(n),h=Math.sin((1-a)*n)/o,Math.sin(a*n)/o):(h=1-a,a),s[r+0]=h*l+n*t,s[r+1]=h*u+n*_,s[r+2]=h*c+n*f,s[r+3]=h*e+n*i,s}},{key:"getRotation",value:function(e,t,i,n){return Math.atan2(n-t,i-e)/Math.PI*180}},{key:"sortBigFirst",value:function(e,t){return e==t?0:e<t?1:-1}},{key:"sortSmallFirst",value:function(e,t){return e==t?0:e<t?-1:1}},{key:"sortNumBigFirst",value:function(e,t){return parseFloat(t)-parseFloat(e)}},{key:"sortNumSmallFirst",value:function(e,t){return parseFloat(e)-parseFloat(t)}},{key:"sortByKey",value:function(i){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1],t=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],n=e?t?a.sortNumBigFirst:a.sortBigFirst:t?a.sortNumSmallFirst:a.sortSmallFirst;return function(e,t){return n(e[i],t[i])}}}]),a}()),l=function(){f(i,Ei);var t=T(i);function i(){var e;return b(this,i),e=t.call(this),null===i._sortIndexFun&&(i._sortIndexFun=Ri.sortByKey("index",!1,!0)),e}return y(i,[{key:"_setUp",value:function(e,t){this._targetDic=e,this._animationData=t,this.interval=1e3/t.frameRate,t.parsed?(this._count=t.count,this._labels=t.labels,this._usedFrames=t.animationNewFrames):(this._usedFrames=[],this._calculateDatas(),t.parsed=!0,t.labels=this._labels,t.count=this._count,t.animationNewFrames=this._usedFrames)}},{key:"clear",value:function(){return m(g(i.prototype),"clear",this).call(this),this._targetDic=null,this._animationData=null,this}},{key:"_displayToIndex",value:function(e){if(this._animationData){(e=e<0?0:e)>this._count&&(e=this._count);for(var t=this._animationData.nodes,i=t.length,n=0;n<i;n++)this._displayNodeToFrame(t[n],e)}}},{key:"_displayNodeToFrame",value:function(e,t){var i=((2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)||this._targetDic)[e.target];if(i){for(var n,a,s=e.frames,r=e.keys,o=r.length,h=0;h<o;h++)a=(a=s[n=r[h]]).length>t?a[t]:a[a.length-1],i[n]=a;var l,u=e.funkeys,o=u.length;if(0!=o)for(h=0;h<o;h++)void 0!==(l=s[n=u[h]])[t]&&i[n]&&i[n].apply(i,l[t])}}},{key:"_calculateDatas",value:function(){if(this._animationData){for(var e,t=this._animationData.nodes,i=t.length,n=this._count=0;n<i;n++)e=t[n],this._calculateKeyFrames(e);this._count+=1}}},{key:"_calculateKeyFrames",value:function(e){var t,i=e.keyframes,n=e.target;for(t in e.frames||(e.frames={}),e.keys?e.keys.length=0:e.keys=[],e.funkeys?e.funkeys.length=0:e.funkeys=[],e.initValues||(e.initValues={}),i){var a=-1!=t.indexOf("()"),s=i[t];if(a&&(t=t.substr(0,t.length-2)),e.frames[t]||(e.frames[t]=[]),a){e.funkeys.push(t);for(var r=e.frames[t],o=0;o<s.length;o++){var h=s[o];r[h.index]=h.value,h.index>this._count&&(this._count=h.index)}}else this._targetDic&&this._targetDic[n]&&(e.initValues[t]=this._targetDic[n][t]),e.keys.push(t),this._calculateNodePropFrames(s,e.frames[t],t,n)}}},{key:"resetNodes",value:function(){if(this._targetDic&&this._animationData)for(var e,t,i=this._animationData.nodes,n=i.length,a=0;a<n;a++)if(t=(e=i[a]).initValues){var s,r=this._targetDic[e.target];if(r)for(s in t)r[s]=t[s]}}},{key:"_calculateNodePropFrames",value:function(e,t,i,n){var a,s=e.length-1;for(t.length=e[s].index+1,a=0;a<s;a++)this._dealKeyFrame(e[a]),this._calculateFrameValues(e[a],e[a+1],t);0==s&&(t[0]=e[0].value,this._usedFrames&&(this._usedFrames[e[0].index]=!0)),this._dealKeyFrame(e[a])}},{key:"_dealKeyFrame",value:function(e){e.label&&""!=e.label&&this.addLabel(e.label,e.index)}},{key:"_calculateFrameValues",value:function(e,t,i){var n,a,s=e.index,r=t.index,o=e.value,h=t.value-e.value,l=r-s,u=this._usedFrames;if(r>this._count&&(this._count=r),e.tween)for(null==(a=Ti[e.tweenMethod])&&(a=Ti.linearNone),n=s;n<r;n++)i[n]=a(n-s,o,h,l),u&&(u[n]=!0);else for(n=s;n<r;n++)i[n]=o;u&&(u[e.index]=!0,u[t.index]=!0),i[t.index]=t.value}}]),i}(),Ai=(M.regClass("laya.display.FrameAnimation",l),M.regClass("Laya.FrameAnimation",l),function(){function i(){b(this,i),this._obj={},i._maps.push(this)}return y(i,[{key:"set",value:function(e,t){null==e||i.supportWeakMap||("string"==typeof e||"number"==typeof e?this._obj[e]=t:(e.$_GID||(e.$_GID=Se.getGID()),this._obj[e.$_GID]=t))}},{key:"get",value:function(e){return null==e?null:i.supportWeakMap?void 0:"string"==typeof e||"number"==typeof e?this._obj[e]:this._obj[e.$_GID]}},{key:"del",value:function(e){null==e||i.supportWeakMap||("string"==typeof e||"number"==typeof e?delete this._obj[e]:delete this._obj[this._obj.$_GID])}},{key:"has",value:function(e){return null!=e&&(i.supportWeakMap?void 0:"string"==typeof e||"number"==typeof e?null!=this._obj[e]:null!=this._obj[this._obj.$_GID])}}],[{key:"__init__",value:function(){i.I=new i,i.supportWeakMap||L.systemTimer.loop(i.delInterval,null,i.clearCache)}},{key:"clearCache",value:function(){for(var e=0,t=i._maps.length;e<t;e++)i._maps[e]._obj={}}}]),i}()),Li=(Ai.supportWeakMap=!1,Ai.delInterval=6e5,Ai._maps=[],function(){function g(){b(this,g)}return y(g,null,[{key:"__init",value:function(){g._funMap=new Ai}},{key:"getBindFun",value:function(e){var t,i=g._funMap.get(e);return null==i&&(t=(t='"'+e+'"').replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'),i=window.Laya._runScript("(function(data){if(data==null)return;with(data){try{\nreturn "+t+"\n}catch(e){}}})"),g._funMap.set(e,i)),i}},{key:"createByData",value:function(e,t){var i=Pi.create();if((e=g.createComp(t,e,e,null,i))._setBit(Ht.NOT_READY,!0),"_idMap"in e&&(e._idMap=i._idMap),t.animations){for(var n,a,s=[],r=t.animations,o=r.length,h=0;h<o;h++){switch(n=new l,a=r[h],n._setUp(i._idMap,a),(e[a.name]=n)._setControlNode(e),a.action){case 1:n.play(0,!1);break;case 2:n.play(0,!0)}s.push(n)}e._aniList=s}return"Scene"===e._$componentType&&0<e._width&&null==t.props.hitTestPrior&&!e.mouseThrough&&(e.hitTestPrior=!0),i.beginLoad(e),e}},{key:"createInitTool",value:function(){return Pi.create()}},{key:"createComp",value:function(e){var t,i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,s=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,r=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null;if("Scene3D"==e.type||"Sprite3D"==e.type)return i=L.Laya.Utils3D._createSceneByJsonForMaker(e,t=[],r),"Sprite3D"==e.type?L.Laya.StaticBatchManager.combine(i,t):L.Laya.StaticBatchManager.combine(null,t),i;if(!(n=n||g.getCompInstance(e)))return e.props&&e.props.runtime?console.warn("runtime not found:"+e.props.runtime):console.warn("can not create:"+e.type),null;var o=e.child;if(o)for(var h="List"==n._$componentType,l=0,u=o.length;l<u;l++){var c,_,f=o[l];"itemRender"in n&&("render"==f.props.name||"render"===f.props.renderType)?n.itemRender=f:"Graphic"==f.type?L.ClassUtils._addGraphicsToSprite(f,n):L.ClassUtils._isDrawType(f.type)?L.ClassUtils._addGraphicToSprite(f,n,!0):(h?(_=g.createComp(f,null,a,c=[],r),c.length&&(_._$bindData=c)):_=g.createComp(f,null,a,s,r),"Script"==f.type?_ instanceof Mi?n._addComponentInstance(_):"owner"in _?_.owner=n:"target"in _&&(_.target=n):"mask"==f.props.renderType||"mask"==f.props.name?n.mask=_:_ instanceof ei&&n.addChild(_))}var d,p=e.props;for(d in p){var y=p[d];"string"==typeof y&&(0<=y.indexOf("@node:")||0<=y.indexOf("@Prefab:"))?r&&r.addNodeRef(n,d,y):g.setCompValue(n,d,y,a,s)}return n._afterInited&&n._afterInited(),e.compId&&r&&r._idMap&&(r._idMap[e.compId]=n),n}},{key:"setCompValue",value:function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null;if("string"==typeof i&&-1<i.indexOf("${"))if(g._sheet=g._sheet?g._sheet:L.ClassUtils.getClass("laya.data.Table")){if(a)a.push(e,t,i);else if(n){-1==i.indexOf("].")&&(i=i.replace(".","[0]."));for(var s,r=new Ni(e,t,i),o=(r.exe(n),i.replace(/\[.*?\]\./g,"."));null!=(s=g._parseWatchData.exec(o));){for(var h=s[1];null!=(l=g._parseKeyWord.exec(h));){var l=l[0],u=n._watchMap[l]||(n._watchMap[l]=[]);u.push(r),g._sheet.I.notifer.on(l,n,n.changeData,[l])}(u=n._watchMap[h]||(n._watchMap[h]=[])).push(r),g._sheet.I.notifer.on(h,n,n.changeData,[h])}}}else console.warn("Can not find class Sheet");else"var"===t&&n?n[i]=e:e[t]="true"===i||"false"!==i&&i}},{key:"getCompInstance",value:function(e){if("UIView"==e.type&&e.props&&e.props.pageData)return g.createByData(null,e.props.pageData);var t,i=e.props&&e.props.runtime||e.type,n=L.ClassUtils.getClass(i);if(n)return"Script"===e.type&&n.prototype._doAwake?((t=p.createByClass(n))._destroyed=!1,t):e.props&&"renderType"in e.props&&"instance"==e.props.renderType?(n.instance||(n.instance=new n),n.instance):new n;throw"Can not find class "+i}}]),g}()),Ni=(Li._parseWatchData=/\${(.*?)}/g,Li._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g,function(){function n(e,t,i){b(this,n),this.comp=e,this.prop=t,this.value=i}return y(n,[{key:"exe",value:function(e){var t=Li.getBindFun(this.value);this.comp[this.prop]=t.call(this,e)}}]),n}()),Pi=function(){function t(){b(this,t)}return y(t,[{key:"reset",value:function(){this._nodeRefList=null,this._initList=null,this._idMap=null,this._loadList=null,this._scene=null}},{key:"recover",value:function(){this.reset(),p.recover("InitTool",this)}},{key:"addLoadRes",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;this._loadList||(this._loadList=[]),t?this._loadList.push({url:e,type:t}):this._loadList.push(e)}},{key:"addNodeRef",value:function(e,t,i){this._nodeRefList||(this._nodeRefList=[]),this._nodeRefList.push([e,t,i]),0<=i.indexOf("@Prefab:")&&this.addLoadRes(i.replace("@Prefab:",""),E.PREFAB)}},{key:"setNodeRef",value:function(){if(this._nodeRefList)if(this._idMap){for(var e,t=this._nodeRefList.length,i=0;i<t;i++)(e=this._nodeRefList[i])[0][e[1]]=this.getReferData(e[2]);this._nodeRefList=null}else this._nodeRefList=null}},{key:"getReferData",value:function(e){if(0<=e.indexOf("@Prefab:"))return E.getRes(e.replace("@Prefab:",""));if(0<=e.indexOf("@arr:")){for(var t,i,n=(t=(e=e.replace("@arr:","")).split(",")).length,a=0;a<n;a++)i=t[a],t[a]=i?this._idMap[i.replace("@node:","")]:null;return t}return this._idMap[e.replace("@node:","")]}},{key:"addInitItem",value:function(e){this._initList||(this._initList=[]),this._initList.push(e)}},{key:"doInits",value:function(){this._initList&&(this._initList=null)}},{key:"finish",value:function(){this.setNodeRef(),this.doInits(),this._scene._setBit(Ht.NOT_READY,!1),this._scene.parent&&this._scene.parent.activeInHierarchy&&this._scene.active&&this._scene._processActive(),this._scene.event("onViewCreated"),this.recover()}},{key:"beginLoad",value:function(e){this._scene=e,!this._loadList||this._loadList.length<1?this.finish():L.loader.load(this._loadList,x.create(this,this.finish))}}],[{key:"create",value:function(){var e=p.getItemByClass("InitTool",t);return e._idMap=[],e}}]),t}(),Bi=function(){function e(){b(this,e)}return y(e,[{key:"show",value:function(){}},{key:"enable",value:function(){}},{key:"hide",value:function(){}},{key:"set_onclick",value:function(e){}},{key:"isCanvasRender",value:function(){return!0}},{key:"renderNotCanvas",value:function(e,t,i){}}]),e}(),Di=function(){f(r,Bi);var t=T(r);function r(){var e;return b(this,r),(e=t.apply(this,arguments))._show=!1,e._useCanvas=!1,e._height=100,e._view=[],e}return y(r,[{key:"show",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;I.onMiniGame||L.Render.isConchApp||I.onBDMiniGame||I.onKGMiniGame||I.onQGMiniGame||I.onQQMiniGame||I.onAlipayMiniGame||(this._useCanvas=!0),this._show=!0,k._fpsData.length=60,this._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},this._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},this._view[2]={title:"RenderBatches",value:"renderBatches",color:"white",units:"int"},this._view[3]={title:"SavedRenderBatches",value:"savedRenderBatches",color:"white",units:"int"},this._view[4]={title:"CPUMemory",value:"cpuMemory",color:"yellow",units:"M"},this._view[5]={title:"GPUMemory",value:"gpuMemory",color:"yellow",units:"M"},this._view[6]={title:"Shader",value:"shaderCall",color:"white",units:"int"},Bt.is3DMode?(this._view[0].title="FPS(3D)",this._view[7]={title:"TriFaces",value:"trianglesFaces",color:"white",units:"int"},this._view[8]={title:"FrustumCulling",value:"frustumCulling",color:"white",units:"int"},this._view[9]={title:"OctreeNodeCulling",value:"octreeNodeCulling",color:"white",units:"int"}):(this._view[0].title="FPS(WebGL)",this._view[7]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"}),this._useCanvas?this.createUIPre(e,t):this.createUI(e,t),this.enable()}},{key:"createUIPre",value:function(e,t){var i=I.pixelRatio;this._width=180*i,this._vx=120*i,this._height=i*(12*this._view.length+3*i)+4,r._fontSize=12*i;for(var n=0;n<this._view.length;n++)this._view[n].x=4,this._view[n].y=n*r._fontSize+2*i;this._canvas||(this._canvas=new Kt(!0),this._canvas.size(this._width,this._height),this._ctx=this._canvas.getContext("2d"),this._ctx.textBaseline="top",this._ctx.font=r._fontSize+"px Arial",this._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+e+"px;top:"+t+"px;width:"+this._width/i+"px;height:"+this._height/i+"px;"),I.onKGMiniGame||I.container.appendChild(this._canvas.source),this._first=!0,this.loop(),this._first=!1}},{key:"createUI",value:function(e,t){for(var i=this._sp,n=I.pixelRatio,a=(i||(i=new N,this._leftText=new ii,this._leftText.pos(5,5),this._leftText.color="#ffffff",i.addChild(this._leftText),this._txt=new ii,this._txt.pos(130*n,5),this._txt.color="#ffffff",i.addChild(this._txt),this._sp=i),i.pos(e,t),""),s=0;s<this._view.length;s++)a+=this._view[s].title+"\n";this._leftText.text=a;e=138*n,t=n*(12*this._view.length+3*n)+4;this._txt.fontSize=r._fontSize*n,this._leftText.fontSize=r._fontSize*n,i.size(e,t),i.graphics.clear(),i.graphics.alpha(.5),i.graphics.drawRect(0,0,110+e,30+t,"#999999"),i.graphics.alpha(2),this.loop()}},{key:"enable",value:function(){L.systemTimer.frameLoop(1,this,this.loop)}},{key:"hide",value:function(){this._show=!1,L.systemTimer.clear(this,this.loop),this._canvas&&I.removeElement(this._canvas.source)}},{key:"set_onclick",value:function(e){this._sp&&this._sp.on("click",this._sp,e),this._canvas&&(this._canvas.source.onclick=e,this._canvas.source.style.pointerEvents="")}},{key:"loop",value:function(){k._count++;var e,t=I.now();t-k._timer<1e3||(e=k._count,k.FPS=Math.round(1e3*e/(t-k._timer)),this._show&&(k.trianglesFaces=Math.round(k.trianglesFaces/e),this._useCanvas?k.renderBatches=Math.round(k.renderBatches/e):k.renderBatches=Math.round(k.renderBatches/e)-1,k.savedRenderBatches=Math.round(k.savedRenderBatches/e),k.shaderCall=Math.round(k.shaderCall/e),k.spriteRenderUseCacheCount=Math.round(k.spriteRenderUseCacheCount/e),k.canvasNormal=Math.round(k.canvasNormal/e),k.canvasBitmap=Math.round(k.canvasBitmap/e),k.canvasReCache=Math.ceil(k.canvasReCache/e),k.frustumCulling=Math.round(k.frustumCulling/e),k.octreeNodeCulling=Math.round(k.octreeNodeCulling/e),e=0<k.FPS?Math.floor(1e3/k.FPS).toString():" ",k._fpsStr=k.FPS+(k.renderSlow?" slow":"")+" "+e,k._spriteStr=k.spriteCount+(k.spriteRenderUseCacheCount?"/"+k.spriteRenderUseCacheCount:""),k._canvasStr=k.canvasReCache+"/"+k.canvasNormal+"/"+k.canvasBitmap,k.cpuMemory=oe.cpuMemory,k.gpuMemory=oe.gpuMemory,this._useCanvas?this.renderInfoPre():this.renderInfo(),k.clear()),k._count=0,k._timer=t)}},{key:"renderInfoPre",value:function(){var e,t,i=0;if(this._canvas){var n=this._ctx;for(n.clearRect(this._first?0:this._vx,0,this._width,this._height),i=0;i<this._view.length;i++)e=this._view[i],this._first&&(n.fillStyle="white",n.fillText(e.title,e.x,e.y)),n.fillStyle=e.color,t=k[e.value],"M"==e.units&&(t=Math.floor(t/1048576*100)/100+" M"),n.fillText(t+"",e.x+this._vx,e.y)}}},{key:"renderInfo",value:function(){for(var e="",t=0;t<this._view.length;t++){var i=this._view[t],n=k[i.value];"M"==i.units&&(n=Math.floor(n/1048576*100)/100+" M"),e+=(n="K"==i.units?Math.floor(n/1024*100)/100+" K":n)+"\n"}this._txt.text=e}},{key:"isCanvasRender",value:function(){return this._useCanvas}},{key:"renderNotCanvas",value:function(e,t,i){this._show&&this._sp&&this._sp.render(e,0,0)}}]),r}(),Oi=(Di._fontSize=12,function(){function h(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];b(this,h),this.scale=1,this.currTimer=Date.now(),this.currFrame=0,this._delta=0,this._lastTimer=Date.now(),this._map=[],this._handlers=[],this._temp=[],this._count=0,e&&h.gSysTimer&&h.gSysTimer.frameLoop(1,this,this._update)}return y(h,[{key:"delta",get:function(){return this._delta}},{key:"_update",value:function(){if(this.scale<=0)return this._lastTimer=Date.now(),void(this._delta=0);for(var e=this.currFrame=this.currFrame+this.scale,t=Date.now(),i=3e4<t-this._lastTimer,n=(this._delta=(t-this._lastTimer)*this.scale,this.currTimer=this.currTimer+this._delta),a=(this._lastTimer=t,this._handlers),s=this._count=0,r=a.length;s<r;s++){var o=a[s];if(null!==o.method){var h=o.userFrame?e:n;if(h>=o.exeTime)if(o.repeat)if(!o.jumpFrame||i)o.exeTime+=o.delay,o.run(!1),h>o.exeTime&&(o.exeTime+=Math.ceil((h-o.exeTime)/o.delay)*o.delay);else for(;h>=o.exeTime;)o.exeTime+=o.delay,o.run(!1);else o.run(!0)}else this._count++}(30<this._count||e%200==0)&&this._clearHandlers()}},{key:"_clearHandlers",value:function(){for(var e=this._handlers,t=0,i=e.length;t<i;t++){var n=e[t];null!==n.method?this._temp.push(n):this._recoverHandler(n)}this._handlers=this._temp,e.length=0,this._temp=e}},{key:"_recoverHandler",value:function(e){this._map[e.key]==e&&(this._map[e.key]=null),e.clear(),h._pool.push(e)}},{key:"_create",value:function(e,t,i,n,a,s,r){if(!i)return a.apply(n,s),null;if(r){var o=this._getHandler(n,a);if(o)return o.repeat=t,o.userFrame=e,o.delay=i,o.caller=n,o.method=a,o.args=s,o.exeTime=i+(e?this.currFrame:this.currTimer+Date.now()-this._lastTimer),o}return(o=0<h._pool.length?h._pool.pop():new Fi).repeat=t,o.userFrame=e,o.delay=i,o.caller=n,o.method=a,o.args=s,o.exeTime=i+(e?this.currFrame:this.currTimer+Date.now()-this._lastTimer),this._indexHandler(o),this._handlers.push(o),o}},{key:"_indexHandler",value:function(e){var t=e.caller,i=e.method,t=t?t.$_GID||(t.$_GID=L.Utils.getGID()):0,i=i.$_TID||(i.$_TID=1e5*h._mid++);e.key=t+i,this._map[e.key]=e}},{key:"once",value:function(e,t,i){this._create(!1,!1,e,t,i,3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,!(4<arguments.length&&void 0!==arguments[4])||arguments[4])}},{key:"loop",value:function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,a=!(4<arguments.length&&void 0!==arguments[4])||arguments[4],s=5<arguments.length&&void 0!==arguments[5]&&arguments[5],e=this._create(!1,!0,e,t,i,n,a);e&&(e.jumpFrame=s)}},{key:"frameOnce",value:function(e,t,i){this._create(!0,!1,e,t,i,3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,!(4<arguments.length&&void 0!==arguments[4])||arguments[4])}},{key:"frameLoop",value:function(e,t,i){this._create(!0,!0,e,t,i,3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,!(4<arguments.length&&void 0!==arguments[4])||arguments[4])}},{key:"toString",value:function(){return" handlers:"+this._handlers.length+" pool:"+h._pool.length}},{key:"clear",value:function(e,t){e=this._getHandler(e,t);e&&(this._map[e.key]=null,e.key=0,e.clear())}},{key:"clearAll",value:function(e){if(e)for(var t=0,i=this._handlers.length;t<i;t++){var n=this._handlers[t];n.caller===e&&(this._map[n.key]=null,n.key=0,n.clear())}}},{key:"_getHandler",value:function(e,t){e=e?e.$_GID||(e.$_GID=L.Utils.getGID()):0,t=t.$_TID||(t.$_TID=1e5*h._mid++);return this._map[e+t]}},{key:"callLater",value:function(e,t){ri.I.callLater(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)}},{key:"runCallLater",value:function(e,t){ri.I.runCallLater(e,t)}},{key:"runTimer",value:function(e,t){e=this._getHandler(e,t);e&&null!=e.method&&(this._map[e.key]=null,e.run(!0))}},{key:"pause",value:function(){this.scale=0}},{key:"resume",value:function(){this.scale=1}}]),h}()),Fi=(Oi.gSysTimer=null,Oi._pool=[],Oi._mid=1,function(){function e(){b(this,e)}return y(e,[{key:"clear",value:function(){this.caller=null,this.method=null,this.args=null}},{key:"run",value:function(e){var t=this.caller;if(t&&t.destroyed)return this.clear();var i=this.method,n=this.args;e&&this.clear(),null!=i&&(n?i.apply(t,n):i.call(t))}}]),e}()),Vi=function(){f(s,xe);var a=T(s);function s(e){b(this,s),(t=a.call(this,ge.SKINMESH,0)).offsetX=300,t.offsetY=0;var t,i=v.mainContext,n=8*ut.BYTES_PE;return t.position=[2,i.FLOAT,!1,n,0],t.texcoord=[2,i.FLOAT,!1,n,2*ut.BYTES_PE],t.color=[4,i.FLOAT,!1,n,4*ut.BYTES_PE],t}return y(s)}(),Ui=function(){f(n,xe);var i=T(n);function n(e){var t;return b(this,n),(t=i.call(this,ge.PRIMITIVE,0))._attribLocation=["position",0,"attribColor",1],t}return y(n)}(),zi=function(){f(i,xe);var t=T(i);function i(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return b(this,i),(e=t.call(this,ge.TEXTURE2D,e)).strength=0,e.blurInfo=null,e.colorMat=null,e.colorAlpha=null,e._attribLocation=["posuv",0,"attribColor",1,"attribFlags",2],e}return y(i,[{key:"clear",value:function(){this.texture=null,this.shader=null,this.defines._value=this.subID}}]),i}(),Yi=function(){function s(e){b(this,s),this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=e;for(var t,i=0;!((i=e.indexOf("#begin",i))<0);){for(t=i+5;;){if((t=e.indexOf("#end",t))<0)break;if("i"!==e.charAt(t+4))break;t+=5}if(t<0)throw"add include err,no #end:"+e;var n=e.indexOf("\n",i),a=L.ShaderCompile.splitToWords(e.substr(i,n-i),null);"code"==a[1]?this.codes[a[2]]=e.substr(n+1,t-n-1):"function"==a[1]&&(n=e.indexOf("function",i),n+="function".length,this.funs[a[3]]=e.substr(n+1,t-n-1),this.funnames+=a[3]+";"),i=t+1}}return y(s,[{key:"getWith",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=e?this.codes[e]:this.script;if(t)return t;throw"get with error:"+e}},{key:"getFunsScript",value:function(e){var t,i="";for(t in this.funs)0<=e.indexOf(t+";")&&(i+=this.funs[t]);return i}}]),s}(),Gi=function(){function i(e){b(this,i),this.childs=[],this.text="",this.useFuns="",this.z=0,this.includefiles=e}return y(i,[{key:"setParent",value:function(e){e.childs.push(this),this.z=e.z+1,this.parent=e}},{key:"setCondition",value:function(e,t){e&&(this.conditionType=t,e=e.replace(/(\s*$)/g,""),this.condition=function(){return this[e]},this.condition.__condition=e)}},{key:"toscript",value:function(e,t){return this._toscript(e,t,++i.__id)}},{key:"_toscript",value:function(n,a,s){if(this.childs.length<1&&!this.text)return a;a.length;if(this.condition){var e=!!this.condition.call(n);if(!(e=this.conditionType===L.ShaderCompile.IFDEF_ELSE?!e:e))return a}if(this.text&&a.push(this.text),0<this.childs.length&&this.childs.forEach(function(e,t,i){e._toscript(n,a,s)}),0<this.includefiles.length&&0<this.useFuns.length)for(var t,i=0,r=this.includefiles.length;i<r;i++)this.includefiles[i].curUseID!=s&&0<(t=this.includefiles[i].file.getFunsScript(this.useFuns)).length&&(this.includefiles[i].curUseID=s,a[0]=t+a[0]);return a}}]),i}(),Xi=(Gi.__id=1,function(){function g(e,t,i){b(this,g),this.defs={};var n=this;function a(e){e=e.replace(g._clearCR,"");var t=[],i=new Gi(t);return n._compileToTree(i,e.split("\n"),0,t,n.defs),i}var s=Date.now();this._VS=a(e),this._PS=a(t),this._nameMap=i,2<Date.now()-s&&console.log("ShaderCompile use time:"+(Date.now()-s)+"  size:"+e.length+"/"+t.length)}return y(g,[{key:"_compileToTree",value:function(e,t,i,n,a){for(var s,r,o,h,l,u,c,_,f=i;f<t.length;f++)if(!((o=t[f]).length<1)&&0!==(l=o.indexOf("//"))){if(0<=l&&(o=o.substr(0,l)),s=u||new Gi(n),u=null,s.text=o,s.noCompile=!0,0<=(l=o.indexOf("#"))){for(h="#",_=l+1,c=o.length;_<c;_++){var d=o.charAt(_);if(" "===d||"\t"===d||"?"===d)break;h+=d}switch(s.name=h){case"#ifdef":case"#ifndef":if(s.src=o,s.noCompile=null!=o.match(/[!&|()=<>]/),s.noCompile?console.log("function():Boolean{return "+o.substr(l+s.name.length)+"}"):(p=o.replace(/^\s*/,"").split(/\s+/),s.setCondition(p[1],"#ifdef"===h?g.IFDEF_YES:g.IFDEF_ELSE),s.text="//"+s.text),s.setParent(e),e=s,a)for(p=o.substr(_).split(g._splitToWordExps3),_=0;_<p.length;_++)(o=p[_]).length&&(a[o]=!0);continue;case"#if":if(s.src=o,s.noCompile=!0,s.setParent(e),e=s,a)for(p=o.substr(_).split(g._splitToWordExps3),_=0;_<p.length;_++)(o=p[_]).length&&"defined"!=o&&(a[o]=!0);continue;case"#else":s.src=o,r=(e=e.parent).childs[e.childs.length-1],s.noCompile=r.noCompile,s.noCompile||(s.condition=r.condition,s.conditionType=r.conditionType==g.IFDEF_YES?g.IFDEF_ELSE:g.IFDEF_YES,s.text="//"+s.text+" "+r.text+" "+s.conditionType),s.setParent(e),e=s;continue;case"#endif":r=(e=e.parent).childs[e.childs.length-1],s.noCompile=r.noCompile,s.noCompile||(s.text="//"+s.text),s.setParent(e);continue;case"#include":var p=g.splitToWords(o,null),y=g.includes[p[1]];if(!y)throw"ShaderCompile error no this include file:"+p[1];if((l=p[0].indexOf("?"))<0){s.setParent(e),o=y.getWith("with"==p[2]?p[3]:null),this._compileToTree(s,o.split("\n"),0,n,a),s.text="";continue}s.setCondition(p[0].substr(l+1),g.IFDEF_YES),s.text=y.getWith("with"==p[2]?p[3]:null);break;case"#import":y=(p=g.splitToWords(o,null))[1],n.push({node:s,file:g.includes[y],ofs:s.text.length});continue}}else{if((r=e.childs[e.childs.length-1])&&!r.name){0<n.length&&g.splitToWords(o,r),u=s,r.text+="\n"+o;continue}0<n.length&&g.splitToWords(o,s)}s.setParent(e)}}},{key:"createShader",value:function(e,t,i,n){var a={},s="";if(e)for(var r in e)s+="#define "+r+"\n",a[r]=!0;var e=this._VS.toscript(a,[]),o=this._PS.toscript(a,[]);return(i||me.create)(s+e.join("\n"),s+o.join("\n"),t,this._nameMap,n)}}],[{key:"__init__",value:function(){var e=S.instance;g.shaderParamsMap={float:e.FLOAT,int:e.INT,bool:e.BOOL,vec2:e.FLOAT_VEC2,vec3:e.FLOAT_VEC3,vec4:e.FLOAT_VEC4,ivec2:e.INT_VEC2,ivec3:e.INT_VEC3,ivec4:e.INT_VEC4,bvec2:e.BOOL_VEC2,bvec3:e.BOOL_VEC3,bvec4:e.BOOL_VEC4,mat2:e.FLOAT_MAT2,mat3:e.FLOAT_MAT3,mat4:e.FLOAT_MAT4,sampler2D:e.SAMPLER_2D,samplerCube:e.SAMPLER_CUBE}}},{key:"_parseOne",value:function(e,t,i,n,a,s){var r={type:g.shaderParamsMap[i[n+1]],name:i[n+2],size:isNaN(parseInt(i[n+3]))?1:parseInt(i[n+3])};return s&&("attribute"==a?e:t).push(r),":"==i[n+3]&&(r.type=i[n+4],n+=2),n+=2}},{key:"addInclude",value:function(e,t){if(!t||0===t.length)throw new Error("add shader include file err:"+e);if(g.includes[e])throw new Error("add shader include file err, has add:"+e);g.includes[e]=new Yi(t)}},{key:"preGetParams",value:function(e,t){var i=[e,t],e={},n=[],a=[],s={},r=[];e.attributes=n,e.uniforms=a,e.defines=s;for(var o=0;o<2;o++){i[o]=i[o].replace(g._removeAnnotation,"");for(var h=i[o].match(g._reg),l=0,u=h.length;l<u;l++){var c=h[l];if("attribute"!=c&&"uniform"!=c){if("#define"==c)r[c=h[++l]]=1;else if("#ifdef"==c){var _;s[_=h[++l]]=s[_]||[];for(l++;l<u;l++)if("attribute"!=(c=h[l])&&"uniform"!=c){if("#else"==c)for(l++;l<u;l++)if("attribute"!=(c=h[l])&&"uniform"!=c){if("#endif"==c)break}else l=g._parseOne(n,a,h,l,c,!r[_])}else l=g._parseOne(n,a,h,l,c,r[_])}}else l=g._parseOne(n,a,h,l,c,!0)}}return e}},{key:"splitToWords",value:function(e,t){for(var i,n,a=[],s=-1,r=0,o=e.length;r<o;r++)if(i=e.charAt(r),0<=" \t=+-*/&%!<>()'\",;".indexOf(i))if(0<=s&&1<r-s&&(n=e.substr(s,r-s),a.push(n)),'"'==i||"'"==i){var h=e.indexOf(i,r+1);if(h<0)throw"Sharder err:"+e;a.push(e.substr(r+1,h-r-1)),r=h,s=-1}else"("==i&&t&&0<a.length&&(n=a[a.length-1]+";","vec4;main;".indexOf(n)<0&&(t.useFuns+=n)),s=-1;else s<0&&(s=r);return s<o&&1<o-s&&(n=e.substr(s,o-s),a.push(n)),a}}]),g}()),i=(Xi.IFDEF_NO=0,Xi.IFDEF_YES=1,Xi.IFDEF_ELSE=2,Xi.IFDEF_PARENT=3,Xi._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),Xi._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),Xi._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),Xi.includes={},Xi._clearCR=new RegExp("\r","g"),Xi._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g"),function(){f(a,ae);var i=T(a);function a(){b(this,a),(e=i.call(this)).worker=new Worker(a.workerPath);var e,t=O(e);return e.worker.onmessage=function(e){t.workerMessage(e.data)},e}return y(a,[{key:"workerMessage",value:function(e){if(e)switch(e.type){case"Image":this.imageLoaded(e);break;case"Disable":a.enable=!1}}},{key:"imageLoaded",value:function(e){var t,i;e.dataType&&"imageBitmap"==e.dataType?(t=e.imageBitmap,(i=new ue).loadImageSource(t),console.log("load:",e.url),this.event(e.url,i)):this.event(e.url,null)}},{key:"loadImage",value:function(e){this.worker.postMessage(e)}},{key:"_loadImage",value:function(t){var i,n=this;this._useWorkerLoader&&a._enable?(t=re.formatURL(t),i=function(e){a.I.off(t,n,i),e?n.onLoaded(e):a._preLoadFun.call(n,t)},a.I.on(t,n,i),a.I.loadImage(t)):a._preLoadFun.call(n,t)}}],[{key:"__init__",value:function(){return null==a._preLoadFun&&(!!Worker&&(a._preLoadFun=E.prototype._loadImage,E.prototype._loadImage=a.prototype._loadImage,a.I||(a.I=new a),!0))}},{key:"workerSupported",value:function(){return!!Worker}},{key:"enableWorkerLoader",value:function(){a._tryEnabled||(a.enable=!0,a._tryEnabled=!0)}},{key:"enable",get:function(){return a._enable},set:function(e){a._enable!=e&&(a._enable=e)&&null==a._preLoadFun&&(a._enable=a.__init__())}}]),a}()),Wi=(i.workerPath="libs/workerloader.js",i._enable=!1,i._tryEnabled=!1,function(){function t(){b(this,t)}return y(t,null,[{key:"cursor",get:function(){return t._style.cursor},set:function(e){t._style.cursor=e}},{key:"__init__",value:function(){}},{key:"hide",value:function(){"none"!=t.cursor&&(t._preCursor=t.cursor,t.cursor="none")}},{key:"show",value:function(){"none"==t.cursor&&(t.cursor=t._preCursor||"auto")}}]),t}()),Hi=function(){f(n,et);var i=T(n);function n(e){var t;return b(this,n),(t=i.call(this,n.const_stride,4*e*n.const_stride,4)).canReuse=!0,t.setAttributes(n._fixattriInfo),t.createQuadIB(e),t._quadNum=e,t}return y(n,[{key:"setMaxParticleNum",value:function(e){this._vb._resizeBuffer(4*e*n.const_stride,!1),this.createQuadIB(e)}},{key:"releaseMesh",value:function(){this._vb.setByteLength(0),this.vertNum=0,this.indexNum=0,n._POOL.push(this)}},{key:"destroy",value:function(){this._ib.destroy(),this._vb.destroy(),this._vb.deleteBuffer()}}],[{key:"__init__",value:function(){var e=S.instance;n._fixattriInfo=[e.FLOAT,4,0,e.FLOAT,3,16,e.FLOAT,3,28,e.FLOAT,4,40,e.FLOAT,4,56,e.FLOAT,3,72,e.FLOAT,2,84,e.FLOAT,4,92,e.FLOAT,1,108,e.FLOAT,1,112]}},{key:"getAMesh",value:function(e){var t;return n._POOL.length?((t=n._POOL.pop()).setMaxParticleNum(e),t):new n(e)}}]),n}(),n=(Hi.const_stride=116,Hi._POOL=[],function(){f(t,he);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t)}()),o=(n.create=function(e,t,i){e=new ue(e,t,i,!1,!1);return e.wrapModeU=le.WARPMODE_CLAMP,e.wrapModeV=le.WARPMODE_CLAMP,e},function(){function l(){b(this,l)}return y(l,null,[{key:"__init",value:function(e){e.forEach(function(e){e.__init$&&e.__init$()})}},{key:"init",value:function(e,t){if(!l._isinit){l._isinit=!0,ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=l._arrayBufferSlice),I.__init__();var i=I.mainCanvas=new Kt(!0),n=i.source.style;n.position="absolute",n.top=n.left="0px",n.background="#000000",I.onKGMiniGame||I.onAlipayMiniGame||I.container.appendChild(i.source),I.canvas=new Kt(!0),I.context=I.canvas.getContext("2d"),I.supportWebAudio=yi.__init__(),I.supportLocalStorage=Si.__init__(),l.systemTimer=new Oi(!1),Oi.gSysTimer=l.systemTimer,l.startTimer=new Oi(!1),l.physicsTimer=new Oi(!1),l.updateTimer=new Oi(!1),l.lateTimer=new Oi(!1),l.timer=new Oi(!1),L.startTimer=l.startTimer,L.lateTimer=l.lateTimer,L.updateTimer=l.updateTimer,L.systemTimer=l.systemTimer,L.timer=l.timer,L.physicsTimer=l.physicsTimer,l.loader=new wi,L.Laya=l,L.loader=l.loader,Ai.__init__(),Li.__init(),Wi.__init__(),Et.inner_enable();for(var a=arguments.length,s=new Array(2<a?a-2:0),r=2;r<a;r++)s[r-2]=arguments[r];if(s)for(var o=0,h=s.length;o<h;o++)s[o]&&s[o].enable&&s[o].enable();return L.Render.isConchApp&&l.enableNative(),l.enableWebGLPlus(),Gt.beginCheck(),u=l.stage=new li,L.stage=l.stage,Se.gStage=l.stage,re.rootPath=re._basePath=l._getUrlPath(),tt.__int__(),nt.__init__(),it.__init__(),l.render=new Bt(0,0,I.mainCanvas),l.stage.size(e,t),window.stage=l.stage,v.__init__(),Hi.__init__(),Xi.__init__(),qt.__init__(),ui.__init__(),si.instance.__init__(l.stage,Bt.canvas),ni.__init__(),yi.autoStopMusic=!0,k._StatRender=new Di,xe._initone(ge.TEXTURE2D,zi),xe._initone(ge.TEXTURE2D|ge.FILTERGLOW,zi),xe._initone(ge.PRIMITIVE,Ui),xe._initone(ge.SKINMESH,Vi),Bt.canvas}}},{key:"_getUrlPath",value:function(){var e=I.window.location,t=":"==(t=e.pathname).charAt(2)?t.substring(1):t;return re.getPath("file:"==e.protocol?t:e.protocol+"//"+e.host+e.pathname)}},{key:"_arrayBufferSlice",value:function(e,t){t=new Uint8Array(this,e,t-e),e=new Uint8Array(t.length);return e.set(t),e.buffer}},{key:"alertGlobalError",set:function(e){var s=0;I.window.onerror=e?function(e,t,i,n,a){s++<5&&a&&this.alert("出错啦，请把此信息截图给研发商\n"+e+"\n"+a.stack)}:null}},{key:"_runScript",value:function(e){return I.window[l._evcode](e)}},{key:"enableDebugPanel",value:function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"libs/laya.debugtool.js";window.Laya.DebugPanel?window.Laya.DebugPanel.enable():((e=I.createElement("script")).onload=function(){window.Laya.DebugPanel.enable()},e.src=t,I.document.body.appendChild(e))}},{key:"enableWebGLPlus",value:function(){v.__init_native()}},{key:"enableNative",value:function(){l.isNativeRender_enable||(l.isNativeRender_enable=!0,Bt.supportWebGLPlusRendering&&(me.prototype.uploadTexture2D=function(e){var t=S.instance;t.bindTexture(t.TEXTURE_2D,e)}),_e.width=I.window.innerWidth,_e.height=I.window.innerHeight,I.measureText=function(e,t){return window.conchTextCanvas.font=t,window.conchTextCanvas.measureText(e)},li.clear=function(e){Ct.set2DRenderConfig();var e=Ie.create(e).arrColor,t=S.instance;e&&t.clearColor(e[0],e[1],e[2],e[3]),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT|t.STENCIL_BUFFER_BIT),_e.clear()},N.drawToCanvas=N.drawToTexture=function(e,t,i,n,a,s){a=a-e.x|0,s=s-e.y|0,i|=0,n|=0;var r=new Kt(!1),o=r.getContext("2d");return r.size(i,n),o.asBitmap=!0,o._targets.start(),qt.renders[t]._fun(e,o,a,s),o.flush(),o._targets.end(),o._targets.restore(),r},Object.defineProperty(fe.prototype,"uv",{get:function(){return this._uv},set:function(e){this._uv=e}}),Kt.prototype.getTexture=function(){return this._texture||(this._texture=this.context._targets,this._texture.uv=fe.flipyuv,this._texture.bitmap=this._texture),this._texture})}}]),l}()),ji=(o.stage=null,o.systemTimer=null,o.startTimer=null,o.physicsTimer=null,o.updateTimer=null,o.lateTimer=null,o.timer=null,o.loader=null,o.version="2.4.0",o._isinit=!1,o.isWXOpenDataContext=!1,o.isWXPosMsg=!1,o.__classmap=null,o.Config=Fe,o.TextRender=Tt,o.EventDispatcher=ae,o.SoundChannel=ci,o.Stage=li,o.Render=Bt,o.Browser=I,o.Sprite=N,o.Node=ei,o.Context=Ct,o.WebGL=Et,o.Handler=x,o.RunDriver=hi,o.Utils=Se,o.Input=ni,o.Loader=E,o.LocalStorage=Si,o.SoundManager=yi,o.URL=re,o.Event=Me,o.Matrix=Ce,o.HTMLImage=n,(o.Laya=o)._evcode="eval",o.isNativeRender_enable=!1,o.__classmap=L.__classMap,L.Timer=Oi,L.Dragging=t,L.GraphicsBounds=Ft,L.Sprite=N,L.TextRender=Tt,L.Loader=E,L.TTFLoader=e,L.WebAudioSound=pi,L.SoundManager=yi,L.ShaderCompile=Xi,L.ClassUtils=M,L.SceneUtils=Li,L.Context=Ct,L.Render=Bt,L.MouseManager=si,L.Text=ii,L.Browser=I,L.WebGL=Et,L.AudioSound=fi,L.Pool=p,L.Utils=Se,L.Graphics=Wt,L.Submit=ct,L.Stage=li,L.Resource=oe,L.WorkerLoader=i,window._layalibs);if(ji){ji.sort(function(e,t){return e.i-t.i});for(var qi=0;qi<ji.length;qi++)ji[qi].f(window,window.document,o)}var u,Ki,Qi,Zi,Ji,$i,en,tn,nn,an,n=window,sn=(n.Laya?(n.Laya.Laya=o,Object.assign(n.Laya,o)):n.Laya=o,function(){f(t,Mi);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"isSingleton",get:function(){return!1}},{key:"_onAwake",value:function(){this.onAwake(),this.onStart!==t.prototype.onStart&&L.startTimer.callLater(this,this.onStart)}},{key:"_onEnable",value:function(){var e=t.prototype;this.onTriggerEnter!==e.onTriggerEnter&&this.owner.on(Me.TRIGGER_ENTER,this,this.onTriggerEnter),this.onTriggerStay!==e.onTriggerStay&&this.owner.on(Me.TRIGGER_STAY,this,this.onTriggerStay),this.onTriggerExit!==e.onTriggerExit&&this.owner.on(Me.TRIGGER_EXIT,this,this.onTriggerExit),this.onMouseDown!==e.onMouseDown&&this.owner.on(Me.MOUSE_DOWN,this,this.onMouseDown),this.onMouseUp!==e.onMouseUp&&this.owner.on(Me.MOUSE_UP,this,this.onMouseUp),this.onClick!==e.onClick&&this.owner.on(Me.CLICK,this,this.onClick),this.onStageMouseDown!==e.onStageMouseDown&&L.stage.on(Me.MOUSE_DOWN,this,this.onStageMouseDown),this.onStageMouseUp!==e.onStageMouseUp&&L.stage.on(Me.MOUSE_UP,this,this.onStageMouseUp),this.onStageClick!==e.onStageClick&&L.stage.on(Me.CLICK,this,this.onStageClick),this.onStageMouseMove!==e.onStageMouseMove&&L.stage.on(Me.MOUSE_MOVE,this,this.onStageMouseMove),this.onDoubleClick!==e.onDoubleClick&&this.owner.on(Me.DOUBLE_CLICK,this,this.onDoubleClick),this.onRightClick!==e.onRightClick&&this.owner.on(Me.RIGHT_CLICK,this,this.onRightClick),this.onMouseMove!==e.onMouseMove&&this.owner.on(Me.MOUSE_MOVE,this,this.onMouseMove),this.onMouseOver!==e.onMouseOver&&this.owner.on(Me.MOUSE_OVER,this,this.onMouseOver),this.onMouseOut!==e.onMouseOut&&this.owner.on(Me.MOUSE_OUT,this,this.onMouseOut),this.onKeyDown!==e.onKeyDown&&L.stage.on(Me.KEY_DOWN,this,this.onKeyDown),this.onKeyPress!==e.onKeyPress&&L.stage.on(Me.KEY_PRESS,this,this.onKeyPress),this.onKeyUp!==e.onKeyUp&&L.stage.on(Me.KEY_UP,this,this.onKeyUp),this.onUpdate!==e.onUpdate&&L.updateTimer.frameLoop(1,this,this.onUpdate),this.onLateUpdate!==e.onLateUpdate&&L.lateTimer.frameLoop(1,this,this.onLateUpdate),this.onPreRender!==e.onPreRender&&L.lateTimer.frameLoop(1,this,this.onPreRender)}},{key:"_onDisable",value:function(){this.owner.offAllCaller(this),L.stage.offAllCaller(this),L.startTimer.clearAll(this),L.updateTimer.clearAll(this),L.lateTimer.clearAll(this)}},{key:"_isScript",value:function(){return!0}},{key:"_onDestroy",value:function(){this.onDestroy()}},{key:"onAwake",value:function(){}},{key:"onEnable",value:function(){}},{key:"onStart",value:function(){}},{key:"onTriggerEnter",value:function(e,t,i){}},{key:"onTriggerStay",value:function(e,t,i){}},{key:"onTriggerExit",value:function(e,t,i){}},{key:"onMouseDown",value:function(e){}},{key:"onMouseUp",value:function(e){}},{key:"onClick",value:function(e){}},{key:"onStageMouseDown",value:function(e){}},{key:"onStageMouseUp",value:function(e){}},{key:"onStageClick",value:function(e){}},{key:"onStageMouseMove",value:function(e){}},{key:"onDoubleClick",value:function(e){}},{key:"onRightClick",value:function(e){}},{key:"onMouseMove",value:function(e){}},{key:"onMouseOver",value:function(e){}},{key:"onMouseOut",value:function(e){}},{key:"onKeyDown",value:function(e){}},{key:"onKeyPress",value:function(e){}},{key:"onKeyUp",value:function(e){}},{key:"onUpdate",value:function(){}},{key:"onLateUpdate",value:function(){}},{key:"onPreRender",value:function(){}},{key:"onPostRender",value:function(){}},{key:"onDisable",value:function(){}},{key:"onDestroy",value:function(){}}]),t}()),rn=function(){f(i,sn);var t=T(i);function i(){var e;return b(this,i),(e=t.apply(this,arguments)).transparent=!0,e.clickSound="SFX_UI_001.mp3",e}return y(i,[{key:"onEnable",value:function(){var e,t;this.btn=this.owner,this.originScaleX=this.btn.scaleX,this.originScaleY=this.btn.scaleY,.5!=this.btn.anchorX&&(t=isNaN(this.btn.anchorX)?0:this.btn.anchorX,t=this.btn.width*(.5-t),this.btn.anchorX=.5,this.btn.x+=t),.5!=this.btn.anchorY&&(e=isNaN(this.btn.anchorY)?0:this.btn.anchorY,t=this.btn.height*(.5-e),this.btn.anchorY=.5,this.btn.y+=t),this.bindMouseDown(),this.bindMouseUp(),this.bindMouseOut()}},{key:"bindMouseDown",value:function(){var e=this;this.btn.on(Me.MOUSE_DOWN,this,function(){void 0!==e.zoom&&e.btn.scale(e.zoom,e.zoom),e.transparent&&(e.btn.alpha=.7),yi.playSound("res/fishxy/sound/"+e.clickSound)})}},{key:"bindMouseUp",value:function(){var e=this;this.btn.on(Me.MOUSE_UP,this,function(){void 0!==e.zoom&&e.btn.scale(e.originScaleX,e.originScaleY),e.transparent&&(e.btn.alpha=1)})}},{key:"bindMouseOut",value:function(){var e=this;this.btn.on(Me.MOUSE_OUT,this,function(){void 0!==e.zoom&&e.btn.scale(e.originScaleX,e.originScaleY),e.transparent&&(e.btn.alpha=1)})}}]),i}(),on=y(function e(){b(this,e),this.placeholder=0}),hn=function(){function e(){b(this,e)}return y(e,[{key:"autoDestroyLoadingViewWhenLoadComplete",value:function(){return!0}}]),e}(),ln=function(){f(t,hn);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"createView",value:function(){if(!this.view)return this.view=new(this.getViewCtor()),this.view}}]),t}(),un=function(){f(n,ae);var t=T(n);function n(){var e;return b(this,n),(e=t.call(this))._completeHandler=new x(O(e),e.onOneLoadComplete),e.reset(),e}return y(n,[{key:"reset",value:function(){this._toLoadList=[],this._isLoading=!1,this.totalCount=0}},{key:"leftCount",get:function(){return this._isLoading?this._toLoadList.length+1:this._toLoadList.length}},{key:"loadedCount",get:function(){return this.totalCount-this.leftCount}},{key:"load",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];if(e instanceof Array)for(var n=e.length,a=0;a<n;a++)this._addToLoadList(e[a],t);else this._addToLoadList(e,t);i&&this._checkNext()}},{key:"_addToLoadList",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];0<=this._toLoadList.indexOf(e)||E.getRes(e)||(t?this._toLoadList.push({url:e}):this._toLoadList.push(e),this.totalCount++)}},{key:"_checkNext",value:function(){var e;this._isLoading||(0==this._toLoadList.length?this.event(Me.COMPLETE):"string"==typeof(e=this._toLoadList.pop())?this.loadOne(e):this.loadOne(e.url,!0))}},{key:"loadOne",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=(this._curUrl=e,Se.getFileExtension(this._curUrl));t?L.loader.create(e,this._completeHandler):n.LoadableExtensions[i]?L.loader.load(e,this._completeHandler,null,n.LoadableExtensions[i]):e!=ki.getFileLoadPath(e)||n.No3dLoadTypes[i]||!wi.createMap[i]?L.loader.load(e,this._completeHandler):L.loader.create(e,this._completeHandler)}},{key:"onOneLoadComplete",value:function(){this._isLoading=!1,E.getRes(this._curUrl)||console.log("Fail to load:",this._curUrl);var e,t=Se.getFileExtension(this._curUrl);n.LoadableExtensions[t]&&(e=(e=E.getRes(this._curUrl))&&e instanceof gi?e.json:e)&&(e.loadList&&this.load(e.loadList,!1,!1),e.loadList3D&&this.load(e.loadList3D,!0,!1)),"sk"==t&&this.load(this._curUrl.replace(".sk",".png"),!1,!1),this.event(Me.PROGRESS,this.getProgress()),this._checkNext()}},{key:"getProgress",value:function(){return this.loadedCount/this.totalCount}}]),n}(),cn=(un.LoadableExtensions={scene:E.JSON,scene3d:E.JSON,ani:E.JSON,ui:E.JSON,prefab:E.PREFAB},un.No3dLoadTypes={png:!0,jpg:!0,txt:!0},function(){f(h,N);var i=T(h);function h(){var e,t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];return b(this,h),(e=i.call(this)).autoDestroyAtClosed=!1,e.url=null,e._viewCreated=!1,e._$componentType="Scene",e._setBit(Ht.NOT_READY,!0),h.unDestroyedScenes.push(O(e)),e._scene=O(e),t&&e.createChildren(),e}return y(h,[{key:"createChildren",value:function(){}},{key:"loadScene",value:function(e){var e=-1<e.indexOf(".")?e:e+".scene",t=L.loader.getRes(e);t?this.createView(t):(L.loader.resetProgress(),(t=new un).on(Me.COMPLETE,this,this._onSceneLoaded,[e]),t.load(e))}},{key:"_onSceneLoaded",value:function(e){this.createView(L.Loader.getRes(e))}},{key:"createView",value:function(e){e&&!this._viewCreated&&(this._viewCreated=!0,Li.createByData(this,e))}},{key:"getNodeByID",value:function(e){return this._idMap?this._idMap[e]:null}},{key:"open",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;e&&h.closeAll(),h.root.addChild(this),this.onOpened(t)}},{key:"onOpened",value:function(e){}},{key:"close",value:function(){this.onClosed(0<arguments.length&&void 0!==arguments[0]?arguments[0]:null),this.autoDestroyAtClosed?this.destroy():this.removeSelf()}},{key:"onClosed",value:function(){}},{key:"destroy",value:function(){for(var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],t=(this._idMap=null,m(g(h.prototype),"destroy",this).call(this,e),h.unDestroyedScenes),i=t.length-1;-1<i;i--)if(t[i]===this)return void t.splice(i,1)}},{key:"scaleX",get:function(){return m(g(h.prototype),"scaleX",this)},set:function(e){m(g(h.prototype),"get_scaleX",this).call(this)!=e&&(m(g(h.prototype),"set_scaleX",this).call(this,e),this.event(Me.RESIZE))}},{key:"scaleY",get:function(){return m(g(h.prototype),"scaleY",this)},set:function(e){m(g(h.prototype),"get_scaleY",this).call(this)!=e&&(m(g(h.prototype),"set_scaleY",this).call(this,e),this.event(Me.RESIZE))}},{key:"width",get:function(){if(this._width)return this._width;for(var e=0,t=this.numChildren-1;-1<t;t--){var i=this.getChildAt(t);i._visible&&(e=Math.max(i._x+i.width*i.scaleX,e))}return e},set:function(e){m(g(h.prototype),"get_width",this).call(this)!=e&&(m(g(h.prototype),"set_width",this).call(this,e),this.callLater(this._sizeChanged))}},{key:"height",get:function(){if(this._height)return this._height;for(var e=0,t=this.numChildren-1;-1<t;t--){var i=this.getChildAt(t);i._visible&&(e=Math.max(i._y+i.height*i.scaleY,e))}return e},set:function(e){m(g(h.prototype),"get_height",this).call(this)!=e&&(m(g(h.prototype),"set_height",this).call(this,e),this.callLater(this._sizeChanged))}},{key:"_sizeChanged",value:function(){this.event(Me.RESIZE)}},{key:"timer",get:function(){return this._timer||L.timer},set:function(e){this._timer=e}}],[{key:"setUIMap",value:function(e){var t,i=L.loader.getRes(e);if(!i)throw"请提前加载uimap的json，再使用该接口设置！";for(t in i)L.Loader.loadedMap[re.formatURL(t+".scene")]=i[t]}},{key:"root",get:function(){return h._root||((h._root=L.stage.addChild(new N)).name="root",L.stage.on("resize",null,function(){h._root.size(L.stage.width,L.stage.height),h._root.event(Me.RESIZE)}),h._root.size(L.stage.width,L.stage.height),h._root.event(Me.RESIZE)),h._root}},{key:"load",value:function(a){var s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,r=(L.loader.resetProgress(),new un);function o(e){h._loadPage&&h._loadPage.event("progress",e),t&&t.runWith(e)}r.on(Me.PROGRESS,null,o),r.once(Me.COMPLETE,null,function(){r.off(Me.PROGRESS,null,o);var e=L.Loader.getRes(a);if(!e)throw"Can not find scene:"+a;if(!e.props)throw"Scene data is error:"+a;var t=e.props.runtime||e.type,i=L.ClassUtils.getClass(t);{var n;n="instance"==e.props.renderType?i.instance||(i.instance=new i):new i}{if(!(n&&n instanceof ei))throw"Can not find scene:"+t;n.url=a,n._getBit(Ht.NOT_READY)?(n.on("onViewCreated",null,function(){s&&s.runWith(n)}),n.createView(e)):s&&s.runWith(n),h.hideLoadingPage()}}),r.load(a)}},{key:"open",value:function(e){var t,i=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null;n instanceof x&&(t=a,a=n,n=t),h.showLoadingPage(),h.load(e,x.create(null,this._onSceneLoaded,[i,a,n]),s)}},{key:"_onSceneLoaded",value:function(e,t,i,n){n.open(e,i),t&&t.runWith(n)}},{key:"close",value:function(e){for(var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",i=!1,n=h.unDestroyedScenes,a=0,s=n.length;a<s;a++){var r=n[a];r&&r.parent&&r.url===e&&r.name==t&&(r.close(),i=!0)}return i}},{key:"closeAll",value:function(){for(var e=h.root,t=0,i=e.numChildren;t<i;t++){var n=e.getChildAt(0);n instanceof h?n.close():n.removeSelf()}}},{key:"destroy",value:function(e){for(var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",i=!1,n=h.unDestroyedScenes,a=0,s=n.length;a<s;a++){var r=n[a];r.url===e&&r.name==t&&(r.destroy(),i=!0)}return i}},{key:"gc",value:function(){oe.destroyUnusedResources()}},{key:"setLoadingPage",value:function(e){h._loadPage!=e&&(h._loadPage=e)}},{key:"showLoadingPage",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:500;h._loadPage&&(L.systemTimer.clear(null,h._showLoading),L.systemTimer.clear(null,h._hideLoading),L.systemTimer.once(t,null,h._showLoading,[e],!1))}},{key:"_showLoading",value:function(e){L.stage.addChild(h._loadPage),h._loadPage.onOpened(e)}},{key:"_hideLoading",value:function(){h._loadPage.close()}},{key:"hideLoadingPage",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:500;h._loadPage&&(L.systemTimer.clear(null,h._showLoading),L.systemTimer.clear(null,h._hideLoading),L.systemTimer.once(e,null,h._hideLoading))}}]),h}()),_n=(cn.unDestroyedScenes=[],L.regClass(cn),M.regClass("laya.display.Scene",cn),M.regClass("Laya.Scene",cn),function(){f(i,Mi);var t=T(i);function i(){var e;return b(this,i),(e=t.apply(this,arguments))._top=NaN,e._bottom=NaN,e._left=NaN,e._right=NaN,e._centerX=NaN,e._centerY=NaN,e}return y(i,[{key:"onReset",value:function(){this._top=this._bottom=this._left=this._right=this._centerX=this._centerY=NaN}},{key:"_onEnable",value:function(){this.owner.parent?this._onAdded():this.owner.once(Me.ADDED,this,this._onAdded)}},{key:"_onDisable",value:function(){this.owner.off(Me.ADDED,this,this._onAdded),this.owner.parent&&this.owner.parent.off(Me.RESIZE,this,this._onParentResize)}},{key:"_onAdded",value:function(){this.owner.parent&&this.owner.parent.on(Me.RESIZE,this,this._onParentResize),this.resetLayoutX(),this.resetLayoutY()}},{key:"_onParentResize",value:function(){var e=this.resetLayoutX(),t=this.resetLayoutY();(e||t)&&this.owner.event(Me.RESIZE)}},{key:"resetLayoutX",value:function(){var e=this.owner;if(!e)return!1;var t=e.parent;if(t)if(isNaN(this.centerX)){if(isNaN(this.left))isNaN(this.right)||(e.x=Math.round(t.width-e.displayWidth-this.right+e.pivotX*e.scaleX));else if(e.x=Math.round(this.left+e.pivotX*e.scaleX),!isNaN(this.right)){var i=(t._width-this.left-this.right)/(e.scaleX||.01);if(i!=e.width)return e.width=i,!0}}else e.x=Math.round(.5*(t.width-e.displayWidth)+this.centerX+e.pivotX*e.scaleX);return!1}},{key:"resetLayoutY",value:function(){var e=this.owner;if(!e)return!1;var t=e.parent;if(t)if(isNaN(this.centerY)){if(isNaN(this.top))isNaN(this.bottom)||(e.y=Math.round(t.height-e.displayHeight-this.bottom+e.pivotY*e.scaleY));else if(e.y=Math.round(this.top+e.pivotY*e.scaleY),!isNaN(this.bottom)){var i=(t._height-this.top-this.bottom)/(e.scaleY||.01);if(i!=e.height)return e.height=i,!0}}else e.y=Math.round(.5*(t.height-e.displayHeight)+this.centerY+e.pivotY*e.scaleY);return!1}},{key:"resetLayout",value:function(){this.owner&&(this.resetLayoutX(),this.resetLayoutY())}},{key:"top",get:function(){return this._top},set:function(e){this._top!=e&&(this._top=e,this.resetLayoutY())}},{key:"bottom",get:function(){return this._bottom},set:function(e){this._bottom!=e&&(this._bottom=e,this.resetLayoutY())}},{key:"left",get:function(){return this._left},set:function(e){this._left!=e&&(this._left=e,this.resetLayoutX())}},{key:"right",get:function(){return this._right},set:function(e){this._right!=e&&(this._right=e,this.resetLayoutX())}},{key:"centerX",get:function(){return this._centerX},set:function(e){this._centerX!=e&&(this._centerX=e,this.resetLayoutX())}},{key:"centerY",get:function(){return this._centerY},set:function(e){this._centerY!=e&&(this._centerY=e,this.resetLayoutY())}}]),i}()),fn=(_n.EMPTY=null,L.regClass(_n),_n.EMPTY=new _n,M.regClass("laya.ui.Widget",_n),M.regClass("Laya.Widget",_n),function(){f(p,l);var t=T(p);function p(){var e;return b(this,p),(e=t.apply(this,arguments))._nodeIDAniDic={},e}return y(p,[{key:"_parseNodeList",value:function(e){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[e.compId]=e.props,e.compId&&this._nodeList.push(e.compId);var t=e.child;if(t)for(var i=t.length,n=0;n<i;n++)this._parseNodeList(t[n])}},{key:"_calGraphicData",value:function(e){if(this._setUp(null,e),this._createGraphicData(),this._nodeIDAniDic)for(var t in this._nodeIDAniDic)this._nodeIDAniDic[t]=null}},{key:"_createGraphicData",value:function(){for(var e,t=[],i=this.count,n=(n=this._usedFrames)||[],a=0;a<i;a++)!n[a]&&e||(e=this._createFrameGraphic(a)),t.push(e);this._gList=t}},{key:"_createFrameGraphic",value:function(e){var t=new Wt;return p._rootMatrix||(p._rootMatrix=new Ce),this._updateNodeGraphic(this._rootNode,e,p._rootMatrix,t),t}},{key:"_updateNodeGraphic",value:function(e,t,i,n){var a,s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:1,r=this._nodeGDic[e.compId]=this._getNodeGraphicData(e.compId,t,this._nodeGDic[e.compId]),o=(r.resultTransform||(r.resultTransform=new Ce),a=r.resultTransform,Ce.mul(r.transform,i,a),r.alpha*s);if(!(o<.01)){r.skin&&(i=this._getTextureByUrl(r.skin))&&(a._checkTransform()?(n.drawTexture(i,0,0,r.width,r.height,a,o),r.resultTransform=null):n.drawTexture(i,a.tx,a.ty,r.width,r.height,null,o));var h=e.child;if(h)for(var l=h.length,u=0;u<l;u++)this._updateNodeGraphic(h[u],t,a,n,o)}}},{key:"_updateNoChilds",value:function(e,t){var i,n;!e.skin||(i=this._getTextureByUrl(e.skin))&&((n=e.transform)._checkTransform(),!n._bTransform?t.drawTexture(i,n.tx,n.ty,e.width,e.height,null,e.alpha):t.drawTexture(i,0,0,e.width,e.height,n.clone(),e.alpha))}},{key:"_updateNodeGraphic2",value:function(e,t,i){var n=this._nodeGDic[e.compId]=this._getNodeGraphicData(e.compId,t,this._nodeGDic[e.compId]);if(e.child){var a,s,r,o=n.transform,h=(o._checkTransform(),s=(a=!o._bTransform)&&(0!=o.tx||0!=o.ty),(r=o._bTransform||1!=n.alpha)&&i.save(),1!=n.alpha&&i.alpha(n.alpha),a?s&&i.translate(o.tx,o.ty):i.transform(o.clone()),e.child);if(n.skin&&(e=this._getTextureByUrl(n.skin))&&i.drawImage(e,0,0,n.width,n.height),h)for(var l=h.length,u=0;u<l;u++)this._updateNodeGraphic2(h[u],t,i);r?i.restore():a?s&&i.translate(-o.tx,-o.ty):i.transform(o.clone().invert())}else this._updateNoChilds(n,i)}},{key:"_calculateKeyFrames",value:function(e){m(g(p.prototype),"_calculateKeyFrames",this).call(this,e),this._nodeIDAniDic[e.target]=e}},{key:"getNodeDataByID",value:function(e){return this._nodeIDAniDic[e]}},{key:"_getParams",value:function(e,t,i,n){var a=p._temParam;a.length=t.length;for(var s=t.length,r=0;r<s;r++)a[r]=this._getObjVar(e,t[r][0],i,t[r][1],n);return a}},{key:"_getObjVar",value:function(e,t,i,n,a){var s;return t in e?(i>=(s=e[t]).length&&(i=s.length-1),e[t][i]):t in a?a[t]:n}},{key:"_getNodeGraphicData",value:function(e,t,i){(i=i||new dn).transform?i.transform.identity():i.transform=new Ce;var n=this.getNodeDataByID(e);if(!n)return i;var n=n.frames,n=this._getParams(n,p._drawTextureCmd,t,this._nodeDefaultProps[e]),t=n[0],e=n[5],a=n[6],s=n[13],r=n[14],o=n[7],h=n[8],l=n[9],u=n[11],c=n[12],_=n[3],f=n[4],d=(0!=_&&0!=f||(t=null),-1==_&&(_=0),-1==f&&(f=0),i.skin=t,i.width=_,i.height=f,t&&((d=this._getTextureByUrl(t))?(_=_||d.sourceWidth,f=f||d.sourceHeight):console.warn("lost skin:",t,",you may load pics first")),i.alpha=n[10],i.transform),t=(0!=r&&(a=r*f),0==(e=0!=s?s*_:e)&&0==a||d.translate(-e,-a),null);return(l||1!==o||1!==h||u||c)&&((t=p._tempMt).identity(),t._bTransform=!0,r=.0174532922222222*(l-u),f=.0174532922222222*(l+c),s=Math.cos(f),_=Math.sin(f),e=Math.sin(r),a=Math.cos(r),t.a=o*s,t.b=o*_,t.c=-h*e,t.d=h*a,t.tx=t.ty=0),(d=t?Ce.mul(d,t,d):d).translate(n[1],n[2]),i}},{key:"_getTextureByUrl",value:function(e){return E.getRes(e)}},{key:"setAniData",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if(e.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=e,this._parseNodeList(e);for(var i,n={},a=[],s=e.animations,r=s.length,o=0;o<r;o++)if(i=s[o],this._labels=null,(!t||t==i.name)&&i){try{this._calGraphicData(i)}catch(e){console.warn("parse animation fail:"+i.name+",empty animation created"),this._gList=[]}var h={};h.interval=1e3/i.frameRate,h.frames=this._gList,h.labels=this._labels,h.name=i.name,a.push(h),n[i.name]=h}this.animationList=a,this.animationDic=n}p._temParam.length=0}},{key:"parseByData",value:function(e){var t=e.nodeRoot,i=e.aniO;delete e.nodeRoot,delete e.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=t,this._parseNodeList(t),this._labels=null;try{this._calGraphicData(i)}catch(e){console.warn("parse animation fail:"+i.name+",empty animation created"),this._gList=[]}t=e;return t.interval=1e3/i.frameRate,t.frames=this._gList,t.labels=this._labels,t.name=i.name,t}},{key:"setUpAniData",value:function(e){if(e.animations){for(var t,i,n={},a=[],s=e.animations,r=s.length,o=0;o<r;o++)(i=s[o])&&((t={}).name=i.name,t.aniO=i,t.nodeRoot=e,a.push(t),n[i.name]=t);this.animationList=a,this.animationDic=n}}},{key:"_clear",value:function(){this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic=null}}],[{key:"parseAnimationByData",value:function(e){e=(p._I=p._I?p._I:new p).parseByData(e);return p._I._clear(),e}},{key:"parseAnimationData",value:function(e){return(p._I=p._I?p._I:new p).setUpAniData(e),(e={}).animationList=p._I.animationList,e.animationDic=p._I.animationDic,p._I._clear(),e}}]),p}()),dn=(fn._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],fn._temParam=[],fn._tempMt=new Ce,y(function e(){b(this,e),this.alpha=1})),pn=function(){f(l,Ei);var t=T(l);function l(){var e;return b(this,l),(e=t.call(this))._setControlNode(O(e)),e}return y(l,[{key:"destroy",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this.stop(),m(g(l.prototype),"destroy",this).call(this,e),this._frames=null,this._labels=null}},{key:"play",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"";i&&this._setFramesFromCache(i,!0),m(g(l.prototype),"play",this).call(this,e,t,i)}},{key:"_setFramesFromCache",value:function(e){var t,i=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return(e=this._url?this._url+"#"+e:e)&&l.framesMap[e]?((t=l.framesMap[e])instanceof Array?(this._frames=l.framesMap[e],this._count=this._frames.length):(t.nodeRoot&&(l.framesMap[e]=fn.parseAnimationByData(t),t=l.framesMap[e]),this._frames=t.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=t.interval),this._labels=this._copyLabels(t.labels)),!0):(i&&console.log("ani not found:",e),!1)}},{key:"_copyLabels",value:function(e){if(!e)return null;var t,i={};for(t in e)i[t]=Se.copyArray([],e[t]);return i}},{key:"_frameLoop",value:function(){this._visible&&.01<this._style.alpha&&this._frames&&m(g(l.prototype),"_frameLoop",this).call(this)}},{key:"_displayToIndex",value:function(e){this._frames&&(this.graphics=this._frames[e])}},{key:"frames",get:function(){return this._frames},set:function(e){(this._frames=e)&&(this._count=e.length,this._actionName&&this._setFramesFromCache(this._actionName,!0),this.index=this._index)}},{key:"source",set:function(e){-1<e.indexOf(".ani")?this.loadAnimation(e):-1<e.indexOf(".json")||-1<e.indexOf("als")||-1<e.indexOf("atlas")?this.loadAtlas(e):this.loadImages(e.split(","))}},{key:"autoAnimation",set:function(e){this.play(0,!0,e)}},{key:"autoPlay",set:function(e){e?this.play():this.stop()}},{key:"clear",value:function(){return m(g(l.prototype),"clear",this).call(this),this.stop(),this.graphics=null,this._frames=null,this._labels=null,this}},{key:"loadImages",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";return this._url="",this._setFramesFromCache(t)||(this.frames=l.framesMap[t]||l.createFrames(e,t)),this}},{key:"loadAtlas",value:function(t){var e,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",a=(this._url="",this);return a._setFramesFromCache(n)||(e=function(e){t===e&&(a.frames=l.framesMap[n]||l.createFrames(t,n),i&&i.run())},E.getAtlas(t)?e(t):L.loader.load(t,x.create(null,e,[t]),null,E.ATLAS)),this}},{key:"loadAnimation",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;this._url=e;return this._actionName||(this._actionName=""),this._setFramesFromCache(this._actionName)?(this._setFramesFromCache(this._actionName,!0),this.index=0,t&&t.run()):!i||E.getAtlas(i)?this._loadAnimationData(e,t,i):L.loader.load(i,x.create(this,this._loadAnimationData,[e,t,i]),null,E.ATLAS),this}},{key:"_loadAnimationData",value:function(r){var o,h=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;function t(e){if(E.getRes(e)){if(r===e){var t;if(l.framesMap[r+"#"])o._setFramesFromCache(o._actionName,!0),o.index=0,o._resumePlay();else{e=fn.parseAnimationData(E.getRes(r));if(!e)return;for(var i,n=e.animationList,a=n.length,s=0;s<a;s++)t=n[s],l.framesMap[r+"#"+t.name]=t,i=i||t;i&&(l.framesMap[r+"#"]=i,o._setFramesFromCache(o._actionName,!0),o.index=0),o._resumePlay()}h&&h.run()}E.clearRes(r)}else l.framesMap[r+"#"]&&(o._setFramesFromCache(o._actionName,!0),o.index=0,o._resumePlay(),h&&h.run())}e&&!E.getAtlas(e)?console.warn("atlas load fail:"+e):(o=this,E.getRes(r)?t(r):L.loader.load(r,x.create(null,t,[r]),null,E.JSON))}}],[{key:"createFrames",value:function(e,t){if("string"==typeof e){var i=E.getAtlas(e);if(i&&i.length)for(var n=[],a=0,s=i.length;a<s;a++){var r=new Wt;r.drawImage(E.getRes(i[a]),0,0),n.push(r)}}else if(e instanceof Array)for(n=[],a=0,s=e.length;a<s;a++)(r=new Wt).loadImage(e[a],0,0),n.push(r);return t&&(l.framesMap[t]=n),n}},{key:"clearCache",value:function(e){var t,i=e+"#";for(t in l.framesMap)t!==e&&0!==t.indexOf(i)||delete l.framesMap[t]}}]),l}(),yn=(pn.framesMap={},L.regClass(pn),M.regClass("laya.display.Animation",pn),M.regClass("Laya.Animation",pn),function(){f(t,Me);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t)}()),gn=(yn.SHOW_TIP="showtip",yn.HIDE_TIP="hidetip",L.regClass(yn),M.regClass("laya.ui.UIEvent",yn),M.regClass("Laya.UIEvent",yn),function(){function n(){b(this,n)}return y(n,null,[{key:"fillArray",value:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=e.concat();if(t)for(var a=t.split(","),s=0,r=Math.min(n.length,a.length);s<r;s++){var o=a[s];n[s]="true"==o||"false"!=o&&o,null!=i&&(n[s]=i(o))}return n}},{key:"toColor",value:function(e){return Se.toHexColor(e)}},{key:"gray",value:function(e){!(1<arguments.length&&void 0!==arguments[1])||arguments[1]?n.addFilter(e,n.grayFilter):n.clearFilter(e,Te)}},{key:"addFilter",value:function(e,t){var i=e.filters||[];i.push(t),e.filters=i}},{key:"clearFilter",value:function(e,t){var i=e.filters;if(null!=i&&0<i.length){for(var n=i.length-1;-1<n;n--)i[n]instanceof t&&i.splice(n,1);e.filters=i}}},{key:"_getReplaceStr",value:function(e){return n.escapeSequence[e]}},{key:"adptString",value:function(e){return e.replace(/\\(\w)/g,n._getReplaceStr)}},{key:"getBindFun",value:function(e){var t,i=(n._funMap=n._funMap?n._funMap:new Ai).get(e);return null==i&&(t=(t='"'+e+'"').replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'),i=window.Laya._runScript("(function(data){if(data==null)return;with(data){try{\nreturn "+t+"\n}catch(e){}}})"),n._funMap.set(e,i)),i}}]),n}()),mn=(gn.grayFilter=new Te([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0]),gn.escapeSequence={"\\n":"\n","\\t":"\t"},gn._funMap=null,M.regClass("laya.ui.UIUtils",gn),M.regClass("Laya.UIUtils",gn),function(){f(n,N);var i=T(n);function n(){var e,t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];return b(this,n),(e=i.call(this))._anchorX=NaN,e._anchorY=NaN,e._widget=_n.EMPTY,t&&(e.preinitialize(),e.createChildren(),e.initialize()),e}return y(n,[{key:"destroy",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];m(g(n.prototype),"destroy",this).call(this,e),this._dataSource=null,this._tag=null,this._toolTip=null}},{key:"preinitialize",value:function(){}},{key:"createChildren",value:function(){}},{key:"initialize",value:function(){}},{key:"width",get:function(){return this.get_width()},set:function(e){this.set_width(e)}},{key:"get_width",value:function(){return this._width||this.measureWidth()}},{key:"measureWidth",value:function(){var e=0;this.commitMeasure();for(var t=this.numChildren-1;-1<t;t--){var i=this.getChildAt(t);i._visible&&(e=Math.max(i._x+i.width*i.scaleX,e))}return e}},{key:"commitMeasure",value:function(){}},{key:"height",get:function(){return this.get_height()},set:function(e){this.set_height(e)}},{key:"get_height",value:function(){return this._height||this.measureHeight()}},{key:"measureHeight",value:function(){var e=0;this.commitMeasure();for(var t=this.numChildren-1;-1<t;t--){var i=this.getChildAt(t);i._visible&&(e=Math.max(i._y+i.height*i.scaleY,e))}return e}},{key:"dataSource",get:function(){return this.get_dataSource()},set:function(e){this.set_dataSource(e)}},{key:"get_dataSource",value:function(){return this._dataSource}},{key:"set_dataSource",value:function(e){for(var t in this._dataSource=e,this._dataSource)t in this&&"function"!=typeof this[t]&&(this[t]=this._dataSource[t])}},{key:"top",get:function(){return this.get_top()},set:function(e){this.set_top(e)}},{key:"get_top",value:function(){return this._widget.top}},{key:"set_top",value:function(e){e!=this._widget.top&&(this._getWidget().top=e)}},{key:"bottom",get:function(){return this.get_bottom()},set:function(e){this.set_bottom(e)}},{key:"get_bottom",value:function(){return this._widget.bottom}},{key:"set_bottom",value:function(e){e!=this._widget.bottom&&(this._getWidget().bottom=e)}},{key:"left",get:function(){return this._widget.left},set:function(e){e!=this._widget.left&&(this._getWidget().left=e)}},{key:"right",get:function(){return this._widget.right},set:function(e){e!=this._widget.right&&(this._getWidget().right=e)}},{key:"centerX",get:function(){return this._widget.centerX},set:function(e){e!=this._widget.centerX&&(this._getWidget().centerX=e)}},{key:"centerY",get:function(){return this._widget.centerY},set:function(e){e!=this._widget.centerY&&(this._getWidget().centerY=e)}},{key:"_sizeChanged",value:function(){isNaN(this._anchorX)||(this.pivotX=this.anchorX*this.width),isNaN(this._anchorY)||(this.pivotY=this.anchorY*this.height),this.event(Me.RESIZE),this._widget!==_n.EMPTY&&this._widget.resetLayout()}},{key:"tag",get:function(){return this._tag},set:function(e){this._tag=e}},{key:"toolTip",get:function(){return this._toolTip},set:function(e){this._toolTip!=e&&(null!=(this._toolTip=e)?(this.on(Me.MOUSE_OVER,this,this.onMouseOver),this.on(Me.MOUSE_OUT,this,this.onMouseOut)):(this.off(Me.MOUSE_OVER,this,this.onMouseOver),this.off(Me.MOUSE_OUT,this,this.onMouseOut)))}},{key:"onMouseOver",value:function(e){L.stage.event(yn.SHOW_TIP,this._toolTip)}},{key:"onMouseOut",value:function(e){L.stage.event(yn.HIDE_TIP,this._toolTip)}},{key:"gray",get:function(){return this._gray},set:function(e){e!==this._gray&&(this._gray=e,gn.gray(this,e))}},{key:"disabled",get:function(){return this._disabled},set:function(e){e!==this._disabled&&(this.gray=this._disabled=e,this.mouseEnabled=!e)}},{key:"_getWidget",value:function(){return this._widget===_n.EMPTY&&(this._widget=this.addComponent(_n)),this._widget}},{key:"scaleX",get:function(){return m(g(n.prototype),"scaleX",this)},set:function(e){this.set_scaleX(e)}},{key:"set_scaleX",value:function(e){m(g(n.prototype),"get_scaleX",this).call(this)!=e&&(m(g(n.prototype),"set_scaleX",this).call(this,e),this.event(Me.RESIZE))}},{key:"scaleY",get:function(){return m(g(n.prototype),"scaleY",this)},set:function(e){this.set_scaleY(e)}},{key:"set_scaleY",value:function(e){m(g(n.prototype),"get_scaleY",this).call(this)!=e&&(m(g(n.prototype),"set_scaleY",this).call(this,e),this.event(Me.RESIZE))}},{key:"onCompResize",value:function(){this._sizeChanged()}},{key:"set_width",value:function(e){m(g(n.prototype),"get_width",this).call(this)!=e&&(m(g(n.prototype),"set_width",this).call(this,e),this.callLater(this._sizeChanged))}},{key:"set_height",value:function(e){m(g(n.prototype),"get_height",this).call(this)!=e&&(m(g(n.prototype),"set_height",this).call(this,e),this.callLater(this._sizeChanged))}},{key:"anchorX",get:function(){return this.get_anchorX()},set:function(e){this.set_anchorX(e)}},{key:"get_anchorX",value:function(){return this._anchorX}},{key:"set_anchorX",value:function(e){this._anchorX!=e&&(this._anchorX=e,this.callLater(this._sizeChanged))}},{key:"anchorY",get:function(){return this.get_anchorY()},set:function(e){this.set_anchorY(e)}},{key:"get_anchorY",value:function(){return this._anchorY}},{key:"set_anchorY",value:function(e){this._anchorY!=e&&(this._anchorY=e,this.callLater(this._sizeChanged))}},{key:"_childChanged",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;this.callLater(this._sizeChanged),m(g(n.prototype),"_childChanged",this).call(this,e)}}]),n}()),vn=(L.regClass(mn),M.regClass("laya.ui.UIComponent",mn),M.regClass("Laya.UIComponent",mn),function(){f(t,mn);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"dataSource",get:function(){return m(g(t.prototype),"dataSource",this)},set:function(e){for(var t in this._dataSource=e){var i=this.getChildByName(t);i?i.dataSource=e[t]:t in this&&!(this[t]instanceof Function)&&(this[t]=e[t])}}},{key:"bgColor",get:function(){return this._bgColor},set:function(e){(this._bgColor=e)?(this._onResize(null),this.on(Me.RESIZE,this,this._onResize)):(this.graphics.clear(),this.off(Me.RESIZE,this,this._onResize))}},{key:"_onResize",value:function(e){this.graphics.clear(),this.graphics.drawRect(0,0,this.width,this.height,this._bgColor)}}]),t}()),xn=(L.regClass(vn),M.regClass("laya.ui.Box",vn),M.regClass("Laya.Box",vn),y(function e(){b(this,e)})),kn=(xn.defaultSizeGrid=[4,4,4,4,0],xn.labelColor="#000000",xn.labelPadding=[2,2,2,2],xn.inputLabelPadding=[1,1,1,3],xn.buttonStateNum=3,xn.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"],xn.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"],xn.scrollBarMinNum=15,xn.scrollBarDelayTime=500,function(){f(i,Wt);var t=T(i);function i(){var e;return b(this,i),(e=t.apply(this,arguments)).autoCacheCmd=!0,e._width=0,e._height=0,e.uv=null,e}return y(i,[{key:"destroy",value:function(){m(g(i.prototype),"destroy",this).call(this),this._source=null,this._sizeGrid=null,this._offset=null}},{key:"sizeGrid",get:function(){return this._sizeGrid},set:function(e){this._sizeGrid=e.map(function(e){return+e}),this._setChanged()}},{key:"width",get:function(){return this._width||(this._source?this._source.sourceWidth:0)},set:function(e){this._width!=e&&(this._width=e,this._setChanged())}},{key:"height",get:function(){return this._height||(this._source?this._source.sourceHeight:0)},set:function(e){this._height!=e&&(this._height=e,this._setChanged())}},{key:"source",get:function(){return this._source},set:function(e){e?(this._source=e,this._setChanged()):(this._source=null,this.clear())}},{key:"_setChanged",value:function(){this._isChanged||(this._isChanged=!0,L.timer.callLater(this,this.changeSource))}},{key:"changeSource",value:function(){this._isChanged=!1;var e=this._source;if(e&&e.bitmap){var t=this.width,i=this.height,n=this._sizeGrid,a=e.sourceWidth,s=e.sourceHeight;if(n&&(a!==t||s!==i))return this.clear(),this.draw9Grid(e,0,0,t,i,n),void this._repaint();this.clear(),this.drawTexture(e,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,t,i,null,1,null,null,this.uv),this._repaint()}}},{key:"drawBitmap",value:function(e,t,i,n){var a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0;a<.1||s<.1||(!e||t.width==a&&t.height==s?this.drawImage(t,i,n,a,s):this.fillTexture(t,i,n,a,s))}}],[{key:"getTexture",value:function(e,t,i,n,a){var s;return n<=0&&(n=1),a<=0&&(a=1),e.$_GID||(e.$_GID=Se.getGID()),s=s&&s._getSource()?s:vt.createFromTexture(e,t,i,n,a)}}]),i}()),wn=(M.regClass("laya.ui.AutoBitmap",kn),M.regClass("Laya.AutoBitmap",kn),function(){f(a,mn);var n=T(a);function a(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";return b(this,a),(e=n.call(this))._labelColors=xn.buttonLabelColors,e._state=0,e._autoSize=!0,e._stateNum=xn.buttonStateNum,e._stateChanged=!1,e.skin=t,e.label=i,e}return y(a,[{key:"destroy",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];m(g(a.prototype),"destroy",this).call(this,e),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy(e),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null}},{key:"createChildren",value:function(){this.graphics=this._bitmap=new kn}},{key:"createText",value:function(){this._text||(this._text=new ii,this._text.overflow=ii.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)}},{key:"initialize",value:function(){1!==this._mouseState&&(this.mouseEnabled=!0,this._setBit(Ht.HAS_MOUSE,!0)),this._createListener(Me.MOUSE_OVER,this,this.onMouse,null,!1,!1),this._createListener(Me.MOUSE_OUT,this,this.onMouse,null,!1,!1),this._createListener(Me.MOUSE_DOWN,this,this.onMouse,null,!1,!1),this._createListener(Me.MOUSE_UP,this,this.onMouse,null,!1,!1),this._createListener(Me.CLICK,this,this.onMouse,null,!1,!1)}},{key:"onMouse",value:function(e){if(!1!==this.toggle||!this._selected)return e.type===Me.CLICK?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(this._selected||(this.state=a.stateMap[e.type]))}},{key:"skin",get:function(){return this._skin},set:function(e){this._skin!=e&&(!(this._skin=e)||E.getRes(e)?this._skinLoaded():L.loader.load(this._skin,x.create(this,this._skinLoaded),null,E.IMAGE,1))}},{key:"_skinLoaded",value:function(){this.callLater(this.changeClips),this._setStateChanged(),this._sizeChanged(),this.event(Me.LOADED)}},{key:"stateNum",get:function(){return this._stateNum},set:function(e){"string"==typeof e&&(e=parseInt(e)),this._stateNum!=e&&(this._stateNum=e<1?1:3<e?3:e,this.callLater(this.changeClips))}},{key:"changeClips",value:function(){var e=E.getRes(this._skin);if(e){var t=e.sourceWidth,i=e.sourceHeight/this._stateNum,n=(e.$_GID||(e.$_GID=Se.getGID()),e.$_GID+"-"+this._stateNum),a=Ai.I.get(n);if(a=Se.isOkTextureList(a)?a:null)this._sources=a;else{if(this._sources=[],1===this._stateNum)this._sources.push(e);else for(var s=0;s<this._stateNum;s++)this._sources.push(vt.createFromTexture(e,0,i*s,t,i));Ai.I.set(n,this._sources)}this._autoSize?(this._bitmap.width=this._width||t,this._bitmap.height=this._height||i,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=t)}}},{key:"measureWidth",value:function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}},{key:"measureHeight",value:function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}},{key:"label",get:function(){return this._text?this._text.text:null},set:function(e){(this._text||e)&&(this.createText(),this._text.text!=e&&(e&&!this._text.parent&&this.addChild(this._text),this._text.text=(e+"").replace(/\\n/g,"\n"),this._setStateChanged()))}},{key:"selected",get:function(){return this._selected},set:function(e){this._selected!=e&&(this._selected=e,this.state=this._selected?2:0,this.event(Me.CHANGE))}},{key:"state",get:function(){return this._state},set:function(e){this._state!=e&&(this._state=e,this._setStateChanged())}},{key:"changeState",value:function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var e=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[e]),this.label&&(this._text.color=this._labelColors[e],this._strokeColors&&(this._text.strokeColor=this._strokeColors[e]))}},{key:"labelColors",get:function(){return this._labelColors.join(",")},set:function(e){this._labelColors=gn.fillArray(xn.buttonLabelColors,e,String),this._setStateChanged()}},{key:"strokeColors",get:function(){return this._strokeColors?this._strokeColors.join(","):""},set:function(e){this._strokeColors=gn.fillArray(xn.buttonLabelColors,e,String),this._setStateChanged()}},{key:"labelPadding",get:function(){return this.createText(),this._text.padding.join(",")},set:function(e){this.createText(),this._text.padding=gn.fillArray(xn.labelPadding,e,Number)}},{key:"labelSize",get:function(){return this.createText(),this._text.fontSize},set:function(e){this.createText(),this._text.fontSize=e}},{key:"labelStroke",get:function(){return this.createText(),this._text.stroke},set:function(e){this.createText(),this._text.stroke=e}},{key:"labelStrokeColor",get:function(){return this.createText(),this._text.strokeColor},set:function(e){this.createText(),this._text.strokeColor=e}},{key:"labelBold",get:function(){return this.createText(),this._text.bold},set:function(e){this.createText(),this._text.bold=e}},{key:"labelFont",get:function(){return this.createText(),this._text.font},set:function(e){this.createText(),this._text.font=e}},{key:"labelAlign",get:function(){return this.createText(),this._text.align},set:function(e){this.createText(),this._text.align=e}},{key:"clickHandler",get:function(){return this._clickHandler},set:function(e){this._clickHandler=e}},{key:"text",get:function(){return this.createText(),this._text}},{key:"sizeGrid",get:function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},set:function(e){this._bitmap.sizeGrid=gn.fillArray(xn.defaultSizeGrid,e,Number)}},{key:"width",get:function(){return m(g(a.prototype),"get_width",this).call(this)},set:function(e){m(g(a.prototype),"set_width",this).call(this,e),this._autoSize&&(this._bitmap.width=e,this._text&&(this._text.width=e))}},{key:"height",get:function(){return m(g(a.prototype),"get_height",this).call(this)},set:function(e){m(g(a.prototype),"set_height",this).call(this,e),this._autoSize&&(this._bitmap.height=e,this._text&&(this._text.height=e))}},{key:"dataSource",get:function(){return m(g(a.prototype),"get_dataSource",this).call(this)},set:function(e){"number"==typeof(this._dataSource=e)||"string"==typeof e?this.label=e+"":m(g(a.prototype),"set_dataSource",this).call(this,e)}},{key:"iconOffset",get:function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},set:function(e){this._bitmap._offset=e?gn.fillArray([1,1],e,Number):[]}},{key:"_setStateChanged",value:function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))}}]),a}()),bn=(wn.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0},L.regClass(wn),M.regClass("laya.ui.Button",wn),M.regClass("Laya.Button",wn),function(){f(n,wn);var i=T(n);function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";return b(this,n),(e=i.call(this,e,t)).toggle=!0,e._autoSize=!1,e}return y(n,[{key:"preinitialize",value:function(){m(g(n.prototype),"preinitialize",this).call(this),this.toggle=!0,this._autoSize=!1}},{key:"initialize",value:function(){m(g(n.prototype),"initialize",this).call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0}},{key:"dataSource",get:function(){return m(g(n.prototype),"dataSource",this)},set:function(e){(this._dataSource=e)instanceof Boolean?this.selected=e:"string"==typeof e?this.selected="true"===e:U(g(n.prototype),"dataSource",e,this,!0)}}]),n}()),h=(L.regClass(bn),M.regClass("laya.ui.CheckBox",bn),M.regClass("Laya.CheckBox",bn),function(){f(n,mn);var i=T(n);function n(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;return b(this,n),(e=i.call(this)).skin=t,e}return y(n,[{key:"destroy",value:function(){m(g(n.prototype),"destroy",this).call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null}},{key:"dispose",value:function(){this.destroy(!0),L.loader.clearRes(this._skin)}},{key:"createChildren",value:function(){this.graphics=this._bitmap=new kn,this._bitmap.autoCacheCmd=!1}},{key:"skin",get:function(){return this._skin},set:function(e){this._skin!=e&&((this._skin=e)?(e=E.getRes(e))?(this.source=e,this.onCompResize()):L.loader.load(this._skin,x.create(this,this.setSource,[this._skin]),null,E.IMAGE,1,!0,this._group):this.source=null)}},{key:"source",get:function(){return this._bitmap.source},set:function(e){this._bitmap&&(this._bitmap.source=e,this.event(Me.LOADED),this.repaint())}},{key:"group",get:function(){return this._group},set:function(e){e&&this._skin&&E.setGroup(this._skin,e),this._group=e}},{key:"setSource",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;e===this._skin&&t&&(this.source=t,this.onCompResize())}},{key:"measureWidth",value:function(){return this._bitmap.width}},{key:"measureHeight",value:function(){return this._bitmap.height}},{key:"width",get:function(){return m(g(n.prototype),"width",this)},set:function(e){U(g(n.prototype),"width",e,this,!0),this._bitmap.width=0==e?1e-7:e}},{key:"height",get:function(){return m(g(n.prototype),"height",this)},set:function(e){U(g(n.prototype),"height",e,this,!0),this._bitmap.height=0==e?1e-7:e}},{key:"sizeGrid",get:function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},set:function(e){this._bitmap.sizeGrid=gn.fillArray(xn.defaultSizeGrid,e,Number)}},{key:"dataSource",get:function(){return m(g(n.prototype),"dataSource",this)},set:function(e){"string"==typeof(this._dataSource=e)?this.skin=e:U(g(n.prototype),"dataSource",e,this,!0)}}]),n}()),Sn=(L.regClass(h),M.regClass("laya.ui.Image",h),M.regClass("Laya.Image",h),function(){f(n,mn);var i=T(n);function n(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";return b(this,n),(e=i.call(this)).text=t,e}return y(n,[{key:"destroy",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];m(g(n.prototype),"destroy",this).call(this,e),this._tf=null}},{key:"createChildren",value:function(){this.addChild(this._tf=new ii)}},{key:"text",get:function(){return this._tf.text},set:function(e){this._tf.text!=e&&(e=e&&gn.adptString(e+""),this._tf.text=e,this.event(Me.CHANGE),this._width&&this._height||this.onCompResize())}},{key:"changeText",value:function(e){this._tf.changeText(e)}},{key:"wordWrap",get:function(){return this._tf.wordWrap},set:function(e){this._tf.wordWrap=e}},{key:"color",get:function(){return this._tf.color},set:function(e){this._tf.color=e}},{key:"font",get:function(){return this._tf.font},set:function(e){this._tf.font=e}},{key:"align",get:function(){return this._tf.align},set:function(e){this._tf.align=e}},{key:"valign",get:function(){return this._tf.valign},set:function(e){this._tf.valign=e}},{key:"bold",get:function(){return this._tf.bold},set:function(e){this._tf.bold=e}},{key:"italic",get:function(){return this._tf.italic},set:function(e){this._tf.italic=e}},{key:"leading",get:function(){return this._tf.leading},set:function(e){this._tf.leading=e}},{key:"fontSize",get:function(){return this._tf.fontSize},set:function(e){this._tf.fontSize=e}},{key:"padding",get:function(){return this._tf.padding.join(",")},set:function(e){this._tf.padding=gn.fillArray(xn.labelPadding,e,Number)}},{key:"bgColor",get:function(){return this._tf.bgColor},set:function(e){this._tf.bgColor=e}},{key:"borderColor",get:function(){return this._tf.borderColor},set:function(e){this._tf.borderColor=e}},{key:"stroke",get:function(){return this._tf.stroke},set:function(e){this._tf.stroke=e}},{key:"strokeColor",get:function(){return this._tf.strokeColor},set:function(e){this._tf.strokeColor=e}},{key:"textField",get:function(){return this._tf}},{key:"measureWidth",value:function(){return this._tf.width}},{key:"measureHeight",value:function(){return this._tf.height}},{key:"width",get:function(){return this._width||this._tf.text?m(g(n.prototype),"width",this):0},set:function(e){U(g(n.prototype),"width",e,this,!0),this._tf.width=e}},{key:"height",get:function(){return this._height||this._tf.text?m(g(n.prototype),"height",this):0},set:function(e){U(g(n.prototype),"height",e,this,!0),this._tf.height=e}},{key:"dataSource",get:function(){return m(g(n.prototype),"dataSource",this)},set:function(e){"number"==typeof(this._dataSource=e)||"string"==typeof e?this.text=e+"":U(g(n.prototype),"dataSource",e,this,!0)}},{key:"overflow",get:function(){return this._tf.overflow},set:function(e){this._tf.overflow=e}},{key:"underline",get:function(){return this._tf.underline},set:function(e){this._tf.underline=e}},{key:"underlineColor",get:function(){return this._tf.underlineColor},set:function(e){this._tf.underlineColor=e}}]),n}()),In=(L.regClass(Sn),M.regClass("laya.ui.Label",Sn),M.regClass("Laya.Label",Sn),function(){f(n,mn);var i=T(n);function n(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;return b(this,n),(e=i.call(this))._value=.5,e.skin=t,e}return y(n,[{key:"destroy",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];m(g(n.prototype),"destroy",this).call(this,e),this._bg&&this._bg.destroy(e),this._bar&&this._bar.destroy(e),this._bg=this._bar=null,this.changeHandler=null}},{key:"createChildren",value:function(){this.addChild(this._bg=new h),this.addChild(this._bar=new h),this._bar._bitmap.autoCacheCmd=!1}},{key:"skin",get:function(){return this._skin},set:function(e){this._skin!=e&&(this._skin=e,this._skin&&!E.getRes(this._skin)?L.loader.load(this._skin,x.create(this,this._skinLoaded),null,E.IMAGE,1):this._skinLoaded())}},{key:"_skinLoaded",value:function(){this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue),this._sizeChanged(),this.event(Me.LOADED)}},{key:"measureWidth",value:function(){return this._bg.width}},{key:"measureHeight",value:function(){return this._bg.height}},{key:"value",get:function(){return this._value},set:function(e){this._value!=e&&(this._value=e=1<e?1:e<0?0:e,this.callLater(this.changeValue),this.event(Me.CHANGE),this.changeHandler&&this.changeHandler.runWith(e))}},{key:"changeValue",value:function(){var e,t,i;this.sizeGrid?(t=this.sizeGrid.split(","),e=Number(t[3]),t=Number(t[1]),i=(this.width-e-t)*this._value,this._bar.width=e+t+i,this._bar.visible=this._bar.width>e+t):this._bar.width=this.width*this._value}},{key:"bar",get:function(){return this._bar}},{key:"bg",get:function(){return this._bg}},{key:"sizeGrid",get:function(){return this._bg.sizeGrid},set:function(e){this._bg.sizeGrid=this._bar.sizeGrid=e}},{key:"width",get:function(){return m(g(n.prototype),"width",this)},set:function(e){U(g(n.prototype),"width",e,this,!0),this._bg.width=this._width,this.callLater(this.changeValue)}},{key:"height",get:function(){return m(g(n.prototype),"height",this)},set:function(e){U(g(n.prototype),"height",e,this,!0),this._bg.height=this._height,this._bar.height=this._height}},{key:"dataSource",get:function(){return m(g(n.prototype),"dataSource",this)},set:function(e){"number"==typeof(this._dataSource=e)||"string"==typeof e?this.value=Number(e):U(g(n.prototype),"dataSource",e,this,!0)}}]),n}()),Tn=(L.regClass(In),M.regClass("laya.ui.ProgressBar",In),M.regClass("Laya.ProgressBar",In),function(){f(n,wn);var i=T(n);function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";return b(this,n),(e=i.call(this,e,t)).toggle=!1,e._autoSize=!1,e}return y(n,[{key:"destroy",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];m(g(n.prototype),"destroy",this).call(this,e),this._value=null}},{key:"preinitialize",value:function(){m(g(n.prototype),"preinitialize",this).call(this),this.toggle=!1,this._autoSize=!1}},{key:"initialize",value:function(){m(g(n.prototype),"initialize",this).call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on(Me.CLICK,this,this.onClick)}},{key:"onClick",value:function(e){this.selected=!0}},{key:"value",get:function(){return null!=this._value?this._value:this.label},set:function(e){this._value=e}}]),n}()),Cn=(L.regClass(Tn),M.regClass("laya.ui.Radio",Tn),M.regClass("Laya.Radio",Tn),function(){f(a,vn);var n=T(a);function a(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return b(this,a),(e=n.call(this))._selectedIndex=-1,e._direction="horizontal",e._space=0,e.skin=i,e.labels=t,e}return y(a,[{key:"preinitialize",value:function(){this.mouseEnabled=!0}},{key:"destroy",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];m(g(a.prototype),"destroy",this).call(this,e),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null}},{key:"addItem",value:function(e){var t,i=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=this._items.length;return e.name="item"+n,this.addChild(e),this.initItems(),i&&0<n?(t=this._items[n-1],"horizontal"==this._direction?e.x=t._x+t.width+this._space:e.y=t._y+t.height+this._space):i&&(e.x=0,e.y=0),n}},{key:"delItem",value:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],i=this._items.indexOf(e);if(-1!=i){var n=e;this.removeChild(n);for(var a=i+1,s=this._items.length;a<s;a++){var r=this._items[a];r.name="item"+(a-1),t&&("horizontal"==this._direction?r.x-=n.width+this._space:r.y-=n.height+this._space)}this.initItems(),-1<this._selectedIndex&&(e=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=e)}}},{key:"_afterInited",value:function(){this.initItems()}},{key:"initItems",value:function(){this._items||(this._items=[]);for(var e=this._items.length=0;e<1e4;e++){var t=this.getChildByName("item"+e);if(null==t)break;this._items.push(t),t.selected=e===this._selectedIndex,t.clickHandler=x.create(this,this.itemClick,[e],!1)}}},{key:"itemClick",value:function(e){this.selectedIndex=e}},{key:"selectedIndex",get:function(){return this._selectedIndex},set:function(e){this._selectedIndex!=e&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=e,this.setSelect(e,!0),this.event(Me.CHANGE),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}},{key:"setSelect",value:function(e,t){this._items&&-1<e&&e<this._items.length&&(this._items[e].selected=t)}},{key:"skin",get:function(){return this._skin},set:function(e){this._skin!=e&&(this._skin=e,this._skin&&!E.getRes(this._skin)?L.loader.load(this._skin,x.create(this,this._skinLoaded),null,E.IMAGE,1):this._skinLoaded())}},{key:"_skinLoaded",value:function(){this._setLabelChanged(),this.event(Me.LOADED)}},{key:"labels",get:function(){return this._labels},set:function(e){if(this._labels!=e){if(this._labels=e,this.removeChildren(),this._setLabelChanged(),this._labels)for(var t=this._labels.split(","),i=0,n=t.length;i<n;i++){var a=this.createItem(this._skin,t[i]);a.name="item"+i,this.addChild(a)}this.initItems()}}},{key:"createItem",value:function(e,t){return null}},{key:"labelColors",get:function(){return this._labelColors},set:function(e){this._labelColors!=e&&(this._labelColors=e,this._setLabelChanged())}},{key:"labelStroke",get:function(){return this._labelStroke},set:function(e){this._labelStroke!=e&&(this._labelStroke=e,this._setLabelChanged())}},{key:"labelStrokeColor",get:function(){return this._labelStrokeColor},set:function(e){this._labelStrokeColor!=e&&(this._labelStrokeColor=e,this._setLabelChanged())}},{key:"strokeColors",get:function(){return this._strokeColors},set:function(e){this._strokeColors!=e&&(this._strokeColors=e,this._setLabelChanged())}},{key:"labelSize",get:function(){return this._labelSize},set:function(e){this._labelSize!=e&&(this._labelSize=e,this._setLabelChanged())}},{key:"stateNum",get:function(){return this._stateNum},set:function(e){this._stateNum!=e&&(this._stateNum=e,this._setLabelChanged())}},{key:"labelBold",get:function(){return this._labelBold},set:function(e){this._labelBold!=e&&(this._labelBold=e,this._setLabelChanged())}},{key:"labelFont",get:function(){return this._labelFont},set:function(e){this._labelFont!=e&&(this._labelFont=e,this._setLabelChanged())}},{key:"labelPadding",get:function(){return this._labelPadding},set:function(e){this._labelPadding!=e&&(this._labelPadding=e,this._setLabelChanged())}},{key:"direction",get:function(){return this._direction},set:function(e){this._direction=e,this._setLabelChanged()}},{key:"space",get:function(){return this._space},set:function(e){this._space=e,this._setLabelChanged()}},{key:"changeLabels",value:function(){if(this._labelChanged=!1,this._items)for(var e=0,t=0,i=this._items.length;t<i;t++){var n=this._items[t];this._skin&&(n.skin=this._skin),this._labelColors&&(n.labelColors=this._labelColors),this._labelSize&&(n.labelSize=this._labelSize),this._labelStroke&&(n.labelStroke=this._labelStroke),this._labelStrokeColor&&(n.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(n.strokeColors=this._strokeColors),this._labelBold&&(n.labelBold=this._labelBold),this._labelPadding&&(n.labelPadding=this._labelPadding),this._labelAlign&&(n.labelAlign=this._labelAlign),this._stateNum&&(n.stateNum=this._stateNum),this._labelFont&&(n.labelFont=this._labelFont),"horizontal"===this._direction?(n.y=0,n.x=e,e+=n.width+this._space):(n.x=0,n.y=e,e+=n.height+this._space)}this._sizeChanged()}},{key:"commitMeasure",value:function(){this.runCallLater(this.changeLabels)}},{key:"items",get:function(){return this._items}},{key:"selection",get:function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},set:function(e){this.selectedIndex=this._items.indexOf(e)}},{key:"dataSource",get:function(){return m(g(a.prototype),"dataSource",this)},set:function(e){"number"==typeof(this._dataSource=e)||"string"==typeof e?this.selectedIndex=parseInt(e):e instanceof Array?this.labels=e.join(","):U(g(a.prototype),"dataSource",e,this,!0)}},{key:"_setLabelChanged",value:function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))}}]),a}()),Mn=(L.regClass(Cn),M.regClass("laya.ui.UIGroup",Cn),M.regClass("Laya.UIGroup",Cn),function(){f(t,Cn);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"createItem",value:function(e,t){return new Tn(e,t)}}]),t}()),En=(L.regClass(Mn),M.regClass("laya.ui.RadioGroup",Mn),M.regClass("Laya.RadioGroup",Mn),function(){f(t,Cn);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"createItem",value:function(e,t){return new wn(e,t)}}]),t}()),Rn=(L.regClass(En),M.regClass("laya.ui.Tab",En),M.regClass("Laya.Tab",En),function(){f(i,vn);var t=T(i);function i(){var e;return b(this,i),(e=t.apply(this,arguments))._setIndexHandler=x.create(O(e),e.setIndex,null,!1),e}return y(i,[{key:"setItems",value:function(e){this.removeChildren();for(var t=0,i=0,n=e.length;i<n;i++){var a=e[i];a&&(a.name="item"+t,this.addChild(a),t++)}this.initItems()}},{key:"addItem",value:function(e){e.name="item"+this._items.length,this.addChild(e),this.initItems()}},{key:"_afterInited",value:function(){this.initItems()}},{key:"initItems",value:function(){this._items=[];for(var e=0;e<1e4;e++){var t=this.getChildByName("item"+e);if(null==t)break;this._items.push(t),t.visible=e==this._selectedIndex}}},{key:"selectedIndex",get:function(){return this._selectedIndex},set:function(e){this._selectedIndex!=e&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=e,this.setSelect(this._selectedIndex,!0))}},{key:"setSelect",value:function(e,t){this._items&&-1<e&&e<this._items.length&&(this._items[e].visible=t)}},{key:"selection",get:function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},set:function(e){this.selectedIndex=this._items.indexOf(e)}},{key:"setIndexHandler",get:function(){return this._setIndexHandler},set:function(e){this._setIndexHandler=e}},{key:"setIndex",value:function(e){this.selectedIndex=e}},{key:"items",get:function(){return this._items}},{key:"dataSource",get:function(){return m(g(i.prototype),"dataSource",this)},set:function(e){if("number"==typeof(this._dataSource=e)||"string"==typeof e)this.selectedIndex=parseInt(e);else for(var t in this._dataSource)t in this&&(this[t]=this._dataSource[t])}}]),i}()),An=(L.regClass(Rn),M.regClass("laya.ui.ViewStack",Rn),M.regClass("Laya.ViewStack",Rn),function(){f(n,Sn);var i=T(n);function n(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";return b(this,n),(e=i.call(this)).text=t,e.skin=e.skin,e}return y(n,[{key:"preinitialize",value:function(){this.mouseEnabled=!0}},{key:"destroy",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];m(g(n.prototype),"destroy",this).call(this,e),this._bg&&this._bg.destroy(),this._bg=null}},{key:"createChildren",value:function(){this.addChild(this._tf=new ni),this._tf.padding=xn.inputLabelPadding,this._tf.on(Me.INPUT,this,this._onInput),this._tf.on(Me.ENTER,this,this._onEnter),this._tf.on(Me.BLUR,this,this._onBlur),this._tf.on(Me.FOCUS,this,this._onFocus)}},{key:"_onFocus",value:function(){this.event(Me.FOCUS,this)}},{key:"_onBlur",value:function(){this.event(Me.BLUR,this)}},{key:"_onInput",value:function(){this.event(Me.INPUT,this)}},{key:"_onEnter",value:function(){this.event(Me.ENTER,this)}},{key:"initialize",value:function(){this.width=128,this.height=22}},{key:"bg",get:function(){return this._bg},set:function(e){this.graphics=this._bg=e}},{key:"skin",get:function(){return this._skin},set:function(e){this._skin!=e&&(this._skin=e,this._skin&&!E.getRes(this._skin)?L.loader.load(this._skin,x.create(this,this._skinLoaded),null,E.IMAGE,1):this._skinLoaded())}},{key:"_skinLoaded",value:function(){this._bg||(this.graphics=this._bg=new kn),this._bg.source=E.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height),this._sizeChanged(),this.event(Me.LOADED)}},{key:"sizeGrid",get:function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},set:function(e){this._bg||(this.graphics=this._bg=new kn),this._bg.sizeGrid=gn.fillArray(xn.defaultSizeGrid,e,Number)}},{key:"text",get:function(){return m(g(n.prototype),"text",this)},set:function(e){this._tf.text!=e&&(this._tf.text=e+="",this.event(Me.CHANGE))}},{key:"width",get:function(){return m(g(n.prototype),"width",this)},set:function(e){U(g(n.prototype),"width",e,this,!0),this._bg&&(this._bg.width=e)}},{key:"height",get:function(){return m(g(n.prototype),"height",this)},set:function(e){U(g(n.prototype),"height",e,this,!0),this._bg&&(this._bg.height=e)}},{key:"multiline",get:function(){return this._tf.multiline},set:function(e){this._tf.multiline=e}},{key:"editable",get:function(){return this._tf.editable},set:function(e){this._tf.editable=e}},{key:"select",value:function(){this._tf.select()}},{key:"restrict",get:function(){return this._tf.restrict},set:function(e){this._tf.restrict=e}},{key:"prompt",get:function(){return this._tf.prompt},set:function(e){this._tf.prompt=e}},{key:"promptColor",get:function(){return this._tf.promptColor},set:function(e){this._tf.promptColor=e}},{key:"maxChars",get:function(){return this._tf.maxChars},set:function(e){this._tf.maxChars=e}},{key:"focus",get:function(){return this._tf.focus},set:function(e){this._tf.focus=e}},{key:"type",get:function(){return this._tf.type},set:function(e){this._tf.type=e}},{key:"setSelection",value:function(e,t){this._tf.setSelection(e,t)}}]),n}()),Ln=(L.regClass(An),M.regClass("laya.ui.TextInput",An),M.regClass("Laya.TextInput",An),function(){f(n,mn);var i=T(n);function n(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;return b(this,n),(e=i.call(this)).isVertical=!0,e.showLabel=!0,e._max=100,e._min=0,e._tick=1,e._value=0,n.label||(n.label=new Sn),e.skin=t,e}return y(n,[{key:"destroy",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];m(g(n.prototype),"destroy",this).call(this,e),this._bg&&this._bg.destroy(e),this._bar&&this._bar.destroy(e),this._progress&&this._progress.destroy(e),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null}},{key:"createChildren",value:function(){this.addChild(this._bg=new h),this.addChild(this._bar=new wn)}},{key:"initialize",value:function(){this._bar.on(Me.MOUSE_DOWN,this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0}},{key:"onBarMouseDown",value:function(e){var t=L;this._globalSacle||(this._globalSacle=new ie),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=t.stage.mouseX,this._ty=t.stage.mouseY,t.stage.on(Me.MOUSE_MOVE,this,this.mouseMove),t.stage.once(Me.MOUSE_UP,this,this.mouseUp),t.stage.once(Me.MOUSE_OUT,this,this.mouseUp),this.showValueText()}},{key:"showValueText",value:function(){var e;this.showLabel&&(this.addChild(e=n.label),e.textField.changeText(this._value+""),this.isVertical?(e.x=this._bar._x+20,e.y=.5*(this._bar.height-e.height)+this._bar._y):(e.y=this._bar._y-20,e.x=.5*(this._bar.width-e.width)+this._bar._x))}},{key:"hideValueText",value:function(){n.label&&n.label.removeSelf()}},{key:"mouseUp",value:function(e){var t=L.stage;t.off(Me.MOUSE_MOVE,this,this.mouseMove),t.off(Me.MOUSE_UP,this,this.mouseUp),t.off(Me.MOUSE_OUT,this,this.mouseUp),this.sendChangeEvent(Me.CHANGED),this.hideValueText()}},{key:"mouseMove",value:function(e){var t=L.stage,i=this._value;this.isVertical?(this._bar.y+=(t.mouseY-this._ty)/this._globalSacle.y,this._bar._y>this._maxMove?this._bar.y=this._maxMove:this._bar._y<0&&(this._bar.y=0),this._value=this._bar._y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar._y+.5*this._bar.height)):(this._bar.x+=(t.mouseX-this._tx)/this._globalSacle.x,this._bar._x>this._maxMove?this._bar.x=this._maxMove:this._bar._x<0&&(this._bar.x=0),this._value=this._bar._x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar._x+.5*this._bar.width)),this._tx=t.mouseX,this._ty=t.mouseY,0!=this._tick&&(t=Math.pow(10,(this._tick+"").length-1),this._value=Math.round(Math.round(this._value/this._tick)*this._tick*t)/t),this._value!=i&&this.sendChangeEvent(),this.showValueText()}},{key:"sendChangeEvent",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:Me.CHANGE;this.event(e),this.changeHandler&&this.changeHandler.runWith(this._value)}},{key:"skin",get:function(){return this._skin},set:function(e){this._skin!=e&&(this._skin=e,this._skin&&!E.getRes(this._skin)?L.loader.load([this._skin,this._skin.replace(".png","$bar.png")],x.create(this,this._skinLoaded)):this._skinLoaded())}},{key:"_skinLoaded",value:function(){this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var e=this._skin.replace(".png","$progress.png");E.getRes(e)&&(this._progress||(this.addChild(this._progress=new h),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=e),this.setBarPoint(),this.callLater(this.changeValue),this._sizeChanged(),this.event(Me.LOADED)}},{key:"setBarPoint",value:function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))}},{key:"measureWidth",value:function(){return Math.max(this._bg.width,this._bar.width)}},{key:"measureHeight",value:function(){return Math.max(this._bg.height,this._bar.height)}},{key:"_sizeChanged",value:function(){m(g(n.prototype),"_sizeChanged",this).call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()}},{key:"sizeGrid",get:function(){return this._bg.sizeGrid},set:function(e){this._bg.sizeGrid=e,this._bar.sizeGrid=e,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}},{key:"setSlider",value:function(e,t,i){this._value=-1,this._min=e,this._max=e<t?t:e,this.value=i<e?e:t<i?t:i}},{key:"tick",get:function(){return this._tick},set:function(e){this._tick!=e&&(this._tick=e,this.callLater(this.changeValue))}},{key:"changeValue",value:function(){0!=this.tick&&(e=Math.pow(10,(this._tick+"").length-1),this._value=Math.round(Math.round(this._value/this._tick)*this._tick*e)/e),this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var e=this._max-this._min;0===e&&(e=1),this.isVertical?(this._bar.y=(this._value-this._min)/e*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar._y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/e*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar._x+.5*this._bar.width))}},{key:"max",get:function(){return this._max},set:function(e){this._max!=e&&(this._max=e,this.callLater(this.changeValue))}},{key:"min",get:function(){return this._min},set:function(e){this._min!=e&&(this._min=e,this.callLater(this.changeValue))}},{key:"value",get:function(){return this._value},set:function(e){var t;this._value!=e&&(t=this._value,this._value=e,this.changeValue(),this._value!=t&&this.sendChangeEvent())}},{key:"allowClickBack",get:function(){return this._allowClickBack},set:function(e){this._allowClickBack!=e&&((this._allowClickBack=e)?this._bg.on(Me.MOUSE_DOWN,this,this.onBgMouseDown):this._bg.off(Me.MOUSE_DOWN,this,this.onBgMouseDown))}},{key:"onBgMouseDown",value:function(e){var t=this._bg.getMousePoint();this.isVertical?this.value=t.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=t.x/(this.width-this._bar.width)*(this._max-this._min)+this._min}},{key:"dataSource",get:function(){return m(g(n.prototype),"dataSource",this)},set:function(e){"number"==typeof(this._dataSource=e)||"string"==typeof e?this.value=Number(e):U(g(n.prototype),"dataSource",e,this,!0)}},{key:"bar",get:function(){return this._bar}}]),n}()),Nn=(Ln.label=null,L.regClass(Ln),M.regClass("laya.ui.Slider",Ln),M.regClass("Laya.Slider",Ln),y(function e(){b(this,e)})),Pn=(Nn.touchScrollEnable=!0,Nn.mouseWheelEnable=!0,Nn.showButtons=!0,Nn.popupBgColor="#000000",Nn.popupBgAlpha=.5,Nn.closeDialogOnSide=!0,window.UIConfig=Nn,function(){f(n,mn);var i=T(n);function n(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;return b(this,n),(e=i.call(this)).rollRatio=.97,e.scaleBar=!0,e.autoHide=!1,e.elasticDistance=0,e.elasticBackTime=500,e._showButtons=Nn.showButtons,e._scrollSize=1,e._thumbPercent=1,e._lastOffset=0,e._checkElastic=!1,e._isElastic=!1,e._hide=!1,e._clickOnly=!0,e._touchScrollEnable=Nn.touchScrollEnable,e._mouseWheelEnable=Nn.mouseWheelEnable,e.skin=t,e.max=1,e}return y(n,[{key:"destroy",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this.stopScroll(),this.target=null,m(g(n.prototype),"destroy",this).call(this,e),this.upButton&&this.upButton.destroy(e),this.downButton&&this.downButton.destroy(e),this.slider&&this.slider.destroy(e),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null}},{key:"createChildren",value:function(){this.addChild(this.slider=new Ln),this.addChild(this.upButton=new wn),this.addChild(this.downButton=new wn)}},{key:"initialize",value:function(){this.slider.showLabel=!1,this.slider.tick=0,this.slider.on(Me.CHANGE,this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on(Me.MOUSE_DOWN,this,this.onButtonMouseDown),this.downButton.on(Me.MOUSE_DOWN,this,this.onButtonMouseDown)}},{key:"onSliderChange",value:function(){this._value!=this.slider.value&&(this.value=this.slider.value)}},{key:"onButtonMouseDown",value:function(e){e=e.currentTarget===this.upButton;this.slide(e),L.timer.once(xn.scrollBarDelayTime,this,this.startLoop,[e]),L.stage.once(Me.MOUSE_UP,this,this.onStageMouseUp)}},{key:"startLoop",value:function(e){L.timer.frameLoop(1,this,this.slide,[e])}},{key:"slide",value:function(e){e?this.value-=this._scrollSize:this.value+=this._scrollSize}},{key:"onStageMouseUp",value:function(e){L.timer.clear(this,this.startLoop),L.timer.clear(this,this.slide)}},{key:"skin",get:function(){return this._skin},set:function(e){" "!=e&&this._skin!=e&&(this._skin=e,this._skin&&!E.getRes(this._skin)?L.loader.load([this._skin,this._skin.replace(".png","$up.png"),this._skin.replace(".png","$down.png"),this._skin.replace(".png","$bar.png")],x.create(this,this._skinLoaded)):this._skinLoaded())}},{key:"_skinLoaded",value:function(){this.slider.skin=this._skin,this.callLater(this.changeScrollBar),this._sizeChanged(),this.event(Me.LOADED)}},{key:"changeScrollBar",value:function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()}},{key:"_sizeChanged",value:function(){m(g(n.prototype),"_sizeChanged",this).call(this),this.repaint(),this.resetPositions(),this.event(Me.CHANGE),this.changeHandler&&this.changeHandler.runWith(this.value)}},{key:"resetPositions",value:function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()}},{key:"resetButtonPosition",value:function(){this.slider.isVertical?this.downButton.y=this.slider._y+this.slider.height:this.downButton.x=this.slider._x+this.slider.width}},{key:"measureWidth",value:function(){return this.slider.isVertical?this.slider.width:100}},{key:"measureHeight",value:function(){return this.slider.isVertical?100:this.slider.height}},{key:"setScroll",value:function(e,t,i){this.runCallLater(this._sizeChanged),this.slider.setSlider(e,t,i),this.slider.bar.visible=0<t,!this._hide&&this.autoHide&&(this.visible=!1)}},{key:"max",get:function(){return this.slider.max},set:function(e){this.slider.max=e}},{key:"min",get:function(){return this.slider.min},set:function(e){this.slider.min=e}},{key:"value",get:function(){return this._value},set:function(e){e!==this._value&&(this._value=e,this._isElastic||(this.slider._value!=e&&(this.slider._value=e,this.slider.changeValue()),this._value=this.slider._value),this.event(Me.CHANGE),this.changeHandler&&this.changeHandler.runWith(this._value))}},{key:"isVertical",get:function(){return this.slider.isVertical},set:function(e){this.slider.isVertical=e}},{key:"sizeGrid",get:function(){return this.slider.sizeGrid},set:function(e){this.slider.sizeGrid=e}},{key:"scrollSize",get:function(){return this._scrollSize},set:function(e){this._scrollSize=e}},{key:"dataSource",get:function(){return m(g(n.prototype),"dataSource",this)},set:function(e){"number"==typeof(this._dataSource=e)||"string"==typeof e?this.value=Number(e):U(g(n.prototype),"dataSource",e,this,!0)}},{key:"thumbPercent",get:function(){return this._thumbPercent},set:function(e){this.runCallLater(this.changeScrollBar),this.runCallLater(this._sizeChanged),this._thumbPercent=e=1<=e?.99:e,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*e,xn.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*e,xn.scrollBarMinNum))}},{key:"target",get:function(){return this._target},set:function(e){this._target&&(this._target.off(Me.MOUSE_WHEEL,this,this.onTargetMouseWheel),this._target.off(Me.MOUSE_DOWN,this,this.onTargetMouseDown)),(this._target=e)&&(this._mouseWheelEnable&&this._target.on(Me.MOUSE_WHEEL,this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on(Me.MOUSE_DOWN,this,this.onTargetMouseDown))}},{key:"hide",get:function(){return this._hide},set:function(e){this._hide=e,this.visible=!e}},{key:"showButtons",get:function(){return this._showButtons},set:function(e){this._showButtons=e,this.callLater(this.changeScrollBar)}},{key:"touchScrollEnable",get:function(){return this._touchScrollEnable},set:function(e){this._touchScrollEnable=e,this.target=this._target}},{key:"mouseWheelEnable",get:function(){return this._mouseWheelEnable},set:function(e){this._mouseWheelEnable=e,this.target=this._target}},{key:"onTargetMouseWheel",value:function(e){this.value-=e.delta*this._scrollSize,this.target=this._target}},{key:"onTargetMouseDown",value:function(e){this.isLockedFun&&!this.isLockedFun(e)||(this.event(Me.END),this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new ie),this._lastPoint.setTo(L.stage.mouseX,L.stage.mouseY),L.timer.clear(this,this.tweenMove),Ci.clearTween(this),L.stage.once(Me.MOUSE_UP,this,this.onStageMouseUp2),L.stage.once(Me.MOUSE_OUT,this,this.onStageMouseUp2),L.timer.frameLoop(1,this,this.loop))}},{key:"startDragForce",value:function(){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new ie),this._lastPoint.setTo(L.stage.mouseX,L.stage.mouseY),L.timer.clear(this,this.tweenMove),Ci.clearTween(this),L.stage.once(Me.MOUSE_UP,this,this.onStageMouseUp2),L.stage.once(Me.MOUSE_OUT,this,this.onStageMouseUp2),L.timer.frameLoop(1,this,this.loop)}},{key:"cancelDragOp",value:function(){L.stage.off(Me.MOUSE_UP,this,this.onStageMouseUp2),L.stage.off(Me.MOUSE_OUT,this,this.onStageMouseUp2),L.timer.clear(this,this.tweenMove),L.timer.clear(this,this.loop),this._target.mouseEnabled=!0}},{key:"checkTriggers",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];return 0<=this.value&&this.value-this._lastOffset<=0&&this.triggerDownDragLimit&&this.triggerDownDragLimit(e)?(this.cancelDragOp(),!(this.value=0)):!!(this.value<=this.max&&this.value-this._lastOffset>=this.max&&this.triggerUpDragLimit&&this.triggerUpDragLimit(e))&&(this.cancelDragOp(),this.value=this.max,!0)}},{key:"lastOffset",get:function(){return this._lastOffset}},{key:"startTweenMoveForce",value:function(e){this._lastOffset=e,L.timer.frameLoop(1,this,this.tweenMove,[200])}},{key:"loop",value:function(){var e=L.stage.mouseY,t=L.stage.mouseX;if(this._lastOffset=this.isVertical?e-this._lastPoint.y:t-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?L.stage._canvasTransform.getScaleY():L.stage._canvasTransform.getScaleX()))))return;if(this._clickOnly=!1,this.checkTriggers())return;this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event(Me.START)}else if(this.checkTriggers())return;this._offsets.push(this._lastOffset),this._lastPoint.x=t,this._lastPoint.y=e,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?0<this._lastOffset?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):(this.value-=.5*this._lastOffset,this._value>=this.min&&(this._checkElastic=!1)):this._value>=this.max&&(this._lastOffset<0?this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance):(this.value-=.5*this._lastOffset,this._value<=this.max&&(this._checkElastic=!1))):this.value-=this._lastOffset)}},{key:"onStageMouseUp2",value:function(e){if(L.stage.off(Me.MOUSE_UP,this,this.onStageMouseUp2),L.stage.off(Me.MOUSE_OUT,this,this.onStageMouseUp2),L.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?Ci.to(this,{value:this.min},this.elasticBackTime,Ti.sineOut,x.create(this,this.elasticOver)):this._value>this.max&&Ci.to(this,{value:this.max},this.elasticBackTime,Ti.sineOut,x.create(this,this.elasticOver));else if(this._offsets){this._offsets.length<1&&(this._offsets[0]=this.isVertical?L.stage.mouseY-this._lastPoint.y:L.stage.mouseX-this._lastPoint.x);for(var t,i=0,n=Math.min(this._offsets.length,3),a=0;a<n;a++)i+=this._offsets[this._offsets.length-1-a];this._lastOffset=i/n,(i=Math.abs(this._lastOffset))<2?this.event(Me.END):(250<i&&(this._lastOffset=0<this._lastOffset?250:-250),t=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/150))),L.timer.frameLoop(1,this,this.tweenMove,[t]))}}},{key:"elasticOver",value:function(){this._isElastic=!1,!this.hide&&this.autoHide&&Ci.to(this,{alpha:0},500),this.event(Me.END)}},{key:"tweenMove",value:function(e){var t;this._lastOffset*=this.rollRatio,this.checkTriggers(!0)||(0<e&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,t=.5*-(this.min-e-this.value),this._lastOffset>t&&(this._lastOffset=t)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,t=.5*-(this.max+e-this.value),this._lastOffset<t&&(this._lastOffset=t))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<.1&&(L.timer.clear(this,this.tweenMove),this._isElastic?this._value<this.min?Ci.to(this,{value:this.min},this.elasticBackTime,Ti.sineOut,x.create(this,this.elasticOver)):this._value>this.max?Ci.to(this,{value:this.max},this.elasticBackTime,Ti.sineOut,x.create(this,this.elasticOver)):this.elasticOver():(this.event(Me.END),!this.hide&&this.autoHide&&Ci.to(this,{alpha:0},500))))}},{key:"stopScroll",value:function(){this.onStageMouseUp2(null),L.timer.clear(this,this.tweenMove),Ci.clearTween(this)}},{key:"tick",get:function(){return this.slider.tick},set:function(e){this.slider.tick=e}}]),n}()),Bn=(L.regClass(Pn),M.regClass("laya.ui.ScrollBar",Pn),M.regClass("Laya.ScrollBar",Pn),function(){f(t,Pn);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t)}()),Dn=(L.regClass(Bn),M.regClass("laya.ui.VScrollBar",Bn),M.regClass("Laya.VScrollBar",Bn),function(){f(t,Pn);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"initialize",value:function(){m(g(t.prototype),"initialize",this).call(this),this.slider.isVertical=!1}}]),t}()),On=(L.regClass(Dn),M.regClass("laya.ui.HScrollBar",Dn),M.regClass("Laya.HScrollBar",Dn),function(){f(i,An);var t=T(i);function i(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";return b(this,i),(e=t.call(this,e)).on(Me.CHANGE,O(e),e._onTextChange),e}return y(i,[{key:"_onTextChange",value:function(){this.callLater(this.changeScroll)}},{key:"destroy",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null,m(g(i.prototype),"destroy",this).call(this,e)}},{key:"initialize",value:function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0}},{key:"width",get:function(){return m(g(i.prototype),"width",this)},set:function(e){U(g(i.prototype),"width",e,this,!0),this.callLater(this.changeScroll)}},{key:"height",get:function(){return m(g(i.prototype),"height",this)},set:function(e){U(g(i.prototype),"height",e,this,!0),this.callLater(this.changeScroll)}},{key:"vScrollBarSkin",get:function(){return this._vScrollBar?this._vScrollBar.skin:null},set:function(e){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new Bn),this._vScrollBar.on(Me.CHANGE,this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=e}},{key:"hScrollBarSkin",get:function(){return this._hScrollBar?this._hScrollBar.skin:null},set:function(e){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new Dn),this._hScrollBar.on(Me.CHANGE,this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=e}},{key:"onVBarChanged",value:function(e){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)}},{key:"onHBarChanged",value:function(e){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)}},{key:"vScrollBar",get:function(){return this._vScrollBar}},{key:"hScrollBar",get:function(){return this._hScrollBar}},{key:"maxScrollY",get:function(){return this._tf.maxScrollY}},{key:"scrollY",get:function(){return this._tf.scrollY}},{key:"maxScrollX",get:function(){return this._tf.maxScrollX}},{key:"scrollX",get:function(){return this._tf.scrollX}},{key:"changeScroll",value:function(){var e=this._vScrollBar&&0<this._tf.maxScrollY,t=this._hScrollBar&&0<this._tf.maxScrollX,i=e?this._width-this._vScrollBar.width:this._width,n=t?this._height-this._hScrollBar.height:this._height,a=this._tf.padding||xn.labelPadding;this._tf.width=i,this._tf.height=n,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-a[2],this._vScrollBar.y=a[1],this._vScrollBar.height=this._height-(t?this._hScrollBar.height:0)-a[1]-a[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=n/Math.max(this._tf.textHeight,n),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=e),this._hScrollBar&&(this._hScrollBar.x=a[0],this._hScrollBar.y=this._height-this._hScrollBar.height-a[3],this._hScrollBar.width=this._width-(e?this._vScrollBar.width:0)-a[0]-a[2],this._hScrollBar.scrollSize=Math.max(.033*i,1),this._hScrollBar.thumbPercent=i/Math.max(this._tf.textWidth,i),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=t)}},{key:"scrollTo",value:function(e){this.commitMeasure(),this._tf.scrollY=e}}]),i}()),Fn=(L.regClass(On),M.regClass("laya.ui.TextArea",On),M.regClass("Laya.TextArea",On),function(){f(i,mn);var t=T(i);function i(){var e;return b(this,i),(e=t.apply(this,arguments))._gridSize=11,e._bgColor="#ffffff",e._borderColor="#000000",e._inputColor="#000000",e._inputBgColor="#efefef",e._colors=[],e._selectedColor="#000000",e}return y(i,[{key:"destroy",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];m(g(i.prototype),"destroy",this).call(this,e),this._colorPanel&&this._colorPanel.destroy(e),this._colorButton&&this._colorButton.destroy(e),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null}},{key:"createChildren",value:function(){this.addChild(this._colorButton=new wn),this._colorPanel=new vn,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new N),this._colorPanel.addChild(this._colorBlock=new N),this._colorPanel.addChild(this._colorInput=new ni)}},{key:"initialize",value:function(){this._colorButton.on(Me.CLICK,this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on(Me.CHANGE,this,this.onColorInputChange),this._colorInput.on(Me.KEY_DOWN,this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on(Me.MOUSE_MOVE,this,this.onColorTilesMouseMove),this._colorTiles.on(Me.CLICK,this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on(Me.MOUSE_DOWN,this,this.onPanelMouseDown),this.bgColor=this._bgColor}},{key:"onPanelMouseDown",value:function(e){e.stopPropagation()}},{key:"changePanel",value:function(){this._panelChanged=!1;for(var e=this._colorPanel.graphics,t=(e.clear(!0),e.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,(e=this._colorTiles.graphics).clear(!0),[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935]),i=0;i<12;i++)for(var n=0;n<20;n++){var a=0===n?t[i]:1===n?0:51*(((3*i+n/6)%3<<0)+3*(i/6<<0))<<16|n%6*51<<8|(i<<0)%6*51,a=gn.toColor(a),s=(this._colors.push(a),n*this._gridSize),r=i*this._gridSize;e.drawRect(s,r,this._gridSize,this._gridSize,a,"#000000")}}},{key:"onColorButtonClick",value:function(e){this._colorPanel.parent?this.close():this.open()}},{key:"open",value:function(){var e=L.stage,t=this.localToGlobal(new ie),i=t.x+this._colorPanel.width<=e.width?t.x:e.width-this._colorPanel.width,n=(n=t.y+this._colorButton.height)+this._colorPanel.height<=e.height?n:t.y-this._colorPanel.height;this._colorPanel.pos(i,n),this._colorPanel.zOrder=1001,e.addChild(this._colorPanel),e.on(Me.MOUSE_DOWN,this,this.removeColorBox)}},{key:"close",value:function(){L.stage.off(Me.MOUSE_DOWN,this,this.removeColorBox),this._colorPanel.removeSelf()}},{key:"removeColorBox",value:function(){this.close()}},{key:"onColorFieldKeyDown",value:function(e){13==e.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),e.stopPropagation())}},{key:"onColorInputChange",value:function(){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")}},{key:"onColorTilesClick",value:function(e){this.selectedColor=this.getColorByMouse(),this.close()}},{key:"onColorTilesMouseMove",value:function(e){this._colorInput.focus=!1;var t=this.getColorByMouse();this._colorInput.text=t,this.drawBlock(t)}},{key:"getColorByMouse",value:function(){var e=this._colorTiles.getMousePoint(),t=Math.floor(e.x/this._gridSize),e=Math.floor(e.y/this._gridSize);return this._colors[20*e+t]}},{key:"drawBlock",value:function(e){var t=this._colorBlock.graphics,i=(t.clear(!0),e||"#ffffff");t.drawRect(0,0,50,20,i,this._borderColor),e||t.drawLine(0,0,50,20,"#ff0000")}},{key:"selectedColor",get:function(){return this._selectedColor},set:function(e){this._selectedColor!=e&&(this._selectedColor=this._colorInput.text=e,this.drawBlock(e),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event(Me.CHANGE,Me.EMPTY.setTo(Me.CHANGE,this,this)))}},{key:"skin",get:function(){return this._colorButton.skin},set:function(e){this._colorButton.once(Me.LOADED,this,this.changeColor),this._colorButton.skin=e}},{key:"changeColor",value:function(){var e=this.graphics,t=(e.clear(!0),this._selectedColor||"#000000");e.drawRect(0,0,this._colorButton.width,this._colorButton.height,t)}},{key:"bgColor",get:function(){return this._bgColor},set:function(e){this._bgColor=e,this._setPanelChanged()}},{key:"borderColor",get:function(){return this._borderColor},set:function(e){this._borderColor=e,this._setPanelChanged()}},{key:"inputColor",get:function(){return this._inputColor},set:function(e){this._inputColor=e,this._setPanelChanged()}},{key:"inputBgColor",get:function(){return this._inputBgColor},set:function(e){this._inputBgColor=e,this._setPanelChanged()}},{key:"_setPanelChanged",value:function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))}}]),i}()),Vn=(L.regClass(Fn),M.regClass("laya.ui.ColorPicker",Fn),M.regClass("Laya.ColorPicker",Fn),function(){f(i,vn);var t=T(i);function i(){var e;return b(this,i),(e=t.apply(this,arguments))._oldW=0,e._oldH=0,e}return y(i,[{key:"onEnable",value:function(){L.stage.on("resize",this,this.onResize),this.onResize()}},{key:"onDisable",value:function(){L.stage.off("resize",this,this.onResize)}},{key:"onResize",value:function(){var e,t=L.stage;0<this.width&&0<this.height&&(e=Math.min(t.width/this._oldW,t.height/this._oldH),U(g(i.prototype),"width",t.width,this,!0),U(g(i.prototype),"height",t.height,this,!0),this.scale(e,e))}},{key:"width",get:function(){return m(g(i.prototype),"width",this)},set:function(e){U(g(i.prototype),"width",e,this,!0),this._oldW=e}},{key:"height",get:function(){return m(g(i.prototype),"height",this)},set:function(e){U(g(i.prototype),"height",e,this,!0),this._oldH=e}}]),i}()),Un=(L.regClass(Vn),M.regClass("laya.ui.ScaleBox",Vn),M.regClass("Laya.ScaleBox",Vn),function(){f(s,mn);var a=T(s);function s(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;return b(this,s),(e=a.call(this))._clipX=1,e._clipY=1,e._clipWidth=0,e._clipHeight=0,e._interval=50,e._index=0,e._toIndex=-1,e._clipX=i,e._clipY=n,e.skin=t,e}return y(s,[{key:"destroy",value:function(){m(g(s.prototype),"destroy",this).call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null}},{key:"dispose",value:function(){this.destroy(!0),L.loader.clearRes(this._skin)}},{key:"createChildren",value:function(){this.graphics=this._bitmap=new kn}},{key:"_onDisplay",value:function(e){this._isPlaying?this._getBit(Ht.DISPLAYED_INSTAGE)?this.play():this.stop():this._autoPlay&&this.play()}},{key:"skin",get:function(){return this._skin},set:function(e){this._skin!=e&&((this._skin=e)?E.getRes(e)?this._skinLoaded():L.loader.load(this._skin,x.create(this,this._skinLoaded),null,E.IMAGE,1):this._bitmap.source=null)}},{key:"_skinLoaded",value:function(){this._setClipChanged(),this._sizeChanged(),this.event(Me.LOADED)}},{key:"clipX",get:function(){return this._clipX},set:function(e){this._clipX=e||1,this._setClipChanged()}},{key:"clipY",get:function(){return this._clipY},set:function(e){this._clipY=e||1,this._setClipChanged()}},{key:"clipWidth",get:function(){return this._clipWidth},set:function(e){this._clipWidth=e,this._setClipChanged()}},{key:"clipHeight",get:function(){return this._clipHeight},set:function(e){this._clipHeight=e,this._setClipChanged()}},{key:"changeClip",value:function(){var e;this._clipChanged=!1,this._skin&&((e=E.getRes(this._skin))?this.loadComplete(this._skin,e):L.loader.load(this._skin,x.create(this,this.loadComplete,[this._skin])))}},{key:"loadComplete",value:function(e,t){if(e===this._skin&&t){var i=this._clipWidth||Math.ceil(t.sourceWidth/this._clipX),n=this._clipHeight||Math.ceil(t.sourceHeight/this._clipY),e=this._skin+i+n,a=Ai.I.get(e);if(a=Se.isOkTextureList(a)?a:null)this._sources=a;else{this._sources=[];for(var s=0;s<this._clipY;s++)for(var r=0;r<this._clipX;r++)this._sources.push(vt.createFromTexture(t,i*r,n*s,i,n));Ai.I.set(e,this._sources)}this.index=this._index,this.event(Me.LOADED),this.onCompResize()}}},{key:"sources",get:function(){return this._sources},set:function(e){this._sources=e,this.index=this._index,this.event(Me.LOADED)}},{key:"group",get:function(){return this._group},set:function(e){e&&this._skin&&E.setGroup(this._skin,e),this._group=e}},{key:"width",get:function(){return m(g(s.prototype),"width",this)},set:function(e){U(g(s.prototype),"width",e,this,!0),this._bitmap.width=e}},{key:"height",get:function(){return m(g(s.prototype),"height",this)},set:function(e){U(g(s.prototype),"height",e,this,!0),this._bitmap.height=e}},{key:"measureWidth",value:function(){return this.runCallLater(this.changeClip),this._bitmap.width}},{key:"measureHeight",value:function(){return this.runCallLater(this.changeClip),this._bitmap.height}},{key:"sizeGrid",get:function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},set:function(e){this._bitmap.sizeGrid=gn.fillArray(xn.defaultSizeGrid,e,Number)}},{key:"index",get:function(){return this._index},set:function(e){this._index=e,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[e]),this.event(Me.CHANGE)}},{key:"total",get:function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}},{key:"autoPlay",get:function(){return this._autoPlay},set:function(e){this._autoPlay!=e&&((this._autoPlay=e)?this.play():this.stop())}},{key:"interval",get:function(){return this._interval},set:function(e){this._interval!=e&&(this._interval=e,this._isPlaying&&this.play())}},{key:"isPlaying",get:function(){return this._isPlaying},set:function(e){this._isPlaying=e}},{key:"play",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1;this._isPlaying=!0,this.index=e,this._toIndex=t,this._index++,L.timer.loop(this.interval,this,this._loop),this.on(Me.DISPLAY,this,this._onDisplay),this.on(Me.UNDISPLAY,this,this._onDisplay)}},{key:"_loop",value:function(){this._visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)}},{key:"stop",value:function(){this._isPlaying=!1,L.timer.clear(this,this._loop),this.event(Me.COMPLETE)}},{key:"dataSource",get:function(){return m(g(s.prototype),"dataSource",this)},set:function(e){"number"==typeof(this._dataSource=e)||"string"==typeof e?this.index=parseInt(e):U(g(s.prototype),"dataSource",e,this,!0)}},{key:"bitmap",get:function(){return this._bitmap}},{key:"_setClipChanged",value:function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))}}]),s}()),zn=(L.regClass(Un),M.regClass("laya.ui.Clip",Un),M.regClass("Laya.Clip",Un),function(){f(i,vn);var t=T(i);function i(){var e;return b(this,i),(e=t.apply(this,arguments)).selectEnable=!1,e.totalPage=0,e._$componentType="List",e._repeatX=0,e._repeatY=0,e._repeatX2=0,e._repeatY2=0,e._spaceX=0,e._spaceY=0,e._cells=[],e._startIndex=0,e._selectedIndex=-1,e._page=0,e._isVertical=!0,e._cellSize=20,e._cellOffset=0,e._createdLine=0,e._offset=new ie,e._usedCache=null,e._elasticEnabled=!1,e._preLen=0,e}return y(i,[{key:"destroy",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this._content&&this._content.destroy(e),this._scrollBar&&this._scrollBar.destroy(e),m(g(i.prototype),"destroy",this).call(this,e),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this.selectHandler=this.renderHandler=this.mouseHandler=null}},{key:"createChildren",value:function(){this.addChild(this._content=new vn)}},{key:"cacheAs",get:function(){return m(g(i.prototype),"cacheAs",this)},set:function(e){U(g(i.prototype),"cacheAs",e,this,!0),this._scrollBar&&(this._usedCache=null,"none"!==e?this._scrollBar.on(Me.START,this,this.onScrollStart):this._scrollBar.off(Me.START,this,this.onScrollStart))}},{key:"onScrollStart",value:function(){this._usedCache||(this._usedCache=m(g(i.prototype),"cacheAs",this)),U(g(i.prototype),"cacheAs","none",this,!0),this._scrollBar.once(Me.END,this,this.onScrollEnd)}},{key:"onScrollEnd",value:function(){U(g(i.prototype),"cacheAs",this._usedCache,this,!0)}},{key:"content",get:function(){return this._content}},{key:"vScrollBarSkin",get:function(){return this._scrollBar?this._scrollBar.skin:null},set:function(e){this._removePreScrollBar();var t=new Bn;t.name="scrollBar",t.right=0,t.skin=e,t.elasticDistance=this._elasticEnabled?200:0,this.scrollBar=t,this.addChild(t),this._setCellChanged()}},{key:"_removePreScrollBar",value:function(){var e=this.removeChildByName("scrollBar");e&&e.destroy(!0)}},{key:"hScrollBarSkin",get:function(){return this._scrollBar?this._scrollBar.skin:null},set:function(e){this._removePreScrollBar();var t=new Dn;t.name="scrollBar",t.bottom=0,t.skin=e,t.elasticDistance=this._elasticEnabled?200:0,this.scrollBar=t,this.addChild(t),this._setCellChanged()}},{key:"scrollBar",get:function(){return this._scrollBar},set:function(e){this._scrollBar!=e&&(this._scrollBar=e)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on(Me.CHANGE,this,this.onScrollBarChange))}},{key:"itemRender",get:function(){return this._itemRender},set:function(e){if(this._itemRender!=e){this._itemRender=e;for(var t=this._cells.length-1;-1<t;t--)this._cells[t].destroy();this._cells.length=0,this._setCellChanged()}}},{key:"width",get:function(){return m(g(i.prototype),"width",this)},set:function(e){e!=this._width&&(U(g(i.prototype),"width",e,this,!0),this._setCellChanged())}},{key:"height",get:function(){return m(g(i.prototype),"height",this)},set:function(e){e!=this._height&&(U(g(i.prototype),"height",e,this,!0),this._setCellChanged())}},{key:"repeatX",get:function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},set:function(e){this._repeatX=e,this._setCellChanged()}},{key:"repeatY",get:function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},set:function(e){this._repeatY=e,this._setCellChanged()}},{key:"spaceX",get:function(){return this._spaceX},set:function(e){this._spaceX=e,this._setCellChanged()}},{key:"spaceY",get:function(){return this._spaceY},set:function(e){this._spaceY=e,this._setCellChanged()}},{key:"changeCells",value:function(){var e,t,i,n;this._cellChanged=!1,this._itemRender&&(this.scrollBar=this.getChildByName("scrollBar"),n=(i=this._getOneCell()).width+this._spaceX||1,i=i.height+this._spaceY||1,0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/n):Math.ceil(this._width/n)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/i):Math.round(this._height/i)),e=this._width||n*this.repeatX-this._spaceX,t=this._height||i*this.repeatY-this._spaceY,this._cellSize=this._isVertical?i:n,this._cellOffset=this._isVertical?i*Math.max(this._repeatY2,this._repeatY)-t-this._spaceY:n*Math.max(this._repeatX2,this._repeatX)-e-this._spaceX,this._isVertical&&this.vScrollBarSkin?this._scrollBar.height=t:!this._isVertical&&this.hScrollBarSkin&&(this._scrollBar.width=e),this.setContentSize(e,t),i=this._isVertical?this.repeatX:this.repeatY,n=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0),this._createItems(0,i,n),this._createdLine=n,this._array&&(this.array=this._array,this.runCallLater(this.renderItems)))}},{key:"_getOneCell",value:function(){if(0===this._cells.length){var e=this.createItem();if(this._offset.setTo(e._x,e._y),this.cacheContent)return e;this._cells.push(e)}return this._cells[0]}},{key:"_createItems",value:function(e,t,i){var n=this._content,a=this._getOneCell(),s=a.width+this._spaceX,r=a.height+this._spaceY;if(this.cacheContent){var o=new vn;o.cacheAs="normal",o.pos((this._isVertical?0:e)*s,(this._isVertical?e:0)*r),this._content.addChild(o),n=o}else{for(var h=[],l=this._cells.length-1;-1<l;l--){var u=this._cells[l];u.removeSelf(),h.push(u)}this._cells.length=0}for(var c=e;c<i;c++)for(var _=0;_<t;_++)(a=h&&h.length?h.pop():this.createItem()).x=(this._isVertical?_:c)*s-n._x,a.y=(this._isVertical?c:_)*r-n._y,a.name="item"+(c*t+_),n.addChild(a),this.addCell(a)}},{key:"createItem",value:function(){var e=[],t="function"==typeof this._itemRender?new this._itemRender:Li.createComp(this._itemRender,null,null,e);if(0==e.length&&t._watchMap){var i,n=t._watchMap;for(i in n)for(var a=n[i],s=0;s<a.length;s++){var r=a[s];e.push(r.comp,r.prop,r.value)}}return e.length&&(t._$bindData=e),t}},{key:"addCell",value:function(e){e.on(Me.CLICK,this,this.onCellMouse),e.on(Me.RIGHT_CLICK,this,this.onCellMouse),e.on(Me.MOUSE_OVER,this,this.onCellMouse),e.on(Me.MOUSE_OUT,this,this.onCellMouse),e.on(Me.MOUSE_DOWN,this,this.onCellMouse),e.on(Me.MOUSE_UP,this,this.onCellMouse),this._cells.push(e)}},{key:"_afterInited",value:function(){this.initItems()}},{key:"initItems",value:function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var e=0,t=0;t<1e4;t++){var i=this.getChildByName("item"+t);if(!i)break;this.addCell(i),e++}this.repeatY=e}}},{key:"setContentSize",value:function(e,t){this._content.width=e,this._content.height=t,!this._scrollBar&&0==this._offset.x&&0==this._offset.y||(this._content._style.scrollRect||(this._content.scrollRect=ne.create()),this._content._style.scrollRect.setTo(-this._offset.x,-this._offset.y,e,t),this._content.scrollRect=this._content.scrollRect),this.event(Me.RESIZE)}},{key:"onCellMouse",value:function(e){e.type===Me.MOUSE_DOWN&&(this._isMoved=!1);var t=e.currentTarget,i=this._startIndex+this._cells.indexOf(t);i<0||(e.type===Me.CLICK||e.type===Me.RIGHT_CLICK?this.selectEnable&&!this._isMoved?this.selectedIndex=i:this.changeCellState(t,!0,0):e.type!==Me.MOUSE_OVER&&e.type!==Me.MOUSE_OUT||this._selectedIndex===i||this.changeCellState(t,e.type===Me.MOUSE_OVER,0),this.mouseHandler&&this.mouseHandler.runWith([e,i]))}},{key:"changeCellState",value:function(e,t,i){e=e.getChildByName("selectBox");e&&(this.selectEnable=!0,e.visible=t,e.index=i)}},{key:"_sizeChanged",value:function(){m(g(i.prototype),"_sizeChanged",this).call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)}},{key:"onScrollBarChange",value:function(){this.runCallLater(this.changeCells);var e=this._scrollBar.value,t=this._isVertical?this.repeatX:this.repeatY,i=this._isVertical?this.repeatY:this.repeatX,n=Math.floor(e/this._cellSize);if(this.cacheContent)this._createdLine-n<(r=i+1)&&(this._createItems(this._createdLine,t,this._createdLine+r),this.renderItems(this._createdLine*t,0),this._createdLine+=r);else{var a,s,n=n*t,r=0;n>this._startIndex?(r=n-this._startIndex,s=this._startIndex+t*(i+1),this._isMoved=a=!0):n<this._startIndex&&(r=this._startIndex-n,s=this._startIndex-1,this._isMoved=!(a=!1));for(var o=0;o<r;o++){var h,l=a?(h=this._cells.shift(),this._cells[this._cells.length]=h,s+o):(h=this._cells.pop(),this._cells.unshift(h),s-o),u=Math.floor(l/t)*this._cellSize;this._isVertical?h.y=u:h.x=u,this.renderItem(h,l)}this._startIndex=n,this.changeSelectStatus()}i=this._content._style.scrollRect;this._isVertical?(i.y=e-this._offset.y,i.x=-this._offset.x):(i.y=-this._offset.y,i.x=e-this._offset.x),this._content.scrollRect=i}},{key:"posCell",value:function(e,t){var i;this._scrollBar&&(i=this._isVertical?this.repeatX:this.repeatY,this._isVertical?this.repeatY:this.repeatX,t=Math.floor(t/i)*this._cellSize,this._isVertical?e._y=t:e.x=t)}},{key:"selectedIndex",get:function(){return this._selectedIndex},set:function(e){this._selectedIndex!=e&&(this._selectedIndex=e,this.changeSelectStatus(),this.event(Me.CHANGE),this.selectHandler&&this.selectHandler.runWith(e),this.startIndex=this._startIndex)}},{key:"changeSelectStatus",value:function(){for(var e=0,t=this._cells.length;e<t;e++)this.changeCellState(this._cells[e],this._selectedIndex===this._startIndex+e,1)}},{key:"selectedItem",get:function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},set:function(e){this.selectedIndex=this._array.indexOf(e)}},{key:"selection",get:function(){return this.getCell(this._selectedIndex)},set:function(e){this.selectedIndex=this._startIndex+this._cells.indexOf(e)}},{key:"startIndex",get:function(){return this._startIndex},set:function(e){this._startIndex=0<e?e:0,this.callLater(this.renderItems)}},{key:"renderItems",value:function(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:0)||this._cells.length;e<t;e++)this.renderItem(this._cells[e],this._startIndex+e);this.changeSelectStatus()}},{key:"renderItem",value:function(e,t){this._array&&0<=t&&t<this._array.length?(e.visible=!0,e._$bindData?(e._dataSource=this._array[t],this._bindData(e,this._array[t])):e.dataSource=this._array[t],this.cacheContent||this.posCell(e,t),this.hasListener(Me.RENDER)&&this.event(Me.RENDER,[e,t]),this.renderHandler&&this.renderHandler.runWith([e,t])):(e.visible=!1,e.dataSource=null)}},{key:"_bindData",value:function(e,t){for(var i=e._$bindData,n=0,a=i.length;n<a;n++){var s=i[n++],r=i[n++],o=i[n],o=gn.getBindFun(o);s[r]=o.call(this,t)}}},{key:"array",get:function(){return this._array},set:function(e){this.runCallLater(this.changeCells),this._array=e||[],this._preLen=this._array.length;var t,i,e=this._array.length;this.totalPage=Math.ceil(e/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<e?this._selectedIndex:e-1,this.startIndex=this._startIndex,this._scrollBar&&(this._scrollBar.stopScroll(),t=this._isVertical?this.repeatX:this.repeatY,i=this._isVertical?this.repeatY:this.repeatX,e=Math.ceil(e/t),1<(0<this._cellOffset?this.totalPage+1:this.totalPage)&&i<=e?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=i/e,this._scrollBar.setScroll(0,(e-i)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content)}},{key:"updateArray",value:function(e){var t,i;this._array=e,this._array&&(0<=(i=this._preLen-this._startIndex)&&this.renderItems(i),this._preLen=this._array.length),this._scrollBar&&(i=e.length,e=this._isVertical?this.repeatX:this.repeatY,(t=this._isVertical?this.repeatY:this.repeatX)<=(i=Math.ceil(i/e))&&(this._scrollBar.thumbPercent=t/i,this._scrollBar.slider._max=(i-t)*this._cellSize+this._cellOffset))}},{key:"page",get:function(){return this._page},set:function(e){this._page=e,this._array&&(this._page=0<e?e:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}},{key:"length",get:function(){return this._array?this._array.length:0}},{key:"dataSource",get:function(){return m(g(i.prototype),"dataSource",this)},set:function(e){"number"==typeof(this._dataSource=e)||"string"==typeof e?this.selectedIndex=parseInt(e):e instanceof Array?this.array=e:U(g(i.prototype),"dataSource",e,this,!0)}},{key:"cells",get:function(){return this.runCallLater(this.changeCells),this._cells}},{key:"elasticEnabled",get:function(){return this._elasticEnabled},set:function(e){this._elasticEnabled=e,this._scrollBar&&(this._scrollBar.elasticDistance=e?200:0)}},{key:"refresh",value:function(){this.array=this._array}},{key:"getItem",value:function(e){return-1<e&&e<this._array.length?this._array[e]:null}},{key:"changeItem",value:function(e,t){-1<e&&e<this._array.length&&(this._array[e]=t,e>=this._startIndex&&e<this._startIndex+this._cells.length&&this.renderItem(this.getCell(e),e))}},{key:"setItem",value:function(e,t){this.changeItem(e,t)}},{key:"addItem",value:function(e){this._array.push(e),this.array=this._array}},{key:"addItemAt",value:function(e,t){this._array.splice(t,0,e),this.array=this._array}},{key:"deleteItem",value:function(e){this._array.splice(e,1),this.array=this._array}},{key:"getCell",value:function(e){return this.runCallLater(this.changeCells),-1<e&&this._cells?this._cells[(e-this._startIndex)%this._cells.length]:null}},{key:"scrollTo",value:function(e){var t;this._scrollBar?(t=this._isVertical?this.repeatX:this.repeatY,this._scrollBar.value=Math.floor(e/t)*this._cellSize):this.startIndex=e}},{key:"tweenTo",value:function(e){var t,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:200,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;this._scrollBar?(this._scrollBar.stopScroll(),t=this._isVertical?this.repeatX:this.repeatY,Ci.to(this._scrollBar,{value:Math.floor(e/t)*this._cellSize},i,a,n,0,!0)):(this.startIndex=e,n&&n.run())}},{key:"_setCellChanged",value:function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))}},{key:"commitMeasure",value:function(){this.runCallLater(this.changeCells)}}]),i}()),Yn=(L.regClass(zn),M.regClass("laya.ui.List",zn),M.regClass("Laya.List",zn),function(){f(a,mn);var n=T(a);function a(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return b(this,a),(e=n.call(this))._visibleNum=6,e._itemColors=xn.comboBoxItemColors,e._itemSize=12,e._labels=[],e._selectedIndex=-1,e.itemRender=null,e.skin=t,e.labels=i,e}return y(a,[{key:"destroy",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];m(g(a.prototype),"destroy",this).call(this,e),this._button&&this._button.destroy(e),this._list&&this._list.destroy(e),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null}},{key:"createChildren",value:function(){this.addChild(this._button=new wn),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on(Me.MOUSE_DOWN,this,this.onButtonMouseDown)}},{key:"_createList",value:function(){this._list=new zn,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)}},{key:"_setListEvent",value:function(e){this._list.selectEnable=!0,this._list.on(Me.MOUSE_DOWN,this,this.onListDown),this._list.mouseHandler=x.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on(Me.MOUSE_DOWN,this,this.onScrollBarDown)}},{key:"onListDown",value:function(e){e.stopPropagation()}},{key:"onScrollBarDown",value:function(e){e.stopPropagation()}},{key:"onButtonMouseDown",value:function(e){this.callLater(this.switchTo,[!this._isOpen])}},{key:"skin",get:function(){return this._button.skin},set:function(e){this._button.skin!=e&&(this._button.skin=e,this._listChanged=!0)}},{key:"measureWidth",value:function(){return this._button.width}},{key:"measureHeight",value:function(){return this._button.height}},{key:"changeList",value:function(){this._listChanged=!1;var e=this.width-2,t=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:e,height:this._itemHeight,fontSize:this._itemSize,color:t}}]},this._list.repeatY=this._visibleNum,this._list.refresh()}},{key:"onlistItemMouse",value:function(e,t){var i,e=e.type;e===Me.MOUSE_OVER||e===Me.MOUSE_OUT?this._isCustomList||(i=this._list.getCell(t))&&(i=i.getChildByName("label"))&&(e===Me.ROLL_OVER?(i.bgColor=this._itemColors[0],i.color=this._itemColors[1]):(i.bgColor=null,i.color=this._itemColors[2])):e===Me.CLICK&&(this.selectedIndex=t,this.isOpen=!1)}},{key:"switchTo",value:function(e){this.isOpen=e}},{key:"changeOpen",value:function(){this.isOpen=!this._isOpen}},{key:"width",get:function(){return m(g(a.prototype),"width",this)},set:function(e){U(g(a.prototype),"width",e,this,!0),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}},{key:"height",get:function(){return m(g(a.prototype),"height",this)},set:function(e){U(g(a.prototype),"height",e,this,!0),this._button.height=this._height}},{key:"labels",get:function(){return this._labels.join(",")},set:function(e){0<this._labels.length&&(this.selectedIndex=-1),e?this._labels=e.split(","):this._labels.length=0,this._itemChanged=!0}},{key:"changeItem",value:function(){this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,this._isCustomList||((e=this._list.graphics).clear(!0),e.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3]));for(var e,t=this._list.array||[],i=t.length=0,n=this._labels.length;i<n;i++)t.push({label:this._labels[i]});this._list.height=this._listHeight,this._list.array=t}},{key:"selectedIndex",get:function(){return this._selectedIndex},set:function(e){this._selectedIndex!=e&&(this._selectedIndex=e,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event(Me.CHANGE,[Me.EMPTY.setTo(Me.CHANGE,this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}},{key:"changeSelected",value:function(){this._button.label=this.selectedLabel}},{key:"selectHandler",get:function(){return this._selectHandler},set:function(e){this._selectHandler=e}},{key:"selectedLabel",get:function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},set:function(e){this.selectedIndex=this._labels.indexOf(e)}},{key:"visibleNum",get:function(){return this._visibleNum},set:function(e){this._visibleNum=e,this._listChanged=!0}},{key:"itemColors",get:function(){return String(this._itemColors)},set:function(e){this._itemColors=gn.fillArray(this._itemColors,e,String),this._listChanged=!0}},{key:"itemSize",get:function(){return this._itemSize},set:function(e){this._itemSize=e,this._listChanged=!0}},{key:"isOpen",get:function(){return this._isOpen},set:function(e){var t;this._isOpen!=e&&(this._isOpen=e,this._button.selected=this._isOpen,this._isOpen?(this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem(),t=(t=(e=this.localToGlobal(ie.TEMP.setTo(0,0))).y+this._button.height)+this._listHeight<=L.stage.height?t:e.y-this._listHeight,this._list.pos(e.x,t),this._list.zOrder=1001,L.stage.addChild(this._list),L.stage.once(Me.MOUSE_DOWN,this,this.removeList),L.stage.on(Me.MOUSE_WHEEL,this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex):this._list&&this._list.removeSelf())}},{key:"_onStageMouseWheel",value:function(e){this._list&&!this._list.contains(e.target)&&this.removeList(null)}},{key:"removeList",value:function(e){L.stage.off(Me.MOUSE_DOWN,this,this.removeList),L.stage.off(Me.MOUSE_WHEEL,this,this._onStageMouseWheel),this.isOpen=!1}},{key:"scrollBarSkin",get:function(){return this._scrollBarSkin},set:function(e){this._scrollBarSkin=e}},{key:"sizeGrid",get:function(){return this._button.sizeGrid},set:function(e){this._button.sizeGrid=e}},{key:"scrollBar",get:function(){return this.list.scrollBar}},{key:"button",get:function(){return this._button}},{key:"list",get:function(){return this._list||this._createList(),this._list},set:function(e){e&&(e.removeSelf(),this._isCustomList=!0,this._list=e,this._setListEvent(e),this._itemHeight=e.getCell(0).height+e.spaceY)}},{key:"dataSource",get:function(){return m(g(a.prototype),"dataSource",this)},set:function(e){"number"==typeof(this._dataSource=e)||"string"==typeof e?this.selectedIndex=parseInt(e):e instanceof Array?this.labels=e.join(","):U(g(a.prototype),"dataSource",e,this,!0)}},{key:"labelColors",get:function(){return this._button.labelColors},set:function(e){this._button.labelColors!=e&&(this._button.labelColors=e)}},{key:"labelPadding",get:function(){return this._button.text.padding.join(",")},set:function(e){this._button.text.padding=gn.fillArray(xn.labelPadding,e,Number)}},{key:"labelSize",get:function(){return this._button.text.fontSize},set:function(e){this._button.text.fontSize=e}},{key:"labelBold",get:function(){return this._button.text.bold},set:function(e){this._button.text.bold=e}},{key:"labelFont",get:function(){return this._button.text.font},set:function(e){this._button.text.font=e}},{key:"stateNum",get:function(){return this._button.stateNum},set:function(e){this._button.stateNum=e}}]),a}()),Gn=(L.regClass(Yn),M.regClass("laya.ui.ComboBox",Yn),M.regClass("Laya.ComboBox",Yn),function(){f(i,Ln);var t=T(i);function i(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;return b(this,i),(e=t.call(this,e)).isVertical=!1,e}return y(i)}()),Xn=(L.regClass(Gn),M.regClass("laya.ui.HSlider",Gn),M.regClass("Laya.HSlider",Gn),function(){f(i,vn);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this))._usedCache=null,e._elasticEnabled=!1,e.width=e.height=100,e}return y(i,[{key:"destroy",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];m(g(i.prototype),"destroy",this).call(this,e),this._content&&this._content.destroy(e),this._vScrollBar&&this._vScrollBar.destroy(e),this._hScrollBar&&this._hScrollBar.destroy(e),this._vScrollBar=null,this._hScrollBar=null,this._content=null}},{key:"destroyChildren",value:function(){this._content.destroyChildren()}},{key:"createChildren",value:function(){m(g(i.prototype),"addChild",this).call(this,this._content=new vn)}},{key:"addChild",value:function(e){return e.on(Me.RESIZE,this,this.onResize),this._setScrollChanged(),this._content.addChild(e)}},{key:"onResize",value:function(){this._setScrollChanged()}},{key:"addChildAt",value:function(e,t){return e.on(Me.RESIZE,this,this.onResize),this._setScrollChanged(),this._content.addChildAt(e,t)}},{key:"removeChild",value:function(e){return e.off(Me.RESIZE,this,this.onResize),this._setScrollChanged(),this._content.removeChild(e)}},{key:"removeChildAt",value:function(e){return this.getChildAt(e).off(Me.RESIZE,this,this.onResize),this._setScrollChanged(),this._content.removeChildAt(e)}},{key:"removeChildren",value:function(){return this._content.removeChildren(0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,1<arguments.length&&void 0!==arguments[1]?arguments[1]:2147483647),this._setScrollChanged(),this}},{key:"getChildAt",value:function(e){return this._content.getChildAt(e)}},{key:"getChildByName",value:function(e){return this._content.getChildByName(e)}},{key:"getChildIndex",value:function(e){return this._content.getChildIndex(e)}},{key:"numChildren",get:function(){return this._content.numChildren}},{key:"changeScroll",value:function(){this._scrollChanged=!1;var e=this.contentWidth||1,t=this.contentHeight||1,i=this._vScrollBar,n=this._hScrollBar,a=i&&t>this._height,s=n&&e>this._width,r=a?this._width-i.width:this._width,o=s?this._height-n.height:this._height;i&&(i.x=this._width-i.width,i.y=0,i.height=this._height-(s?n.height:0),i.scrollSize=Math.max(.033*this._height,1),i.thumbPercent=o/t,i.setScroll(0,t-o,i.value)),n&&(n.x=0,n.y=this._height-n.height,n.width=this._width-(a?i.width:0),n.scrollSize=Math.max(.033*this._width,1),n.thumbPercent=r/e,n.setScroll(0,e-r,n.value))}},{key:"_sizeChanged",value:function(){m(g(i.prototype),"_sizeChanged",this).call(this),this.setContentSize(this._width,this._height)}},{key:"contentWidth",get:function(){for(var e=0,t=this._content.numChildren-1;-1<t;t--)var i=this._content.getChildAt(t),e=Math.max(i._x+i.width*i.scaleX-i.pivotX,e);return e}},{key:"contentHeight",get:function(){for(var e=0,t=this._content.numChildren-1;-1<t;t--)var i=this._content.getChildAt(t),e=Math.max(i._y+i.height*i.scaleY-i.pivotY,e);return e}},{key:"setContentSize",value:function(e,t){var i=this._content;i.width=e,i.height=t,i._style.scrollRect||(i.scrollRect=ne.create()),i._style.scrollRect.setTo(0,0,e,t),i.scrollRect=i.scrollRect}},{key:"width",get:function(){return m(g(i.prototype),"width",this)},set:function(e){U(g(i.prototype),"width",e,this,!0),this._setScrollChanged()}},{key:"height",get:function(){return m(g(i.prototype),"height",this)},set:function(e){U(g(i.prototype),"height",e,this,!0),this._setScrollChanged()}},{key:"vScrollBarSkin",get:function(){return this._vScrollBar?this._vScrollBar.skin:null},set:function(e){null==this._vScrollBar&&(m(g(i.prototype),"addChild",this).call(this,this._vScrollBar=new Bn),this._vScrollBar.on(Me.CHANGE,this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._vScrollBar.elasticDistance=this._elasticEnabled?200:0,this._setScrollChanged()),this._vScrollBar.skin=e}},{key:"hScrollBarSkin",get:function(){return this._hScrollBar?this._hScrollBar.skin:null},set:function(e){null==this._hScrollBar&&(m(g(i.prototype),"addChild",this).call(this,this._hScrollBar=new Dn),this._hScrollBar.on(Me.CHANGE,this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._hScrollBar.elasticDistance=this._elasticEnabled?200:0,this._setScrollChanged()),this._hScrollBar.skin=e}},{key:"vScrollBar",get:function(){return this._vScrollBar}},{key:"hScrollBar",get:function(){return this._hScrollBar}},{key:"content",get:function(){return this._content}},{key:"onScrollBarChange",value:function(e){var t,i=this._content._style.scrollRect;i&&(t=Math.round(e.value),e.isVertical?i.y=t:i.x=t,this._content.scrollRect=i)}},{key:"scrollTo",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;this.vScrollBar&&(this.vScrollBar.value=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0),this.hScrollBar&&(this.hScrollBar.value=e)}},{key:"refresh",value:function(){this.changeScroll()}},{key:"cacheAs",get:function(){return m(g(i.prototype),"cacheAs",this)},set:function(e){U(g(i.prototype),"cacheAs",e,this,!0),this._usedCache=null,"none"!==e?(this._hScrollBar&&this._hScrollBar.on(Me.START,this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on(Me.START,this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off(Me.START,this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off(Me.START,this,this.onScrollStart))}},{key:"elasticEnabled",get:function(){return this._elasticEnabled},set:function(e){this._elasticEnabled=e,this._vScrollBar&&(this._vScrollBar.elasticDistance=e?200:0),this._hScrollBar&&(this._hScrollBar.elasticDistance=e?200:0)}},{key:"onScrollStart",value:function(){this._usedCache||(this._usedCache=m(g(i.prototype),"cacheAs",this)),U(g(i.prototype),"cacheAs","none",this,!0),this._hScrollBar&&this._hScrollBar.once(Me.END,this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once(Me.END,this,this.onScrollEnd)}},{key:"onScrollEnd",value:function(){U(g(i.prototype),"cacheAs",this._usedCache,this,!0)}},{key:"_setScrollChanged",value:function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))}}]),i}()),Wn=(L.regClass(Xn),M.regClass("laya.ui.Panel",Xn),M.regClass("Laya.Panel",Xn),function(){f(t,Ln);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t)}()),Hn=(L.regClass(Wn),M.regClass("laya.ui.VSlider",Wn),M.regClass("Laya.VSlider",Wn),function(){f(i,vn);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this))._spaceLeft=10,e._spaceBottom=0,e._keepStatus=!0,e.width=e.height=200,e}return y(i,[{key:"destroy",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];m(g(i.prototype),"destroy",this).call(this,e),this._list&&this._list.destroy(e),this._list=null,this._source=null,this._renderHandler=null}},{key:"createChildren",value:function(){this.addChild(this._list=new zn),this._list.renderHandler=x.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on(Me.CHANGE,this,this.onListChange)}},{key:"onListChange",value:function(){this.event(Me.CHANGE)}},{key:"keepStatus",get:function(){return this._keepStatus},set:function(e){this._keepStatus=e}},{key:"array",get:function(){return this._list.array},set:function(e){this._keepStatus&&this._list.array&&e&&this.parseOpenStatus(this._list.array,e),this._source=e,this._list.array=this.getArray()}},{key:"source",get:function(){return this._source}},{key:"list",get:function(){return this._list}},{key:"itemRender",get:function(){return this._list.itemRender},set:function(e){this._list.itemRender=e}},{key:"scrollBarSkin",get:function(){return this._list.vScrollBarSkin},set:function(e){this._list.vScrollBarSkin=e}},{key:"scrollBar",get:function(){return this._list.scrollBar}},{key:"mouseHandler",get:function(){return this._list.mouseHandler},set:function(e){this._list.mouseHandler=e}},{key:"renderHandler",get:function(){return this._renderHandler},set:function(e){this._renderHandler=e}},{key:"spaceLeft",get:function(){return this._spaceLeft},set:function(e){this._spaceLeft=e}},{key:"spaceBottom",get:function(){return this._list.spaceY},set:function(e){this._list.spaceY=e}},{key:"selectedIndex",get:function(){return this._list.selectedIndex},set:function(e){this._list.selectedIndex=e}},{key:"selectedItem",get:function(){return this._list.selectedItem},set:function(e){this._list.selectedItem=e}},{key:"width",get:function(){return m(g(i.prototype),"width",this)},set:function(e){U(g(i.prototype),"width",e,this,!0),this._list.width=e}},{key:"height",get:function(){return m(g(i.prototype),"height",this)},set:function(e){U(g(i.prototype),"height",e,this,!0),this._list.height=e}},{key:"getArray",value:function(){var e,t=[];for(e in this._source){var i=this._source[e];this.getParentOpenStatus(i)&&(i.x=this._spaceLeft*this.getDepth(i),t.push(i))}return t}},{key:"getDepth",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return null==e.nodeParent?t:this.getDepth(e.nodeParent,t+1)}},{key:"getParentOpenStatus",value:function(e){e=e.nodeParent;return null==e||!!e.isOpen&&(null==e.nodeParent||this.getParentOpenStatus(e))}},{key:"renderItem",value:function(e,t){var i,n=e.dataSource;n&&(e.left=n.x,(i=e.getChildByName("arrow"))&&(n.hasChild?(i.visible=!0,i.index=n.isOpen?1:0,i.tag=t,i.off(Me.CLICK,this,this.onArrowClick),i.on(Me.CLICK,this,this.onArrowClick)):i.visible=!1),(i=e.getChildByName("folder"))&&(2==i.clipY?i.index=n.isDirectory?0:1:i.index=n.isDirectory?n.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([e,t]))}},{key:"onArrowClick",value:function(e){e=e.currentTarget.tag;this._list.array[e].isOpen=!this._list.array[e].isOpen,this.event(Me.OPEN),this._list.array=this.getArray()}},{key:"setItemState",value:function(e,t){this._list.array[e]&&(this._list.array[e].isOpen=t,this._list.array=this.getArray())}},{key:"fresh",value:function(){this._list.array=this.getArray(),this.repaint()}},{key:"dataSource",get:function(){return m(g(i.prototype),"dataSource",this)},set:function(e){this._dataSource=e,U(g(i.prototype),"dataSource",e,this,!0)}},{key:"xml",set:function(e){var t=[];this.parseXml(e.childNodes[0],t,null,!0),this.array=t}},{key:"parseXml",value:function(e,t,i,n){var a=e.childNodes,s=a.length;if(!n){var r,o={},h=e.attributes;for(r in h){var l=h[r],u=l.nodeName,l=l.nodeValue;o[u]="true"==l||"false"!=l&&l}o.nodeParent=i,0<s&&(o.isDirectory=!0),o.hasChild=0<s,t.push(o)}for(var c=0;c<s;c++){var _=a[c];this.parseXml(_,t,o,!1)}}},{key:"parseOpenStatus",value:function(e,t){for(var i=0,n=t.length;i<n;i++){var a=t[i];if(a.isDirectory)for(var s=0,r=e.length;s<r;s++){var o=e[s];if(o.isDirectory&&this.isSameParent(o,a)&&a.label==o.label){a.isOpen=o.isOpen;break}}}}},{key:"isSameParent",value:function(e,t){return null==e.nodeParent&&null==t.nodeParent||null!=e.nodeParent&&null!=t.nodeParent&&(e.nodeParent.label==t.nodeParent.label&&this.isSameParent(e.nodeParent,t.nodeParent))}},{key:"selectedPath",get:function(){return this._list.selectedItem?this._list.selectedItem.path:null}},{key:"filter",value:function(e){var t;Boolean(e)?(this.getFilterSource(this._source,t=[],e),this._list.array=t):this._list.array=this.getArray()}},{key:"getFilterSource",value:function(e,t,i){i=i.toLocaleLowerCase();var n,a=Y(e);try{for(a.s();!(n=a.n()).done;){var s=n.value;!s.isDirectory&&-1<String(s.label).toLowerCase().indexOf(i)&&(s.x=0,t.push(s)),s.child&&0<s.child.length&&this.getFilterSource(s.child,t,i)}}catch(e){a.e(e)}finally{a.f()}}}]),i}()),jn=(L.regClass(Hn),M.regClass("laya.ui.Tree",Hn),M.regClass("Laya.Tree",Hn),function(){f(i,vn);var t=T(i);function i(){var e;return b(this,i),(e=t.apply(this,arguments))._space=0,e._align="none",e._itemChanged=!1,e}return y(i,[{key:"addChild",value:function(e){return e.on(Me.RESIZE,this,this.onResize),this._setItemChanged(),m(g(i.prototype),"addChild",this).call(this,e)}},{key:"onResize",value:function(e){this._setItemChanged()}},{key:"addChildAt",value:function(e,t){return e.on(Me.RESIZE,this,this.onResize),this._setItemChanged(),m(g(i.prototype),"addChildAt",this).call(this,e,t)}},{key:"removeChildAt",value:function(e){return this.getChildAt(e).off(Me.RESIZE,this,this.onResize),this._setItemChanged(),m(g(i.prototype),"removeChildAt",this).call(this,e)}},{key:"refresh",value:function(){this._setItemChanged()}},{key:"changeItems",value:function(){this._itemChanged=!1}},{key:"space",get:function(){return this._space},set:function(e){this._space=e,this._setItemChanged()}},{key:"align",get:function(){return this._align},set:function(e){this._align=e,this._setItemChanged()}},{key:"sortItem",value:function(e){e&&e.sort(function(e,t){return e.y-t.y})}},{key:"_setItemChanged",value:function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))}}]),i}()),qn=(L.regClass(jn),M.regClass("laya.ui.LayoutBox",jn),M.regClass("Laya.LayoutBox",jn),function(){f(r,jn);var e=T(r);function r(){return b(this,r),e.apply(this,arguments)}return y(r,[{key:"sortItem",value:function(e){e&&e.sort(function(e,t){return e.x-t.x})}},{key:"height",get:function(){return m(g(r.prototype),"height",this)},set:function(e){this._height!=e&&(U(g(r.prototype),"height",e,this,!0),this.callLater(this.changeItems))}},{key:"changeItems",value:function(){this._itemChanged=!1;for(var e=[],t=0,i=0,n=this.numChildren;i<n;i++){var a=this.getChildAt(i);a&&(e.push(a),t=this._height||Math.max(t,a.height*a.scaleY))}this.sortItem(e);for(var s=0,i=0,n=e.length;i<n;i++)(a=e[i]).x=s,s+=a.width*a.scaleX+this._space,this._align==r.TOP?a.y=0:this._align==r.MIDDLE?a.y=.5*(t-a.height*a.scaleY):this._align==r.BOTTOM&&(a.y=t-a.height*a.scaleY);this._sizeChanged()}}]),r}()),Kn=(qn.NONE="none",qn.TOP="top",qn.MIDDLE="middle",qn.BOTTOM="bottom",L.regClass(qn),M.regClass("laya.ui.HBox",qn),M.regClass("Laya.HBox",qn),function(){f(r,jn);var e=T(r);function r(){return b(this,r),e.apply(this,arguments)}return y(r,[{key:"width",get:function(){return m(g(r.prototype),"width",this)},set:function(e){this._width!=e&&(U(g(r.prototype),"width",e,this,!0),this.callLater(this.changeItems))}},{key:"changeItems",value:function(){this._itemChanged=!1;for(var e=[],t=0,i=0,n=this.numChildren;i<n;i++){var a=this.getChildAt(i);a&&(e.push(a),t=this._width||Math.max(t,a.width*a.scaleX))}this.sortItem(e);for(var s=0,i=0,n=e.length;i<n;i++)(a=e[i]).y=s,s+=a.height*a.scaleY+this._space,this._align==r.LEFT?a.x=0:this._align==r.CENTER?a.x=.5*(t-a.width*a.scaleX):this._align==r.RIGHT&&(a.x=t-a.width*a.scaleX);this._sizeChanged()}}]),r}()),Qn=(Kn.NONE="none",Kn.LEFT="left",Kn.CENTER="center",Kn.RIGHT="right",L.regClass(Kn),M.regClass("laya.ui.VBox",Kn),M.regClass("Laya.VBox",Kn),function(){f(a,Un);var n=T(a);function a(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return b(this,a),(e=n.call(this))._valueArr="",e._indexMap=null,e._sheet=null,e._direction="horizontal",e._spaceX=0,e._spaceY=0,e._align="left",e._wordsW=0,e._wordsH=0,t&&(e.skin=t),i&&(e.sheet=i),e}return y(a,[{key:"createChildren",value:function(){this._bitmap=new kn,this.on(Me.LOADED,this,this._onClipLoaded)}},{key:"_onClipLoaded",value:function(){this.callLater(this.changeValue)}},{key:"sheet",get:function(){return this._sheet},set:function(e){var t=(this._sheet=e+="").split(" ");this._clipX=String(t[0]).length,this.clipY=t.length,this._indexMap={};for(var i=0;i<this._clipY;i++)for(var n=t[i].split(""),a=0,s=n.length;a<s;a++)this._indexMap[n[a]]=i*this._clipX+a}},{key:"value",get:function(){return this._valueArr||""},set:function(e){this._valueArr=e+="",this.callLater(this.changeValue)}},{key:"direction",get:function(){return this._direction},set:function(e){this._direction=e,this.callLater(this.changeValue)}},{key:"spaceX",get:function(){return this._spaceX},set:function(e){this._spaceX=e,"horizontal"===this._direction&&this.callLater(this.changeValue)}},{key:"spaceY",get:function(){return this._spaceY},set:function(e){this._spaceY=e,"horizontal"!==this._direction&&this.callLater(this.changeValue)}},{key:"align",get:function(){return this._align},set:function(e){this._align=e,this.callLater(this.changeValue)}},{key:"changeValue",value:function(){var e;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),e=this._sources[0]))){var t="horizontal"===this._direction,i=(t?(this._wordsW=this._valueArr.length*(e.sourceWidth+this.spaceX),this._wordsH=e.sourceHeight):(this._wordsW=e.sourceWidth,this._wordsH=(e.sourceHeight+this.spaceY)*this._valueArr.length),0);if(this._width)switch(this._align){case"center":i=.5*(this._width-this._wordsW);break;case"right":i=this._width-this._wordsW;break;default:i=0}for(var n=0,a=this._valueArr.length;n<a;n++){var s=this._indexMap[this._valueArr.charAt(n)];this.sources[s]&&(e=this.sources[s],t?this.graphics.drawImage(e,i+n*(e.sourceWidth+this.spaceX),0,e.sourceWidth,e.sourceHeight):this.graphics.drawImage(e,0+i,n*(e.sourceHeight+this.spaceY),e.sourceWidth,e.sourceHeight))}this._width||(this._widget.resetLayoutX(),this.callLater(this._sizeChanged)),this._height||(this._widget.resetLayoutY(),this.callLater(this._sizeChanged))}}},{key:"width",get:function(){return m(g(a.prototype),"width",this)},set:function(e){U(g(a.prototype),"width",e,this,!0),this.callLater(this.changeValue)}},{key:"height",get:function(){return m(g(a.prototype),"height",this)},set:function(e){U(g(a.prototype),"height",e,this,!0),this.callLater(this.changeValue)}},{key:"measureWidth",value:function(){return this._wordsW}},{key:"measureHeight",value:function(){return this._wordsH}},{key:"destroy",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off(Me.LOADED,this,this._onClipLoaded),m(g(a.prototype),"destroy",this).call(this,e)}}]),a}()),a=(L.regClass(Qn),M.regClass("laya.ui.FontClip",Qn),M.regClass("Laya.FontClip",Qn),function(){f(i,cn);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this,!1))._watchMap={},e._anchorX=NaN,e._anchorY=NaN,e._widget=_n.EMPTY,e.createChildren(),e}return y(i,[{key:"destroy",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this._watchMap=null,m(g(i.prototype),"destroy",this).call(this,e)}},{key:"changeData",value:function(e){var t=this._watchMap[e];if(t)for(var i=0,n=t.length;i<n;i++)t[i].exe(this)}},{key:"top",get:function(){return this._widget.top},set:function(e){e!=this._widget.top&&(this._getWidget().top=e)}},{key:"bottom",get:function(){return this._widget.bottom},set:function(e){e!=this._widget.bottom&&(this._getWidget().bottom=e)}},{key:"left",get:function(){return this._widget.left},set:function(e){e!=this._widget.left&&(this._getWidget().left=e)}},{key:"right",get:function(){return this._widget.right},set:function(e){e!=this._widget.right&&(this._getWidget().right=e)}},{key:"centerX",get:function(){return this._widget.centerX},set:function(e){e!=this._widget.centerX&&(this._getWidget().centerX=e)}},{key:"centerY",get:function(){return this._widget.centerY},set:function(e){e!=this._widget.centerY&&(this._getWidget().centerY=e)}},{key:"anchorX",get:function(){return this._anchorX},set:function(e){this._anchorX!=e&&(this._anchorX=e,this.callLater(this._sizeChanged))}},{key:"anchorY",get:function(){return this._anchorY},set:function(e){this._anchorY!=e&&(this._anchorY=e,this.callLater(this._sizeChanged))}},{key:"_sizeChanged",value:function(){isNaN(this._anchorX)||(this.pivotX=this.anchorX*this.width),isNaN(this._anchorY)||(this.pivotY=this.anchorY*this.height),this.event(Me.RESIZE)}},{key:"_getWidget",value:function(){return this._widget===_n.EMPTY&&(this._widget=this.addComponent(_n)),this._widget}},{key:"loadUI",value:function(e){e=i.uiMap[e];i.uiMap&&this.createView(e)}},{key:"dataSource",get:function(){return this._dataSource},set:function(e){for(var t in this._dataSource=e){var i=this.getChildByName(t);i instanceof mn?i.dataSource=e[t]:t in this&&!(this[t]instanceof Function)&&(this[t]=e[t])}}}],[{key:"__init__",value:function(){L.ClassUtils.regShortClassName([Rn,wn,On,Fn,vn,Vn,bn,Un,Yn,mn,Dn,Gn,h,Sn,zn,Xn,In,Tn,Mn,Pn,Ln,En,An,i,Bn,Wn,Hn,qn,Kn,pn,ii,Qn])}},{key:"regComponent",value:function(e,t){L.ClassUtils.regClass(e,t)}},{key:"regViewRuntime",value:function(e,t){L.ClassUtils.regClass(e,t)}},{key:"regUI",value:function(e,t){L.loader.cacheRes(e,t)}}]),i}()),Zn=(a.uiMap={},L.regClass(a),M.regClass("laya.ui.View",a),M.regClass("Laya.View",a),function(){function A(e,t){b(this,A),this.isSpine=!0,this.isDebug=!1,this._targetBone=t[e.targetBoneIndex],this.isSpine=e.isSpine,null==this._bones&&(this._bones=[]);for(var i=this._bones.length=0,n=e.boneIndexs.length;i<n;i++)this._bones.push(t[e.boneIndexs[i]]);this.name=e.name,this.mix=e.mix,this.bendDirection=e.bendDirection}return y(A,[{key:"apply",value:function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}}},{key:"_applyIk1",value:function(e,t,i,n){var a=e.parentBone,s=1/(a.resultMatrix.a*a.resultMatrix.d-a.resultMatrix.b*a.resultMatrix.c),t=t-a.resultMatrix.tx,i=i-a.resultMatrix.ty,r=(t*a.resultMatrix.d-i*a.resultMatrix.c)*s-e.transform.x,i=(i*a.resultMatrix.a-t*a.resultMatrix.b)*s-e.transform.y,t=Math.atan2(i,r)*A.radDeg-e.transform.skX;e.transform.scX<0&&(t+=180),180<t?t-=360:t<-180&&(t+=360),e.transform.skX=e.transform.skY=e.transform.skX+t*n,e.update()}},{key:"updatePos",value:function(e,t){this._sp&&this._sp.pos(e,t)}},{key:"_applyIk2",value:function(e,t,i,n,a,s){var r,o,h,l,u,c,_,f,d,p,y,g,m,v,x,k,w,b,S,I,T,C,M,E,R;0!=s&&(r=e.resultTransform.x,o=e.resultTransform.y,l=(I=e.transform.scX)<0?(I=-I,h=180,-1):(h=0,1),(b=e.transform.scY)<0&&(b=-b,l=-l),u=(M=t.transform.scX)<0?(M=-M,180):0,c=t.resultTransform.x,E=e.resultMatrix.a,p=e.resultMatrix.c,S=e.resultMatrix.b,m=e.resultMatrix.d,C=(y=Math.abs(I-b)<=1e-4)?(g=E*c+p*(_=t.resultTransform.y)+e.resultMatrix.tx,S*c+m*_+e.resultMatrix.ty):(_=0,g=E*c+e.resultMatrix.tx,S*c+e.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new N,L.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(i,n,15,"#ffff00"),this._sp.graphics.drawCircle(g,C,15,"#ff00ff")),e.setRotation(Math.atan2(C-e.resultMatrix.ty,g-e.resultMatrix.tx)),E=(f=e.parentBone).resultMatrix.a,p=f.resultMatrix.c,S=f.resultMatrix.b,k=1/(E*(m=f.resultMatrix.d)-p*S),v=((i=i-f.resultMatrix.tx)*m-(n=n-f.resultMatrix.ty)*p)*k-r,w=(n*E-i*S)*k-o,g=((i=g-f.resultMatrix.tx)*m-(n=C-f.resultMatrix.ty)*p)*k-r,C=(n*E-i*S)*k-o,f=Math.sqrt(g*g+C*C),k=t.length*M,y?((g=(v*v+w*w-f*f-(k*=I)*k)/(2*f*k))<-1?g=-1:1<g&&(g=1),d=Math.acos(g)*a,E=f+k*g,p=k*Math.sin(d),R=Math.atan2(w*E-v*p,v*E+w*p)):(C=(E=I*k)*E,M=(p=b*k)*p,y=v*v+w*w,g=Math.atan2(w,v),0<(m=(k=-2*M*f)*k-4*(w=M-C)*(S=M*f*f+C*y-C*M))&&(v=Math.sqrt(m),k=(v=-(k+(v=k<0?-v:v))/2)/w,w=S/v,(S=Math.abs(k)<Math.abs(w)?k:w)*S<=y&&(n=Math.sqrt(y-S*S)*a,R=g-Math.atan2(n,S),d=Math.atan2(n/b,(S-f)/I))),T=I=S=b=w=k=v=0,S<(m=(i=f+E)*i)&&(b=0,S=m,I=i),(m=(i=f-E)*i)<(x=Number.MAX_VALUE)&&(v=Math.PI,x=m,k=i),C=Math.acos(-E*f/(C-M)),(m=(i=E*Math.cos(C)+f)*i+(n=p*Math.sin(C))*n)<x&&(v=C,x=m,k=i,w=n),S<m&&(b=C,S=m,I=i,T=n),d=y<=(x+S)/2?(R=g-Math.atan2(w*a,k),v*a):(R=g-Math.atan2(T*a,I),b*a)),M=Math.atan2(_,c)*l,E=e.resultTransform.skX,180<(R=(R-M)*A.radDeg+h-E)?R-=360:R<-180&&(R+=360),e.resultTransform.x=r,e.resultTransform.y=o,e.resultTransform.skX=e.resultTransform.skY=E+R*s,E=t.resultTransform.skX,180<(d=(d+M)*A.radDeg*l+u-(E%=360))?d-=360:d<-180&&(d+=360),t.resultTransform.x=c,t.resultTransform.y=_,t.resultTransform.skX=t.resultTransform.skY=t.resultTransform.skY+d*s,e.update())}},{key:"_applyIk3",value:function(e,t,i,n,a,s){var r,o,h,l,u,c,_,f,d,p,y;0!=s&&(s=(s=t.resultMatrix.a*t.length)*s+(s=t.resultMatrix.b*t.length)*s,f=Math.sqrt(s),r=e.resultMatrix.tx,o=e.resultMatrix.ty,_=(d=(u=t.resultMatrix.tx)-r)*d+(p=(c=t.resultMatrix.ty)-o)*p,y=Math.sqrt(_),h=(d=i-e.resultMatrix.tx)*d+(p=n-e.resultMatrix.ty)*p,c=f+y<=(l=Math.sqrt(h))||l+f<=y||l+y<=f?(u=r+(f=f+y<=l?1:-1)*(i-r)*y/l,o+f*(n-o)*y/l):(y=r+d*(f=(_-s+h)/(2*h)),s=o+p*f,_=-p*(p=Math.sqrt(_-f*f*h)/l),f=d*p,0<a?(u=y-_,s-f):(u=y+_,s+f)),h=u,l=c,this.isDebug&&(this._sp||(this._sp=new N,L.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(r,o,15,"#ff00ff"),this._sp.graphics.drawCircle(i,n,15,"#ffff00"),this._sp.graphics.drawCircle(h,l,15,"#ff00ff")),d=Math.atan2(l-e.resultMatrix.ty,h-e.resultMatrix.tx),e.setRotation(d),(p=A._tempMatrix).identity(),p.rotate(d),p.scale(e.resultMatrix.getScaleX(),e.resultMatrix.getScaleY()),p.translate(e.resultMatrix.tx,e.resultMatrix.ty),p.copyTo(e.resultMatrix),e.updateChild(),a=Math.atan2(n-l,i-h),t.setRotation(a),(y=A._tempMatrix).identity(),y.rotate(a),y.scale(t.resultMatrix.getScaleX(),t.resultMatrix.getScaleY()),y.translate(h,l),p.copyTo(t.resultMatrix),t.updateChild())}}]),A}()),Jn=(Zn.radDeg=180/Math.PI,Zn.degRad=Math.PI/180,Zn._tempMatrix=new Ce,function(){function L(e,t){b(this,L),this._debugKey=!1,this._segments=[],this._curves=[],this.data=e,this.position=e.position,this.spacing=e.spacing,this.rotateMix=e.rotateMix,this.translateMix=e.translateMix,this.bones=[];for(var i=this.data.bones,n=0,a=i.length;n<a;n++)this.bones.push(t[i[n]])}return y(L,[{key:"apply",value:function(e,t){if(this.target){var i=this.translateMix,n=this.translateMix,a=0<n,s=this.data.spacingMode,r="length"==s,o=this.data.rotateMode,h="tangent"==o,l="chainScale"==o,u=[],c=this.bones.length,_=h?c:c+1,f=[],d=((this._spaces=f)[0]=this.position,this.spacing);if(l||r)for(var p=0,y=_-1;p<y;){var g=this.bones[p],m=(x=g.length)*g.resultMatrix.a,v=x*g.resultMatrix.b,x=Math.sqrt(m*m+v*v);l&&(u[p]=x),f[++p]=r?Math.max(0,x+d):d}else for(p=1;p<_;p++)f[p]=d;var k=this.computeWorldPositions(this.target,e,t,_,h,"percent"==this.data.positionMode,"percent"==s);if(this._debugKey){for(p=0;p<k.length;p++)t.drawCircle(k[p++],k[p++],5,"#00ff00");for(var w=[],p=0;p<k.length;p++)w.push(k[p++],k[p++]);t.drawLines(0,0,w,"#ff0000")}var b,S=k[0],I=k[1],T=this.data.offsetRotation,D="chain"==o&&0==T;for(p=0,b=3;p<c;p++,b+=3){(g=this.bones[p]).resultMatrix.tx+=(S-g.resultMatrix.tx)*i,g.resultMatrix.ty+=(I-g.resultMatrix.ty)*i;var C,M,E,R,A,L,N,P=(m=k[b])-S,B=(v=k[b+1])-I;l&&0!=(x=u[p])&&(C=(Math.sqrt(P*P+B*B)/x-1)*n+1,g.resultMatrix.a*=C,g.resultMatrix.c*=C),S=m,I=v,a&&(C=g.resultMatrix.a,M=g.resultMatrix.c,E=g.resultMatrix.b,R=g.resultMatrix.d,N=h?k[b-1]:0==f[p+1]?k[b+2]:Math.atan2(B,P),N-=Math.atan2(E,C)-T/180*Math.PI,D&&(A=Math.cos(N),L=Math.sin(N),S+=((x=g.length)*(A*C-L*E)-P)*n,I+=(x*(L*C+A*E)-B)*n),N>Math.PI?N-=2*Math.PI:N<-Math.PI&&(N+=2*Math.PI),N*=n,A=Math.cos(N),L=Math.sin(N),g.resultMatrix.a=A*C-L*E,g.resultMatrix.c=A*M-L*R,g.resultMatrix.b=L*C+A*E,g.resultMatrix.d=L*M+A*R)}}}},{key:"computeWorldVertices2",value:function(e,t,i,n,a,s){var r,o,h=e.currDisplayData.bones,l=e.currDisplayData.weights,u=e.currDisplayData.triangles,c=0,_=0,f=0,d=0,p=0,y=0,g=0,m=0,v=0,x=0;if(null==h){var k,u=u||l;if(e.deformData&&(u=e.deformData),k=e.parent,t)for(o=t.length,c=0;c<o;c++)if(t[c].name==k){r=t[c];break}var w,b=(w=(w=r?r.resultMatrix:w)||L._tempMt).tx,S=w.ty,I=w.a,T=w.b,C=w.c,M=w.d;for(r&&(M*=r.d),_=i,p=s;p<n;_+=2,p+=2)v=u[_],x=u[_+1],a[p]=v*I+x*T+b,a[p+1]=-(v*C+x*M+S)}else{for(c=0;c<i;c+=2)_+=(d=h[_])+1,f+=d;for(var E=t,p=s,y=3*f;p<n;p+=2){for(m=g=0,d=h[_++],d+=_;_<d;_++,y+=3){var R=E[h[_]].resultMatrix,v=l[y],x=l[y+1],A=l[y+2];g+=(v*R.a+x*R.c+R.tx)*A,m+=(v*R.b+x*R.d+R.ty)*A}a[p]=g,a[p+1]=m}}}},{key:"computeWorldPositions",value:function(e,D,O,t,F,V,U){e.currDisplayData.bones,e.currDisplayData.weights,e.currDisplayData.triangles;var i,n,a,s,z,r,o,h=[],l=0,u=e.currDisplayData.verLen,Y=this.position,G=this._spaces,c=[],_=u/6,X=-1;if(_--,this.computeWorldVertices2(e,D,2,u-=4,h,0),this._debugKey)for(l=0;l<h.length;)O.drawCircle(h[l++],h[l++],10,"#ff0000");i=h,this._curves.length=_;for(var f=this._curves,d=0,p=i[0],y=i[1],g=0,m=0,v=0,x=0,k=0,w=0,l=0,b=2;l<_;l++,b+=6)L=2*(C=.1875*(p-2*(g=i[b])+(v=i[b+2])))+(E=.09375*(3*(g-v)-p+(k=i[b+4]))),N=2*(M=.1875*(y-2*(m=i[b+1])+(x=i[b+3])))+(R=.09375*(3*(m-x)-y+(w=i[b+5]))),P=.75*(g-p)+C+.16666667*E,B=.75*(m-y)+M+.16666667*R,d+=Math.sqrt(P*P+B*B),P+=L,B+=N,L+=E,N+=R,d+=Math.sqrt(P*P+B*B),P+=L,B+=N,d+=Math.sqrt(P*P+B*B),P+=L+E,B+=N+R,d+=Math.sqrt(P*P+B*B),f[l]=d,p=k,y=w;if(V&&(Y*=d),U)for(l=0;l<t;l++)G[l]*=d;for(var S=this._segments,I=0,T=a=n=l=0;l<t;l++,n+=3)if((s=Y+=z=G[l])<0)this.addBeforePosition(s,i,0,c,n);else if(d<s)this.addAfterPosition(s-d,i,u-4,c,n);else{for(;;a++)if(!((o=f[a])<s)){0==a?s/=o:s=(s-(r=f[a-1]))/(o-r);break}if(a!=X){var C,M,E,R,X=a,A=6*a,p=i[A],y=i[A+1],g=i[A+2],m=i[A+3],v=i[A+4],x=i[A+5],L=2*(C=.03*(p-2*g+v))+(E=.006*(3*(g-v)-p+(k=i[A+6]))),N=2*(M=.03*(y-2*m+x))+(R=.006*(3*(m-x)-y+(w=i[A+7]))),P=.3*(g-p)+C+.16666667*E,B=.3*(m-y)+M+.16666667*R,I=Math.sqrt(P*P+B*B);for(S[0]=I,A=1;A<8;A++)P+=L,B+=N,L+=E,N+=R,I+=Math.sqrt(P*P+B*B),S[A]=I;P+=L,B+=N,I+=Math.sqrt(P*P+B*B),S[8]=I,P+=L+E,B+=N+R,I+=Math.sqrt(P*P+B*B),S[9]=I,T=0}for(s*=I;;T++)if(!((o=S[T])<s)){0==T?s/=o:s=T+(s-(r=S[T-1]))/(o-r);break}this.addCurvePosition(.1*s,p,y,g,m,v,x,k,w,c,n,F||0<l&&0==z)}return c}},{key:"addBeforePosition",value:function(e,t,i,n,a){var s=t[i],r=t[i+1],o=t[i+2]-s,t=t[i+3]-r,i=Math.atan2(t,o);n[a]=s+e*Math.cos(i),n[a+1]=r+e*Math.sin(i),n[a+2]=i}},{key:"addAfterPosition",value:function(e,t,i,n,a){var s=t[i+2],r=t[i+3],o=s-t[i],t=r-t[i+1],i=Math.atan2(t,o);n[a]=s+e*Math.cos(i),n[a+1]=r+e*Math.sin(i),n[a+2]=i}},{key:"addCurvePosition",value:function(e,t,i,n,a,s,r,o,h,l,u,c){var _=(e=0==e?1e-4:e)*e,f=_*e,d=1-e,p=d*d,y=p*d,g=d*e,m=3*g,d=d*m,m=m*e,e=t*y+n*d+s*m+o*f,o=i*y+a*d+r*m+h*f;l[u]=e,l[u+1]=o,l[u+2]=c?Math.atan2(o-(i*p+a*g*2+r*_),e-(t*p+n*g*2+s*_)):0}}]),L}()),$n=(Jn.BEFORE=-2,Jn.AFTER=-3,Jn._tempMt=new Ce,function(){function a(e,t){var i,n;for(b(this,a),this._temp=[],this._data=e,null==this._bones&&(this._bones=[]),this.target=t[e.targetIndex],i=0,n=e.boneIndexs.length;i<n;i++)this._bones.push(t[e.boneIndexs[i]]);this.rotateMix=e.rotateMix,this.translateMix=e.translateMix,this.scaleMix=e.scaleMix,this.shearMix=e.shearMix}return y(a,[{key:"apply",value:function(){for(var e=this.target.resultMatrix.a,t=this.target.resultMatrix.b,i=this.target.resultMatrix.c,n=this.target.resultMatrix.d,a=0,s=this._bones.length;a<s;a++){var r,o,h,l,u,c,_,f,d=this._bones[a];0<this.rotateMix&&(o=d.resultMatrix.a,u=d.resultMatrix.b,h=d.resultMatrix.c,c=d.resultMatrix.d,(f=Math.atan2(i,e)-Math.atan2(h,o)+this._data.offsetRotation*Math.PI/180)>Math.PI?f-=2*Math.PI:f<-Math.PI&&(f+=2*Math.PI),f*=this.rotateMix,r=Math.cos(f),_=Math.sin(f),d.resultMatrix.a=r*o-_*h,d.resultMatrix.b=r*u-_*c,d.resultMatrix.c=_*o+r*h,d.resultMatrix.d=_*u+r*c),this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),d.resultMatrix.tx+=(this._temp[0]-d.resultMatrix.tx)*this.translateMix,d.resultMatrix.ty+=(this._temp[1]-d.resultMatrix.ty)*this.translateMix,d.updateChild()),0<this.scaleMix&&(o=Math.sqrt(d.resultMatrix.a*d.resultMatrix.a+d.resultMatrix.c*d.resultMatrix.c),h=Math.sqrt(e*e+i*i),l=1e-5<o?(o+(h-o+this._data.offsetScaleX)*this.scaleMix)/o:0,d.resultMatrix.a*=l,d.resultMatrix.c*=l,o=Math.sqrt(d.resultMatrix.b*d.resultMatrix.b+d.resultMatrix.d*d.resultMatrix.d),h=Math.sqrt(t*t+n*n),l=1e-5<o?(o+(h-o+this._data.offsetScaleY)*this.scaleMix)/o:0,d.resultMatrix.b*=l,d.resultMatrix.d*=l),0<this.shearMix&&(u=d.resultMatrix.b,c=d.resultMatrix.d,_=Math.atan2(c,u),(f=Math.atan2(n,t)-Math.atan2(i,e)-(_-Math.atan2(d.resultMatrix.c,d.resultMatrix.a)))>Math.PI?f-=2*Math.PI:f<-Math.PI&&(f+=2*Math.PI),f=_+(f+this._data.offsetShearY*Math.PI/180)*this.shearMix,l=Math.sqrt(u*u+c*c),d.resultMatrix.b=Math.cos(f)*l,d.resultMatrix.d=Math.sin(f)*l)}}}]),a}()),ea=y(function e(){b(this,e)}),ta=(ea.stopped=0,ea.paused=1,ea.playing=2,function(){f(i,ae);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).isCache=!0,e.playbackRate=1,e._destroyed=!1,e._currentAnimationClipIndex=-1,e._currentKeyframeIndex=-1,e._currentTime=0,e._overallDuration=Number.MAX_VALUE,e._stopWhenCircleFinish=!1,e._elapsedPlaybackTime=0,e._startUpdateLoopCount=-1,e._cachePlayRate=1,e.cacheFrameRate=60,e.returnToZeroStopped=!1,e}return y(i,[{key:"templet",get:function(){return this._templet},set:function(e){this.state!==ea.stopped&&this.stop(!0),this._templet!==e&&(this._templet=e,this._computeFullKeyframeIndices())}},{key:"playStart",get:function(){return this._playStart}},{key:"playEnd",get:function(){return this._playEnd}},{key:"playDuration",get:function(){return this._playDuration}},{key:"overallDuration",get:function(){return this._overallDuration}},{key:"currentAnimationClipIndex",get:function(){return this._currentAnimationClipIndex}},{key:"currentKeyframeIndex",get:function(){return this._currentKeyframeIndex}},{key:"currentPlayTime",get:function(){return this._currentTime+this._playStart}},{key:"currentFrameTime",get:function(){return this._currentFrameTime}},{key:"cachePlayRate",get:function(){return this._cachePlayRate},set:function(e){this._cachePlayRate!==e&&(this._cachePlayRate=e,this._templet&&this._computeFullKeyframeIndices())}},{key:"cacheFrameRate",get:function(){return this._cacheFrameRate},set:function(e){this._cacheFrameRate!==e&&(this._cacheFrameRate=e,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&this._computeFullKeyframeIndices())}},{key:"currentTime",set:function(e){if(-1!==this._currentAnimationClipIndex&&this._templet){if(e<this._playStart||e>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=k.loopCount;var t=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=e,this._currentKeyframeIndex=Math.floor(this.currentPlayTime/t),this._currentFrameTime=this._currentKeyframeIndex*t}}},{key:"paused",get:function(){return this._paused},set:function(e){(this._paused=e)&&this.event(Me.PAUSED)}},{key:"cacheFrameRateInterval",get:function(){return this._cacheFrameRateInterval}},{key:"state",get:function(){return-1===this._currentAnimationClipIndex?ea.stopped:this._paused?ea.paused:ea.playing}},{key:"destroyed",get:function(){return this._destroyed}},{key:"_onTempletLoadedComputeFullKeyframeIndices",value:function(e,t,i){this._templet===i&&this._cachePlayRate===e&&this._cacheFrameRate===t&&this._computeFullKeyframeIndices()}},{key:"_computeFullKeyframeIndices",value:function(){}},{key:"_onAnimationTempletLoaded",value:function(){this.destroyed||this._calculatePlayDuration()}},{key:"_calculatePlayDuration",value:function(){var e;this.state!==ea.stopped&&(e=this._templet.getAniDuration(this._currentAnimationClipIndex),0===this._playEnd&&(this._playEnd=e),this._playEnd>e&&(this._playEnd=e),this._playDuration=this._playEnd-this._playStart)}},{key:"_setPlayParams",value:function(e,t){this._currentTime=e,this._currentKeyframeIndex=Math.floor(this.currentPlayTime/t+.01),this._currentFrameTime=this._currentKeyframeIndex*t}},{key:"_setPlayParamsWhenStop",value:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:-1,i=(this._currentTime=e,0<i?i:e);this._currentKeyframeIndex=Math.floor(i/t+.01),this._currentKeyframeIndex=Math.floor(e/t+.01),this._currentFrameTime=this._currentKeyframeIndex*t,this._currentAnimationClipIndex=-1}},{key:"_update",value:function(e){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet){var t=this._cacheFrameRateInterval*this._cachePlayRate,i=0,e=(this._startUpdateLoopCount!==k.loopCount&&(i=e*this.playbackRate,this._elapsedPlaybackTime+=i),this.playDuration);if(i+=this._currentTime,0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=e||0===this._overallDuration&&i>=this.playEnd)return this._setPlayParamsWhenStop(e,t,this.playEnd),void this.event(Me.STOPPED);if(0<e)e<=i?this._stopWhenCircleFinish?(this._setPlayParamsWhenStop(e,t),this._stopWhenCircleFinish=!1,this.event(Me.STOPPED)):(this._setPlayParams(i%=e,t),this.event(Me.COMPLETE)):this._setPlayParams(i,t);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(e,t),this._stopWhenCircleFinish=!1,void this.event(Me.STOPPED);this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event(Me.COMPLETE)}}}},{key:"_destroy",value:function(){this.offAll(),this._templet=null,this._destroyed=!0}},{key:"play",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:2147483647,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0;if(!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if(i<0||n<0||a<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==a&&a<n)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=t,this._overallDuration=i,this._playStart=n,this._playEnd=a,this._paused=!1,this._currentAnimationClipIndex=e,this._currentKeyframeIndex=0,this._startUpdateLoopCount=k.loopCount,this.event(Me.PLAYED),this._calculatePlayDuration(),this._update(0)}},{key:"playByFrame",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:2147483647,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,s=1e3/(5<arguments.length&&void 0!==arguments[5]?arguments[5]:30);this.play(e,t,i,n*s,a*s)}},{key:"stop",value:function(){!(0<arguments.length&&void 0!==arguments[0])||arguments[0]?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event(Me.STOPPED)):this._stopWhenCircleFinish=!0}},{key:"destroy",value:function(){}}]),i}()),ia=function(){f(t,Wt);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"drawSkin",value:function(e,t){this.drawTriangles(e.texture,0,0,e.vertices,e.uvs,e.indexes,e.transform||Ce.EMPTY,t)}}],[{key:"create",value:function(){return t._caches.pop()||new t}},{key:"recycle",value:function(e){e.clear(),t._caches.push(e)}}]),t}(),na=(ia._caches=[],y(function e(){b(this,e)})),aa=(na.Skeleton=null,na.AnimationTemplet=null,na.Templet=null,function(){f(a,N);var n=T(a);function a(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return b(this,a),(e=n.call(this))._boneMatrixArray=[],e._lastTime=0,e._currAniIndex=-1,e._pause=!0,e._aniClipIndex=-1,e._clipIndex=-1,e._skinIndex=0,e._skinName="default",e._aniMode=0,e._index=-1,e._total=-1,e._indexControl=!1,e._eventIndex=0,e._drawOrderIndex=0,e._drawOrder=null,e._lastAniClipIndex=-1,e._lastUpdateAniClipIndex=-1,e._playAudio=!0,e._soundChannelArr=[],t&&e.init(t,i),e}return y(a,[{key:"init",value:function(e){var t,i,n,a,s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=0;if(1==s)for(this._graphicsCache=[],r=0,t=e.getAnimationCount();r<t;r++)this._graphicsCache.push([]);if(this._yReverseMatrix=e.yReverseMatrix,this._aniMode=s,this._templet=e,this._templet._addReference(1),this._player=new ta,this._player.cacheFrameRate=e.rate,this._player.templet=e,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=e.mBoneArr,this._rootBone=e.mRootBone,this._aniSectionDic=e.aniSectionDic,0<e.ikArr.length)for(this._ikArr=[],r=0,t=e.ikArr.length;r<t;r++)this._ikArr.push(new Zn(e.ikArr[r],this._boneList));if(0<e.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),r=0,t=e.pathArr.length;r<t;r++)i=e.pathArr[r],n=new Jn(i,this._boneList),(a=this._boneSlotDic[i.name])&&((n=new Jn(i,this._boneList)).target=a),this._pathDic[i.name]=n;if(0<e.tfArr.length)for(this._tfArr=[],r=0,t=e.tfArr.length;r<t;r++)this._tfArr.push(new $n(e.tfArr[r],this._boneList));0<e.skinDataArray.length&&(s=this._templet.skinDataArray[this._skinIndex],this._skinName=s.name),this._player.on(Me.PLAYED,this,this._onPlay),this._player.on(Me.STOPPED,this,this._onStop),this._player.on(Me.PAUSED,this,this._onPause)}},{key:"url",get:function(){return this._aniPath},set:function(e){this.load(e)}},{key:"load",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;this._aniPath=e,this._complete=t,this._loadAniMode=i,L.loader.load([{url:e,type:L.Loader.BUFFER}],x.create(this,this._onLoaded))}},{key:"_onLoaded",value:function(){var e,t=L.Loader.getRes(this._aniPath);null!=t&&(null==na.Templet.TEMPLET_DICTIONARY&&(na.Templet.TEMPLET_DICTIONARY={}),(e=na.Templet.TEMPLET_DICTIONARY[this._aniPath])?e.isParseFail?this._parseFail():e.isParserComplete?this._parseComplete():(e.on(Me.COMPLETE,this,this._parseComplete),e.on(Me.ERROR,this,this._parseFail)):((e=new na.Templet)._setCreateURL(this._aniPath),(na.Templet.TEMPLET_DICTIONARY[this._aniPath]=e).on(Me.COMPLETE,this,this._parseComplete),e.on(Me.ERROR,this,this._parseFail),e.isParserComplete=!1,e.parseData(null,t)))}},{key:"_parseComplete",value:function(){var e=na.Templet.TEMPLET_DICTIONARY[this._aniPath];e&&(this.init(e,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)}},{key:"_parseFail",value:function(){console.log("[Error]:"+this._aniPath+"解析失败")}},{key:"_onPlay",value:function(){this.event(Me.PLAYED)}},{key:"_onStop",value:function(){var e,t=this._templet.eventAniArr[this._aniClipIndex];if(t&&this._eventIndex<t.length)for(;this._eventIndex<t.length;this._eventIndex++)(e=t[this._eventIndex]).time>=this._player.playStart&&e.time<=this._player.playEnd&&this.event(Me.LABEL,e);this._drawOrder=null,this.event(Me.STOPPED)}},{key:"_onPause",value:function(){this.event(Me.PAUSED)}},{key:"_parseSrcBoneMatrix",value:function(){var e=0,t=0;for(t=this._templet.srcBoneMatrixArr.length,e=0;e<t;e++)this._boneMatrixArray.push(new Ce);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);for(var i,n,a=this._templet.boneSlotArray,e=0,t=a.length;e<t;e++)i=a[e],null==(n=this._bindBoneBoneSlotDic[i.parent])&&(this._bindBoneBoneSlotDic[i.parent]=n=[]),this._boneSlotDic[i.name]=i=i.copy(),n.push(i),this._boneSlotArray.push(i)}}},{key:"_emitMissedEvents",value:function(e,t){var i=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if(i)for(var n,a=0,s=i.length,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;a<s;a++)(n=i[a]).time>=this._player.playStart&&n.time<=this._player.playEnd&&this.event(Me.LABEL,n)}},{key:"_update",value:function(){var e,t,i,n,a,s=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this._pause||s&&this._indexControl||(n=this.timer.currTimer,e=this._player.currentKeyframeIndex,t=n-this._lastTime,s?this._player._update(t):e=-1,this._lastTime=n,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,this._index<0||0<t&&this._clipIndex==e&&this._lastUpdateAniClipIndex==this._aniClipIndex||(this._lastUpdateAniClipIndex=this._aniClipIndex,e>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0),(s=this._templet.eventAniArr[this._aniClipIndex])&&this._eventIndex<s.length&&((n=s[this._eventIndex]).time>=this._player.playStart&&n.time<=this._player.playEnd?this._player.currentPlayTime>=n.time&&(this.event(Me.LABEL,n),this._eventIndex++,this._playAudio&&n.audioValue&&"null"!==n.audioValue&&"undefined"!==n.audioValue&&(i=yi.playSound(this._player.templet._path+n.audioValue,1,x.create(this,this._onAniSoundStoped)),yi.playbackRate=this._player.playbackRate,i&&this._soundChannelArr.push(i))):n.time<this._player.playStart&&this._playAudio&&n.audioValue&&"null"!==n.audioValue&&"undefined"!==n.audioValue?(this._eventIndex++,i=yi.playSound(this._player.templet._path+n.audioValue,1,x.create(this,this._onAniSoundStoped),null,(this._player.currentPlayTime-n.time)/1e3),yi.playbackRate=this._player.playbackRate,i&&this._soundChannelArr.push(i)):this._eventIndex++),0==this._aniMode?(a=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex)||this._createGraphics())&&this.graphics!=a&&(this.graphics=a):1==this._aniMode?(a=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex)||this._createGraphics())&&this.graphics!=a&&(this.graphics=a):this._createGraphics())))}},{key:"_onAniSoundStoped",value:function(e){for(var t,i=this._soundChannelArr.length,n=0;n<i;n++)((t=this._soundChannelArr[n]).isStopped||e)&&(t.isStopped||t.stop(),this._soundChannelArr.splice(n,1),i--,n--)}},{key:"_createGraphics",value:function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1,i=(t=-1==t?this._clipIndex:t)*this._player.cacheFrameRateInterval,n=this._templet.drawOrderAniArr[this._aniClipIndex];if(n&&0<n.length)for(this._drawOrderIndex=0,e=n[this._drawOrderIndex];i>=e.time&&(this._drawOrder=e.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=n.length));)e=n[this._drawOrderIndex];0!=this._aniMode&&1!=this._aniMode&&this.graphics instanceof ia?this.graphics.clear():this.graphics=ia.create();var a,s,r=this.graphics,o=this._templet.getNodes(this._aniClipIndex),h=0==this._player.state,h=(this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,null,t,h?i+this._player.cacheFrameRateInterval:i),this._aniSectionDic[this._aniClipIndex]),l=0,u=0,c=0,_=0,f=0,d=this._templet.srcBoneMatrixArr.length,p=this._curOriginalData;for(f=h[u=0];u<d;u++){var y,g=(y=this._boneList[u]).resultTransform,m=this._templet.srcBoneMatrixArr[u];g.scX=m.scX*p[l++],g.skX=m.skX+p[l++],g.skY=m.skY+p[l++],g.scY=m.scY*p[l++],g.x=m.x+p[l++],g.y=m.y+p[l++],8===this._templet.tMatrixDataLen&&(g.skewX=m.skewX+p[l++],g.skewY=m.skewY+p[l++])}var v={},x={};for(f+=h[1];u<f;u++)v[(b=o[u]).name]=p[l++],x[b.name]=p[l++],l+=4;var k={},w={};for(f+=h[2];u<f;u++)k[(b=o[u]).name]=p[l++],w[b.name]=p[l++],l+=4;if(this._pathDic)for(f+=h[3];u<f;u++){var b=o[u],S=this._pathDic[b.name];if(S)switch(new mi(b.extenData).getByte()){case 1:S.position=p[l++];break;case 2:S.spacing=p[l++];break;case 3:S.rotateMix=p[l++],S.translateMix=p[l++]}}if(this._rootBone.update(this._yReverseMatrix||Ce.TEMP.identity()),this._ikArr)for(var I,u=0,f=this._ikArr.length;u<f;u++)(I=this._ikArr[u]).name in k&&(I.bendDirection=k[I.name]),I.name in w&&(I.mix=w[I.name]),I.apply();if(this._pathDic)for(var T in this._pathDic)(S=this._pathDic[T]).apply(this._boneList,r);if(this._tfArr)for(u=0,_=this._tfArr.length;u<_;u++)this._tfArr[u].apply();for(u=0,_=this._boneList.length;u<_;u++)if(y=this._boneList[u],s=this._bindBoneBoneSlotDic[y.name],y.resultMatrix.copyTo(this._boneMatrixArray[u]),s)for(c=0,f=s.length;c<f;c++)(a=s[c])&&a.setParentMatrix(y.resultMatrix);var C,M,E,R={},h=this._templet.deformAniArr;if(h&&0<h.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,u=0,f=this._boneSlotArray.length;u<f;u++)(a=this._boneSlotArray[u]).deformData=null;var A,L=h[this._aniClipIndex],N=L.default;for(A in this._setDeform(N,R,this._boneSlotArray,i),L)"default"!=A&&A!=this._skinName&&(N=L[A],this._setDeform(N,R,this._boneSlotArray,i));N=L[this._skinName],this._setDeform(N,R,this._boneSlotArray,i)}if(this._drawOrder)for(u=0,f=this._drawOrder.length;u<f;u++)C=v[(a=this._boneSlotArray[this._drawOrder[u]]).name],M=x[a.name],isNaN(C)||-2==C||(this._templet.attachmentNames?a.showDisplayByName(this._templet.attachmentNames[C]):a.showDisplayByIndex(C)),R[this._drawOrder[u]]?(E=R[this._drawOrder[u]],a.currDisplayData&&E[a.currDisplayData.attachmentName]?a.deformData=E[a.currDisplayData.attachmentName]:a.deformData=null):a.deformData=null,isNaN(M)?a.draw(r,this._boneMatrixArray,2==this._aniMode):a.draw(r,this._boneMatrixArray,2==this._aniMode,M);else for(u=0,f=this._boneSlotArray.length;u<f;u++)C=v[(a=this._boneSlotArray[u]).name],M=x[a.name],isNaN(C)||-2==C||(this._templet.attachmentNames?a.showDisplayByName(this._templet.attachmentNames[C]):a.showDisplayByIndex(C)),R[u]?(E=R[u],a.currDisplayData&&E[a.currDisplayData.attachmentName]?a.deformData=E[a.currDisplayData.attachmentName]:a.deformData=null):a.deformData=null,isNaN(M)?a.draw(r,this._boneMatrixArray,2==this._aniMode):a.draw(r,this._boneMatrixArray,2==this._aniMode,M);return 0==this._aniMode?(this._templet.setGrahicsDataWithCache(this._aniClipIndex,t,r),this._checkIsAllParsed(this._aniClipIndex)):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,t,r),r}},{key:"_checkIsAllParsed",value:function(e){for(var t=Math.floor(.01+this._templet.getAniDuration(e)/1e3*this._player.cacheFrameRate),i=0;i<t;i++)if(!this._templet.getGrahicsDataWithCache(e,i))return;this._templet.getGrahicsDataWithCache(e,t)?this._templet.deleteAniData(e):this._createGraphics(t)}},{key:"_setDeform",value:function(e,t,i,n){var a,s,r,o,h,l;if(e&&e)for(o=0,h=e.deformSlotDataList.length;o<h;o++)for(a=e.deformSlotDataList[o],l=0;l<a.deformSlotDisplayList.length;l++)r=i[(s=a.deformSlotDisplayList[l]).slotIndex],s.apply(n,r),t[s.slotIndex]||(t[s.slotIndex]={}),t[s.slotIndex][s.attachment]=s.deformData}},{key:"getAnimNum",value:function(){return this._templet.getAnimationCount()}},{key:"getAniNameByIndex",value:function(e){return this._templet.getAniNameByIndex(e)}},{key:"getSlotByName",value:function(e){return this._boneSlotDic[e]}},{key:"showSkinByName",value:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];this.showSkinByIndex(this._templet.getSkinIndexByName(e),t)}},{key:"showSkinByIndex",value:function(e){for(var t,i=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=0;n<this._boneSlotArray.length;n++)this._boneSlotArray[n].showSlotData(null,i);this._templet.showSkinByIndex(this._boneSlotDic,e,i)&&(t=this._templet.skinDataArray[e],this._skinIndex=e,this._skinName=t.name),this._clearCache()}},{key:"showSlotSkinByIndex",value:function(e,t){0!=this._aniMode&&((e=this.getSlotByName(e))&&e.showDisplayByIndex(t),this._clearCache())}},{key:"showSlotSkinByName",value:function(e,t){0!=this._aniMode&&((e=this.getSlotByName(e))&&e.showDisplayByName(t),this._clearCache())}},{key:"replaceSlotSkinName",value:function(e,t,i){0!=this._aniMode&&((e=this.getSlotByName(e))&&e.replaceDisplayByName(t,i),this._clearCache())}},{key:"replaceSlotSkinByIndex",value:function(e,t,i){0!=this._aniMode&&((e=this.getSlotByName(e))&&e.replaceDisplayByIndex(t,i),this._clearCache())}},{key:"setSlotSkin",value:function(e,t){0!=this._aniMode&&((e=this.getSlotByName(e))&&e.replaceSkin(t),this._clearCache())}},{key:"_clearCache",value:function(){if(1==this._aniMode)for(var e=0,t=this._graphicsCache.length;e<t;e++){for(var i=0,n=this._graphicsCache[e].length;i<n;i++){var a=this._graphicsCache[e][i];a&&a!=this.graphics&&ia.recycle(a)}this._graphicsCache[e].length=0}}},{key:"play",value:function(e,t){var i=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,s=!(5<arguments.length&&void 0!==arguments[5])||arguments[5],r=(this._playAudio=!(6<arguments.length&&void 0!==arguments[6])||arguments[6],this._indexControl=!1,-1),t=t?2147483647:0;if("string"==typeof e)for(var o=0,h=this._templet.getAnimationCount();o<h;o++){var l=this._templet.getAnimation(o);if(l&&e==l.name){r=o;break}}else r=e;-1<r&&r<this.getAnimNum()&&(this._aniClipIndex=r,(i||this._pause||this._currAniIndex!=r)&&(this._currAniIndex=r,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(r)),this._drawOrder=null,this._eventIndex=0,this._player.play(r,this._player.playbackRate,t,n,a),s&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=L.Browser.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))}},{key:"stop",value:function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),0<this._soundChannelArr.length&&this._onAniSoundStoped(!0),this.timer.clear(this,this._update))}},{key:"playbackRate",value:function(e){this._player&&(this._player.playbackRate=e)}},{key:"paused",value:function(){if(!this._pause){if(this._pause=!0,this._player&&(this._player.paused=!0),0<this._soundChannelArr.length)for(var e,t=this._soundChannelArr.length,i=0;i<t;i++)(e=this._soundChannelArr[i]).isStopped||e.pause();this.timer.clear(this,this._update)}}},{key:"resume",value:function(){if(this._indexControl=!1,this._pause){if(this._pause=!1,this._player&&(this._player.paused=!1),0<this._soundChannelArr.length)for(var e,t=this._soundChannelArr.length,i=0;i<t;i++)(e=this._soundChannelArr[i]).audioBuffer&&e.resume();this._lastTime=L.Browser.now(),this.timer.frameLoop(1,this,this._update,null,!0)}}},{key:"_getGrahicsDataWithCache",value:function(e,t){return this._graphicsCache[e][t]}},{key:"_setGrahicsDataWithCache",value:function(e,t,i){this._graphicsCache[e][t]=i}},{key:"destroy",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];m(g(a.prototype),"destroy",this).call(this,e),this._templet._removeReference(1),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update),0<this._soundChannelArr.length&&this._onAniSoundStoped(!0)}},{key:"index",get:function(){return this._index},set:function(e){this.player&&(this._index=e,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}},{key:"total",get:function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}},{key:"player",get:function(){return this._player}},{key:"templet",get:function(){return this._templet}}]),a}()),sa=(aa.useSimpleMeshInCanvas=!1,na.Skeleton=aa,L.regClass(aa),M.regClass("laya.ani.bone.Skeleton",aa),M.regClass("Laya.Skeleton",aa),y(function e(){b(this,e)})),ra=(sa.Dialog=null,function(){f(i,N);var e=T(i);function i(){var t;return b(this,i),(t=e.call(this)).maskLayer=new N,t.popupEffect=function(e){e.scale(1,1),e._effectTween=Ci.from(e,{x:L.stage.width/2,y:L.stage.height/2,scaleX:0,scaleY:0},300,Ti.backOut,x.create(O(t),t.doOpen,[e]),0,!1,!1)},t.closeEffect=function(e){e._effectTween=Ci.to(e,{x:L.stage.width/2,y:L.stage.height/2,scaleX:0,scaleY:0},300,Ti.strongOut,x.create(O(t),t.doClose,[e]),0,!1,!1)},t.popupEffectHandler=new x(O(t),t.popupEffect),t.closeEffectHandler=new x(O(t),t.closeEffect),t.mouseEnabled=t.maskLayer.mouseEnabled=!0,t.zOrder=1e3,L.stage.addChild(O(t)),L.stage.on(Me.RESIZE,O(t),t._onResize),Nn.closeDialogOnSide&&t.maskLayer.on("click",O(t),t._closeOnSide),t._onResize(null),t}return y(i,[{key:"_closeOnSide",value:function(){var e=this.getChildAt(this.numChildren-1);e instanceof sa.Dialog&&e.close()}},{key:"setLockView",value:function(e){this.lockLayer||(this.lockLayer=new vn,this.lockLayer.mouseEnabled=!0,this.lockLayer.size(L.stage.width,L.stage.height)),this.lockLayer.removeChildren(),e&&(e.centerX=e.centerY=0,this.lockLayer.addChild(e))}},{key:"_onResize",value:function(){var e=this.maskLayer.width=L.stage.width,t=this.maskLayer.height=L.stage.height;this.lockLayer&&this.lockLayer.size(e,t),this.maskLayer.graphics.clear(!0),this.maskLayer.graphics.drawRect(0,0,e,t,Nn.popupBgColor),this.maskLayer.alpha=Nn.popupBgAlpha;for(var i=this.numChildren-1;-1<i;i--){var n=this.getChildAt(i);n.isPopupCenter&&this._centerDialog(n)}}},{key:"_centerDialog",value:function(e){e.x=Math.round((L.stage.width-e.width>>1)+e.pivotX),e.y=Math.round((L.stage.height-e.height>>1)+e.pivotY)}},{key:"open",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=2<arguments.length&&void 0!==arguments[2]&&arguments[2];t&&this._closeAll(),this._clearDialogEffect(e),e.isPopupCenter&&this._centerDialog(e),this.addChild(e),(e.isModal||this._getBit(Ht.HAS_ZORDER))&&L.timer.callLater(this,this._checkMask),i&&null!=e.popupEffect?e.popupEffect.runWith(e):this.doOpen(e),this.event(Me.OPEN)}},{key:"_clearDialogEffect",value:function(e){e._effectTween&&(Ci.clear(e._effectTween),e._effectTween=null)}},{key:"doOpen",value:function(e){e.onOpened(e._param)}},{key:"lock",value:function(e){this.lockLayer&&(e?this.addChild(this.lockLayer):this.lockLayer.removeSelf())}},{key:"close",value:function(e){this._clearDialogEffect(e),e.isShowEffect&&null!=e.closeEffect?e.closeEffect.runWith([e]):this.doClose(e),this.event(Me.CLOSE)}},{key:"doClose",value:function(e){e.removeSelf(),e.isModal&&this._checkMask(),e.closeHandler&&e.closeHandler.runWith(e.closeType),e.onClosed(e.closeType),e.autoDestroyAtClosed&&e.destroy()}},{key:"closeAll",value:function(){this._closeAll(),this.event(Me.CLOSE)}},{key:"_closeAll",value:function(){for(var e=this.numChildren-1;-1<e;e--){var t=this.getChildAt(e);t&&null!=t.close&&this.doClose(t)}}},{key:"getDialogsByGroup",value:function(e){for(var t=[],i=this.numChildren-1;-1<i;i--){var n=this.getChildAt(i);n&&n.group===e&&t.push(n)}return t}},{key:"closeByGroup",value:function(e){for(var t=[],i=this.numChildren-1;-1<i;i--){var n=this.getChildAt(i);n&&n.group===e&&(n.close(),t.push(n))}return t}},{key:"_checkMask",value:function(){this.maskLayer.removeSelf();for(var e=this.numChildren-1;-1<e;e--){var t=this.getChildAt(e);if(t&&t.isModal)return void this.addChildAt(this.maskLayer,e)}}}]),i}()),oa=(M.regClass("laya.ui.DialogManager",ra),M.regClass("Laya.DialogManager",ra),function(){f(n,a);var t=T(n);function n(){var e;return b(this,n),(e=t.call(this)).isShowEffect=!0,e.isPopupCenter=!0,e.popupEffect=n.manager.popupEffectHandler,e.closeEffect=n.manager.closeEffectHandler,e._dealDragArea(),e.on(Me.CLICK,O(e),e._onClick),e}return y(n,[{key:"_dealDragArea",value:function(){var e=this.getChildByName("drag");e&&(this.dragArea=e._x+","+e._y+","+e.width+","+e.height,e.removeSelf())}},{key:"dragArea",get:function(){return this._dragArea?this._dragArea.toString():null},set:function(e){e?(e=gn.fillArray([0,0,0,0],e,Number),this._dragArea=new ne(e[0],e[1],e[2],e[3]),this.on(Me.MOUSE_DOWN,this,this._onMouseDown)):(this._dragArea=null,this.off(Me.MOUSE_DOWN,this,this._onMouseDown))}},{key:"_onMouseDown",value:function(e){var t=this.getMousePoint();this._dragArea.contains(t.x,t.y)?this.startDrag():this.stopDrag()}},{key:"_onClick",value:function(e){var t=e.target;if(t)switch(t.name){case n.CLOSE:case n.CANCEL:case n.SURE:case n.NO:case n.OK:case n.YES:return void this.close(t.name)}}},{key:"open",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;this._dealDragArea(),this._param=t,n.manager.open(this,e,this.isShowEffect),n.manager.lock(!1)}},{key:"close",value:function(){this.closeType=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,n.manager.close(this)}},{key:"destroy",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this._dragArea=null,m(g(n.prototype),"destroy",this).call(this,e)}},{key:"show",value:function(){this._open(!1,0<arguments.length&&void 0!==arguments[0]&&arguments[0],!(1<arguments.length&&void 0!==arguments[1])||arguments[1])}},{key:"popup",value:function(){this._open(!0,0<arguments.length&&void 0!==arguments[0]&&arguments[0],!(1<arguments.length&&void 0!==arguments[1])||arguments[1])}},{key:"_open",value:function(e,t,i){this.isModal=e,this.isShowEffect=i,n.manager.lock(!0),this.open(t)}},{key:"isPopup",get:function(){return null!=this.parent}},{key:"zOrder",get:function(){return m(g(n.prototype),"zOrder",this)},set:function(e){U(g(n.prototype),"zOrder",e,this,!0),n.manager._checkMask()}}],[{key:"manager",get:function(){return n._manager=n._manager||new ra},set:function(e){n._manager=e}},{key:"setLockView",value:function(e){n.manager.setLockView(e)}},{key:"lock",value:function(e){n.manager.lock(e)}},{key:"closeAll",value:function(){n.manager.closeAll()}},{key:"getDialogsByGroup",value:function(e){return n.manager.getDialogsByGroup(e)}},{key:"closeByGroup",value:function(e){return n.manager.closeByGroup(e)}}]),n}()),t=(oa.CLOSE="close",oa.CANCEL="cancel",oa.SURE="sure",oa.NO="no",oa.YES="yes",oa.OK="ok",sa.Dialog=oa,L.regClass(oa),M.regClass("laya.ui.Dialog",oa),M.regClass("Laya.Dialog",oa),M.regClass),ha=(e=(e=(e=Ki=Ki||{}).fishxy||(e.fishxy={})).animation||(e.animation={}),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Image",props:{y:0,x:0,width:422,skin:"fishxy/animation/prop/prop2/month_box_01.png",height:410,anchorY:.5,anchorX:.5},compId:3}],animations:[{nodes:[{target:3,keyframes:{y:[{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"y",index:0}],x:[{value:0,tweenMethod:"linearNone",tween:!1,target:3,key:"x",index:0}],skin:[{value:"fishxy/animation/prop/prop2/month_box_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:0},{value:"fishxy/animation/prop/prop2/month_box_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:2},{value:"fishxy/animation/prop/prop2/month_box_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:4},{value:"fishxy/animation/prop/prop2/month_box_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:6},{value:"fishxy/animation/prop/prop2/month_box_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:8},{value:"fishxy/animation/prop/prop2/month_box_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:10},{value:"fishxy/animation/prop/prop2/month_box_07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:12},{value:"fishxy/animation/prop/prop2/month_box_08.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:14},{value:"fishxy/animation/prop/prop2/month_box_09.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:16},{value:"fishxy/animation/prop/prop2/month_box_10.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:18},{value:"fishxy/animation/prop/prop2/month_box_11.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:20},{value:"fishxy/animation/prop/prop2/month_box_12.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:22},{value:"fishxy/animation/prop/prop2/month_box_13.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:24},{value:"fishxy/animation/prop/prop2/month_box_14.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:26},{value:"fishxy/animation/prop/prop2/month_box_15.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:28}],pivotY:[{value:205,tweenMethod:"linearNone",tween:!0,target:3,key:"pivotY",index:0}],pivotX:[{value:211,tweenMethod:"linearNone",tween:!0,target:3,key:"pivotX",index:0}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/prop/prop2/month_box_01.png","fishxy/animation/prop/prop2/month_box_02.png","fishxy/animation/prop/prop2/month_box_03.png","fishxy/animation/prop/prop2/month_box_04.png","fishxy/animation/prop/prop2/month_box_05.png","fishxy/animation/prop/prop2/month_box_06.png","fishxy/animation/prop/prop2/month_box_07.png","fishxy/animation/prop/prop2/month_box_08.png","fishxy/animation/prop/prop2/month_box_09.png","fishxy/animation/prop/prop2/month_box_10.png","fishxy/animation/prop/prop2/month_box_11.png","fishxy/animation/prop/prop2/month_box_12.png","fishxy/animation/prop/prop2/month_box_13.png","fishxy/animation/prop/prop2/month_box_14.png","fishxy/animation/prop/prop2/month_box_15.png"],loadList3D:[]},e.award_props_1UI=i,t("ui.fishxy.animation.award_props_1UI",i),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Image",props:{y:0,x:0,width:422,skin:"fishxy/animation/prop/prop1/mirror_01.png",height:410,anchorY:.5,anchorX:.5},compId:3}],animations:[{nodes:[{target:3,keyframes:{skin:[{value:"fishxy/animation/prop/prop1/mirror_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:0},{value:"fishxy/animation/prop/prop1/mirror_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:2},{value:"fishxy/animation/prop/prop1/mirror_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:4},{value:"fishxy/animation/prop/prop1/mirror_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:6},{value:"fishxy/animation/prop/prop1/mirror_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:8},{value:"fishxy/animation/prop/prop1/mirror_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:10},{value:"fishxy/animation/prop/prop1/mirror_07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:12},{value:"fishxy/animation/prop/prop1/mirror_08.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:14},{value:"fishxy/animation/prop/prop1/mirror_09.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:16},{value:"fishxy/animation/prop/prop1/mirror_10.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:18},{value:"fishxy/animation/prop/prop1/mirror_11.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:20},{value:"fishxy/animation/prop/prop1/mirror_12.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:22},{value:"fishxy/animation/prop/prop1/mirror_13.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:24},{value:"fishxy/animation/prop/prop1/mirror_14.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:26},{value:"fishxy/animation/prop/prop1/mirror_15.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:28}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/prop/prop1/mirror_01.png","fishxy/animation/prop/prop1/mirror_02.png","fishxy/animation/prop/prop1/mirror_03.png","fishxy/animation/prop/prop1/mirror_04.png","fishxy/animation/prop/prop1/mirror_05.png","fishxy/animation/prop/prop1/mirror_06.png","fishxy/animation/prop/prop1/mirror_07.png","fishxy/animation/prop/prop1/mirror_08.png","fishxy/animation/prop/prop1/mirror_09.png","fishxy/animation/prop/prop1/mirror_10.png","fishxy/animation/prop/prop1/mirror_11.png","fishxy/animation/prop/prop1/mirror_12.png","fishxy/animation/prop/prop1/mirror_13.png","fishxy/animation/prop/prop1/mirror_14.png","fishxy/animation/prop/prop1/mirror_15.png"],loadList3D:[]},e.award_props_2UI=i,t("ui.fishxy.animation.award_props_2UI",i),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Image",props:{y:0,x:0,width:422,skin:"fishxy/animation/prop/prop3/fan_01.png",height:410,anchorY:.5,anchorX:.5},compId:3}],animations:[{nodes:[{target:3,keyframes:{y:[{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"y",index:0}],x:[{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"x",index:0}],skin:[{value:"fishxy/animation/prop/prop3/fan_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:0},{value:"fishxy/animation/prop/prop3/fan_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:2},{value:"fishxy/animation/prop/prop3/fan_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:4},{value:"fishxy/animation/prop/prop3/fan_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:6},{value:"fishxy/animation/prop/prop3/fan_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:8},{value:"fishxy/animation/prop/prop3/fan_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:10},{value:"fishxy/animation/prop/prop3/fan_07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:12},{value:"fishxy/animation/prop/prop3/fan_08.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:14},{value:"fishxy/animation/prop/prop3/fan_09.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:16},{value:"fishxy/animation/prop/prop3/fan_10.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:18},{value:"fishxy/animation/prop/prop3/fan_11.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:20},{value:"fishxy/animation/prop/prop3/fan_12.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:22},{value:"fishxy/animation/prop/prop3/fan_13.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:24},{value:"fishxy/animation/prop/prop3/fan_14.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:26},{value:"fishxy/animation/prop/prop3/fan_15.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:28}],pivotY:[{value:205,tweenMethod:"linearNone",tween:!0,target:3,key:"pivotY",index:0}],pivotX:[{value:211,tweenMethod:"linearNone",tween:!0,target:3,key:"pivotX",index:0}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/prop/prop3/fan_01.png","fishxy/animation/prop/prop3/fan_02.png","fishxy/animation/prop/prop3/fan_03.png","fishxy/animation/prop/prop3/fan_04.png","fishxy/animation/prop/prop3/fan_05.png","fishxy/animation/prop/prop3/fan_06.png","fishxy/animation/prop/prop3/fan_07.png","fishxy/animation/prop/prop3/fan_08.png","fishxy/animation/prop/prop3/fan_09.png","fishxy/animation/prop/prop3/fan_10.png","fishxy/animation/prop/prop3/fan_11.png","fishxy/animation/prop/prop3/fan_12.png","fishxy/animation/prop/prop3/fan_13.png","fishxy/animation/prop/prop3/fan_14.png","fishxy/animation/prop/prop3/fan_15.png"],loadList3D:[]},e.award_props_3UI=i,t("ui.fishxy.animation.award_props_3UI",i),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,zn,a,h,vn,Sn,N],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Image",props:{y:0,x:0,width:398,skin:"fishxy/animation/common/img_Ray.png",rotation:180,height:398,anchorY:.5,anchorX:.5},compId:3},{type:"Image",props:{y:-103,x:-96,width:190,skin:"fishxy/animation/common/img_vitemBg.png",height:214},compId:8},{type:"List",props:{y:-106,x:-62,width:117,var:"list",spaceY:5,selectEnable:!1,repeatY:5,height:213},compId:34,child:[{type:"Box",props:{y:0,x:0,width:128,name:"render",height:38},compId:35,child:[{type:"Label",props:{width:241,text:"x 50",scaleY:.5,scaleX:.5,name:"score",height:52,font:"bmfont_bigCoin",align:"left"},compId:14}]}]},{type:"Sprite",props:{y:23,x:-2,width:1,texture:"fishxy/animation/common/Bg_Line.png",scaleY:3,scaleX:2,rotation:90,pivotY:33,pivotX:1,height:65},compId:28},{type:"Sprite",props:{y:65,x:93,width:1,texture:"fishxy/animation/common/Bg_Line.png",scaleY:3,scaleX:2,rotation:90,pivotX:1,height:65},compId:29},{type:"Sprite",props:{y:-21,x:99,width:1,texture:"fishxy/animation/common/Bg_Line.png",scaleY:3,scaleX:2,rotation:90,pivotX:2,height:65},compId:27},{type:"Sprite",props:{y:-65,x:94,width:1,texture:"fishxy/animation/common/Bg_Line.png",scaleY:3,scaleX:2,rotation:90,pivotX:1,height:65},compId:30},{type:"Image",props:{y:-172,x:-158,skin:"fishxy/animation/common/img_vdragonUp.png"},compId:4},{type:"Image",props:{y:-50,x:-120,skin:"fishxy/animation/common/img_lightDbulb-04.png",name:"lizi"},compId:15,child:[{type:"Image",props:{y:79,x:0,skin:"fishxy/animation/common/img_lightDbulb-01.png",name:"lizi"},compId:16},{type:"Image",props:{y:159,x:0,skin:"fishxy/animation/common/img_lightDbulb-02.png",name:"lizi"},compId:17},{type:"Image",props:{y:159,x:79,skin:"fishxy/animation/common/img_lightDbulb-03.png",name:"lizi"},compId:18},{type:"Image",props:{y:159,x:146,skin:"fishxy/animation/common/img_lightDbulb-04.png",name:"lizi"},compId:19},{type:"Image",props:{y:158,x:215,skin:"fishxy/animation/common/img_lightDbulb-01.png",name:"lizi"},compId:20},{type:"Image",props:{y:79,x:215,skin:"fishxy/animation/common/img_lightDbulb-02.png",name:"lizi"},compId:21},{type:"Image",props:{y:0,x:215,skin:"fishxy/animation/common/img_lightDbulb-03.png",name:"lizi"},compId:22},{type:"Image",props:{y:-76,x:215,skin:"fishxy/animation/common/img_lightDbulb-04.png",name:"lizi"},compId:23},{type:"Image",props:{y:-76,x:146,skin:"fishxy/animation/common/img_lightDbulb-01.png",name:"lizi"},compId:25},{type:"Image",props:{y:-76,x:79,skin:"fishxy/animation/common/img_lightDbulb-02.png",name:"lizi"},compId:26},{type:"Image",props:{y:-76,x:0,skin:"fishxy/animation/common/img_lightDbulb-03.png",name:"lizi"},compId:24}]},{type:"Sprite",props:{y:-155,x:-132,texture:"fishxy/animation/common/Ribbon.png"},compId:6,child:[{type:"Sprite",props:{y:0,x:268,texture:"fishxy/animation/common/Ribbon.png",scaleX:-1},compId:7}]},{type:"Image",props:{y:-54,x:-120,width:243,skin:"fishxy/animation/common/img_vdragonUp_.png",height:104,sizeGrid:"34,35,36,36"},compId:9},{type:"Sprite",props:{y:-149,x:-71.5,texture:"fishxy/animation/common/fish_name_28_Cn.png"},compId:32}],animations:[{nodes:[{target:15,keyframes:{x:[{value:-120,tweenMethod:"linearNone",tween:!0,target:15,key:"x",index:0},{value:-120,tweenMethod:"linearNone",tween:!0,target:15,key:"x",index:15}],skin:[{value:"fishxy/animation/common/img_lightDbulb-01.png",tweenMethod:"linearNone",tween:!1,target:15,key:"skin",index:0},{value:"fishxy/animation/common/img_lightDbulb-02.png",tweenMethod:"linearNone",tween:!1,target:15,key:"skin",index:4},{value:"fishxy/animation/common/img_lightDbulb-03.png",tweenMethod:"linearNone",tween:!1,target:15,key:"skin",index:8},{value:"fishxy/animation/common/img_lightDbulb-04.png",tweenMethod:"linearNone",tween:!1,target:15,key:"skin",index:12}]}},{target:16,keyframes:{skin:[{value:"fishxy/animation/common/img_lightDbulb-02.png",tweenMethod:"linearNone",tween:!1,target:16,key:"skin",index:0},{value:"fishxy/animation/common/img_lightDbulb-03.png",tweenMethod:"linearNone",tween:!1,target:16,key:"skin",index:4},{value:"fishxy/animation/common/img_lightDbulb-04.png",tweenMethod:"linearNone",tween:!1,target:16,key:"skin",index:8},{value:"fishxy/animation/common/img_lightDbulb-01.png",tweenMethod:"linearNone",tween:!1,target:16,key:"skin",index:12}]}},{target:17,keyframes:{skin:[{value:"fishxy/animation/common/img_lightDbulb-03.png",tweenMethod:"linearNone",tween:!1,target:17,key:"skin",index:0},{value:"fishxy/animation/common/img_lightDbulb-04.png",tweenMethod:"linearNone",tween:!1,target:17,key:"skin",index:4},{value:"fishxy/animation/common/img_lightDbulb-01.png",tweenMethod:"linearNone",tween:!1,target:17,key:"skin",index:8},{value:"fishxy/animation/common/img_lightDbulb-02.png",tweenMethod:"linearNone",tween:!1,target:17,key:"skin",index:12}]}},{target:18,keyframes:{skin:[{value:"fishxy/animation/common/img_lightDbulb-04.png",tweenMethod:"linearNone",tween:!1,target:18,key:"skin",index:0},{value:"fishxy/animation/common/img_lightDbulb-01.png",tweenMethod:"linearNone",tween:!1,target:18,key:"skin",index:4},{value:"fishxy/animation/common/img_lightDbulb-02.png",tweenMethod:"linearNone",tween:!1,target:18,key:"skin",index:8},{value:"fishxy/animation/common/img_lightDbulb-03.png",tweenMethod:"linearNone",tween:!1,target:18,key:"skin",index:12}]}},{target:19,keyframes:{x:[{value:146,tweenMethod:"linearNone",tween:!0,target:19,key:"x",index:0}],skin:[{value:"fishxy/animation/common/img_lightDbulb-01.png",tweenMethod:"linearNone",tween:!1,target:19,key:"skin",index:0},{value:"fishxy/animation/common/img_lightDbulb-02.png",tweenMethod:"linearNone",tween:!1,target:19,label:null,key:"skin",index:4},{value:"fishxy/animation/common/img_lightDbulb-03.png",tweenMethod:"linearNone",tween:!1,target:19,label:null,key:"skin",index:8},{value:"fishxy/animation/common/img_lightDbulb-04.png",tweenMethod:"linearNone",tween:!1,target:19,label:null,key:"skin",index:12}]}},{target:20,keyframes:{skin:[{value:"fishxy/animation/common/img_lightDbulb-02.png",tweenMethod:"linearNone",tween:!1,target:20,key:"skin",index:0},{value:"fishxy/animation/common/img_lightDbulb-03.png",tweenMethod:"linearNone",tween:!1,target:20,label:null,key:"skin",index:4},{value:"fishxy/animation/common/img_lightDbulb-04.png",tweenMethod:"linearNone",tween:!1,target:20,label:null,key:"skin",index:8},{value:"fishxy/animation/common/img_lightDbulb-01.png",tweenMethod:"linearNone",tween:!1,target:20,label:null,key:"skin",index:12}]}},{target:21,keyframes:{skin:[{value:"fishxy/animation/common/img_lightDbulb-03.png",tweenMethod:"linearNone",tween:!1,target:21,key:"skin",index:0},{value:"fishxy/animation/common/img_lightDbulb-04.png",tweenMethod:"linearNone",tween:!1,target:21,label:null,key:"skin",index:4},{value:"fishxy/animation/common/img_lightDbulb-01.png",tweenMethod:"linearNone",tween:!1,target:21,label:null,key:"skin",index:8},{value:"fishxy/animation/common/img_lightDbulb-02.png",tweenMethod:"linearNone",tween:!1,target:21,label:null,key:"skin",index:12}]}},{target:22,keyframes:{skin:[{value:"fishxy/animation/common/img_lightDbulb-04.png",tweenMethod:"linearNone",tween:!1,target:22,key:"skin",index:0},{value:"fishxy/animation/common/img_lightDbulb-01.png",tweenMethod:"linearNone",tween:!1,target:22,label:null,key:"skin",index:4},{value:"fishxy/animation/common/img_lightDbulb-02.png",tweenMethod:"linearNone",tween:!1,target:22,label:null,key:"skin",index:8},{value:"fishxy/animation/common/img_lightDbulb-03.png",tweenMethod:"linearNone",tween:!1,target:22,label:null,key:"skin",index:12}]}},{target:23,keyframes:{skin:[{value:"fishxy/animation/common/img_lightDbulb-01.png",tweenMethod:"linearNone",tween:!1,target:23,key:"skin",index:0},{value:"fishxy/animation/common/img_lightDbulb-02.png",tweenMethod:"linearNone",tween:!1,target:23,label:null,key:"skin",index:4},{value:"fishxy/animation/common/img_lightDbulb-03.png",tweenMethod:"linearNone",tween:!1,target:23,label:null,key:"skin",index:8},{value:"fishxy/animation/common/img_lightDbulb-04.png",tweenMethod:"linearNone",tween:!1,target:23,label:null,key:"skin",index:12}]}},{target:25,keyframes:{skin:[{value:"fishxy/animation/common/img_lightDbulb-02.png",tweenMethod:"linearNone",tween:!1,target:25,key:"skin",index:0},{value:"fishxy/animation/common/img_lightDbulb-03.png",tweenMethod:"linearNone",tween:!1,target:25,label:null,key:"skin",index:4},{value:"fishxy/animation/common/img_lightDbulb-04.png",tweenMethod:"linearNone",tween:!1,target:25,label:null,key:"skin",index:8},{value:"fishxy/animation/common/img_lightDbulb-01.png",tweenMethod:"linearNone",tween:!1,target:25,label:null,key:"skin",index:12}]}},{target:26,keyframes:{skin:[{value:"fishxy/animation/common/img_lightDbulb-03.png",tweenMethod:"linearNone",tween:!1,target:26,key:"skin",index:0},{value:"fishxy/animation/common/img_lightDbulb-04.png",tweenMethod:"linearNone",tween:!1,target:26,label:null,key:"skin",index:4},{value:"fishxy/animation/common/img_lightDbulb-01.png",tweenMethod:"linearNone",tween:!1,target:26,label:null,key:"skin",index:8},{value:"fishxy/animation/common/img_lightDbulb-02.png",tweenMethod:"linearNone",tween:!1,target:26,label:null,key:"skin",index:12}]}},{target:24,keyframes:{skin:[{value:"fishxy/animation/common/img_lightDbulb-04.png",tweenMethod:"linearNone",tween:!1,target:24,key:"skin",index:0},{value:"fishxy/animation/common/img_lightDbulb-01.png",tweenMethod:"linearNone",tween:!1,target:24,label:null,key:"skin",index:4},{value:"fishxy/animation/common/img_lightDbulb-02.png",tweenMethod:"linearNone",tween:!1,target:24,label:null,key:"skin",index:8},{value:"fishxy/animation/common/img_lightDbulb-03.png",tweenMethod:"linearNone",tween:!1,target:24,label:null,key:"skin",index:12}]}},{target:3,keyframes:{rotation:[{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"rotation",index:0},{value:180,tweenMethod:"linearNone",tween:!0,target:3,key:"rotation",index:15}]}}],name:"ani1",id:1,frameRate:24,action:2}],loadList:["fishxy/animation/common/img_Ray.png","fishxy/animation/common/img_vitemBg.png","fishxy/animation/common/Bg_Line.png","fishxy/animation/common/img_vdragonUp.png","fishxy/animation/common/img_lightDbulb-04.png","fishxy/animation/common/img_lightDbulb-01.png","fishxy/animation/common/img_lightDbulb-02.png","fishxy/animation/common/img_lightDbulb-03.png","fishxy/animation/common/Ribbon.png","fishxy/animation/common/img_vdragonUp_.png","fishxy/animation/common/fish_name_28_Cn.png"],loadList3D:[]},e.blue_shake_lotteryUI=i,t("ui.fishxy.animation.blue_shake_lotteryUI",i),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-230,x:-200,texture:"fishxy/animation/waterBomb/explosion_01.png"},compId:3}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/waterBomb/explosion_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/waterBomb/explosion_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:1},{value:"fishxy/animation/waterBomb/explosion_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/waterBomb/explosion_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:3},{value:"fishxy/animation/waterBomb/explosion_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/waterBomb/explosion_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:5},{value:"fishxy/animation/waterBomb/explosion_07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/waterBomb/explosion_08.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:7},{value:"fishxy/animation/waterBomb/explosion_09.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/waterBomb/explosion_10.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:9},{value:"fishxy/animation/waterBomb/explosion_11.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10},{value:"fishxy/animation/waterBomb/explosion_12.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:11},{value:"fishxy/animation/waterBomb/explosion_13.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:12},{value:"fishxy/animation/waterBomb/explosion_14.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:13},{value:"fishxy/animation/waterBomb/explosion_15.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:14},{value:"fishxy/animation/waterBomb/explosion_16.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:15},{value:"fishxy/animation/waterBomb/explosion_17.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:16},{value:"fishxy/animation/waterBomb/explosion_18.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:17},{value:"fishxy/animation/waterBomb/explosion_19.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:18},{value:"fishxy/animation/waterBomb/explosion_20.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:19},{value:"fishxy/animation/waterBomb/explosion_21.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:20},{value:"fishxy/animation/waterBomb/explosion_22.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:21},{value:"fishxy/animation/waterBomb/explosion_23.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:22},{value:"fishxy/animation/waterBomb/explosion_23.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:24}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:3,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:3,key:"alpha",index:22},{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"alpha",index:24}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/waterBomb/explosion_01.png","fishxy/animation/waterBomb/explosion_02.png","fishxy/animation/waterBomb/explosion_03.png","fishxy/animation/waterBomb/explosion_04.png","fishxy/animation/waterBomb/explosion_05.png","fishxy/animation/waterBomb/explosion_06.png","fishxy/animation/waterBomb/explosion_07.png","fishxy/animation/waterBomb/explosion_08.png","fishxy/animation/waterBomb/explosion_09.png","fishxy/animation/waterBomb/explosion_10.png","fishxy/animation/waterBomb/explosion_11.png","fishxy/animation/waterBomb/explosion_12.png","fishxy/animation/waterBomb/explosion_13.png","fishxy/animation/waterBomb/explosion_14.png","fishxy/animation/waterBomb/explosion_15.png","fishxy/animation/waterBomb/explosion_16.png","fishxy/animation/waterBomb/explosion_17.png","fishxy/animation/waterBomb/explosion_18.png","fishxy/animation/waterBomb/explosion_19.png","fishxy/animation/waterBomb/explosion_20.png","fishxy/animation/waterBomb/explosion_21.png","fishxy/animation/waterBomb/explosion_22.png","fishxy/animation/waterBomb/explosion_23.png"],loadList3D:[]},e.boom_die_effUI=i,t("ui.fishxy.animation.boom_die_effUI",i),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,h,vn,a,N],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{width:1280,height:720},compId:2,child:[{type:"Image",props:{var:"bg",top:0,skin:"fishxy/animation/fish/fish/fish34/BOSSui/bg.png",right:0,left:0,bottom:0},compId:11},{type:"Box",props:{x:1282,width:4878,var:"item",height:267,centerY:0,anchorY:.5},compId:17,child:[{type:"Image",props:{skin:"fishxy/animation/fish/fish/fish34/BOSSui/4.png"},compId:16},{type:"Image",props:{y:0,x:203,skin:"fishxy/animation/fish/fish/fish34/BOSSui/4.png"},compId:18},{type:"Image",props:{x:406,skin:"fishxy/animation/fish/fish/fish34/BOSSui/4.png"},compId:19},{type:"Image",props:{x:610,skin:"fishxy/animation/fish/fish/fish34/BOSSui/4.png"},compId:20},{type:"Image",props:{y:0,x:813,skin:"fishxy/animation/fish/fish/fish34/BOSSui/4.png"},compId:21},{type:"Image",props:{y:0,x:1015,skin:"fishxy/animation/fish/fish/fish34/BOSSui/4.png"},compId:22},{type:"Image",props:{x:1219,skin:"fishxy/animation/fish/fish/fish34/BOSSui/4.png"},compId:23},{type:"Image",props:{x:1424,skin:"fishxy/animation/fish/fish/fish34/BOSSui/4.png"},compId:24},{type:"Image",props:{x:1627,skin:"fishxy/animation/fish/fish/fish34/BOSSui/4.png"},compId:25},{type:"Image",props:{x:1831,skin:"fishxy/animation/fish/fish/fish34/BOSSui/4.png"},compId:26},{type:"Image",props:{x:2034,skin:"fishxy/animation/fish/fish/fish34/BOSSui/4.png"},compId:27},{type:"Image",props:{y:0,x:2237,skin:"fishxy/animation/fish/fish/fish34/BOSSui/4.png"},compId:28},{type:"Image",props:{y:0,x:2433,skin:"fishxy/animation/fish/fish/fish34/BOSSui/4.png"},compId:29},{type:"Image",props:{y:0,x:2637,skin:"fishxy/animation/fish/fish/fish34/BOSSui/4.png"},compId:30},{type:"Image",props:{y:0,x:2840,skin:"fishxy/animation/fish/fish/fish34/BOSSui/4.png"},compId:31},{type:"Image",props:{y:0,x:3044,skin:"fishxy/animation/fish/fish/fish34/BOSSui/4.png"},compId:32},{type:"Image",props:{y:0,x:3247,skin:"fishxy/animation/fish/fish/fish34/BOSSui/4.png"},compId:33},{type:"Image",props:{y:0,x:3449,skin:"fishxy/animation/fish/fish/fish34/BOSSui/4.png"},compId:34},{type:"Image",props:{y:0,x:3653,skin:"fishxy/animation/fish/fish/fish34/BOSSui/4.png"},compId:35},{type:"Image",props:{y:0,x:3858,skin:"fishxy/animation/fish/fish/fish34/BOSSui/4.png"},compId:36},{type:"Image",props:{y:0,x:4061,skin:"fishxy/animation/fish/fish/fish34/BOSSui/4.png"},compId:37},{type:"Image",props:{y:0,x:4265,skin:"fishxy/animation/fish/fish/fish34/BOSSui/4.png"},compId:38},{type:"Image",props:{y:0,x:4468,skin:"fishxy/animation/fish/fish/fish34/BOSSui/4.png"},compId:39},{type:"Image",props:{y:0,x:4671,skin:"fishxy/animation/fish/fish/fish34/BOSSui/4.png"},compId:40}]},{type:"Box",props:{x:1289,width:4416,var:"tips1",height:21,centerY:89,anchorY:.5},compId:44,child:[{type:"Sprite",props:{texture:"fishxy/animation/fish/fish/fish34/BOSSui/1.png"},compId:43},{type:"Sprite",props:{y:0,x:737,texture:"fishxy/animation/fish/fish/fish34/BOSSui/1.png"},compId:45},{type:"Sprite",props:{y:0,x:1485,texture:"fishxy/animation/fish/fish/fish34/BOSSui/1.png"},compId:46},{type:"Sprite",props:{y:0,x:2227,texture:"fishxy/animation/fish/fish/fish34/BOSSui/1.png"},compId:47},{type:"Sprite",props:{y:1,x:2964,texture:"fishxy/animation/fish/fish/fish34/BOSSui/1.png"},compId:48},{type:"Sprite",props:{y:1,x:3712,texture:"fishxy/animation/fish/fish/fish34/BOSSui/1.png"},compId:49}]},{type:"Box",props:{x:0,width:4416,var:"tips2",height:21,centerY:-89,anchorY:.5,anchorX:1},compId:50,child:[{type:"Sprite",props:{texture:"fishxy/animation/fish/fish/fish34/BOSSui/1.png"},compId:51},{type:"Sprite",props:{y:0,x:737,texture:"fishxy/animation/fish/fish/fish34/BOSSui/1.png"},compId:52},{type:"Sprite",props:{y:0,x:1485,texture:"fishxy/animation/fish/fish/fish34/BOSSui/1.png"},compId:53},{type:"Sprite",props:{y:0,x:2227,texture:"fishxy/animation/fish/fish/fish34/BOSSui/1.png"},compId:54},{type:"Sprite",props:{y:1,x:2964,texture:"fishxy/animation/fish/fish/fish34/BOSSui/1.png"},compId:55},{type:"Sprite",props:{y:1,x:3712,texture:"fishxy/animation/fish/fish/fish34/BOSSui/1.png"},compId:56}]},{type:"Image",props:{y:360,x:640,skin:"fishxy/animation/fish/fish/fish34/BOSSui/3.png",centerY:0,centerX:0,anchorY:.5,anchorX:.5},compId:14},{type:"Image",props:{y:360,x:640,skin:"fishxy/animation/fish/fish/fish34/BOSSui/3.png",centerY:0,centerX:0,anchorY:.5,anchorX:.5},compId:15}],animations:[{nodes:[{target:11,keyframes:{alpha:[{value:.5,tweenMethod:"linearNone",tween:!0,target:11,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:11,key:"alpha",index:5},{value:.5,tweenMethod:"linearNone",tween:!0,target:11,key:"alpha",index:10}]}}],name:"ani1",id:1,frameRate:24,action:2},{nodes:[{target:14,keyframes:{scaleY:[{value:1.6,tweenMethod:"linearNone",tween:!0,target:14,key:"scaleY",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:14,key:"scaleY",index:10}],scaleX:[{value:1.6,tweenMethod:"linearNone",tween:!0,target:14,key:"scaleX",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:14,key:"scaleX",index:10}]}}],name:"ani2",id:2,frameRate:24,action:0},{nodes:[{target:15,keyframes:{scaleY:[{value:1,tweenMethod:"linearNone",tween:!0,target:15,key:"scaleY",index:0},{value:1.6,tweenMethod:"linearNone",tween:!0,target:15,key:"scaleY",index:10}],scaleX:[{value:1,tweenMethod:"linearNone",tween:!0,target:15,key:"scaleX",index:0},{value:1.6,tweenMethod:"linearNone",tween:!0,target:15,key:"scaleX",index:10}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:15,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:15,key:"alpha",index:10}]}}],name:"ani3",id:3,frameRate:24,action:0}],loadList:["fishxy/animation/fish/fish/fish34/BOSSui/bg.png","fishxy/animation/fish/fish/fish34/BOSSui/4.png","fishxy/animation/fish/fish/fish34/BOSSui/1.png","fishxy/animation/fish/fish/fish34/BOSSui/3.png"],loadList3D:[]},e.boss_comingUI=i,t("ui.fishxy.animation.boss_comingUI",i),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:0,x:0,width:107,texture:"fishxy/animation/common/ms_dice_frame_0001.png",pivotY:54,pivotX:54,height:107},compId:3}],animations:[{nodes:[{target:3,keyframes:{x:[{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"x",index:0}],texture:[{value:"fishxy/animation/common/ms_dice_frame_0001.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/common/ms_dice_frame_0002.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/common/ms_dice_frame_0003.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/common/ms_dice_frame_0004.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6}]}}],name:"roll",id:1,frameRate:24,action:2},{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/common/ms_dice_1.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0}]}}],name:"1",id:2,frameRate:24,action:0},{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/common/ms_dice_2.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0}]}}],name:"2",id:3,frameRate:24,action:0},{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/common/ms_dice_3.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0}]}}],name:"3",id:4,frameRate:24,action:0},{nodes:[{target:3,keyframes:{x:[{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"x",index:0}],texture:[{value:"fishxy/animation/common/ms_dice_4.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0}]}}],name:"4",id:5,frameRate:24,action:0},{nodes:[{target:3,keyframes:{x:[{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"x",index:0}],texture:[{value:"fishxy/animation/common/ms_dice_5.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0}]}}],name:"5",id:6,frameRate:24,action:0},{nodes:[{target:3,keyframes:{x:[{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"x",index:0}],texture:[{value:"fishxy/animation/common/ms_dice_6.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0}]}}],name:"6",id:7,frameRate:24,action:0}],loadList:["fishxy/animation/common/ms_dice_frame_0001.png","fishxy/animation/common/ms_dice_frame_0002.png","fishxy/animation/common/ms_dice_frame_0003.png","fishxy/animation/common/ms_dice_frame_0004.png","fishxy/animation/common/ms_dice_1.png","fishxy/animation/common/ms_dice_2.png","fishxy/animation/common/ms_dice_3.png","fishxy/animation/common/ms_dice_4.png","fishxy/animation/common/ms_dice_5.png","fishxy/animation/common/ms_dice_6.png"],loadList3D:[]},e.diceUI=i,t("ui.fishxy.animation.diceUI",i),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,h,Sn,a,N],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:0,x:0,width:358,texture:"fishxy/animation/common/Ray.png",pivotY:179,pivotX:179,height:358},compId:7},{type:"Sprite",props:{y:0,x:0,width:194,texture:"fishxy/animation/common/Circle-out.png",pivotY:97,pivotX:97,height:194},compId:4},{type:"Sprite",props:{y:0,x:0,width:174,texture:"fishxy/animation/common/Circle-inside.png",pivotY:87,pivotX:87,height:174},compId:3},{type:"Sprite",props:{y:0,x:0,width:210,texture:"fishxy/animation/common/light bulb.png",pivotY:105,pivotX:105,height:210},compId:6},{type:"Sprite",props:{y:38,x:-137,texture:"fishxy/animation/common/Ribbon.png"},compId:8,child:[{type:"Sprite",props:{y:0,x:272,texture:"fishxy/animation/common/Ribbon.png",scaleX:-1},compId:9}]},{type:"Image",props:{y:68,x:0,var:"fish_name",skin:"fishxy/animation/common/fish_name_15_Cn.png",anchorY:.5,anchorX:.5},compId:10},{type:"Label",props:{y:-2,x:-1,width:142,var:"rate",text:"X90",scaleY:.6,scaleX:.6,pivotY:63,pivotX:71,height:32,font:"bmfont_bigWin",align:"center"},compId:12}],animations:[{nodes:[{target:7,keyframes:{y:[{value:2,tweenMethod:"linearNone",tween:!0,target:7,key:"y",index:0}],x:[{value:0,tweenMethod:"linearNone",tween:!0,target:7,key:"x",index:0}],rotation:[{value:0,tweenMethod:"linearNone",tween:!0,target:7,key:"rotation",index:0},{value:360,tweenMethod:"linearNone",tween:!0,target:7,key:"rotation",index:48}]}},{target:4,keyframes:{x:[{value:0,tweenMethod:"linearNone",tween:!0,target:4,key:"x",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"x",index:48}],rotation:[{value:0,tweenMethod:"linearNone",tween:!0,target:4,key:"rotation",index:0},{value:360,tweenMethod:"linearNone",tween:!0,target:4,key:"rotation",index:24},{value:0,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"rotation",index:48}]}},{target:3,keyframes:{x:[{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"x",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"x",index:48}],rotation:[{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"rotation",index:0},{value:360,tweenMethod:"linearNone",tween:!0,target:3,key:"rotation",index:24},{value:720,tweenMethod:"linearNone",tween:!0,target:3,key:"rotation",index:48}]}},{target:6,keyframes:{x:[{value:0,tweenMethod:"linearNone",tween:!0,target:6,key:"x",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:6,label:null,key:"x",index:48}],rotation:[{value:0,tweenMethod:"linearNone",tween:!0,target:6,key:"rotation",index:0},{value:360,tweenMethod:"linearNone",tween:!0,target:6,key:"rotation",index:24},{value:720,tweenMethod:"linearNone",tween:!0,target:6,key:"rotation",index:48}]}},{target:12,keyframes:{x:[{value:5,tweenMethod:"linearNone",tween:!0,target:12,key:"x",index:0},{value:5,tweenMethod:"linearNone",tween:!0,target:12,label:null,key:"x",index:48}],rotation:[{value:0,tweenMethod:"linearNone",tween:!0,target:12,key:"rotation",index:0},{value:15,tweenMethod:"linearNone",tween:!0,target:12,key:"rotation",index:4},{value:-15,tweenMethod:"linearNone",tween:!0,target:12,key:"rotation",index:12},{value:15,tweenMethod:"linearNone",tween:!0,target:12,label:null,key:"rotation",index:20},{value:-15,tweenMethod:"linearNone",tween:!0,target:12,label:null,key:"rotation",index:28},{value:15,tweenMethod:"linearNone",tween:!0,target:12,label:null,key:"rotation",index:36},{value:-15,tweenMethod:"linearNone",tween:!0,target:12,label:null,key:"rotation",index:44},{value:0,tweenMethod:"linearNone",tween:!0,target:12,label:null,key:"rotation",index:48}]}},{target:2,keyframes:{scaleY:[{value:.5,tweenMethod:"linearNone",tween:!0,target:2,key:"scaleY",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:2,key:"scaleY",index:3}],scaleX:[{value:.5,tweenMethod:"linearNone",tween:!0,target:2,key:"scaleX",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:2,key:"scaleX",index:3}]}}],name:"ani1",id:2,frameRate:24,action:0}],loadList:["fishxy/animation/common/Ray.png","fishxy/animation/common/Circle-out.png","fishxy/animation/common/Circle-inside.png","fishxy/animation/common/light bulb.png","fishxy/animation/common/Ribbon.png","fishxy/animation/common/fish_name_15_Cn.png"],loadList3D:[]},e.dldby_fish_die_uiUI=i,t("ui.fishxy.animation.dldby_fish_die_uiUI",i),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:0,x:0,width:496,texture:"fishxy/animation/boom_line_effect/BallExplosion_00.png",pivotY:229,pivotX:248,height:458},compId:3}],animations:[{nodes:[{target:3,keyframes:{x:[{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"x",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:3,label:null,key:"x",index:20},{value:0,tweenMethod:"linearNone",tween:!0,target:3,label:null,key:"x",index:38}],texture:[{value:"fishxy/animation/boom_line_effect/BallExplosion_00.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/boom_line_effect/BallExplosion_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/boom_line_effect/BallExplosion_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/boom_line_effect/BallExplosion_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/boom_line_effect/BallExplosion_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/boom_line_effect/BallExplosion_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10},{value:"fishxy/animation/boom_line_effect/BallExplosion_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:12},{value:"fishxy/animation/boom_line_effect/BallExplosion_07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:14},{value:"fishxy/animation/boom_line_effect/BallExplosion_08.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:16},{value:"fishxy/animation/boom_line_effect/BallExplosion_09.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:18},{value:"fishxy/animation/boom_line_effect/LightningBallLoop_00.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:20},{value:"fishxy/animation/boom_line_effect/LightningBallLoop_01.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:22},{value:"fishxy/animation/boom_line_effect/LightningBallLoop_02.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:24},{value:"fishxy/animation/boom_line_effect/LightningBallLoop_03.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:26},{value:"fishxy/animation/boom_line_effect/LightningBallLoop_04.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:28},{value:"fishxy/animation/boom_line_effect/LightningBallLoop_05.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:30},{value:"fishxy/animation/boom_line_effect/LightningBallLoop_06.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:32},{value:"fishxy/animation/boom_line_effect/LightningBallLoop_07.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:34},{value:"fishxy/animation/boom_line_effect/LightningBallLoop_08.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:36},{value:"fishxy/animation/boom_line_effect/LightningBallLoop_00.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:38},{value:"fishxy/animation/boom_line_effect/LightningBallLoop_01.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:40},{value:"fishxy/animation/boom_line_effect/LightningBallLoop_02.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:42},{value:"fishxy/animation/boom_line_effect/LightningBallLoop_03.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:44},{value:"fishxy/animation/boom_line_effect/LightningBallLoop_04.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:46},{value:"fishxy/animation/boom_line_effect/LightningBallLoop_05.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:48},{value:"fishxy/animation/boom_line_effect/LightningBallLoop_06.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:50},{value:"fishxy/animation/boom_line_effect/LightningBallLoop_07.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:52},{value:"fishxy/animation/boom_line_effect/LightningBallLoop_08.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:54}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/boom_line_effect/BallExplosion_00.png","fishxy/animation/boom_line_effect/BallExplosion_01.png","fishxy/animation/boom_line_effect/BallExplosion_02.png","fishxy/animation/boom_line_effect/BallExplosion_03.png","fishxy/animation/boom_line_effect/BallExplosion_04.png","fishxy/animation/boom_line_effect/BallExplosion_05.png","fishxy/animation/boom_line_effect/BallExplosion_06.png","fishxy/animation/boom_line_effect/BallExplosion_07.png","fishxy/animation/boom_line_effect/BallExplosion_08.png","fishxy/animation/boom_line_effect/BallExplosion_09.png","fishxy/animation/boom_line_effect/LightningBallLoop_00.png","fishxy/animation/boom_line_effect/LightningBallLoop_01.png","fishxy/animation/boom_line_effect/LightningBallLoop_02.png","fishxy/animation/boom_line_effect/LightningBallLoop_03.png","fishxy/animation/boom_line_effect/LightningBallLoop_04.png","fishxy/animation/boom_line_effect/LightningBallLoop_05.png","fishxy/animation/boom_line_effect/LightningBallLoop_06.png","fishxy/animation/boom_line_effect/LightningBallLoop_07.png","fishxy/animation/boom_line_effect/LightningBallLoop_08.png"],loadList3D:[]},e.dldby_flash_eff1UI=i,t("ui.fishxy.animation.dldby_flash_eff1UI",i),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-90,x:-90,texture:"fishxy/animation/boom_line_effect/fish_Suffer_00.png"},compId:3}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/boom_line_effect/fish_Suffer_00.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/boom_line_effect/fish_Suffer_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/boom_line_effect/fish_Suffer_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/boom_line_effect/fish_Suffer_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/boom_line_effect/fish_Suffer_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/boom_line_effect/fish_Suffer_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10},{value:"fishxy/animation/boom_line_effect/fish_Suffer_00.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:12},{value:"fishxy/animation/boom_line_effect/fish_Suffer_01.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:14},{value:"fishxy/animation/boom_line_effect/fish_Suffer_02.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:16},{value:"fishxy/animation/boom_line_effect/fish_Suffer_03.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:18},{value:"fishxy/animation/boom_line_effect/fish_Suffer_04.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:20},{value:"fishxy/animation/boom_line_effect/fish_Suffer_05.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:22},{value:"",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:24}]}}],name:"ani1",id:1,frameRate:24,action:1}],loadList:["fishxy/animation/boom_line_effect/fish_Suffer_00.png","fishxy/animation/boom_line_effect/fish_Suffer_01.png","fishxy/animation/boom_line_effect/fish_Suffer_02.png","fishxy/animation/boom_line_effect/fish_Suffer_03.png","fishxy/animation/boom_line_effect/fish_Suffer_04.png","fishxy/animation/boom_line_effect/fish_Suffer_05.png"],loadList3D:[]},e.dldby_flash_eff2UI=i,t("ui.fishxy.animation.dldby_flash_eff2UI",i),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{width:311,height:108},compId:2,child:[{type:"Sprite",props:{y:0,x:0,width:108,rotation:-90,pivotX:108,height:311},compId:4,child:[{type:"Sprite",props:{texture:"fishxy/animation/boom_line_effect/lightning_00.png"},compId:3}]}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/boom_line_effect/lightning_00.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/boom_line_effect/lightning_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/boom_line_effect/lightning_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/boom_line_effect/lightning_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/boom_line_effect/lightning_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/boom_line_effect/lightning_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10},{value:"fishxy/animation/boom_line_effect/lightning_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:12},{value:"fishxy/animation/boom_line_effect/lightning_07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:14},{value:"fishxy/animation/boom_line_effect/lightning_08.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:16},{value:"fishxy/animation/boom_line_effect/lightning_09.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:18},{value:"fishxy/animation/boom_line_effect/lightning_10.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:20},{value:"fishxy/animation/boom_line_effect/lightning_02.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:22},{value:"fishxy/animation/boom_line_effect/lightning_03.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:24},{value:"fishxy/animation/boom_line_effect/lightning_04.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:26},{value:"fishxy/animation/boom_line_effect/lightning_05.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:28},{value:"fishxy/animation/boom_line_effect/lightning_06.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:30},{value:"fishxy/animation/boom_line_effect/lightning_07.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:32},{value:"fishxy/animation/boom_line_effect/lightning_08.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:34},{value:"fishxy/animation/boom_line_effect/lightning_09.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:36},{value:"fishxy/animation/boom_line_effect/lightning_10.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:38},{value:"fishxy/animation/boom_line_effect/lightning_02.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:40}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/boom_line_effect/lightning_00.png","fishxy/animation/boom_line_effect/lightning_01.png","fishxy/animation/boom_line_effect/lightning_02.png","fishxy/animation/boom_line_effect/lightning_03.png","fishxy/animation/boom_line_effect/lightning_04.png","fishxy/animation/boom_line_effect/lightning_05.png","fishxy/animation/boom_line_effect/lightning_06.png","fishxy/animation/boom_line_effect/lightning_07.png","fishxy/animation/boom_line_effect/lightning_08.png","fishxy/animation/boom_line_effect/lightning_09.png","fishxy/animation/boom_line_effect/lightning_10.png"],loadList3D:[]},e.dldby_flash_lineUI=i,t("ui.fishxy.animation.dldby_flash_lineUI",i),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,h,a],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Image",props:{y:-28,x:-28,var:"t",skin:"fishxy/animation/common/coin_gold_0.png"},compId:3}],animations:[{nodes:[{target:3,keyframes:{skin:[{value:"fishxy/animation/common/coin_gold_0.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:0},{value:"fishxy/animation/common/coin_gold_1.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:1},{value:"fishxy/animation/common/coin_gold_2.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:2},{value:"fishxy/animation/common/coin_gold_3.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:3},{value:"fishxy/animation/common/coin_gold_4.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:4},{value:"fishxy/animation/common/coin_gold_5.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:5},{value:"fishxy/animation/common/coin_gold_6.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:6},{value:"fishxy/animation/common/coin_gold_7.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:7}]}}],name:"ani1",id:1,frameRate:24,action:2}],loadList:["fishxy/animation/common/coin_gold_0.png","fishxy/animation/common/coin_gold_1.png","fishxy/animation/common/coin_gold_2.png","fishxy/animation/common/coin_gold_3.png","fishxy/animation/common/coin_gold_4.png","fishxy/animation/common/coin_gold_5.png","fishxy/animation/common/coin_gold_6.png","fishxy/animation/common/coin_gold_7.png"],loadList3D:[]},e.dldby_jinbi_effUI=i,t("ui.fishxy.animation.dldby_jinbi_effUI",i),(i=function(){f(i,cn);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"Scene",props:{},compId:2,child:[{type:"Image",props:{skin:"fishxy/animation/JPdeath/JPBox_efx_000.png",anchorY:.5,anchorX:.5},compId:3}],animations:[{nodes:[{target:3,keyframes:{skin:[{value:"fishxy/animation/JPdeath/JPBox_efx_000.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:0},{value:"fishxy/animation/JPdeath/JPBox_efx_001.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:1},{value:"fishxy/animation/JPdeath/JPBox_efx_002.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:2},{value:"fishxy/animation/JPdeath/JPBox_efx_003.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:3},{value:"fishxy/animation/JPdeath/JPBox_efx_004.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:4},{value:"fishxy/animation/JPdeath/JPBox_efx_005.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:5},{value:"fishxy/animation/JPdeath/JPBox_efx_006.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:6},{value:"fishxy/animation/JPdeath/JPBox_efx_007.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:7},{value:"fishxy/animation/JPdeath/JPBox_efx_008.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:8}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/JPdeath/JPBox_efx_000.png","fishxy/animation/JPdeath/JPBox_efx_001.png","fishxy/animation/JPdeath/JPBox_efx_002.png","fishxy/animation/JPdeath/JPBox_efx_003.png","fishxy/animation/JPdeath/JPBox_efx_004.png","fishxy/animation/JPdeath/JPBox_efx_005.png","fishxy/animation/JPdeath/JPBox_efx_006.png","fishxy/animation/JPdeath/JPBox_efx_007.png","fishxy/animation/JPdeath/JPBox_efx_008.png"],loadList3D:[]},e.dragon_box_die_effUI=i,t("ui.fishxy.animation.dragon_box_die_effUI",i),(i=function(){f(i,oa);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,aa,Sn,oa,vn],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"Dialog",props:{},compId:2,child:[{type:"Box",props:{y:0,x:0,width:943,height:476},compId:6,child:[{type:"SkeletonPlayer",props:{y:318,x:468,var:"sk",url:"fishxy/animation/dragon_box/JACKPOT_Cn.sk",runtime:"Laya.Skeleton"},compId:4},{type:"Label",props:{y:348,x:476,width:718,var:"score",text:"0",height:82,font:"bmfont_bigCoin",anchorY:.5,anchorX:.5,align:"center"},compId:5}]}],animations:[{nodes:[{target:5,keyframes:{scaleY:[{value:0,tweenMethod:"linearNone",tween:!0,target:5,key:"scaleY",index:0},{value:1,tweenMethod:"elasticOut",tween:!0,target:5,key:"scaleY",index:9}],scaleX:[{value:0,tweenMethod:"linearNone",tween:!0,target:5,key:"scaleX",index:0},{value:1,tweenMethod:"elasticOut",tween:!0,target:5,key:"scaleX",index:9}]}}],name:"ani1",id:1,frameRate:24,action:1}],loadList:["fishxy/animation/dragon_box/JACKPOT_Cn.sk"],loadList3D:[]},e.dragon_box_effUI=i,t("ui.fishxy.animation.dragon_box_effUI",i),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,vn,h,a],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Box",props:{x:-372,width:362,var:"wave",height:806,centerY:0,anchorY:.5},compId:6,child:[{type:"Image",props:{y:474,x:0,skin:"fishxy/animation/array_coming/wave2.png"},compId:8},{type:"Image",props:{y:237,x:0,skin:"fishxy/animation/array_coming/wave2.png"},compId:7},{type:"Image",props:{y:0,x:0,skin:"fishxy/animation/array_coming/wave2.png"},compId:5}]},{type:"Image",props:{x:0,var:"bg",skin:"fishxy/animation/array_coming/bg.png",centerY:0},compId:3},{type:"Image",props:{var:"txt",skin:"fishxy/animation/array_coming/t.png",centerY:0,centerX:0,anchorY:.5,anchorX:.5},compId:4}],animations:[{nodes:[{target:4,keyframes:{scaleY:[{value:2.5,tweenMethod:"linearNone",tween:!0,target:4,key:"scaleY",index:0},{value:.8,tweenMethod:"linearNone",tween:!0,target:4,key:"scaleY",index:5},{value:1,tweenMethod:"linearNone",tween:!0,target:4,key:"scaleY",index:10},{value:.8,tweenMethod:"linearNone",tween:!0,target:4,key:"scaleY",index:15},{value:1,tweenMethod:"linearNone",tween:!0,target:4,key:"scaleY",index:20},{value:.8,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleY",index:25},{value:1,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleY",index:30},{value:.8,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleY",index:35},{value:1,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleY",index:40},{value:.8,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleY",index:45},{value:1,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleY",index:50},{value:.8,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleY",index:55},{value:1,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleY",index:60},{value:.8,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleY",index:65},{value:1,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleY",index:70},{value:.8,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleY",index:75},{value:1,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleY",index:80},{value:.8,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleY",index:85},{value:1,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleY",index:90},{value:.8,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleY",index:95},{value:1,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleY",index:100},{value:.8,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleY",index:105},{value:1,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleY",index:110},{value:.8,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleY",index:115},{value:1,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleY",index:120},{value:.8,tweenMethod:"linearNone",tween:!0,target:4,key:"scaleY",index:125}],scaleX:[{value:2.5,tweenMethod:"linearNone",tween:!0,target:4,key:"scaleX",index:0},{value:.8,tweenMethod:"linearNone",tween:!0,target:4,key:"scaleX",index:5},{value:1,tweenMethod:"linearNone",tween:!0,target:4,key:"scaleX",index:10},{value:.8,tweenMethod:"linearNone",tween:!0,target:4,key:"scaleX",index:15},{value:1,tweenMethod:"linearNone",tween:!0,target:4,key:"scaleX",index:20},{value:.8,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleX",index:25},{value:1,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleX",index:30},{value:.8,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleX",index:35},{value:1,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleX",index:40},{value:.8,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleX",index:45},{value:1,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleX",index:50},{value:.8,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleX",index:55},{value:1,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleX",index:60},{value:.8,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleX",index:65},{value:1,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleX",index:70},{value:.8,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleX",index:75},{value:1,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleX",index:80},{value:.8,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleX",index:85},{value:1,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleX",index:90},{value:.8,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleX",index:95},{value:1,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleX",index:100},{value:.8,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleX",index:105},{value:1,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleX",index:110},{value:.8,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleX",index:115},{value:1,tweenMethod:"linearNone",tween:!0,target:4,label:null,key:"scaleX",index:120},{value:.8,tweenMethod:"linearNone",tween:!0,target:4,key:"scaleX",index:125}],alpha:[{value:.5,tweenMethod:"linearNone",tween:!0,target:4,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:4,key:"alpha",index:5},{value:1,tweenMethod:"linearNone",tween:!0,target:4,key:"alpha",index:120},{value:0,tweenMethod:"linearNone",tween:!0,target:4,key:"alpha",index:125}]}},{target:3,keyframes:{alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:3,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:3,key:"alpha",index:120},{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"alpha",index:125}]}}],name:"ani1",id:1,frameRate:24,action:0},{nodes:[{target:5,keyframes:{skin:[{value:"fishxy/animation/array_coming/wave1.png",tweenMethod:"linearNone",tween:!1,target:5,key:"skin",index:0},{value:"fishxy/animation/array_coming/wave2.png",tweenMethod:"linearNone",tween:!1,target:5,key:"skin",index:2},{value:"fishxy/animation/array_coming/wave3.png",tweenMethod:"linearNone",tween:!1,target:5,key:"skin",index:4}]}},{target:7,keyframes:{skin:[{value:"fishxy/animation/array_coming/wave1.png",tweenMethod:"linearNone",tween:!1,target:7,key:"skin",index:0},{value:"fishxy/animation/array_coming/wave2.png",tweenMethod:"linearNone",tween:!1,target:7,key:"skin",index:2},{value:"fishxy/animation/array_coming/wave3.png",tweenMethod:"linearNone",tween:!1,target:7,key:"skin",index:4}]}},{target:8,keyframes:{skin:[{value:"fishxy/animation/array_coming/wave1.png",tweenMethod:"linearNone",tween:!1,target:8,key:"skin",index:0},{value:"fishxy/animation/array_coming/wave2.png",tweenMethod:"linearNone",tween:!1,target:8,key:"skin",index:2},{value:"fishxy/animation/array_coming/wave3.png",tweenMethod:"linearNone",tween:!1,target:8,key:"skin",index:4}]}}],name:"ani2",id:2,frameRate:24,action:2}],loadList:["fishxy/animation/array_coming/wave2.png","fishxy/animation/array_coming/bg.png","fishxy/animation/array_coming/t.png","fishxy/animation/array_coming/wave1.png","fishxy/animation/array_coming/wave3.png"],loadList3D:[]},e.fish_array_comingUI=i,t("ui.fishxy.animation.fish_array_comingUI",i),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[a,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Image",props:{skin:"fishxy/animation/common/bubble.png",anchorY:.5,anchorX:.5},compId:4},{type:"dice",props:{y:66,x:52,var:"dice",scaleY:.5,scaleX:.5,runtime:"ui.fishxy.animation.diceUI"},compId:3}],loadList:["fishxy/animation/common/bubble.png"],loadList3D:[]},e.fish_dice_bubbleUI=i,t("ui.fishxy.animation.fish_dice_bubbleUI",i),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[Sn,a],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"dice",props:{y:-33,x:-1,width:1,var:"dice",height:1,runtime:"ui.fishxy.animation.diceUI"},compId:3},{type:"Label",props:{y:24,x:-107,width:214,var:"score",text:"+6.1",height:32,font:"bmfont_pickFish",align:"center"},compId:6},{type:"Label",props:{y:80,x:-115,width:153,var:"mult",text:"x6",scaleY:1.5,scaleX:1.5,font:"bmfont_jiangchiZi",align:"center"},compId:5}],loadList:[],loadList3D:[]},e.fish_die_diceUI=i,t("ui.fishxy.animation.fish_die_diceUI",i),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Image",props:{skin:"fishxy/animation/fish/Quasi-heart-box - 01.png",anchorY:.5,anchorX:.5},compId:3},{type:"Image",props:{skin:"fishxy/animation/fish/Quasi-heart-box - 02.png",anchorY:.5,anchorX:.5},compId:4}],animations:[{nodes:[{target:3,keyframes:{scaleY:[{value:1,tweenMethod:"linearNone",tween:!0,target:3,key:"scaleY",index:0},{value:1.2,tweenMethod:"linearNone",tween:!0,target:3,key:"scaleY",index:3},{value:1,tweenMethod:"linearNone",tween:!0,target:3,label:null,key:"scaleY",index:6}],scaleX:[{value:1,tweenMethod:"linearNone",tween:!0,target:3,key:"scaleX",index:0},{value:1.2,tweenMethod:"linearNone",tween:!0,target:3,key:"scaleX",index:3},{value:1,tweenMethod:"linearNone",tween:!0,target:3,label:null,key:"scaleX",index:6}],alpha:[{value:.8,tweenMethod:"linearNone",tween:!0,target:3,key:"alpha",index:0}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/fish/Quasi-heart-box - 01.png","fishxy/animation/fish/Quasi-heart-box - 02.png"],loadList3D:[]},e.jclj_lock_iconUI=i,t("ui.fishxy.animation.jclj_lock_iconUI",i),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Image",props:{x:0,width:354,skin:"fishxy/animation/gun/jgb/stick_bo_01.png",pivotY:219,pivotX:177,height:285},compId:3}],animations:[{nodes:[{target:3,keyframes:{skin:[{value:"fishxy/animation/gun/jgb/stick_bo_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:0},{value:"fishxy/animation/gun/jgb/stick_bo_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:1},{value:"fishxy/animation/gun/jgb/stick_bo_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:2},{value:"fishxy/animation/gun/jgb/stick_bo_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:3},{value:"fishxy/animation/gun/jgb/stick_bo_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:4}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/gun/jgb/stick_bo_01.png","fishxy/animation/gun/jgb/stick_bo_02.png","fishxy/animation/gun/jgb/stick_bo_03.png","fishxy/animation/gun/jgb/stick_bo_04.png","fishxy/animation/gun/jgb/stick_bo_05.png"],loadList3D:[]},e.jgb_bound_explodeUI=i,t("ui.fishxy.animation.jgb_bound_explodeUI",i),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,h,N],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Image",props:{y:-167,x:0,width:50,skin:"fishxy/fight/mainui/location/img_location_03.png",pivotX:25,name:"zt",height:38},compId:5},{type:"Image",props:{y:-169,x:0,width:151,skin:"fishxy/fight/mainui/location/img_location_04.png",pivotY:40,pivotX:76,name:"nb",height:40},compId:6},{type:"Sprite",props:{},compId:18,child:[{type:"Image",props:{y:0,x:0,skin:"fishxy/fight/mainui/location/img_location_02.png",pivotY:128,pivotX:128,name:"hc"},compId:4},{type:"Image",props:{y:0,x:0,width:256,skin:"fishxy/fight/mainui/location/img_location_01.png",pivotY:128,pivotX:128,name:"sc",height:256},compId:3}]}],animations:[{nodes:[{target:3,keyframes:{rotation:[{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"rotation",index:0},{value:180,tweenMethod:"linearNone",tween:!0,target:3,key:"rotation",index:60}]}},{target:4,keyframes:{rotation:[{value:0,tweenMethod:"linearNone",tween:!0,target:4,key:"rotation",index:0},{value:-180,tweenMethod:"linearNone",tween:!0,target:4,key:"rotation",index:60}]}},{target:18,keyframes:{scaleY:[{value:1,tweenMethod:"linearNone",tween:!0,target:18,key:"scaleY",index:0},{value:.85,tweenMethod:"linearNone",tween:!0,target:18,key:"scaleY",index:30},{value:1,tweenMethod:"linearNone",tween:!0,target:18,key:"scaleY",index:60}],scaleX:[{value:1,tweenMethod:"linearNone",tween:!0,target:18,key:"scaleX",index:0},{value:.85,tweenMethod:"linearNone",tween:!0,target:18,key:"scaleX",index:30},{value:1,tweenMethod:"linearNone",tween:!0,target:18,key:"scaleX",index:60}]}},{target:5,keyframes:{y:[{value:-167,tweenMethod:"linearNone",tween:!0,target:5,key:"y",index:0},{value:-172,tweenMethod:"linearNone",tween:!0,target:5,key:"y",index:7},{value:-164,tweenMethod:"linearNone",tween:!0,target:5,key:"y",index:14},{value:-169,tweenMethod:"linearNone",tween:!0,target:5,key:"y",index:20},{value:-167,tweenMethod:"linearNone",tween:!0,target:5,label:null,key:"y",index:25},{value:-167,tweenMethod:"linearNone",tween:!0,target:5,label:null,key:"y",index:30},{value:-172,tweenMethod:"linearNone",tween:!0,target:5,label:null,key:"y",index:37},{value:-164,tweenMethod:"linearNone",tween:!0,target:5,label:null,key:"y",index:44},{value:-169,tweenMethod:"linearNone",tween:!0,target:5,label:null,key:"y",index:50},{value:-167,tweenMethod:"linearNone",tween:!0,target:5,label:null,key:"y",index:55}],height:[{value:38,tweenMethod:"linearNone",tween:!0,target:5,key:"height",index:0},{value:35,tweenMethod:"linearNone",tween:!0,target:5,key:"height",index:7},{value:49,tweenMethod:"linearNone",tween:!0,target:5,key:"height",index:14},{value:38,tweenMethod:"linearNone",tween:!0,target:5,key:"height",index:20},{value:38,tweenMethod:"linearNone",tween:!0,target:5,label:null,key:"height",index:25},{value:38,tweenMethod:"linearNone",tween:!0,target:5,label:null,key:"height",index:30},{value:35,tweenMethod:"linearNone",tween:!0,target:5,label:null,key:"height",index:37},{value:49,tweenMethod:"linearNone",tween:!0,target:5,label:null,key:"height",index:44},{value:38,tweenMethod:"linearNone",tween:!0,target:5,label:null,key:"height",index:50},{value:38,tweenMethod:"linearNone",tween:!0,target:5,label:null,key:"height",index:55}]}},{target:6,keyframes:{y:[{value:-169,tweenMethod:"linearNone",tween:!0,target:6,key:"y",index:0},{value:-165,tweenMethod:"linearNone",tween:!0,target:6,key:"y",index:7},{value:-189.6,tweenMethod:"linearNone",tween:!0,target:6,key:"y",index:14},{value:-166,tweenMethod:"linearNone",tween:!0,target:6,key:"y",index:20},{value:-171,tweenMethod:"linearNone",tween:!0,target:6,key:"y",index:25},{value:-169,tweenMethod:"linearNone",tween:!0,target:6,label:null,key:"y",index:30},{value:-165,tweenMethod:"linearNone",tween:!0,target:6,label:null,key:"y",index:37},{value:-189.6,tweenMethod:"linearNone",tween:!0,target:6,label:null,key:"y",index:44},{value:-166,tweenMethod:"linearNone",tween:!0,target:6,label:null,key:"y",index:50},{value:-171,tweenMethod:"linearNone",tween:!0,target:6,label:null,key:"y",index:55},{value:-169,tweenMethod:"linearNone",tween:!0,target:6,label:null,key:"y",index:60}],height:[{value:40,tweenMethod:"linearNone",tween:!0,target:6,key:"height",index:0},{value:37,tweenMethod:"linearNone",tween:!0,target:6,key:"height",index:7},{value:48,tweenMethod:"linearNone",tween:!0,target:6,key:"height",index:14},{value:38,tweenMethod:"linearNone",tween:!0,target:6,key:"height",index:20},{value:42,tweenMethod:"linearNone",tween:!0,target:6,key:"height",index:25},{value:40,tweenMethod:"linearNone",tween:!0,target:6,label:null,key:"height",index:30},{value:37,tweenMethod:"linearNone",tween:!0,target:6,label:null,key:"height",index:37},{value:48,tweenMethod:"linearNone",tween:!0,target:6,label:null,key:"height",index:44},{value:38,tweenMethod:"linearNone",tween:!0,target:6,label:null,key:"height",index:50},{value:42,tweenMethod:"linearNone",tween:!0,target:6,label:null,key:"height",index:55},{value:40,tweenMethod:"linearNone",tween:!0,target:6,label:null,key:"height",index:60}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/fight/mainui/location/img_location_03.png","fishxy/fight/mainui/location/img_location_04.png","fishxy/fight/mainui/location/img_location_02.png","fishxy/fight/mainui/location/img_location_01.png"],loadList3D:[]},e.Location_EffectUI=i,t("ui.fishxy.animation.Location_EffectUI",i),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,h,a],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Image",props:{y:0,x:0,var:"img",skin:"fishxy/fight/bg/water/Water_0_0000.png"},compId:3}],animations:[{nodes:[{target:3,keyframes:{skin:[{value:"fishxy/fight/bg/water/Water_0_0000.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:0},{value:"fishxy/fight/bg/water/Water_0_0001.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:1},{value:"fishxy/fight/bg/water/Water_0_0002.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:2},{value:"fishxy/fight/bg/water/Water_0_0003.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:3},{value:"fishxy/fight/bg/water/Water_0_0004.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:4},{value:"fishxy/fight/bg/water/Water_0_0005.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:5},{value:"fishxy/fight/bg/water/Water_0_0006.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:6},{value:"fishxy/fight/bg/water/Water_0_0007.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:7},{value:"fishxy/fight/bg/water/Water_0_0008.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:8},{value:"fishxy/fight/bg/water/Water_0_0009.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:9},{value:"fishxy/fight/bg/water/Water_0_0010.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:10},{value:"fishxy/fight/bg/water/Water_0_0011.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:11},{value:"fishxy/fight/bg/water/Water_0_0012.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:12},{value:"fishxy/fight/bg/water/Water_0_0013.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:13},{value:"fishxy/fight/bg/water/Water_0_0014.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:14},{value:"fishxy/fight/bg/water/Water_0_0015.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:15},{value:"fishxy/fight/bg/water/Water_0_0016.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:16},{value:"fishxy/fight/bg/water/Water_0_0017.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:17},{value:"fishxy/fight/bg/water/Water_0_0018.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:18},{value:"fishxy/fight/bg/water/Water_0_0019.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:19},{value:"fishxy/fight/bg/water/Water_0_0020.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:20},{value:"fishxy/fight/bg/water/Water_0_0021.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:21},{value:"fishxy/fight/bg/water/Water_0_0022.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:22},{value:"fishxy/fight/bg/water/Water_0_0023.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:23},{value:"fishxy/fight/bg/water/Water_0_0024.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:24},{value:"fishxy/fight/bg/water/Water_0_0025.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:25},{value:"fishxy/fight/bg/water/Water_0_0026.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:26},{value:"fishxy/fight/bg/water/Water_0_0027.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:27},{value:"fishxy/fight/bg/water/Water_0_0028.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:28},{value:"fishxy/fight/bg/water/Water_0_0029.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:29},{value:"fishxy/fight/bg/water/Water_0_0030.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:30},{value:"fishxy/fight/bg/water/Water_0_0031.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:31}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/fight/bg/water/Water_0_0000.png","fishxy/fight/bg/water/Water_0_0001.png","fishxy/fight/bg/water/Water_0_0002.png","fishxy/fight/bg/water/Water_0_0003.png","fishxy/fight/bg/water/Water_0_0004.png","fishxy/fight/bg/water/Water_0_0005.png","fishxy/fight/bg/water/Water_0_0006.png","fishxy/fight/bg/water/Water_0_0007.png","fishxy/fight/bg/water/Water_0_0008.png","fishxy/fight/bg/water/Water_0_0009.png","fishxy/fight/bg/water/Water_0_0010.png","fishxy/fight/bg/water/Water_0_0011.png","fishxy/fight/bg/water/Water_0_0012.png","fishxy/fight/bg/water/Water_0_0013.png","fishxy/fight/bg/water/Water_0_0014.png","fishxy/fight/bg/water/Water_0_0015.png","fishxy/fight/bg/water/Water_0_0016.png","fishxy/fight/bg/water/Water_0_0017.png","fishxy/fight/bg/water/Water_0_0018.png","fishxy/fight/bg/water/Water_0_0019.png","fishxy/fight/bg/water/Water_0_0020.png","fishxy/fight/bg/water/Water_0_0021.png","fishxy/fight/bg/water/Water_0_0022.png","fishxy/fight/bg/water/Water_0_0023.png","fishxy/fight/bg/water/Water_0_0024.png","fishxy/fight/bg/water/Water_0_0025.png","fishxy/fight/bg/water/Water_0_0026.png","fishxy/fight/bg/water/Water_0_0027.png","fishxy/fight/bg/water/Water_0_0028.png","fishxy/fight/bg/water/Water_0_0029.png","fishxy/fight/bg/water/Water_0_0030.png","fishxy/fight/bg/water/Water_0_0031.png"],loadList3D:[]},e.water_effectUI=i,t("ui.fishxy.animation.water_effectUI",i),n=(n=(n=(n=Ki=Ki||{}).fishxy||(n.fishxy={})).animation||(n.animation={})).bullet||(n.bullet={}),(e=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[a,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Image",props:{y:0,x:0,skin:"fishxy/animation/gun/normal/room1/bullet_1.png",rotation:90,anchorY:.5,anchorX:.5},compId:3},{type:"Image",props:{y:0,x:32,width:28,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:28,anchorY:.5,anchorX:.5},compId:10}],loadList:["fishxy/animation/gun/normal/room1/bullet_1.png","fishxy/animation/fish/img_collider.png"],loadList3D:[]},n.bgxyby_bullet_1UI=e,t("ui.fishxy.animation.bullet.bgxyby_bullet_1UI",e),(e=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[a,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Image",props:{y:0,x:0,skin:"fishxy/animation/gun/normal/room1/bullet_1.png",rotation:90,anchorY:.5,anchorX:.5},compId:3},{type:"Image",props:{y:0,x:32,width:28,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:28,anchorY:.5,anchorX:.5},compId:10}],loadList:["fishxy/animation/gun/normal/room1/bullet_1.png","fishxy/animation/fish/img_collider.png"],loadList3D:[]},n.bgxyby_bullet_10UI=e,t("ui.fishxy.animation.bullet.bgxyby_bullet_10UI",e),(e=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[a,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Image",props:{y:0,x:0,skin:"fishxy/animation/gun/normal/room1/bullet_1.png",rotation:90,anchorY:.5,anchorX:.5},compId:3},{type:"Image",props:{y:0,x:32,width:28,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:28,anchorY:.5,anchorX:.5},compId:10}],loadList:["fishxy/animation/gun/normal/room1/bullet_1.png","fishxy/animation/fish/img_collider.png"],loadList3D:[]},n.bgxyby_bullet_11UI=e,t("ui.fishxy.animation.bullet.bgxyby_bullet_11UI",e),(e=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[a,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Image",props:{y:0,x:0,skin:"fishxy/animation/gun/normal/room1/bullet_1.png",rotation:90,anchorY:.5,anchorX:.5},compId:3},{type:"Image",props:{y:0,x:32,width:28,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:28,anchorY:.5,anchorX:.5},compId:10}],loadList:["fishxy/animation/gun/normal/room1/bullet_1.png","fishxy/animation/fish/img_collider.png"],loadList3D:[]},n.bgxyby_bullet_12UI=e,t("ui.fishxy.animation.bullet.bgxyby_bullet_12UI",e),(e=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[a,vn,N,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Box",props:{width:231,rotation:90,height:212,anchorY:.5,anchorX:.5},compId:6,child:[{type:"Sprite",props:{y:124,x:5,width:"",texture:"fishxy/animation/gun/jgb/Barrel_light-body.png",height:""},compId:3},{type:"Sprite",props:{y:62,x:117,width:"",texture:"fishxy/animation/gun/jgb/Barrel_light-head.png",pivotY:62,pivotX:117,height:""},compId:4}]},{type:"Image",props:{y:0,x:0,width:223,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:223,anchorY:.5,anchorX:.5},compId:7}],loadList:["fishxy/animation/gun/jgb/Barrel_light-body.png","fishxy/animation/gun/jgb/Barrel_light-head.png","fishxy/animation/fish/img_collider.png"],loadList3D:[]},n.bgxyby_bullet_13UI=e,t("ui.fishxy.animation.bullet.bgxyby_bullet_13UI",e),(e=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,vn,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:372,x:234,width:166,texture:"fishxy/animation/gun/xmsb/water2.png",scaleX:4.5,rotation:90,pivotX:166,height:1e4},compId:21},{type:"Box",props:{x:0,width:468,rotation:90,height:344,anchorY:.5,anchorX:.5},compId:17,child:[{type:"Sprite",props:{y:248,x:230,name:"wave"},compId:11,child:[{type:"Sprite",props:{y:-248,x:-222,texture:"fishxy/animation/gun/xmsb/wave_01.png"},compId:8},{type:"Sprite",props:{y:-248,x:220,texture:"fishxy/animation/gun/xmsb/wave_01.png",scaleY:1,scaleX:-1},compId:10}]},{type:"Sprite",props:{y:207,x:230,width:460,texture:"fishxy/animation/gun/xmsb/Y_knife.png",pivotY:165,pivotX:230,height:330},compId:6},{type:"Sprite",props:{y:290,x:227,width:240,name:"bubble",height:11},compId:13,child:[{type:"Sprite",props:{y:-135,x:-224,texture:"fishxy/animation/gun/xmsb/Bubble04.png",scaleY:2,scaleX:2},compId:12},{type:"Sprite",props:{y:-135,x:240,texture:"fishxy/animation/gun/xmsb/Bubble04.png",scaleY:2,scaleX:-2},compId:14}]}]},{type:"Image",props:{y:0,x:-4812,width:1e4,visible:!1,skin:"fishxy/animation/fish/img_rect_collider.png",sizeGrid:"15,13,15,14",name:"collider",height:500,anchorY:.5,anchorX:.5},compId:22}],animations:[{nodes:[{target:12,keyframes:{texture:[{value:"fishxy/animation/gun/xmsb/Bubble01.png",tweenMethod:"linearNone",tween:!1,target:12,key:"texture",index:0},{value:"fishxy/animation/gun/xmsb/Bubble02.png",tweenMethod:"linearNone",tween:!1,target:12,key:"texture",index:2},{value:"fishxy/animation/gun/xmsb/Bubble03.png",tweenMethod:"linearNone",tween:!1,target:12,key:"texture",index:4},{value:"fishxy/animation/gun/xmsb/Bubble04.png",tweenMethod:"linearNone",tween:!1,target:12,key:"texture",index:6},{value:"fishxy/animation/gun/xmsb/Bubble01.png",tweenMethod:"linearNone",tween:!1,target:12,label:null,key:"texture",index:8},{value:"fishxy/animation/gun/xmsb/Bubble02.png",tweenMethod:"linearNone",tween:!1,target:12,label:null,key:"texture",index:10},{value:"fishxy/animation/gun/xmsb/Bubble03.png",tweenMethod:"linearNone",tween:!1,target:12,label:null,key:"texture",index:12},{value:"fishxy/animation/gun/xmsb/Bubble04.png",tweenMethod:"linearNone",tween:!1,target:12,label:null,key:"texture",index:14},{value:"fishxy/animation/gun/xmsb/Bubble01.png",tweenMethod:"linearNone",tween:!1,target:12,label:null,key:"texture",index:16},{value:"fishxy/animation/gun/xmsb/Bubble02.png",tweenMethod:"linearNone",tween:!1,target:12,label:null,key:"texture",index:18},{value:"fishxy/animation/gun/xmsb/Bubble03.png",tweenMethod:"linearNone",tween:!1,target:12,label:null,key:"texture",index:20},{value:"fishxy/animation/gun/xmsb/Bubble04.png",tweenMethod:"linearNone",tween:!1,target:12,label:null,key:"texture",index:22}]}},{target:14,keyframes:{texture:[{value:"fishxy/animation/gun/xmsb/Bubble01.png",tweenMethod:"linearNone",tween:!1,target:14,key:"texture",index:0},{value:"fishxy/animation/gun/xmsb/Bubble02.png",tweenMethod:"linearNone",tween:!1,target:14,key:"texture",index:2},{value:"fishxy/animation/gun/xmsb/Bubble03.png",tweenMethod:"linearNone",tween:!1,target:14,key:"texture",index:4},{value:"fishxy/animation/gun/xmsb/Bubble04.png",tweenMethod:"linearNone",tween:!1,target:14,key:"texture",index:6},{value:"fishxy/animation/gun/xmsb/Bubble01.png",tweenMethod:"linearNone",tween:!1,target:14,label:null,key:"texture",index:8},{value:"fishxy/animation/gun/xmsb/Bubble02.png",tweenMethod:"linearNone",tween:!1,target:14,label:null,key:"texture",index:10},{value:"fishxy/animation/gun/xmsb/Bubble03.png",tweenMethod:"linearNone",tween:!1,target:14,label:null,key:"texture",index:12},{value:"fishxy/animation/gun/xmsb/Bubble04.png",tweenMethod:"linearNone",tween:!1,target:14,label:null,key:"texture",index:14},{value:"fishxy/animation/gun/xmsb/Bubble01.png",tweenMethod:"linearNone",tween:!1,target:14,label:null,key:"texture",index:16},{value:"fishxy/animation/gun/xmsb/Bubble02.png",tweenMethod:"linearNone",tween:!1,target:14,label:null,key:"texture",index:18},{value:"fishxy/animation/gun/xmsb/Bubble03.png",tweenMethod:"linearNone",tween:!1,target:14,label:null,key:"texture",index:20},{value:"fishxy/animation/gun/xmsb/Bubble04.png",tweenMethod:"linearNone",tween:!1,target:14,label:null,key:"texture",index:22}]}},{target:8,keyframes:{texture:[{value:"fishxy/animation/gun/xmsb/wave_01.png",tweenMethod:"linearNone",tween:!1,target:8,key:"texture",index:0},{value:"fishxy/animation/gun/xmsb/wave_02.png",tweenMethod:"linearNone",tween:!1,target:8,key:"texture",index:2},{value:"fishxy/animation/gun/xmsb/wave_03.png",tweenMethod:"linearNone",tween:!1,target:8,key:"texture",index:4},{value:"fishxy/animation/gun/xmsb/wave_01.png",tweenMethod:"linearNone",tween:!1,target:8,label:null,key:"texture",index:6},{value:"fishxy/animation/gun/xmsb/wave_02.png",tweenMethod:"linearNone",tween:!1,target:8,label:null,key:"texture",index:8},{value:"fishxy/animation/gun/xmsb/wave_03.png",tweenMethod:"linearNone",tween:!1,target:8,label:null,key:"texture",index:10},{value:"fishxy/animation/gun/xmsb/wave_01.png",tweenMethod:"linearNone",tween:!1,target:8,label:null,key:"texture",index:12},{value:"fishxy/animation/gun/xmsb/wave_02.png",tweenMethod:"linearNone",tween:!1,target:8,label:null,key:"texture",index:14},{value:"fishxy/animation/gun/xmsb/wave_03.png",tweenMethod:"linearNone",tween:!1,target:8,label:null,key:"texture",index:16},{value:"fishxy/animation/gun/xmsb/wave_01.png",tweenMethod:"linearNone",tween:!1,target:8,label:null,key:"texture",index:18},{value:"fishxy/animation/gun/xmsb/wave_02.png",tweenMethod:"linearNone",tween:!1,target:8,label:null,key:"texture",index:20},{value:"fishxy/animation/gun/xmsb/wave_03.png",tweenMethod:"linearNone",tween:!1,target:8,label:null,key:"texture",index:22}]}},{target:10,keyframes:{texture:[{value:"fishxy/animation/gun/xmsb/wave_01.png",tweenMethod:"linearNone",tween:!1,target:10,key:"texture",index:0},{value:"fishxy/animation/gun/xmsb/wave_02.png",tweenMethod:"linearNone",tween:!1,target:10,key:"texture",index:2},{value:"fishxy/animation/gun/xmsb/wave_03.png",tweenMethod:"linearNone",tween:!1,target:10,key:"texture",index:4},{value:"fishxy/animation/gun/xmsb/wave_01.png",tweenMethod:"linearNone",tween:!1,target:10,label:null,key:"texture",index:6},{value:"fishxy/animation/gun/xmsb/wave_02.png",tweenMethod:"linearNone",tween:!1,target:10,label:null,key:"texture",index:8},{value:"fishxy/animation/gun/xmsb/wave_03.png",tweenMethod:"linearNone",tween:!1,target:10,label:null,key:"texture",index:10},{value:"fishxy/animation/gun/xmsb/wave_01.png",tweenMethod:"linearNone",tween:!1,target:10,label:null,key:"texture",index:12},{value:"fishxy/animation/gun/xmsb/wave_02.png",tweenMethod:"linearNone",tween:!1,target:10,label:null,key:"texture",index:14},{value:"fishxy/animation/gun/xmsb/wave_03.png",tweenMethod:"linearNone",tween:!1,target:10,label:null,key:"texture",index:16},{value:"fishxy/animation/gun/xmsb/wave_01.png",tweenMethod:"linearNone",tween:!1,target:10,label:null,key:"texture",index:18},{value:"fishxy/animation/gun/xmsb/wave_02.png",tweenMethod:"linearNone",tween:!1,target:10,label:null,key:"texture",index:20},{value:"fishxy/animation/gun/xmsb/wave_03.png",tweenMethod:"linearNone",tween:!1,target:10,label:null,key:"texture",index:22}]}},{target:21,keyframes:{texture:[{value:"fishxy/animation/gun/xmsb/water4.png",tweenMethod:"linearNone",tween:!1,target:21,label:null,key:"texture",index:0},{value:"fishxy/animation/gun/xmsb/water3.png",tweenMethod:"linearNone",tween:!1,target:21,label:null,key:"texture",index:3},{value:"fishxy/animation/gun/xmsb/water2.png",tweenMethod:"linearNone",tween:!1,target:21,label:null,key:"texture",index:6},{value:"fishxy/animation/gun/xmsb/water1.png",tweenMethod:"linearNone",tween:!1,target:21,label:null,key:"texture",index:9},{value:"fishxy/animation/gun/xmsb/water4.png",tweenMethod:"linearNone",tween:!1,target:21,label:null,key:"texture",index:12},{value:"fishxy/animation/gun/xmsb/water3.png",tweenMethod:"linearNone",tween:!1,target:21,label:null,key:"texture",index:15},{value:"fishxy/animation/gun/xmsb/water2.png",tweenMethod:"linearNone",tween:!1,target:21,label:null,key:"texture",index:18},{value:"fishxy/animation/gun/xmsb/water1.png",tweenMethod:"linearNone",tween:!1,target:21,label:null,key:"texture",index:21}]}}],name:"ani1",id:2,frameRate:24,action:0}],loadList:["fishxy/animation/gun/xmsb/water2.png","fishxy/animation/gun/xmsb/wave_01.png","fishxy/animation/gun/xmsb/Y_knife.png","fishxy/animation/gun/xmsb/Bubble04.png","fishxy/animation/fish/img_rect_collider.png","fishxy/animation/gun/xmsb/Bubble01.png","fishxy/animation/gun/xmsb/Bubble02.png","fishxy/animation/gun/xmsb/Bubble03.png","fishxy/animation/gun/xmsb/wave_02.png","fishxy/animation/gun/xmsb/wave_03.png","fishxy/animation/gun/xmsb/water4.png","fishxy/animation/gun/xmsb/water3.png","fishxy/animation/gun/xmsb/water1.png"],loadList3D:[]},n.bgxyby_bullet_14UI=e,t("ui.fishxy.animation.bullet.bgxyby_bullet_14UI",e),(e=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:0,x:0,width:98,texture:"fishxy/animation/gun/ffwb/bullet_ffwb.png",pivotY:49,pivotX:49,height:98},compId:3},{type:"Image",props:{y:0,x:0,width:119,visible:!1,name:"collider",height:119,anchorY:.5,anchorX:.5},compId:4}],animations:[{nodes:[{target:3,keyframes:{rotation:[{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"rotation",index:0},{value:180,tweenMethod:"linearNone",tween:!0,target:3,key:"rotation",index:12},{value:360,tweenMethod:"linearNone",tween:!0,target:3,key:"rotation",index:24}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/gun/ffwb/bullet_ffwb.png"],loadList3D:[]},n.bgxyby_bullet_15_childUI=e,t("ui.fishxy.animation.bullet.bgxyby_bullet_15_childUI",e),(e=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[a],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"SkeletonPlayer",props:{y:-88,x:24,url:"fishxy/animation/fish/dragonbones/FourFa.sk",runtime:"Laya.Skeleton"},compId:3}],loadList:["fishxy/animation/fish/dragonbones/FourFa.sk"],loadList3D:[]},n.bgxyby_bullet_15_parentUI=e,t("ui.fishxy.animation.bullet.bgxyby_bullet_15_parentUI",e),(e=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-57,x:-103,texture:"fishxy/animation/gun/jclj/Missile-dark.png",scaleY:.7,scaleX:.7},compId:5},{type:"Sprite",props:{y:-57,x:-213,width:199,texture:"fishxy/animation/gun/jclj/Missile-track4.png",height:108},compId:6},{type:"Image",props:{y:0,x:15,width:80,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:80,anchorY:.5,anchorX:.5},compId:8}],animations:[{nodes:[{target:6,keyframes:{texture:[{value:"fishxy/animation/gun/jclj/Missile-track1.png",tweenMethod:"linearNone",tween:!1,target:6,key:"texture",index:0},{value:"fishxy/animation/gun/jclj/Missile-track2.png",tweenMethod:"linearNone",tween:!1,target:6,key:"texture",index:2},{value:"fishxy/animation/gun/jclj/Missile-track3.png",tweenMethod:"linearNone",tween:!1,target:6,key:"texture",index:4},{value:"fishxy/animation/gun/jclj/Missile-track4.png",tweenMethod:"linearNone",tween:!1,target:6,key:"texture",index:6}]}}],name:"ani1",id:2,frameRate:24,action:0}],loadList:["fishxy/animation/gun/jclj/Missile-dark.png","fishxy/animation/gun/jclj/Missile-track4.png","fishxy/animation/fish/img_collider.png","fishxy/animation/gun/jclj/Missile-track1.png","fishxy/animation/gun/jclj/Missile-track2.png","fishxy/animation/gun/jclj/Missile-track3.png"],loadList3D:[]},n.bgxyby_bullet_16UI=e,t("ui.fishxy.animation.bullet.bgxyby_bullet_16UI",e),(e=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[a,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Image",props:{y:0,x:0,skin:"fishxy/animation/gun/normal/room1/bullet_2.png",rotation:90,anchorY:.5,anchorX:.5},compId:3},{type:"Image",props:{y:0,x:32,width:28,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:28,anchorY:.5,anchorX:.5},compId:10}],loadList:["fishxy/animation/gun/normal/room1/bullet_2.png","fishxy/animation/fish/img_collider.png"],loadList3D:[]},n.bgxyby_bullet_2UI=e,t("ui.fishxy.animation.bullet.bgxyby_bullet_2UI",e),(e=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[a,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Image",props:{y:0,x:0,skin:"fishxy/animation/gun/normal/room1/bullet_3.png",rotation:90,anchorY:.5,anchorX:.5},compId:3},{type:"Image",props:{y:0,x:27,width:28,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:28,anchorY:.5,anchorX:.5},compId:10}],loadList:["fishxy/animation/gun/normal/room1/bullet_3.png","fishxy/animation/fish/img_collider.png"],loadList3D:[]},n.bgxyby_bullet_3UI=e,t("ui.fishxy.animation.bullet.bgxyby_bullet_3UI",e),(e=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[a,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Image",props:{y:0,x:0,skin:"fishxy/animation/gun/normal/room2/bullet_4.png",rotation:90,anchorY:.5,anchorX:.5},compId:3},{type:"Image",props:{y:0,x:28.5,width:39,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:39,anchorY:.5,anchorX:.5},compId:10}],loadList:["fishxy/animation/gun/normal/room2/bullet_4.png","fishxy/animation/fish/img_collider.png"],loadList3D:[]},n.bgxyby_bullet_4UI=e,t("ui.fishxy.animation.bullet.bgxyby_bullet_4UI",e),(e=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[a,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Image",props:{y:0,x:0,skin:"fishxy/animation/gun/normal/room2/bullet_5.png",rotation:90,anchorY:.5,anchorX:.5},compId:3},{type:"Image",props:{y:0,x:28.5,width:40,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:40,anchorY:.5,anchorX:.5},compId:10}],loadList:["fishxy/animation/gun/normal/room2/bullet_5.png","fishxy/animation/fish/img_collider.png"],loadList3D:[]},n.bgxyby_bullet_5UI=e,t("ui.fishxy.animation.bullet.bgxyby_bullet_5UI",e),(e=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[a,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Image",props:{y:0,x:0,skin:"fishxy/animation/gun/normal/room2/bullet_6.png",rotation:90,anchorY:.5,anchorX:.5},compId:3},{type:"Image",props:{y:0,x:19,width:43,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:43,anchorY:.5,anchorX:.5},compId:10}],loadList:["fishxy/animation/gun/normal/room2/bullet_6.png","fishxy/animation/fish/img_collider.png"],loadList3D:[]},n.bgxyby_bullet_6UI=e,t("ui.fishxy.animation.bullet.bgxyby_bullet_6UI",e),(e=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[a,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Image",props:{y:0,x:0,skin:"fishxy/animation/gun/normal/room3/bullet_7.png",rotation:90,anchorY:.5,anchorX:.5},compId:3},{type:"Image",props:{y:0,x:32,width:40,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:40,anchorY:.5,anchorX:.5},compId:10}],loadList:["fishxy/animation/gun/normal/room3/bullet_7.png","fishxy/animation/fish/img_collider.png"],loadList3D:[]},n.bgxyby_bullet_7UI=e,t("ui.fishxy.animation.bullet.bgxyby_bullet_7UI",e),(e=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[a,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Image",props:{y:0,x:0,skin:"fishxy/animation/gun/normal/room3/bullet_8.png",rotation:90,anchorY:.5,anchorX:.5},compId:3},{type:"Image",props:{y:0,x:32,width:48,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:48,anchorY:.5,anchorX:.5},compId:10}],loadList:["fishxy/animation/gun/normal/room3/bullet_8.png","fishxy/animation/fish/img_collider.png"],loadList3D:[]},n.bgxyby_bullet_8UI=e,t("ui.fishxy.animation.bullet.bgxyby_bullet_8UI",e),(e=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[a,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Image",props:{y:0,x:0,skin:"fishxy/animation/gun/normal/room3/bullet_9.png",rotation:90,anchorY:.5,anchorX:.5},compId:3},{type:"Image",props:{y:0,x:29,width:36,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:36,anchorY:.5,anchorX:.5},compId:10}],loadList:["fishxy/animation/gun/normal/room3/bullet_9.png","fishxy/animation/fish/img_collider.png"],loadList3D:[]},n.bgxyby_bullet_9UI=e,t("ui.fishxy.animation.bullet.bgxyby_bullet_9UI",e),(e=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,h,N],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Image",props:{skin:"fishxy/animation/gun/normal/net/img_net1.png",anchorY:.5,anchorX:.5},compId:3},{type:"Sprite",props:{y:-100,x:-100,texture:"fishxy/animation/gun/normal/net/bubble_01.png"},compId:4}],animations:[{nodes:[{target:4,keyframes:{texture:[{value:"fishxy/animation/gun/normal/net/bubble_01.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:0},{value:"fishxy/animation/gun/normal/net/bubble_02.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:1},{value:"fishxy/animation/gun/normal/net/bubble_03.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:2},{value:"fishxy/animation/gun/normal/net/bubble_04.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:3},{value:"fishxy/animation/gun/normal/net/bubble_05.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:4},{value:"fishxy/animation/gun/normal/net/bubble_06.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:5},{value:"fishxy/animation/gun/normal/net/bubble_07.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:6},{value:"fishxy/animation/gun/normal/net/bubble_08.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:7},{value:"fishxy/animation/gun/normal/net/bubble_09.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:8},{value:"fishxy/animation/gun/normal/net/bubble_10.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:9},{value:"fishxy/animation/gun/normal/net/bubble_11.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:10},{value:"fishxy/animation/gun/normal/net/bubble_12.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:11}]}},{target:3,keyframes:{scaleY:[{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"scaleY",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:3,key:"scaleY",index:3}],scaleX:[{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"scaleX",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:3,key:"scaleX",index:3}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:3,key:"alpha",index:3},{value:1,tweenMethod:"linearNone",tween:!0,target:3,key:"alpha",index:8},{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"alpha",index:11}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/gun/normal/net/img_net1.png","fishxy/animation/gun/normal/net/bubble_01.png","fishxy/animation/gun/normal/net/bubble_02.png","fishxy/animation/gun/normal/net/bubble_03.png","fishxy/animation/gun/normal/net/bubble_04.png","fishxy/animation/gun/normal/net/bubble_05.png","fishxy/animation/gun/normal/net/bubble_06.png","fishxy/animation/gun/normal/net/bubble_07.png","fishxy/animation/gun/normal/net/bubble_08.png","fishxy/animation/gun/normal/net/bubble_09.png","fishxy/animation/gun/normal/net/bubble_10.png","fishxy/animation/gun/normal/net/bubble_11.png","fishxy/animation/gun/normal/net/bubble_12.png"],loadList3D:[]},n.bgxyby_net_1UI=e,t("ui.fishxy.animation.bullet.bgxyby_net_1UI",e),(e=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:0,x:0,width:260,texture:"fishxy/animation/gun/jgb/Gold hoop-Blow01.png",pivotY:137,pivotX:130,height:274},compId:3}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/gun/jgb/Gold hoop-Blow01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/gun/jgb/Gold hoop-Blow02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/gun/jgb/Gold hoop-Blow03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/gun/jgb/Gold hoop-Blow04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/gun/jgb/Gold hoop-Blow05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/gun/jgb/Gold hoop-Blow06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10},{value:"fishxy/animation/gun/jgb/Gold hoop-Blow07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:12},{value:"fishxy/animation/gun/jgb/Gold hoop-Blow08.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:14},{value:"fishxy/animation/gun/jgb/Gold hoop-Blow09.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:16},{value:"fishxy/animation/gun/jgb/Gold hoop-Blow10.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:18},{value:"fishxy/animation/gun/jgb/Gold hoop-Blow11.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:20},{value:"fishxy/animation/gun/jgb/Gold hoop-Blow12.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:22}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/gun/jgb/Gold hoop-Blow01.png","fishxy/animation/gun/jgb/Gold hoop-Blow02.png","fishxy/animation/gun/jgb/Gold hoop-Blow03.png","fishxy/animation/gun/jgb/Gold hoop-Blow04.png","fishxy/animation/gun/jgb/Gold hoop-Blow05.png","fishxy/animation/gun/jgb/Gold hoop-Blow06.png","fishxy/animation/gun/jgb/Gold hoop-Blow07.png","fishxy/animation/gun/jgb/Gold hoop-Blow08.png","fishxy/animation/gun/jgb/Gold hoop-Blow09.png","fishxy/animation/gun/jgb/Gold hoop-Blow10.png","fishxy/animation/gun/jgb/Gold hoop-Blow11.png","fishxy/animation/gun/jgb/Gold hoop-Blow12.png"],loadList3D:[]},n.bgxyby_net_13UI=e,t("ui.fishxy.animation.bullet.bgxyby_net_13UI",e),(e=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,h,N],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Image",props:{skin:"fishxy/animation/gun/xmsb/net/fish_Suffer_roll.png",anchorY:.5,anchorX:.5},compId:3},{type:"Sprite",props:{y:-363,x:-235,texture:"fishxy/animation/gun/xmsb/net/water_explode01.png"},compId:4}],animations:[{nodes:[{target:3,keyframes:{rotation:[{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"rotation",index:0},{value:360,tweenMethod:"linearNone",tween:!0,target:3,key:"rotation",index:24}],alpha:[{value:.5,tweenMethod:"linearNone",tween:!0,target:3,key:"alpha",index:0}]}},{target:4,keyframes:{texture:[{value:"fishxy/animation/gun/xmsb/net/water_explode01.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:0},{value:"fishxy/animation/gun/xmsb/net/water_explode02.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:2},{value:"fishxy/animation/gun/xmsb/net/water_explode03.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:4},{value:"fishxy/animation/gun/xmsb/net/water_explode04.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:6},{value:"fishxy/animation/gun/xmsb/net/water_explode05.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:8},{value:"fishxy/animation/gun/xmsb/net/water_explode06.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:10},{value:"fishxy/animation/gun/xmsb/net/water_explode07.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:12},{value:"fishxy/animation/gun/xmsb/net/water_explode08.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:14},{value:"fishxy/animation/gun/xmsb/net/water_explode09.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:16},{value:"fishxy/animation/gun/xmsb/net/water_explode10.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:18},{value:"fishxy/animation/gun/xmsb/net/water_explode11.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:20},{value:"fishxy/animation/gun/xmsb/net/water_explode12.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:22},{value:"fishxy/animation/gun/xmsb/net/water_explode12.png",tweenMethod:"linearNone",tween:!1,target:4,label:null,key:"texture",index:24}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:4,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:4,key:"alpha",index:22},{value:0,tweenMethod:"linearNone",tween:!0,target:4,key:"alpha",index:24}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/gun/xmsb/net/fish_Suffer_roll.png","fishxy/animation/gun/xmsb/net/water_explode01.png","fishxy/animation/gun/xmsb/net/water_explode02.png","fishxy/animation/gun/xmsb/net/water_explode03.png","fishxy/animation/gun/xmsb/net/water_explode04.png","fishxy/animation/gun/xmsb/net/water_explode05.png","fishxy/animation/gun/xmsb/net/water_explode06.png","fishxy/animation/gun/xmsb/net/water_explode07.png","fishxy/animation/gun/xmsb/net/water_explode08.png","fishxy/animation/gun/xmsb/net/water_explode09.png","fishxy/animation/gun/xmsb/net/water_explode10.png","fishxy/animation/gun/xmsb/net/water_explode11.png","fishxy/animation/gun/xmsb/net/water_explode12.png"],loadList3D:[]},n.bgxyby_net_14UI=e,t("ui.fishxy.animation.bullet.bgxyby_net_14UI",e),(e=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-366,x:-235,texture:"fishxy/animation/gun/jclj/net/Explosive light1-01.png"},compId:3},{type:"Sprite",props:{y:-340,x:-325,texture:"fishxy/animation/gun/jclj/net/Explosive light2-01.png"},compId:4}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/gun/jclj/net/Explosive light1-01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/gun/jclj/net/Explosive light1-01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/gun/jclj/net/Explosive light1-02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10},{value:"fishxy/animation/gun/jclj/net/Explosive light1-03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:12},{value:"fishxy/animation/gun/jclj/net/Explosive light1-04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:14},{value:"fishxy/animation/gun/jclj/net/Explosive light1-05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:16},{value:"fishxy/animation/gun/jclj/net/Explosive light1-06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:18},{value:"fishxy/animation/gun/jclj/net/Explosive light1-07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:20},{value:"fishxy/animation/gun/jclj/net/Explosive light1-08.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:22},{value:"fishxy/animation/gun/jclj/net/Explosive light1-09.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:24},{value:"fishxy/animation/gun/jclj/net/Explosive light1-10.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:26},{value:"fishxy/animation/gun/jclj/net/Explosive light1-11.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:28},{value:"fishxy/animation/gun/jclj/net/Explosive light1-12.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:30},{value:"fishxy/animation/gun/jclj/net/Explosive light1-12.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:32}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:3,key:"alpha",index:6},{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"alpha",index:32}]}},{target:4,keyframes:{texture:[{value:"fishxy/animation/gun/jclj/net/Explosive light2-01.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:0},{value:"fishxy/animation/gun/jclj/net/Explosive light2-02.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:2},{value:"fishxy/animation/gun/jclj/net/Explosive light2-03.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:4},{value:"fishxy/animation/gun/jclj/net/Explosive light2-04.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:6},{value:"fishxy/animation/gun/jclj/net/Explosive light2-05.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:8},{value:"fishxy/animation/gun/jclj/net/Explosive light2-06.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:10},{value:"fishxy/animation/gun/jclj/net/Explosive light2-07.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:12},{value:"fishxy/animation/gun/jclj/net/Explosive light2-08.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:14},{value:"fishxy/animation/gun/jclj/net/Explosive light2-09.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:16},{value:"fishxy/animation/gun/jclj/net/Explosive light2-09.png",tweenMethod:"linearNone",tween:!1,target:4,label:null,key:"texture",index:18}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:4,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:4,key:"alpha",index:18}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/gun/jclj/net/Explosive light1-01.png","fishxy/animation/gun/jclj/net/Explosive light2-01.png","fishxy/animation/gun/jclj/net/Explosive light1-02.png","fishxy/animation/gun/jclj/net/Explosive light1-03.png","fishxy/animation/gun/jclj/net/Explosive light1-04.png","fishxy/animation/gun/jclj/net/Explosive light1-05.png","fishxy/animation/gun/jclj/net/Explosive light1-06.png","fishxy/animation/gun/jclj/net/Explosive light1-07.png","fishxy/animation/gun/jclj/net/Explosive light1-08.png","fishxy/animation/gun/jclj/net/Explosive light1-09.png","fishxy/animation/gun/jclj/net/Explosive light1-10.png","fishxy/animation/gun/jclj/net/Explosive light1-11.png","fishxy/animation/gun/jclj/net/Explosive light1-12.png","fishxy/animation/gun/jclj/net/Explosive light2-02.png","fishxy/animation/gun/jclj/net/Explosive light2-03.png","fishxy/animation/gun/jclj/net/Explosive light2-04.png","fishxy/animation/gun/jclj/net/Explosive light2-05.png","fishxy/animation/gun/jclj/net/Explosive light2-06.png","fishxy/animation/gun/jclj/net/Explosive light2-07.png","fishxy/animation/gun/jclj/net/Explosive light2-08.png","fishxy/animation/gun/jclj/net/Explosive light2-09.png"],loadList3D:[]},n.bgxyby_net_16UI=e,t("ui.fishxy.animation.bullet.bgxyby_net_16UI",e),(e=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,h,N],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Image",props:{skin:"fishxy/animation/gun/normal/net/img_net2.png",anchorY:.5,anchorX:.5},compId:3},{type:"Sprite",props:{y:-100,x:-100,texture:"fishxy/animation/gun/normal/net/bubble_01.png"},compId:4}],animations:[{nodes:[{target:4,keyframes:{texture:[{value:"fishxy/animation/gun/normal/net/bubble_01.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:0},{value:"fishxy/animation/gun/normal/net/bubble_02.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:1},{value:"fishxy/animation/gun/normal/net/bubble_03.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:2},{value:"fishxy/animation/gun/normal/net/bubble_04.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:3},{value:"fishxy/animation/gun/normal/net/bubble_05.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:4},{value:"fishxy/animation/gun/normal/net/bubble_06.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:5},{value:"fishxy/animation/gun/normal/net/bubble_07.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:6},{value:"fishxy/animation/gun/normal/net/bubble_08.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:7},{value:"fishxy/animation/gun/normal/net/bubble_09.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:8},{value:"fishxy/animation/gun/normal/net/bubble_10.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:9},{value:"fishxy/animation/gun/normal/net/bubble_11.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:10},{value:"fishxy/animation/gun/normal/net/bubble_12.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:11}]}},{target:3,keyframes:{scaleY:[{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"scaleY",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:3,key:"scaleY",index:3}],scaleX:[{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"scaleX",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:3,key:"scaleX",index:3}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:3,key:"alpha",index:3},{value:1,tweenMethod:"linearNone",tween:!0,target:3,key:"alpha",index:8},{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"alpha",index:11}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/gun/normal/net/img_net2.png","fishxy/animation/gun/normal/net/bubble_01.png","fishxy/animation/gun/normal/net/bubble_02.png","fishxy/animation/gun/normal/net/bubble_03.png","fishxy/animation/gun/normal/net/bubble_04.png","fishxy/animation/gun/normal/net/bubble_05.png","fishxy/animation/gun/normal/net/bubble_06.png","fishxy/animation/gun/normal/net/bubble_07.png","fishxy/animation/gun/normal/net/bubble_08.png","fishxy/animation/gun/normal/net/bubble_09.png","fishxy/animation/gun/normal/net/bubble_10.png","fishxy/animation/gun/normal/net/bubble_11.png","fishxy/animation/gun/normal/net/bubble_12.png"],loadList3D:[]},n.bgxyby_net_2UI=e,t("ui.fishxy.animation.bullet.bgxyby_net_2UI",e),(e=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,h,N],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Image",props:{skin:"fishxy/animation/gun/normal/net/img_net3.png",scaleY:1,scaleX:1,anchorY:.5,anchorX:.5,alpha:1},compId:3},{type:"Sprite",props:{y:-100,x:-100,texture:"fishxy/animation/gun/normal/net/bubble_08.png"},compId:4}],animations:[{nodes:[{target:4,keyframes:{texture:[{value:"fishxy/animation/gun/normal/net/bubble_01.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:0},{value:"fishxy/animation/gun/normal/net/bubble_02.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:1},{value:"fishxy/animation/gun/normal/net/bubble_03.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:2},{value:"fishxy/animation/gun/normal/net/bubble_04.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:3},{value:"fishxy/animation/gun/normal/net/bubble_05.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:4},{value:"fishxy/animation/gun/normal/net/bubble_06.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:5},{value:"fishxy/animation/gun/normal/net/bubble_07.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:6},{value:"fishxy/animation/gun/normal/net/bubble_08.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:7},{value:"fishxy/animation/gun/normal/net/bubble_09.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:8},{value:"fishxy/animation/gun/normal/net/bubble_10.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:9},{value:"fishxy/animation/gun/normal/net/bubble_11.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:10},{value:"fishxy/animation/gun/normal/net/bubble_12.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:11}]}},{target:3,keyframes:{scaleY:[{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"scaleY",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:3,key:"scaleY",index:3}],scaleX:[{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"scaleX",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:3,key:"scaleX",index:3}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:3,key:"alpha",index:3},{value:1,tweenMethod:"linearNone",tween:!0,target:3,key:"alpha",index:8},{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"alpha",index:11}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/gun/normal/net/img_net3.png","fishxy/animation/gun/normal/net/bubble_08.png","fishxy/animation/gun/normal/net/bubble_01.png","fishxy/animation/gun/normal/net/bubble_02.png","fishxy/animation/gun/normal/net/bubble_03.png","fishxy/animation/gun/normal/net/bubble_04.png","fishxy/animation/gun/normal/net/bubble_05.png","fishxy/animation/gun/normal/net/bubble_06.png","fishxy/animation/gun/normal/net/bubble_07.png","fishxy/animation/gun/normal/net/bubble_09.png","fishxy/animation/gun/normal/net/bubble_10.png","fishxy/animation/gun/normal/net/bubble_11.png","fishxy/animation/gun/normal/net/bubble_12.png"],loadList3D:[]},n.bgxyby_net_3UI=e,t("ui.fishxy.animation.bullet.bgxyby_net_3UI",e),i=(i=(i=(i=Ki=Ki||{}).fishxy||(i.fishxy={})).animation||(i.animation={})).fish||(i.fish={}),(n=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-32,x:-41,texture:"fishxy/animation/fish/fish00_00.png"},compId:3},{type:"Image",props:{y:0,x:11,width:47,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:47,anchorY:.5,anchorX:.5},compId:25}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/fish/fish00_00.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/fish/fish00_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/fish/fish00_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/fish/fish00_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/fish/fish00_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/fish/fish00_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10},{value:"fishxy/animation/fish/fish00_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:12},{value:"fishxy/animation/fish/fish00_07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:14}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/fish/fish00_00.png","fishxy/animation/fish/img_collider.png","fishxy/animation/fish/fish00_01.png","fishxy/animation/fish/fish00_02.png","fishxy/animation/fish/fish00_03.png","fishxy/animation/fish/fish00_04.png","fishxy/animation/fish/fish00_05.png","fishxy/animation/fish/fish00_06.png","fishxy/animation/fish/fish00_07.png"],loadList3D:[]},i.YU001UI=n,t("ui.fishxy.animation.fish.YU001UI",n),(n=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-30,x:-40,texture:"fishxy/animation/fish/fish01_00.png"},compId:3},{type:"Image",props:{y:0,x:4,width:48,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:48,anchorY:.5,anchorX:.5},compId:10}],animations:[{nodes:[{target:3,keyframes:{y:[{value:-30,tweenMethod:"linearNone",tween:!0,target:3,key:"y",index:0}],x:[{value:-40,tweenMethod:"linearNone",tween:!0,target:3,key:"x",index:0}],width:[{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"width",index:0}],texture:[{value:"fishxy/animation/fish/fish01_00.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/fish/fish01_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/fish/fish01_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/fish/fish01_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/fish/fish01_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/fish/fish01_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10},{value:"fishxy/animation/fish/fish01_07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:12},{value:"fishxy/animation/fish/fish01_08.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:14}],pivotY:[{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"pivotY",index:0}],pivotX:[{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"pivotX",index:0}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/fish/fish01_00.png","fishxy/animation/fish/img_collider.png","fishxy/animation/fish/fish01_02.png","fishxy/animation/fish/fish01_03.png","fishxy/animation/fish/fish01_04.png","fishxy/animation/fish/fish01_05.png","fishxy/animation/fish/fish01_06.png","fishxy/animation/fish/fish01_07.png","fishxy/animation/fish/fish01_08.png"],loadList3D:[]},i.YU002UI=n,t("ui.fishxy.animation.fish.YU002UI",n),(n=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-33,x:-39,texture:"fishxy/animation/fish/fish02_00.png"},compId:4},{type:"Image",props:{y:0,x:10,width:52,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:52,anchorY:.5,anchorX:.5},compId:10}],animations:[{nodes:[{target:4,keyframes:{texture:[{value:"fishxy/animation/fish/fish02_00.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:0},{value:"fishxy/animation/fish/fish02_01.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:2},{value:"fishxy/animation/fish/fish02_02.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:4},{value:"fishxy/animation/fish/fish02_03.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:6},{value:"fishxy/animation/fish/fish02_04.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:8},{value:"fishxy/animation/fish/fish02_05.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:10},{value:"fishxy/animation/fish/fish02_07.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:12}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/fish/fish02_00.png","fishxy/animation/fish/img_collider.png","fishxy/animation/fish/fish02_01.png","fishxy/animation/fish/fish02_02.png","fishxy/animation/fish/fish02_03.png","fishxy/animation/fish/fish02_04.png","fishxy/animation/fish/fish02_05.png","fishxy/animation/fish/fish02_07.png"],loadList3D:[]},i.YU003UI=n,t("ui.fishxy.animation.fish.YU003UI",n),(n=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-50,x:-50,texture:"fishxy/animation/fish/fish03_00.png"},compId:3},{type:"Image",props:{y:0,x:4,width:76,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:76,anchorY:.5,anchorX:.5},compId:8}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/fish/fish03_00.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/fish/fish03_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/fish/fish03_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/fish/fish03_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/fish/fish03_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/fish/fish03_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10},{value:"fishxy/animation/fish/fish03_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:12}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/fish/fish03_00.png","fishxy/animation/fish/img_collider.png","fishxy/animation/fish/fish03_01.png","fishxy/animation/fish/fish03_02.png","fishxy/animation/fish/fish03_03.png","fishxy/animation/fish/fish03_04.png","fishxy/animation/fish/fish03_05.png","fishxy/animation/fish/fish03_06.png"],loadList3D:[]},i.YU004UI=n,t("ui.fishxy.animation.fish.YU004UI",n),(n=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-40,x:-70,texture:"fishxy/animation/fish/fish04_00.png"},compId:3},{type:"Image",props:{y:5,x:17,width:57,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:57,anchorY:.5,anchorX:.5},compId:9}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/fish/fish04_00.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/fish/fish04_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/fish/fish04_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/fish/fish04_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/fish/fish04_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/fish/fish04_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10},{value:"fishxy/animation/fish/fish04_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:12},{value:"fishxy/animation/fish/fish04_07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:14},{value:"fishxy/animation/fish/fish04_08.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:16},{value:"fishxy/animation/fish/fish04_09.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:18}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/fish/fish04_00.png","fishxy/animation/fish/img_collider.png","fishxy/animation/fish/fish04_01.png","fishxy/animation/fish/fish04_02.png","fishxy/animation/fish/fish04_03.png","fishxy/animation/fish/fish04_04.png","fishxy/animation/fish/fish04_05.png","fishxy/animation/fish/fish04_06.png","fishxy/animation/fish/fish04_07.png","fishxy/animation/fish/fish04_08.png","fishxy/animation/fish/fish04_09.png"],loadList3D:[]},i.YU005UI=n,t("ui.fishxy.animation.fish.YU005UI",n),(n=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-50,x:-100,texture:"fishxy/animation/fish/fish05_03.png"},compId:3},{type:"Image",props:{y:-9,x:0,width:56,visible:!1,skin:"fishxy/animation/fish/img_collider.png",pivotY:28,pivotX:28,name:"collider",height:56},compId:6}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/fish/fish05_00.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/fish/fish05_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/fish/fish05_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/fish/fish05_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/fish/fish05_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/fish/fish05_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10},{value:"fishxy/animation/fish/fish05_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:12},{value:"fishxy/animation/fish/fish05_07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:14}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/fish/fish05_03.png","fishxy/animation/fish/img_collider.png","fishxy/animation/fish/fish05_00.png","fishxy/animation/fish/fish05_01.png","fishxy/animation/fish/fish05_02.png","fishxy/animation/fish/fish05_04.png","fishxy/animation/fish/fish05_05.png","fishxy/animation/fish/fish05_06.png","fishxy/animation/fish/fish05_07.png"],loadList3D:[]},i.YU006UI=n,t("ui.fishxy.animation.fish.YU006UI",n),(n=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-30,x:-50,texture:"fishxy/animation/fish/fish06_00.png"},compId:3},{type:"Image",props:{y:0,x:12,width:61,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:61,anchorY:.5,anchorX:.5},compId:5}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/fish/fish06_00.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/fish/fish06_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/fish/fish06_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/fish/fish06_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/fish/fish06_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/fish/fish06_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10},{value:"fishxy/animation/fish/fish06_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:12},{value:"fishxy/animation/fish/fish06_07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:14},{value:"fishxy/animation/fish/fish06_08.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:16},{value:"fishxy/animation/fish/fish06_09.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:18}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/fish/fish06_00.png","fishxy/animation/fish/img_collider.png","fishxy/animation/fish/fish06_01.png","fishxy/animation/fish/fish06_02.png","fishxy/animation/fish/fish06_03.png","fishxy/animation/fish/fish06_04.png","fishxy/animation/fish/fish06_05.png","fishxy/animation/fish/fish06_06.png","fishxy/animation/fish/fish06_07.png","fishxy/animation/fish/fish06_08.png","fishxy/animation/fish/fish06_09.png"],loadList3D:[]},i.YU007UI=n,t("ui.fishxy.animation.fish.YU007UI",n),(n=function(){f(i,cn);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,N,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"Scene",props:{},compId:2,child:[{type:"Sprite",props:{y:-40,x:-50,texture:"fishxy/animation/fish/fish07_00.png"},compId:3},{type:"Image",props:{y:0,x:0,width:58,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:58,anchorY:.5,anchorX:.5},compId:7}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/fish/fish07_00.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/fish/fish07_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/fish/fish07_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/fish/fish07_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/fish/fish07_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/fish/fish07_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10},{value:"fishxy/animation/fish/fish07_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:12},{value:"fishxy/animation/fish/fish07_07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:14},{value:"fishxy/animation/fish/fish07_08.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:16},{value:"fishxy/animation/fish/fish07_09.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:18}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/fish/fish07_00.png","fishxy/animation/fish/img_collider.png","fishxy/animation/fish/fish07_01.png","fishxy/animation/fish/fish07_02.png","fishxy/animation/fish/fish07_03.png","fishxy/animation/fish/fish07_04.png","fishxy/animation/fish/fish07_05.png","fishxy/animation/fish/fish07_06.png","fishxy/animation/fish/fish07_07.png","fishxy/animation/fish/fish07_08.png","fishxy/animation/fish/fish07_09.png"],loadList3D:[]},i.YU008UI=n,t("ui.fishxy.animation.fish.YU008UI",n),(n=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-63,x:-38,texture:"fishxy/animation/fish/fish08_00.png"},compId:3},{type:"Image",props:{y:3,x:0,width:88,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:88,anchorY:.5,anchorX:.5},compId:8}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/fish/fish08_00.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/fish/fish08_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/fish/fish08_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/fish/fish08_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/fish/fish08_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/fish/fish08_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/fish/fish08_00.png","fishxy/animation/fish/img_collider.png","fishxy/animation/fish/fish08_01.png","fishxy/animation/fish/fish08_02.png","fishxy/animation/fish/fish08_03.png","fishxy/animation/fish/fish08_04.png","fishxy/animation/fish/fish08_05.png"],loadList3D:[]},i.YU009UI=n,t("ui.fishxy.animation.fish.YU009UI",n),(n=function(){f(i,cn);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,N,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"Scene",props:{},compId:2,child:[{type:"Sprite",props:{y:-40,x:-50,texture:"fishxy/animation/fish/fish09_00.png"},compId:3},{type:"Image",props:{y:2,x:12,width:62,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:62,anchorY:.5,anchorX:.5},compId:5}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/fish/fish09_00.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/fish/fish09_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/fish/fish09_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/fish/fish09_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/fish/fish09_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/fish/fish09_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10},{value:"fishxy/animation/fish/fish09_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:12},{value:"fishxy/animation/fish/fish09_07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:14},{value:"fishxy/animation/fish/fish09_08.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:16},{value:"fishxy/animation/fish/fish09_09.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:18},{value:"fishxy/animation/fish/fish09_10.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:20},{value:"fishxy/animation/fish/fish09_11.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:22}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/fish/fish09_00.png","fishxy/animation/fish/img_collider.png","fishxy/animation/fish/fish09_01.png","fishxy/animation/fish/fish09_02.png","fishxy/animation/fish/fish09_03.png","fishxy/animation/fish/fish09_04.png","fishxy/animation/fish/fish09_05.png","fishxy/animation/fish/fish09_06.png","fishxy/animation/fish/fish09_07.png","fishxy/animation/fish/fish09_08.png","fishxy/animation/fish/fish09_09.png","fishxy/animation/fish/fish09_10.png","fishxy/animation/fish/fish09_11.png"],loadList3D:[]},i.YU010UI=n,t("ui.fishxy.animation.fish.YU010UI",n),(n=function(){f(i,cn);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,N,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"Scene",props:{},compId:2,child:[{type:"Sprite",props:{y:-70,x:-98,texture:"fishxy/animation/fish/fish10_00.png"},compId:3},{type:"Image",props:{y:11,x:0,width:102,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:102,anchorY:.5,anchorX:.5},compId:5}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/fish/fish10_00.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/fish/fish10_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/fish/fish10_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/fish/fish10_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/fish/fish10_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/fish/fish10_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10},{value:"fishxy/animation/fish/fish10_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:12},{value:"fishxy/animation/fish/fish10_07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:14}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/fish/fish10_00.png","fishxy/animation/fish/img_collider.png","fishxy/animation/fish/fish10_01.png","fishxy/animation/fish/fish10_02.png","fishxy/animation/fish/fish10_03.png","fishxy/animation/fish/fish10_04.png","fishxy/animation/fish/fish10_05.png","fishxy/animation/fish/fish10_06.png","fishxy/animation/fish/fish10_07.png"],loadList3D:[]},i.YU011UI=n,t("ui.fishxy.animation.fish.YU011UI",n),(n=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-50,x:-100,texture:"fishxy/animation/fish/fish11_00.png"},compId:3},{type:"Sprite",props:{y:-30.5,x:19.5,visible:!1,name:"collider"},compId:6,child:[{type:"Image",props:{y:31,x:-17.25,width:73,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:73,anchorY:.5,anchorX:.5},compId:8},{type:"Image",props:{y:31,x:28,width:73,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:73,anchorY:.5,anchorX:.5},compId:5},{type:"Image",props:{y:32,x:-74,width:74,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:74,anchorY:.5,anchorX:.5},compId:7}]}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/fish/fish11_00.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/fish/fish11_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/fish/fish11_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/fish/fish11_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/fish/fish11_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/fish/fish11_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10},{value:"fishxy/animation/fish/fish11_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:12},{value:"fishxy/animation/fish/fish11_07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:14}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/fish/fish11_00.png","fishxy/animation/fish/img_collider.png","fishxy/animation/fish/fish11_01.png","fishxy/animation/fish/fish11_02.png","fishxy/animation/fish/fish11_03.png","fishxy/animation/fish/fish11_04.png","fishxy/animation/fish/fish11_05.png","fishxy/animation/fish/fish11_06.png","fishxy/animation/fish/fish11_07.png"],loadList3D:[]},i.YU012UI=n,t("ui.fishxy.animation.fish.YU012UI",n),(n=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-60,x:-80,texture:"fishxy/animation/fish/fish12_00.png"},compId:3},{type:"Image",props:{y:9,x:0,width:90,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:90,anchorY:.5,anchorX:.5},compId:5}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/fish/fish12_00.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/fish/fish12_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/fish/fish12_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/fish/fish12_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/fish/fish12_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/fish/fish12_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10},{value:"fishxy/animation/fish/fish12_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:12},{value:"fishxy/animation/fish/fish12_07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:14},{value:"fishxy/animation/fish/fish12_08.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:16},{value:"fishxy/animation/fish/fish12_09.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:18},{value:"fishxy/animation/fish/fish12_10.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:20},{value:"fishxy/animation/fish/fish12_11.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:22},{value:"fishxy/animation/fish/fish12_12.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:24},{value:"fishxy/animation/fish/fish12_13.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:26},{value:"fishxy/animation/fish/fish12_14.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:28}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/fish/fish12_00.png","fishxy/animation/fish/img_collider.png","fishxy/animation/fish/fish12_01.png","fishxy/animation/fish/fish12_02.png","fishxy/animation/fish/fish12_03.png","fishxy/animation/fish/fish12_04.png","fishxy/animation/fish/fish12_05.png","fishxy/animation/fish/fish12_06.png","fishxy/animation/fish/fish12_07.png","fishxy/animation/fish/fish12_08.png","fishxy/animation/fish/fish12_09.png","fishxy/animation/fish/fish12_10.png","fishxy/animation/fish/fish12_11.png","fishxy/animation/fish/fish12_12.png","fishxy/animation/fish/fish12_13.png","fishxy/animation/fish/fish12_14.png"],loadList3D:[]},i.YU013UI=n,t("ui.fishxy.animation.fish.YU013UI",n),(n=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-100,x:-80,texture:"fishxy/animation/fish/fish13_00.png"},compId:3},{type:"Image",props:{y:4,x:-7,width:99,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:99,anchorY:.5,anchorX:.5},compId:5}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/fish/fish13_00.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/fish/fish13_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/fish/fish13_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/fish/fish13_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/fish/fish13_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/fish/fish13_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10},{value:"fishxy/animation/fish/fish13_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:12},{value:"fishxy/animation/fish/fish13_07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:14},{value:"fishxy/animation/fish/fish13_08.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:16},{value:"fishxy/animation/fish/fish13_09.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:18},{value:"fishxy/animation/fish/fish13_10.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:20},{value:"fishxy/animation/fish/fish13_11.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:22}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/fish/fish13_00.png","fishxy/animation/fish/img_collider.png","fishxy/animation/fish/fish13_01.png","fishxy/animation/fish/fish13_02.png","fishxy/animation/fish/fish13_03.png","fishxy/animation/fish/fish13_04.png","fishxy/animation/fish/fish13_05.png","fishxy/animation/fish/fish13_06.png","fishxy/animation/fish/fish13_07.png","fishxy/animation/fish/fish13_08.png","fishxy/animation/fish/fish13_09.png","fishxy/animation/fish/fish13_10.png","fishxy/animation/fish/fish13_11.png"],loadList3D:[]},i.YU014UI=n,t("ui.fishxy.animation.fish.YU014UI",n),(n=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-79,x:-82,texture:"fishxy/animation/fish/fish14_00.png"},compId:3},{type:"Image",props:{y:0,x:11,width:138,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:138,anchorY:.5,anchorX:.5},compId:5}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/fish/fish14_00.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/fish/fish14_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/fish/fish14_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/fish/fish14_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/fish/fish14_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/fish/fish14_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10},{value:"fishxy/animation/fish/fish14_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:12},{value:"fishxy/animation/fish/fish14_07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:14},{value:"fishxy/animation/fish/fish14_08.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:16},{value:"fishxy/animation/fish/fish14_09.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:18},{value:"fishxy/animation/fish/fish14_10.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:20},{value:"fishxy/animation/fish/fish14_11.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:22},{value:"fishxy/animation/fish/fish14_12.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:24},{value:"fishxy/animation/fish/fish14_13.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:26},{value:"fishxy/animation/fish/fish14_14.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:28}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/fish/fish14_00.png","fishxy/animation/fish/img_collider.png","fishxy/animation/fish/fish14_01.png","fishxy/animation/fish/fish14_02.png","fishxy/animation/fish/fish14_03.png","fishxy/animation/fish/fish14_04.png","fishxy/animation/fish/fish14_05.png","fishxy/animation/fish/fish14_06.png","fishxy/animation/fish/fish14_07.png","fishxy/animation/fish/fish14_08.png","fishxy/animation/fish/fish14_09.png","fishxy/animation/fish/fish14_10.png","fishxy/animation/fish/fish14_11.png","fishxy/animation/fish/fish14_12.png","fishxy/animation/fish/fish14_13.png","fishxy/animation/fish/fish14_14.png"],loadList3D:[]},i.YU015UI=n,t("ui.fishxy.animation.fish.YU015UI",n),(n=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-80,x:-160,texture:"fishxy/animation/fish/fish15_00.png"},compId:3},{type:"Sprite",props:{y:-49.5,x:48.5,name:"collider"},compId:6,child:[{type:"Image",props:{y:50,x:-45,width:90,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:90,anchorY:.5,anchorX:.5},compId:7},{type:"Image",props:{y:49.5,x:49.5,width:99,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:99,anchorY:.5,anchorX:.5},compId:5},{type:"Image",props:{y:49.5,x:-120,width:59,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:59,anchorY:.5,anchorX:.5},compId:8}]}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/fish/fish15_00.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/fish/fish15_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/fish/fish15_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/fish/fish15_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/fish/fish15_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/fish/fish15_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10},{value:"fishxy/animation/fish/fish15_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:12}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/fish/fish15_00.png","fishxy/animation/fish/img_collider.png","fishxy/animation/fish/fish15_01.png","fishxy/animation/fish/fish15_02.png","fishxy/animation/fish/fish15_03.png","fishxy/animation/fish/fish15_04.png","fishxy/animation/fish/fish15_05.png","fishxy/animation/fish/fish15_06.png"],loadList3D:[]},i.YU016UI=n,t("ui.fishxy.animation.fish.YU016UI",n),(n=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-175,x:-200,texture:"fishxy/animation/fish/fish/fish16/fish16_00.png"},compId:3},{type:"Sprite",props:{y:-58,x:0,name:"collider"},compId:9,child:[{type:"Image",props:{y:41,x:-61,width:152,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:152,anchorY:.5,anchorX:.5},compId:11},{type:"Image",props:{y:49.5,x:49.5,width:99,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:99,anchorY:.5,anchorX:.5},compId:10}]}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/fish/fish/fish16/fish16_00.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/fish/fish/fish16/fish16_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/fish/fish/fish16/fish16_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/fish/fish/fish16/fish16_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/fish/fish/fish16/fish16_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/fish/fish/fish16/fish16_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10},{value:"fishxy/animation/fish/fish/fish16/fish16_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:12},{value:"fishxy/animation/fish/fish/fish16/fish16_07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:14},{value:"fishxy/animation/fish/fish/fish16/fish16_08.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:16},{value:"fishxy/animation/fish/fish/fish16/fish16_09.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:18},{value:"fishxy/animation/fish/fish/fish16/fish16_10.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:20},{value:"fishxy/animation/fish/fish/fish16/fish16_11.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:22},{value:"fishxy/animation/fish/fish/fish16/fish16_12.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:24},{value:"fishxy/animation/fish/fish/fish16/fish16_13.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:26},{value:"fishxy/animation/fish/fish/fish16/fish16_14.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:28}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/fish/fish/fish16/fish16_00.png","fishxy/animation/fish/img_collider.png","fishxy/animation/fish/fish/fish16/fish16_01.png","fishxy/animation/fish/fish/fish16/fish16_02.png","fishxy/animation/fish/fish/fish16/fish16_03.png","fishxy/animation/fish/fish/fish16/fish16_04.png","fishxy/animation/fish/fish/fish16/fish16_05.png","fishxy/animation/fish/fish/fish16/fish16_06.png","fishxy/animation/fish/fish/fish16/fish16_07.png","fishxy/animation/fish/fish/fish16/fish16_08.png","fishxy/animation/fish/fish/fish16/fish16_09.png","fishxy/animation/fish/fish/fish16/fish16_10.png","fishxy/animation/fish/fish/fish16/fish16_11.png","fishxy/animation/fish/fish/fish16/fish16_12.png","fishxy/animation/fish/fish/fish16/fish16_13.png","fishxy/animation/fish/fish/fish16/fish16_14.png"],loadList3D:[]},i.YU017UI=n,t("ui.fishxy.animation.fish.YU017UI",n),(n=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-80,x:-100,texture:"fishxy/animation/fish/fish/fish17/fish22_00.png"},compId:3},{type:"Sprite",props:{y:-44,x:-7,name:"collider"},compId:8,child:[{type:"Image",props:{y:47,x:47,width:94,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:94,anchorY:.5,anchorX:.5},compId:6},{type:"Image",props:{y:46.5,x:-25.5,width:51,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:51,anchorY:.5,anchorX:.5},compId:11}]}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/fish/fish/fish17/fish22_00.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/fish/fish/fish17/fish22_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/fish/fish/fish17/fish22_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/fish/fish/fish17/fish22_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/fish/fish/fish17/fish22_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/fish/fish/fish17/fish22_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10},{value:"fishxy/animation/fish/fish/fish17/fish22_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:12},{value:"fishxy/animation/fish/fish/fish17/fish22_07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:14},{value:"fishxy/animation/fish/fish/fish17/fish22_08.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:16},{value:"fishxy/animation/fish/fish/fish17/fish22_09.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:18},{value:"fishxy/animation/fish/fish/fish17/fish22_10.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:20},{value:"fishxy/animation/fish/fish/fish17/fish22_11.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:22},{value:"fishxy/animation/fish/fish/fish17/fish22_12.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:24},{value:"fishxy/animation/fish/fish/fish17/fish22_13.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:26},{value:"fishxy/animation/fish/fish/fish17/fish22_14.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:28},{value:"fishxy/animation/fish/fish/fish17/fish22_15.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:30},{value:"fishxy/animation/fish/fish/fish17/fish22_16.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:32},{value:"fishxy/animation/fish/fish/fish17/fish22_17.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:34},{value:"fishxy/animation/fish/fish/fish17/fish22_18.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:36},{value:"fishxy/animation/fish/fish/fish17/fish22_19.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:38},{value:"fishxy/animation/fish/fish/fish17/fish22_20.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:40},{value:"fishxy/animation/fish/fish/fish17/fish22_21.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:42},{value:"fishxy/animation/fish/fish/fish17/fish22_22.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:44},{value:"fishxy/animation/fish/fish/fish17/fish22_23.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:46},{value:"fishxy/animation/fish/fish/fish17/fish22_24.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:48}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/fish/fish/fish17/fish22_00.png","fishxy/animation/fish/img_collider.png","fishxy/animation/fish/fish/fish17/fish22_01.png","fishxy/animation/fish/fish/fish17/fish22_02.png","fishxy/animation/fish/fish/fish17/fish22_03.png","fishxy/animation/fish/fish/fish17/fish22_04.png","fishxy/animation/fish/fish/fish17/fish22_05.png","fishxy/animation/fish/fish/fish17/fish22_06.png","fishxy/animation/fish/fish/fish17/fish22_07.png","fishxy/animation/fish/fish/fish17/fish22_08.png","fishxy/animation/fish/fish/fish17/fish22_09.png","fishxy/animation/fish/fish/fish17/fish22_10.png","fishxy/animation/fish/fish/fish17/fish22_11.png","fishxy/animation/fish/fish/fish17/fish22_12.png","fishxy/animation/fish/fish/fish17/fish22_13.png","fishxy/animation/fish/fish/fish17/fish22_14.png","fishxy/animation/fish/fish/fish17/fish22_15.png","fishxy/animation/fish/fish/fish17/fish22_16.png","fishxy/animation/fish/fish/fish17/fish22_17.png","fishxy/animation/fish/fish/fish17/fish22_18.png","fishxy/animation/fish/fish/fish17/fish22_19.png","fishxy/animation/fish/fish/fish17/fish22_20.png","fishxy/animation/fish/fish/fish17/fish22_21.png","fishxy/animation/fish/fish/fish17/fish22_22.png","fishxy/animation/fish/fish/fish17/fish22_23.png","fishxy/animation/fish/fish/fish17/fish22_24.png"],loadList3D:[]},i.YU018UI=n,t("ui.fishxy.animation.fish.YU018UI",n),(n=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-100,x:-100,texture:"fishxy/animation/fish/fish/fish18/fish20_00.png"},compId:3},{type:"Image",props:{y:23,x:1,width:99,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:99,anchorY:.5,anchorX:.5},compId:5}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/fish/fish/fish18/fish20_00.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/fish/fish/fish18/fish20_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/fish/fish/fish18/fish20_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/fish/fish/fish18/fish20_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/fish/fish/fish18/fish20_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/fish/fish/fish18/fish20_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10},{value:"fishxy/animation/fish/fish/fish18/fish20_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:12},{value:"fishxy/animation/fish/fish/fish18/fish20_07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:14},{value:"fishxy/animation/fish/fish/fish18/fish20_08.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:16},{value:"fishxy/animation/fish/fish/fish18/fish20_09.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:18},{value:"fishxy/animation/fish/fish/fish18/fish20_10.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:20},{value:"fishxy/animation/fish/fish/fish18/fish20_11.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:22},{value:"fishxy/animation/fish/fish/fish18/fish20_12.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:24}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/fish/fish/fish18/fish20_00.png","fishxy/animation/fish/img_collider.png","fishxy/animation/fish/fish/fish18/fish20_01.png","fishxy/animation/fish/fish/fish18/fish20_02.png","fishxy/animation/fish/fish/fish18/fish20_03.png","fishxy/animation/fish/fish/fish18/fish20_04.png","fishxy/animation/fish/fish/fish18/fish20_05.png","fishxy/animation/fish/fish/fish18/fish20_06.png","fishxy/animation/fish/fish/fish18/fish20_07.png","fishxy/animation/fish/fish/fish18/fish20_08.png","fishxy/animation/fish/fish/fish18/fish20_09.png","fishxy/animation/fish/fish/fish18/fish20_10.png","fishxy/animation/fish/fish/fish18/fish20_11.png","fishxy/animation/fish/fish/fish18/fish20_12.png"],loadList3D:[]},i.YU019UI=n,t("ui.fishxy.animation.fish.YU019UI",n),(n=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-114,x:-142,texture:"fishxy/animation/fish/fish/fish19/fish21_00.png"},compId:3},{type:"Sprite",props:{y:-48,x:10,name:"collider"},compId:7,child:[{type:"Image",props:{y:34,x:-26,width:92,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:92,anchorY:.5,anchorX:.5},compId:10},{type:"Image",props:{y:40.5,x:-72.5,width:165,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:165,anchorY:.5,anchorX:.5},compId:8},{type:"Image",props:{y:34,x:33,width:119,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:119,anchorY:.5,anchorX:.5},compId:9}]}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/fish/fish/fish19/fish21_00.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/fish/fish/fish19/fish21_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/fish/fish/fish19/fish21_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/fish/fish/fish19/fish21_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/fish/fish/fish19/fish21_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/fish/fish/fish19/fish21_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10},{value:"fishxy/animation/fish/fish/fish19/fish21_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:12},{value:"fishxy/animation/fish/fish/fish19/fish21_07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:14},{value:"fishxy/animation/fish/fish/fish19/fish21_08.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:16},{value:"fishxy/animation/fish/fish/fish19/fish21_09.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:18},{value:"fishxy/animation/fish/fish/fish19/fish21_10.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:20},{value:"fishxy/animation/fish/fish/fish19/fish21_11.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:22},{value:"fishxy/animation/fish/fish/fish19/fish21_12.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:24},{value:"fishxy/animation/fish/fish/fish19/fish21_13.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:26},{value:"fishxy/animation/fish/fish/fish19/fish21_14.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:28},{value:"fishxy/animation/fish/fish/fish19/fish21_15.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:30},{value:"fishxy/animation/fish/fish/fish19/fish21_16.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:32},{value:"fishxy/animation/fish/fish/fish19/fish21_17.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:34},{value:"fishxy/animation/fish/fish/fish19/fish21_18.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:36},{value:"fishxy/animation/fish/fish/fish19/fish21_19.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:38}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/fish/fish/fish19/fish21_00.png","fishxy/animation/fish/img_collider.png","fishxy/animation/fish/fish/fish19/fish21_01.png","fishxy/animation/fish/fish/fish19/fish21_02.png","fishxy/animation/fish/fish/fish19/fish21_03.png","fishxy/animation/fish/fish/fish19/fish21_04.png","fishxy/animation/fish/fish/fish19/fish21_05.png","fishxy/animation/fish/fish/fish19/fish21_06.png","fishxy/animation/fish/fish/fish19/fish21_07.png","fishxy/animation/fish/fish/fish19/fish21_08.png","fishxy/animation/fish/fish/fish19/fish21_09.png","fishxy/animation/fish/fish/fish19/fish21_10.png","fishxy/animation/fish/fish/fish19/fish21_11.png","fishxy/animation/fish/fish/fish19/fish21_12.png","fishxy/animation/fish/fish/fish19/fish21_13.png","fishxy/animation/fish/fish/fish19/fish21_14.png","fishxy/animation/fish/fish/fish19/fish21_15.png","fishxy/animation/fish/fish/fish19/fish21_16.png","fishxy/animation/fish/fish/fish19/fish21_17.png","fishxy/animation/fish/fish/fish19/fish21_18.png","fishxy/animation/fish/fish/fish19/fish21_19.png"],loadList3D:[]},i.YU020UI=n,t("ui.fishxy.animation.fish.YU020UI",n),(n=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-108,x:-117,texture:"fishxy/animation/fish/fish20_00.png"},compId:3},{type:"Sprite",props:{y:-38,x:20,name:"collider"},compId:7,child:[{type:"Image",props:{y:44,x:-42.5,width:82,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:82,anchorY:.5,anchorX:.5},compId:12},{type:"Image",props:{y:46.75,x:-96,width:82,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:82,anchorY:.5,anchorX:.5},compId:8},{type:"Image",props:{y:0,x:-29,width:85,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:85,anchorY:.5,anchorX:.5},compId:9},{type:"Image",props:{y:53.5,x:7.5,width:85,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:85,anchorY:.5,anchorX:.5},compId:10},{type:"Image",props:{y:99.5,x:-42.5,width:85,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:85,anchorY:.5,anchorX:.5},compId:11}]}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/fish/fish20_00.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/fish/fish20_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:3},{value:"fishxy/animation/fish/fish20_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/fish/fish20_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:9},{value:"fishxy/animation/fish/fish20_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:12},{value:"fishxy/animation/fish/fish20_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:15}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/fish/fish20_00.png","fishxy/animation/fish/img_collider.png","fishxy/animation/fish/fish20_01.png","fishxy/animation/fish/fish20_02.png","fishxy/animation/fish/fish20_03.png","fishxy/animation/fish/fish20_04.png","fishxy/animation/fish/fish20_05.png"],loadList3D:[]},i.YU021UI=n,t("ui.fishxy.animation.fish.YU021UI",n),(n=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-89,x:-130,texture:"fishxy/animation/fish/fish21_00.png"},compId:3},{type:"Image",props:{y:0,x:-13,width:202,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:202,anchorY:.5,anchorX:.5},compId:6}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/fish/fish21_00.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/fish/fish21_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:3},{value:"fishxy/animation/fish/fish21_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/fish/fish21_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:9},{value:"fishxy/animation/fish/fish21_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:12},{value:"fishxy/animation/fish/fish21_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:15}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/fish/fish21_00.png","fishxy/animation/fish/img_collider.png","fishxy/animation/fish/fish21_01.png","fishxy/animation/fish/fish21_02.png","fishxy/animation/fish/fish21_03.png","fishxy/animation/fish/fish21_04.png","fishxy/animation/fish/fish21_05.png"],loadList3D:[]},i.YU022UI=n,t("ui.fishxy.animation.fish.YU022UI",n),(n=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-85,x:-376,texture:"fishxy/animation/fish/fish/fish22/fish17_00.png"},compId:3},{type:"Sprite",props:{y:-28,x:27,name:"collider"},compId:5,child:[{type:"Image",props:{y:31,x:-12,width:85,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:85,anchorY:.5,anchorX:.5},compId:10},{type:"Image",props:{y:32,x:284,width:82,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:82,anchorY:.5,anchorX:.5},compId:6},{type:"Image",props:{y:31,x:209,width:85,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:85,anchorY:.5,anchorX:.5},compId:7},{type:"Image",props:{y:31,x:133,width:85,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:85,anchorY:.5,anchorX:.5},compId:8},{type:"Image",props:{y:31,x:62,width:85,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:85,anchorY:.5,anchorX:.5},compId:9},{type:"Image",props:{y:31,x:-85,width:85,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:85,anchorY:.5,anchorX:.5},compId:11},{type:"Image",props:{y:31,x:-157,width:85,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:85,anchorY:.5,anchorX:.5},compId:12},{type:"Image",props:{y:31,x:-234,width:85,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:85,anchorY:.5,anchorX:.5},compId:13},{type:"Image",props:{y:31,x:-309,width:85,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:85,anchorY:.5,anchorX:.5},compId:14}]}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/fish/fish/fish22/fish17_00.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/fish/fish/fish22/fish17_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:3},{value:"fishxy/animation/fish/fish/fish22/fish17_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/fish/fish/fish22/fish17_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:9},{value:"fishxy/animation/fish/fish/fish22/fish17_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:12},{value:"fishxy/animation/fish/fish/fish22/fish17_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:15}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/fish/fish/fish22/fish17_00.png","fishxy/animation/fish/img_collider.png","fishxy/animation/fish/fish/fish22/fish17_01.png","fishxy/animation/fish/fish/fish22/fish17_02.png","fishxy/animation/fish/fish/fish22/fish17_03.png","fishxy/animation/fish/fish/fish22/fish17_04.png","fishxy/animation/fish/fish/fish22/fish17_05.png"],loadList3D:[]},i.YU023UI=n,t("ui.fishxy.animation.fish.YU023UI",n),(n=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{},compId:14,child:[{type:"Sprite",props:{y:-1,x:0,width:170,rotation:0,name:"s3",height:169},compId:9,child:[{type:"Sprite",props:{y:-131,x:-120,texture:"fishxy/animation/fish/fish_s3.png"},compId:8},{type:"Sprite",props:{y:37,x:-69.5025801005387,width:240,texture:"fishxy/animation/fish/fish_s3.png",rotation:240,pivotY:56,pivotX:120,height:111},compId:11},{type:"Sprite",props:{y:37,x:62,width:240,texture:"fishxy/animation/fish/fish_s3.png",rotation:120,pivotY:56,pivotX:120,height:111},compId:10}]},{type:"Sprite",props:{y:-1,x:0,width:256,rotation:0,pivotY:-49,pivotX:87,name:"s2",height:90},compId:7,child:[{type:"Sprite",props:{y:-162,x:79.5,width:159,texture:"fishxy/animation/fish/fish_s2.png",rotation:0,pivotY:41,pivotX:80,height:81},compId:4},{type:"Sprite",props:{y:-8,x:200,width:159,texture:"fishxy/animation/fish/fish_s2.png",rotation:120,pivotY:41,pivotX:80,height:81},compId:5},{type:"Sprite",props:{y:0,x:-9,width:159,texture:"fishxy/animation/fish/fish_s2.png",rotation:-120,pivotY:41,pivotX:80,height:81},compId:6}]},{type:"Sprite",props:{y:0,x:8,width:188,texture:"fishxy/animation/fish/fish_s1.png",pivotY:81,pivotX:94,name:"s1",height:162},compId:3},{type:"Sprite",props:{y:-104,x:-81,texture:"fishxy/animation/fish/fish31_gun.png"},compId:12},{type:"Sprite",props:{y:-152,x:-118,texture:"fishxy/animation/fish/fish31_gunlight.png"},compId:13}]},{type:"Image",props:{y:-13,x:0,width:273,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:273,anchorY:.5,anchorX:.5},compId:16}],animations:[{nodes:[{target:9,keyframes:{alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:9,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:9,key:"alpha",index:12},{value:1,tweenMethod:"linearNone",tween:!0,target:9,key:"alpha",index:24},{value:0,tweenMethod:"linearNone",tween:!0,target:9,label:null,key:"alpha",index:36},{value:1,tweenMethod:"linearNone",tween:!0,target:9,label:null,key:"alpha",index:48}]}},{target:7,keyframes:{rotation:[{value:0,tweenMethod:"linearNone",tween:!0,target:7,key:"rotation",index:0},{value:180,tweenMethod:"linearNone",tween:!0,target:7,key:"rotation",index:24},{value:360,tweenMethod:"linearNone",tween:!0,target:7,key:"rotation",index:48}]}},{target:13,keyframes:{alpha:[{value:.8,tweenMethod:"linearNone",tween:!0,target:13,key:"alpha",index:0},{value:.3,tweenMethod:"linearNone",tween:!0,target:13,key:"alpha",index:24},{value:.8,tweenMethod:"linearNone",tween:!0,target:13,key:"alpha",index:48}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/fish/fish_s3.png","fishxy/animation/fish/fish_s2.png","fishxy/animation/fish/fish_s1.png","fishxy/animation/fish/fish31_gun.png","fishxy/animation/fish/fish31_gunlight.png","fishxy/animation/fish/img_collider.png"],loadList3D:[]},i.YU024UI=n,t("ui.fishxy.animation.fish.YU024UI",n),(n=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{},compId:14,child:[{type:"Sprite",props:{y:-1,x:0,width:170,rotation:0,name:"s3",height:169},compId:9,child:[{type:"Sprite",props:{y:-131,x:-120,texture:"fishxy/animation/fish/fish_s3.png"},compId:8},{type:"Sprite",props:{y:37,x:-69.5025801005387,width:240,texture:"fishxy/animation/fish/fish_s3.png",rotation:240,pivotY:56,pivotX:120,height:111},compId:11},{type:"Sprite",props:{y:37,x:62,width:240,texture:"fishxy/animation/fish/fish_s3.png",rotation:120,pivotY:56,pivotX:120,height:111},compId:10}]},{type:"Sprite",props:{y:-1,x:0,width:256,rotation:0,pivotY:-49,pivotX:87,name:"s2",height:90},compId:7,child:[{type:"Sprite",props:{y:-162,x:79.5,width:159,texture:"fishxy/animation/fish/fish_s2.png",rotation:0,pivotY:41,pivotX:80,height:81},compId:4},{type:"Sprite",props:{y:-8,x:200,width:159,texture:"fishxy/animation/fish/fish_s2.png",rotation:120,pivotY:41,pivotX:80,height:81},compId:5},{type:"Sprite",props:{y:0,x:-9,width:159,texture:"fishxy/animation/fish/fish_s2.png",rotation:-120,pivotY:41,pivotX:80,height:81},compId:6}]},{type:"Sprite",props:{y:0,x:8,width:188,texture:"fishxy/animation/fish/fish_s1.png",pivotY:81,pivotX:94,name:"s1",height:162},compId:3},{type:"Sprite",props:{y:-98,x:-119,texture:"fishxy/animation/fish/fish29_gun.png"},compId:18}]},{type:"Image",props:{y:-6,x:-8,width:273,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:273,anchorY:.5,anchorX:.5},compId:20}],animations:[{nodes:[{target:9,keyframes:{alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:9,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:9,key:"alpha",index:12},{value:1,tweenMethod:"linearNone",tween:!0,target:9,key:"alpha",index:24},{value:0,tweenMethod:"linearNone",tween:!0,target:9,label:null,key:"alpha",index:36},{value:1,tweenMethod:"linearNone",tween:!0,target:9,label:null,key:"alpha",index:48}]}},{target:7,keyframes:{rotation:[{value:0,tweenMethod:"linearNone",tween:!0,target:7,key:"rotation",index:0},{value:180,tweenMethod:"linearNone",tween:!0,target:7,key:"rotation",index:24},{value:360,tweenMethod:"linearNone",tween:!0,target:7,key:"rotation",index:48}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/fish/fish_s3.png","fishxy/animation/fish/fish_s2.png","fishxy/animation/fish/fish_s1.png","fishxy/animation/fish/fish29_gun.png","fishxy/animation/fish/img_collider.png"],loadList3D:[]},i.YU025UI=n,t("ui.fishxy.animation.fish.YU025UI",n),(n=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{},compId:14,child:[{type:"Sprite",props:{y:-1,x:0,width:170,rotation:0,name:"s3",height:169},compId:9,child:[{type:"Sprite",props:{y:-131,x:-120,texture:"fishxy/animation/fish/fish_s3.png"},compId:8},{type:"Sprite",props:{y:37,x:-69.5025801005387,width:240,texture:"fishxy/animation/fish/fish_s3.png",rotation:240,pivotY:56,pivotX:120,height:111},compId:11},{type:"Sprite",props:{y:37,x:62,width:240,texture:"fishxy/animation/fish/fish_s3.png",rotation:120,pivotY:56,pivotX:120,height:111},compId:10}]},{type:"Sprite",props:{y:-1,x:0,width:256,rotation:0,pivotY:-49,pivotX:87,name:"s2",height:90},compId:7,child:[{type:"Sprite",props:{y:-162,x:79.5,width:159,texture:"fishxy/animation/fish/fish_s2.png",rotation:0,pivotY:41,pivotX:80,height:81},compId:4},{type:"Sprite",props:{y:-8,x:200,width:159,texture:"fishxy/animation/fish/fish_s2.png",rotation:120,pivotY:41,pivotX:80,height:81},compId:5},{type:"Sprite",props:{y:0,x:-9,width:159,texture:"fishxy/animation/fish/fish_s2.png",rotation:-120,pivotY:41,pivotX:80,height:81},compId:6}]},{type:"Sprite",props:{y:0,x:8,width:188,texture:"fishxy/animation/fish/fish_s1.png",pivotY:81,pivotX:94,name:"s1",height:162},compId:3},{type:"Sprite",props:{y:-172,x:-112,texture:"fishxy/animation/fish/fish32_gun.png"},compId:15}]},{type:"Image",props:{y:-11,x:0,width:273,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:273,anchorY:.5,anchorX:.5},compId:17}],animations:[{nodes:[{target:9,keyframes:{alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:9,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:9,key:"alpha",index:12},{value:1,tweenMethod:"linearNone",tween:!0,target:9,key:"alpha",index:24},{value:0,tweenMethod:"linearNone",tween:!0,target:9,label:null,key:"alpha",index:36},{value:1,tweenMethod:"linearNone",tween:!0,target:9,label:null,key:"alpha",index:48}]}},{target:7,keyframes:{rotation:[{value:0,tweenMethod:"linearNone",tween:!0,target:7,key:"rotation",index:0},{value:180,tweenMethod:"linearNone",tween:!0,target:7,key:"rotation",index:24},{value:360,tweenMethod:"linearNone",tween:!0,target:7,key:"rotation",index:48}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/fish/fish_s3.png","fishxy/animation/fish/fish_s2.png","fishxy/animation/fish/fish_s1.png","fishxy/animation/fish/fish32_gun.png","fishxy/animation/fish/img_collider.png"],loadList3D:[]},i.YU026UI=n,t("ui.fishxy.animation.fish.YU026UI",n),(n=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{},compId:14,child:[{type:"Sprite",props:{y:-1,x:0,width:170,rotation:0,name:"s3",height:169},compId:9,child:[{type:"Sprite",props:{y:-131,x:-120,texture:"fishxy/animation/fish/fish_s3.png"},compId:8},{type:"Sprite",props:{y:37,x:-69.5025801005387,width:240,texture:"fishxy/animation/fish/fish_s3.png",rotation:240,pivotY:56,pivotX:120,height:111},compId:11},{type:"Sprite",props:{y:37,x:62,width:240,texture:"fishxy/animation/fish/fish_s3.png",rotation:120,pivotY:56,pivotX:120,height:111},compId:10}]},{type:"Sprite",props:{y:-1,x:0,width:256,rotation:0,pivotY:-49,pivotX:87,name:"s2",height:90},compId:7,child:[{type:"Sprite",props:{y:-162,x:79.5,width:159,texture:"fishxy/animation/fish/fish_s2.png",rotation:0,pivotY:41,pivotX:80,height:81},compId:4},{type:"Sprite",props:{y:-8,x:200,width:159,texture:"fishxy/animation/fish/fish_s2.png",rotation:120,pivotY:41,pivotX:80,height:81},compId:5},{type:"Sprite",props:{y:0,x:-9,width:159,texture:"fishxy/animation/fish/fish_s2.png",rotation:-120,pivotY:41,pivotX:80,height:81},compId:6}]},{type:"Sprite",props:{y:0,x:8,width:188,texture:"fishxy/animation/fish/fish_s1.png",pivotY:81,pivotX:94,name:"s1",height:162},compId:3},{type:"Sprite",props:{y:-85,x:-103,texture:"fishxy/animation/fish/fish30_gun.png"},compId:15}]},{type:"Image",props:{y:-7,x:-8,width:273,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:273,anchorY:.5,anchorX:.5},compId:17}],animations:[{nodes:[{target:9,keyframes:{alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:9,key:"alpha",index:0},{value:0,tweenMethod:"linearNone",tween:!0,target:9,key:"alpha",index:12},{value:1,tweenMethod:"linearNone",tween:!0,target:9,key:"alpha",index:24},{value:0,tweenMethod:"linearNone",tween:!0,target:9,label:null,key:"alpha",index:36},{value:1,tweenMethod:"linearNone",tween:!0,target:9,label:null,key:"alpha",index:48}]}},{target:7,keyframes:{rotation:[{value:0,tweenMethod:"linearNone",tween:!0,target:7,key:"rotation",index:0},{value:180,tweenMethod:"linearNone",tween:!0,target:7,key:"rotation",index:24},{value:360,tweenMethod:"linearNone",tween:!0,target:7,key:"rotation",index:48}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/fish/fish_s3.png","fishxy/animation/fish/fish_s2.png","fishxy/animation/fish/fish_s1.png","fishxy/animation/fish/fish30_gun.png","fishxy/animation/fish/img_collider.png"],loadList3D:[]},i.YU027UI=n,t("ui.fishxy.animation.fish.YU027UI",n),(n=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-150,x:-225,texture:"fishxy/animation/fish/fish/fish27/fish23_00.png"},compId:3},{type:"Sprite",props:{y:-18,x:37,name:"collider"},compId:9,child:[{type:"Image",props:{y:-1,x:-39,width:182,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:182,anchorY:.5,anchorX:.5},compId:19},{type:"Image",props:{y:-1.5,x:76.5,width:116,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:116,anchorY:.5,anchorX:.5},compId:10},{type:"Image",props:{y:-13,x:-166,width:86,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:86,anchorY:.5,anchorX:.5},compId:20}]}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/fish/fish/fish27/fish23_00.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/fish/fish/fish27/fish23_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/fish/fish/fish27/fish23_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/fish/fish/fish27/fish23_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/fish/fish/fish27/fish23_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/fish/fish/fish27/fish23_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10},{value:"fishxy/animation/fish/fish/fish27/fish23_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:12},{value:"fishxy/animation/fish/fish/fish27/fish23_07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:14}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/fish/fish/fish27/fish23_00.png","fishxy/animation/fish/img_collider.png","fishxy/animation/fish/fish/fish27/fish23_01.png","fishxy/animation/fish/fish/fish27/fish23_02.png","fishxy/animation/fish/fish/fish27/fish23_03.png","fishxy/animation/fish/fish/fish27/fish23_04.png","fishxy/animation/fish/fish/fish27/fish23_05.png","fishxy/animation/fish/fish/fish27/fish23_06.png","fishxy/animation/fish/fish/fish27/fish23_07.png"],loadList3D:[]},i.YU028UI=n,t("ui.fishxy.animation.fish.YU028UI",n),(n=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-116,x:-115,texture:"fishxy/animation/fish/fish28_00.png"},compId:3},{type:"Image",props:{y:-8,x:0,width:204,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:204,anchorY:.5,anchorX:.5},compId:4}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/fish/fish28_00.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/fish/fish28_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/fish/fish28_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/fish/fish28_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/fish/fish28_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/fish/fish28_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10},{value:"fishxy/animation/fish/fish28_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:12},{value:"fishxy/animation/fish/fish28_07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:14},{value:"fishxy/animation/fish/fish28_08.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:16}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/fish/fish28_00.png","fishxy/animation/fish/img_collider.png","fishxy/animation/fish/fish28_01.png","fishxy/animation/fish/fish28_02.png","fishxy/animation/fish/fish28_03.png","fishxy/animation/fish/fish28_04.png","fishxy/animation/fish/fish28_05.png","fishxy/animation/fish/fish28_06.png","fishxy/animation/fish/fish28_07.png","fishxy/animation/fish/fish28_08.png"],loadList3D:[]},i.YU029UI=n,t("ui.fishxy.animation.fish.YU029UI",n),(n=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-98,x:-63,texture:"fishxy/animation/fish/fish26_00.png"},compId:3},{type:"Image",props:{y:0,x:0,width:150,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:150,anchorY:.5,anchorX:.5},compId:5}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/fish/fish26_00.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/fish/fish26_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/fish/fish26_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/fish/fish26_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/fish/fish26_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/fish/fish26_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10},{value:"fishxy/animation/fish/fish26_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:12},{value:"fishxy/animation/fish/fish26_07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:14},{value:"fishxy/animation/fish/fish26_08.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:16}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/fish/fish26_00.png","fishxy/animation/fish/img_collider.png","fishxy/animation/fish/fish26_01.png","fishxy/animation/fish/fish26_02.png","fishxy/animation/fish/fish26_03.png","fishxy/animation/fish/fish26_04.png","fishxy/animation/fish/fish26_05.png","fishxy/animation/fish/fish26_06.png","fishxy/animation/fish/fish26_07.png","fishxy/animation/fish/fish26_08.png"],loadList3D:[]},i.YU030UI=n,t("ui.fishxy.animation.fish.YU030UI",n),(n=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-150,x:-150,texture:"fishxy/animation/fish/fish/fish24/fish24_00.png"},compId:3},{type:"Image",props:{y:14,x:0,width:222,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:222,anchorY:.5,anchorX:.5},compId:5}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/fish/fish/fish24/fish24_00.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/fish/fish/fish24/fish24_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/fish/fish/fish24/fish24_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/fish/fish/fish24/fish24_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/fish/fish/fish24/fish24_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/fish/fish/fish24/fish24_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10},{value:"fishxy/animation/fish/fish/fish24/fish24_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:12},{value:"fishxy/animation/fish/fish/fish24/fish24_07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:14},{value:"fishxy/animation/fish/fish/fish24/fish24_08.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:16},{value:"fishxy/animation/fish/fish/fish24/fish24_09.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:18},{value:"fishxy/animation/fish/fish/fish24/fish24_10.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:20},{value:"fishxy/animation/fish/fish/fish24/fish24_11.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:22}]}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/fish/fish/fish24/fish24_00.png","fishxy/animation/fish/img_collider.png","fishxy/animation/fish/fish/fish24/fish24_01.png","fishxy/animation/fish/fish/fish24/fish24_02.png","fishxy/animation/fish/fish/fish24/fish24_03.png","fishxy/animation/fish/fish/fish24/fish24_04.png","fishxy/animation/fish/fish/fish24/fish24_05.png","fishxy/animation/fish/fish/fish24/fish24_06.png","fishxy/animation/fish/fish/fish24/fish24_07.png","fishxy/animation/fish/fish/fish24/fish24_08.png","fishxy/animation/fish/fish/fish24/fish24_09.png","fishxy/animation/fish/fish/fish24/fish24_10.png","fishxy/animation/fish/fish/fish24/fish24_11.png"],loadList3D:[]},i.YU031UI=n,t("ui.fishxy.animation.fish.YU031UI",n),(n=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-93,x:-103,texture:"fishxy/animation/fish/fish27_00.png"},compId:3},{type:"Image",props:{y:0,x:-.5,width:196,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:196,anchorY:.5,anchorX:.5},compId:6}],animations:[{nodes:[{target:3,keyframes:{}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/fish/fish27_00.png","fishxy/animation/fish/img_collider.png"],loadList3D:[]},i.YU032UI=n,t("ui.fishxy.animation.fish.YU032UI",n),(n=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"SkeletonPlayer",props:{y:0,x:0,url:"fishxy/animation/fish/dragonbones/MoneyBoy.sk",runtime:"Laya.Skeleton"},compId:5},{type:"Sprite",props:{y:-38,x:20,name:"collider"},compId:7,child:[{type:"Image",props:{y:23,x:-14,width:220,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:220,anchorY:.5,anchorX:.5},compId:9},{type:"Image",props:{y:-109,x:-13,width:165,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:165,anchorY:.5,anchorX:.5},compId:8}]},{type:"Image",props:{y:-65,x:4,width:82,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:82,anchorY:.5,anchorX:.5},compId:10}],animations:[{nodes:[{target:5,keyframes:{}}],name:"ani1",id:1,frameRate:24,action:0}],loadList:["fishxy/animation/fish/dragonbones/MoneyBoy.sk","fishxy/animation/fish/img_collider.png"],loadList3D:[]},i.YU033UI=n,t("ui.fishxy.animation.fish.YU033UI",n),(n=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-564,x:-369,texture:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSmove/COW_057_blur.png"},compId:9},{type:"Sprite",props:{y:-564,x:-369,texture:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieA000.png"},compId:3},{type:"Sprite",props:{y:-679,x:-526,width:1052,texture:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieEFX01.png",height:1052,alpha:66.66666666666667},compId:4},{type:"Sprite",props:{y:35,x:16.5,name:"collider"},compId:11,child:[{type:"Image",props:{y:-32,x:-24,width:113,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:113,anchorY:.5,anchorX:.5},compId:16},{type:"Image",props:{y:-142,x:-14,width:165,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:165,anchorY:.5,anchorX:.5},compId:12},{type:"Image",props:{y:-10.5,x:-140.5,width:209,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:209,anchorY:.5,anchorX:.5},compId:13},{type:"Image",props:{y:-16.5,x:85.5,width:209,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:209,anchorY:.5,anchorX:.5},compId:14},{type:"Image",props:{y:73.5,x:-14,width:165,visible:!1,skin:"fishxy/animation/fish/img_collider.png",name:"collider",height:165,anchorY:.5,anchorX:.5},compId:15}]}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieA000.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieA001.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieA000.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:4},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieA001.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:6},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieA000.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:8},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieA001.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:10},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieA000.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:12},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieA001.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:14},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_die_000.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:16},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_die_001.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:18},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_die_002.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:20}]}},{target:4,keyframes:{texture:[{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieEFX01.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:0},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieEFX02.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:2},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieEFX03.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:4},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieEFX04.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:6},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieEFX05.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:8},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieEFX06.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:10},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieEFX07.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:12},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieEFX08.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:14},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieEFX09.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:17},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieEFX10.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:18},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieEFX11.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:19},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieEFX12.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:20}],alpha:[{value:60,tweenMethod:"linearNone",tween:!0,target:4,key:"alpha",index:0},{value:100,tweenMethod:"linearNone",tween:!0,target:4,key:"alpha",index:6},{value:100,tweenMethod:"linearNone",tween:!0,target:4,key:"alpha",index:10},{value:90,tweenMethod:"linearNone",tween:!0,target:4,key:"alpha",index:16}]}}],name:"die",id:1,frameRate:18,action:0},{nodes:[{target:3,keyframes:{x:[{value:-369,tweenMethod:"linearNone",tween:!0,target:3,key:"x",index:0}],texture:[{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSmove/cow_move_001.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSmove/cow_move_002.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:3},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSmove/cow_move_003.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSmove/cow_move_004.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:9},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSmove/cow_move_005.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:12},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSmove/cow_move_006.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:15},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSmove/cow_move_007.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:18},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSmove/cow_move_008.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:21},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSmove/cow_move_009.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:24}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:3,key:"alpha",index:0}]}}],name:"move",id:2,frameRate:24,action:0},{nodes:[{target:3,keyframes:{x:[{value:-2104,tweenMethod:"linearNone",tween:!0,target:3,label:null,key:"x",index:0},{value:-369,tweenMethod:"linearNone",tween:!0,target:3,label:null,key:"x",index:10}],texture:[{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSmove/COW_057_blur.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSmove/COW_057_blur.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:3},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieA000.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"texture",index:10}]}},{target:9,keyframes:{x:[{value:1312,tweenMethod:"linearNone",tween:!0,target:9,label:null,key:"x",index:0},{value:-369,tweenMethod:"linearNone",tween:!0,target:9,label:null,key:"x",index:10}],texture:[{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSmove/COW_057_blur.png",tweenMethod:"linearNone",tween:!1,target:9,key:"texture",index:0},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSmove/COW_057_blur.png",tweenMethod:"linearNone",tween:!1,target:9,label:null,key:"texture",index:3},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieA000.png",tweenMethod:"linearNone",tween:!1,target:9,label:null,key:"texture",index:10}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:9,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:9,label:null,key:"alpha",index:3},{value:0,tweenMethod:"linearNone",tween:!0,target:9,label:null,key:"alpha",index:10}]}},{target:4,keyframes:{alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:4,key:"alpha",index:0}]}}],name:"show",id:3,frameRate:24,action:0},{nodes:[{target:4,keyframes:{alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:4,key:"alpha",index:0}]}},{target:3,keyframes:{x:[{value:-369,tweenMethod:"linearNone",tween:!0,target:3,key:"x",index:0}],texture:[{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSShit/cow_hit_001.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSShit/cow_hit_002.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSShit/cow_hit_003.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSShit/cow_hit_004.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSShit/cow_hit_005.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSShit/cow_hit_006.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSShit/cow_hit_007.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:12},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSShit/cow_hit_008.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:14}]}},{target:9,keyframes:{alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:9,key:"alpha",index:0}]}}],name:"hit",id:4,frameRate:24,action:0},{nodes:[{target:4,keyframes:{x:[{value:-150,tweenMethod:"linearNone",tween:!0,target:4,key:"x",index:0}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:4,key:"alpha",index:0}]}},{target:3,keyframes:{x:[{value:-369,tweenMethod:"linearNone",tween:!0,target:3,key:"x",index:0},{value:-2104,tweenMethod:"linearNone",tween:!0,target:3,key:"x",index:10}],texture:[{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieA000.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSmove/COW_057_blur.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:3}]}},{target:9,keyframes:{x:[{value:-369,tweenMethod:"linearNone",tween:!0,target:9,key:"x",index:0},{value:1312,tweenMethod:"linearNone",tween:!0,target:9,key:"x",index:10}],texture:[{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieA000.png",tweenMethod:"linearNone",tween:!1,target:9,key:"texture",index:0},{value:"fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSmove/COW_057_blur.png",tweenMethod:"linearNone",tween:!1,target:9,key:"texture",index:3}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:9,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:9,key:"alpha",index:3}]}}],name:"hide",id:5,frameRate:24,action:0}],loadList:["fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSmove/COW_057_blur.png","fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieA000.png","fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieEFX01.png","fishxy/animation/fish/img_collider.png","fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieA001.png","fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_die_000.png","fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_die_001.png","fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_die_002.png","fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieEFX02.png","fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieEFX03.png","fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieEFX04.png","fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieEFX05.png","fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieEFX06.png","fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieEFX07.png","fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieEFX08.png","fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieEFX09.png","fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieEFX10.png","fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieEFX11.png","fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSdie/cow_dieEFX12.png","fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSmove/cow_move_001.png","fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSmove/cow_move_002.png","fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSmove/cow_move_003.png","fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSmove/cow_move_004.png","fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSmove/cow_move_005.png","fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSmove/cow_move_006.png","fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSmove/cow_move_007.png","fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSmove/cow_move_008.png","fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSSmove/cow_move_009.png","fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSShit/cow_hit_001.png","fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSShit/cow_hit_002.png","fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSShit/cow_hit_003.png","fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSShit/cow_hit_004.png","fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSShit/cow_hit_005.png","fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSShit/cow_hit_006.png","fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSShit/cow_hit_007.png","fishxy/animation/fish/fish/fish34/BOSSfish/BOSSfish/BOSShit/cow_hit_008.png"],loadList3D:[]},i.YU034UI=n,t("ui.fishxy.animation.fish.YU034UI",n),(n=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[Xn,Sn,a,h,N],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Image",props:{y:62,x:71,width:403,skin:"fishxy/animation/fish/fish/fish34/BOSSui/blood_frame.png",sizeGrid:"0,32,0,65",height:62},compId:4},{type:"Panel",props:{y:76,x:124,width:340,var:"blood_panel",height:30},compId:5,child:[{type:"Image",props:{skin:"fishxy/animation/fish/fish/fish34/BOSSui/blood_R.png"},compId:6},{type:"Image",props:{y:0,x:17,skin:"fishxy/animation/fish/fish/fish34/BOSSui/blood_R.png"},compId:7},{type:"Image",props:{y:0,x:34,skin:"fishxy/animation/fish/fish/fish34/BOSSui/blood_R.png"},compId:8},{type:"Image",props:{y:0,x:51,skin:"fishxy/animation/fish/fish/fish34/BOSSui/blood_R.png"},compId:9},{type:"Image",props:{y:0,x:68,skin:"fishxy/animation/fish/fish/fish34/BOSSui/blood_R.png"},compId:10},{type:"Image",props:{y:0,x:85,skin:"fishxy/animation/fish/fish/fish34/BOSSui/blood_R.png"},compId:11},{type:"Image",props:{y:0,x:102,skin:"fishxy/animation/fish/fish/fish34/BOSSui/blood_R.png"},compId:12},{type:"Image",props:{y:0,x:119,skin:"fishxy/animation/fish/fish/fish34/BOSSui/blood_R.png"},compId:13},{type:"Image",props:{y:0,x:136,skin:"fishxy/animation/fish/fish/fish34/BOSSui/blood_O.png"},compId:14},{type:"Image",props:{y:0,x:153,skin:"fishxy/animation/fish/fish/fish34/BOSSui/blood_O.png"},compId:15},{type:"Image",props:{y:0,x:170,skin:"fishxy/animation/fish/fish/fish34/BOSSui/blood_O.png"},compId:16},{type:"Image",props:{y:0,x:187,skin:"fishxy/animation/fish/fish/fish34/BOSSui/blood_O.png"},compId:17},{type:"Image",props:{y:0,x:204,skin:"fishxy/animation/fish/fish/fish34/BOSSui/blood_O.png"},compId:18},{type:"Image",props:{y:0,x:221,skin:"fishxy/animation/fish/fish/fish34/BOSSui/blood_O.png"},compId:19},{type:"Image",props:{y:0,x:238,skin:"fishxy/animation/fish/fish/fish34/BOSSui/blood_Y.png"},compId:20},{type:"Image",props:{y:0,x:255,skin:"fishxy/animation/fish/fish/fish34/BOSSui/blood_Y.png"},compId:21},{type:"Image",props:{y:0,x:272,skin:"fishxy/animation/fish/fish/fish34/BOSSui/blood_Y.png"},compId:22},{type:"Image",props:{y:0,x:289,skin:"fishxy/animation/fish/fish/fish34/BOSSui/blood_Y.png"},compId:23},{type:"Image",props:{y:0,x:306,skin:"fishxy/animation/fish/fish/fish34/BOSSui/blood_Y.png"},compId:24},{type:"Image",props:{y:0,x:323,skin:"fishxy/animation/fish/fish/fish34/BOSSui/blood_Y.png"},compId:32}]},{type:"Image",props:{y:79,x:519,width:66,skin:"fishxy/fight/mainui/toFire.png",name:"type",height:71,anchorY:.5,anchorX:.5},compId:25},{type:"Label",props:{y:82,x:518,width:145,var:"time",text:"300",scaleY:.45,scaleX:.45,height:48,font:"bmfont_bossTime",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:26},{type:"Label",props:{y:79,x:0,width:62,var:"blood",text:"100%",height:32,font:"bmfont_bossZi",color:"#ffffff",align:"center"},compId:27},{type:"Sprite",props:{y:0,x:103,texture:"fishxy/animation/fish/fish/fish34/BOSSui/100_urwin.png",name:"box_1"},compId:28},{type:"Sprite",props:{y:2,x:239,texture:"fishxy/animation/fish/fish/fish34/BOSSui/90_bigwin.png",name:"box_40"},compId:29},{type:"Sprite",props:{y:6,x:344,texture:"fishxy/animation/fish/fish/fish34/BOSSui/70_Mega.png",name:"box_70"},compId:30},{type:"Sprite",props:{y:9,x:413,texture:"fishxy/animation/fish/fish/fish34/BOSSui/40_Mega.png",name:"box_90"},compId:31}],loadList:["fishxy/animation/fish/fish/fish34/BOSSui/blood_frame.png","fishxy/animation/fish/fish/fish34/BOSSui/blood_R.png","fishxy/animation/fish/fish/fish34/BOSSui/blood_O.png","fishxy/animation/fish/fish/fish34/BOSSui/blood_Y.png","fishxy/fight/mainui/toFire.png","fishxy/animation/fish/fish/fish34/BOSSui/100_urwin.png","fishxy/animation/fish/fish/fish34/BOSSui/90_bigwin.png","fishxy/animation/fish/fish/fish34/BOSSui/70_Mega.png","fishxy/animation/fish/fish/fish34/BOSSui/40_Mega.png"],loadList3D:[]},i.YU034_UIUI=n,t("ui.fishxy.animation.fish.YU034_UIUI",n),e=(e=(e=(e=Ki=Ki||{}).fishxy||(e.fishxy={})).animation||(e.animation={})).gun||(e.gun={}),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,Sn],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-158,x:-61.5,texture:"fishxy/animation/gun/normal/room1/sha_lv1_01.png"},compId:3},{type:"Label",props:{y:12,x:-1,width:45,text:"1",name:"cannon_level",height:24,font:"bmfont_fireCoin",anchorY:.5,anchorX:.5,align:"center"},compId:4},{type:"Sprite",props:{y:-66,x:1,name:"muzzle"},compId:5}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/gun/normal/room1/sha_lv1_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0}]}}],name:"stay",id:1,frameRate:24,action:0},{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/gun/normal/room1/sha_lv1_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/gun/normal/room1/sha_lv1_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:1},{value:"fishxy/animation/gun/normal/room1/sha_lv1_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/gun/normal/room1/sha_lv1_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:3},{value:"fishxy/animation/gun/normal/room1/sha_lv1_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/gun/normal/room1/sha_lv1_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:5},{value:"fishxy/animation/gun/normal/room1/sha_lv1_07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/gun/normal/room1/sha_lv1_08.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:7},{value:"fishxy/animation/gun/normal/room1/sha_lv1_09.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/gun/normal/room1/sha_lv1_10.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:9},{value:"fishxy/animation/gun/normal/room1/sha_lv1_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10}]}}],name:"attack",id:2,frameRate:24,action:0}],loadList:["fishxy/animation/gun/normal/room1/sha_lv1_01.png","fishxy/animation/gun/normal/room1/sha_lv1_02.png","fishxy/animation/gun/normal/room1/sha_lv1_03.png","fishxy/animation/gun/normal/room1/sha_lv1_04.png","fishxy/animation/gun/normal/room1/sha_lv1_05.png","fishxy/animation/gun/normal/room1/sha_lv1_06.png","fishxy/animation/gun/normal/room1/sha_lv1_07.png","fishxy/animation/gun/normal/room1/sha_lv1_08.png","fishxy/animation/gun/normal/room1/sha_lv1_09.png","fishxy/animation/gun/normal/room1/sha_lv1_10.png"],loadList3D:[]},e.bgxyby_gun_1UI=i,t("ui.fishxy.animation.gun.bgxyby_gun_1UI",i),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,Sn],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-205,x:-86,texture:"fishxy/animation/gun/normal/room4/sha_lv4_01.png"},compId:3},{type:"Label",props:{y:12,x:-4,width:45,text:"10",name:"cannon_level",height:24,font:"bmfont_fireCoin",anchorY:.5,anchorX:.5,align:"center"},compId:4},{type:"Sprite",props:{y:-83,x:0,name:"muzzle"},compId:5}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/gun/normal/room4/sha_lv4_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0}]}}],name:"stay",id:1,frameRate:24,action:0},{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/gun/normal/room4/sha_lv4_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/gun/normal/room4/sha_lv4_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:1},{value:"fishxy/animation/gun/normal/room4/sha_lv4_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/gun/normal/room4/sha_lv4_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:3},{value:"fishxy/animation/gun/normal/room4/sha_lv4_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/gun/normal/room4/sha_lv4_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:5},{value:"fishxy/animation/gun/normal/room4/sha_lv4_07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/gun/normal/room4/sha_lv4_08.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:7},{value:"fishxy/animation/gun/normal/room4/sha_lv4_09.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/gun/normal/room4/sha_lv4_10.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:9},{value:"fishxy/animation/gun/normal/room4/sha_lv4_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10}]}}],name:"attack",id:2,frameRate:24,action:0}],loadList:["fishxy/animation/gun/normal/room4/sha_lv4_01.png","fishxy/animation/gun/normal/room4/sha_lv4_02.png","fishxy/animation/gun/normal/room4/sha_lv4_03.png","fishxy/animation/gun/normal/room4/sha_lv4_04.png","fishxy/animation/gun/normal/room4/sha_lv4_05.png","fishxy/animation/gun/normal/room4/sha_lv4_06.png","fishxy/animation/gun/normal/room4/sha_lv4_07.png","fishxy/animation/gun/normal/room4/sha_lv4_08.png","fishxy/animation/gun/normal/room4/sha_lv4_09.png","fishxy/animation/gun/normal/room4/sha_lv4_10.png"],loadList3D:[]},e.bgxyby_gun_10UI=i,t("ui.fishxy.animation.gun.bgxyby_gun_10UI",i),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,Sn],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:33,x:0,texture:"fishxy/animation/gun/normal/room4/pig_lv4_01.png",pivotY:265,pivotX:100},compId:3},{type:"Label",props:{y:10,x:-2,width:45,text:"10",name:"cannon_level",height:24,font:"bmfont_fireCoin",anchorY:.5,anchorX:.5,align:"center"},compId:4},{type:"Sprite",props:{y:-96,x:-2,name:"muzzle"},compId:5}],animations:[{nodes:[],name:"stay",id:1,frameRate:24,action:0},{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/gun/normal/room4/pig_lv4_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/gun/normal/room4/pig_lv4_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:1},{value:"fishxy/animation/gun/normal/room4/pig_lv4_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/gun/normal/room4/pig_lv4_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:3},{value:"fishxy/animation/gun/normal/room4/pig_lv4_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/gun/normal/room4/pig_lv4_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:5},{value:"fishxy/animation/gun/normal/room4/pig_lv4_07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/gun/normal/room4/pig_lv4_08.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:7},{value:"fishxy/animation/gun/normal/room4/pig_lv4_09.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/gun/normal/room4/pig_lv4_10.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:9},{value:"fishxy/animation/gun/normal/room4/pig_lv4_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10}]}}],name:"attack",id:2,frameRate:24,action:0}],loadList:["fishxy/animation/gun/normal/room4/pig_lv4_01.png","fishxy/animation/gun/normal/room4/pig_lv4_02.png","fishxy/animation/gun/normal/room4/pig_lv4_03.png","fishxy/animation/gun/normal/room4/pig_lv4_04.png","fishxy/animation/gun/normal/room4/pig_lv4_05.png","fishxy/animation/gun/normal/room4/pig_lv4_06.png","fishxy/animation/gun/normal/room4/pig_lv4_07.png","fishxy/animation/gun/normal/room4/pig_lv4_08.png","fishxy/animation/gun/normal/room4/pig_lv4_09.png","fishxy/animation/gun/normal/room4/pig_lv4_10.png"],loadList3D:[]},e.bgxyby_gun_11UI=i,t("ui.fishxy.animation.gun.bgxyby_gun_11UI",i),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,Sn],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:31,x:0,texture:"fishxy/animation/gun/normal/room4/wukong_lv4_01.png",pivotY:323,pivotX:135},compId:3},{type:"Label",props:{y:8,x:-3,width:45,text:"10",name:"cannon_level",height:24,font:"bmfont_fireCoin",anchorY:.5,anchorX:.5,align:"center"},compId:4},{type:"Sprite",props:{y:-86,x:-3,name:"muzzle"},compId:5}],animations:[{nodes:[],name:"stay",id:1,frameRate:24,action:0},{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/gun/normal/room4/wukong_lv4_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/gun/normal/room4/wukong_lv4_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:1},{value:"fishxy/animation/gun/normal/room4/wukong_lv4_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/gun/normal/room4/wukong_lv4_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:3},{value:"fishxy/animation/gun/normal/room4/wukong_lv4_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/gun/normal/room4/wukong_lv4_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:5},{value:"fishxy/animation/gun/normal/room4/wukong_lv4_07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/gun/normal/room4/wukong_lv4_08.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:7},{value:"fishxy/animation/gun/normal/room4/wukong_lv4_09.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/gun/normal/room4/wukong_lv4_10.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:9},{value:"fishxy/animation/gun/normal/room4/wukong_lv4_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10}]}}],name:"attack",id:2,frameRate:24,action:0}],loadList:["fishxy/animation/gun/normal/room4/wukong_lv4_01.png","fishxy/animation/gun/normal/room4/wukong_lv4_02.png","fishxy/animation/gun/normal/room4/wukong_lv4_03.png","fishxy/animation/gun/normal/room4/wukong_lv4_04.png","fishxy/animation/gun/normal/room4/wukong_lv4_05.png","fishxy/animation/gun/normal/room4/wukong_lv4_06.png","fishxy/animation/gun/normal/room4/wukong_lv4_07.png","fishxy/animation/gun/normal/room4/wukong_lv4_08.png","fishxy/animation/gun/normal/room4/wukong_lv4_09.png","fishxy/animation/gun/normal/room4/wukong_lv4_10.png"],loadList3D:[]},e.bgxyby_gun_12UI=i,t("ui.fishxy.animation.gun.bgxyby_gun_12UI",i),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,h,a,Sn],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Image",props:{y:56,x:0,skin:"fishxy/animation/gun/jgb/stick_attack06.png",name:"gun",anchorY:1,anchorX:.5},compId:3},{type:"Label",props:{y:-5,x:-2,width:45,text:"10",name:"cannon_level",height:24,font:"bmfont_fireCoin",anchorY:.5,anchorX:.5,align:"center"},compId:5},{type:"Image",props:{y:-123,x:0,width:224,visible:!1,var:"bullet",skin:"fishxy/animation/gun/jgb/stick_light08.png",pivotY:68,pivotX:112,name:"muzzle",height:247},compId:7}],animations:[{nodes:[{target:3,keyframes:{skin:[{value:"fishxy/animation/gun/jgb/stick_attack01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:0},{value:"fishxy/animation/gun/jgb/stick_attack02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:1},{value:"fishxy/animation/gun/jgb/stick_attack03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:2},{value:"fishxy/animation/gun/jgb/stick_attack04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:3},{value:"fishxy/animation/gun/jgb/stick_attack05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:4},{value:"fishxy/animation/gun/jgb/stick_attack06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:5},{value:"fishxy/animation/gun/jgb/stick_attack07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:6},{value:"fishxy/animation/gun/jgb/stick_attack08.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:7},{value:"fishxy/animation/gun/jgb/stick_attack09.png",tweenMethod:"linearNone",tween:!1,target:3,key:"skin",index:8}]}}],name:"attack",id:1,frameRate:24,action:0},{nodes:[{target:7,keyframes:{visible:[{value:!0,tweenMethod:"linearNone",tween:!1,target:7,key:"visible",index:0}],alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:7,key:"alpha",index:0},{value:1,tweenMethod:"linearNone",tween:!0,target:7,key:"alpha",index:6},{value:1,tweenMethod:"linearNone",tween:!0,target:7,key:"alpha",index:11},{value:0,tweenMethod:"linearNone",tween:!0,target:7,key:"alpha",index:17},{value:0,tweenMethod:"linearNone",tween:!0,target:7,key:"alpha",index:22}]}}],name:"stay",id:2,frameRate:24,action:0},{nodes:[],name:"light",id:3,frameRate:24,action:0}],loadList:["fishxy/animation/gun/jgb/stick_attack06.png","fishxy/animation/gun/jgb/stick_light08.png","fishxy/animation/gun/jgb/stick_attack01.png","fishxy/animation/gun/jgb/stick_attack02.png","fishxy/animation/gun/jgb/stick_attack03.png","fishxy/animation/gun/jgb/stick_attack04.png","fishxy/animation/gun/jgb/stick_attack05.png","fishxy/animation/gun/jgb/stick_attack07.png","fishxy/animation/gun/jgb/stick_attack08.png","fishxy/animation/gun/jgb/stick_attack09.png"],loadList3D:[]},e.bgxyby_gun_13UI=i,t("ui.fishxy.animation.gun.bgxyby_gun_13UI",i),(i=function(){f(i,cn);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"Scene",props:{},compId:2,child:[{type:"Image",props:{y:0,x:-500,width:400,visible:!1,skin:"fishxy/animation/gun/jgb/Light-bottom06.png",rotation:-90,name:"light",height:3e3,anchorX:.5},compId:3}],animations:[{nodes:[{target:3,keyframes:{visible:[{value:!0,tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"visible",index:0}],skin:[{value:"fishxy/animation/gun/jgb/Light-bottom06.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"skin",index:0},{value:"fishxy/animation/gun/jgb/Light-bottom05.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"skin",index:1},{value:"fishxy/animation/gun/jgb/Light-bottom04.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"skin",index:2},{value:"fishxy/animation/gun/jgb/Light-bottom03.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"skin",index:3},{value:"fishxy/animation/gun/jgb/Light-bottom02.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"skin",index:4},{value:"fishxy/animation/gun/jgb/Light-bottom01.png",tweenMethod:"linearNone",tween:!1,target:3,label:null,key:"skin",index:5}]}}],name:"ani1",id:1,frameRate:24,action:2}],loadList:["fishxy/animation/gun/jgb/Light-bottom06.png","fishxy/animation/gun/jgb/Light-bottom05.png","fishxy/animation/gun/jgb/Light-bottom04.png","fishxy/animation/gun/jgb/Light-bottom03.png","fishxy/animation/gun/jgb/Light-bottom02.png","fishxy/animation/gun/jgb/Light-bottom01.png"],loadList3D:[]},e.bgxyby_gun_13_lighterUI=i,t("ui.fishxy.animation.gun.bgxyby_gun_13_lighterUI",i),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,Sn],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-153,x:-117,texture:"fishxy/animation/gun/xmsb/Y_stay_01.png"},compId:5},{type:"Label",props:{y:11,x:-3,width:45,text:"10",name:"cannon_level",height:24,font:"bmfont_fireCoin",anchorY:.5,anchorX:.5,align:"center"},compId:15},{type:"Sprite",props:{y:-91,x:-3,name:"muzzle"},compId:16}],animations:[{nodes:[{target:5,keyframes:{texture:[{value:"fishxy/animation/gun/xmsb/Y_stay_01.png",tweenMethod:"linearNone",tween:!1,target:5,key:"texture",index:0},{value:"fishxy/animation/gun/xmsb/Y_stay_02.png",tweenMethod:"linearNone",tween:!1,target:5,key:"texture",index:1},{value:"fishxy/animation/gun/xmsb/Y_stay_03.png",tweenMethod:"linearNone",tween:!1,target:5,key:"texture",index:2},{value:"fishxy/animation/gun/xmsb/Y_stay_04.png",tweenMethod:"linearNone",tween:!1,target:5,key:"texture",index:3},{value:"fishxy/animation/gun/xmsb/Y_stay_05.png",tweenMethod:"linearNone",tween:!1,target:5,key:"texture",index:4},{value:"fishxy/animation/gun/xmsb/Y_stay_06.png",tweenMethod:"linearNone",tween:!1,target:5,key:"texture",index:5},{value:"fishxy/animation/gun/xmsb/Y_stay_07.png",tweenMethod:"linearNone",tween:!1,target:5,key:"texture",index:6},{value:"fishxy/animation/gun/xmsb/Y_stay_08.png",tweenMethod:"linearNone",tween:!1,target:5,key:"texture",index:7},{value:"fishxy/animation/gun/xmsb/Y_stay_09.png",tweenMethod:"linearNone",tween:!1,target:5,key:"texture",index:8},{value:"fishxy/animation/gun/xmsb/Y_stay_10.png",tweenMethod:"linearNone",tween:!1,target:5,key:"texture",index:9}]}}],name:"stay",id:1,frameRate:24,action:0},{nodes:[],name:"attack",id:2,frameRate:24,action:0}],loadList:["fishxy/animation/gun/xmsb/Y_stay_01.png","fishxy/animation/gun/xmsb/Y_stay_02.png","fishxy/animation/gun/xmsb/Y_stay_03.png","fishxy/animation/gun/xmsb/Y_stay_04.png","fishxy/animation/gun/xmsb/Y_stay_05.png","fishxy/animation/gun/xmsb/Y_stay_06.png","fishxy/animation/gun/xmsb/Y_stay_07.png","fishxy/animation/gun/xmsb/Y_stay_08.png","fishxy/animation/gun/xmsb/Y_stay_09.png","fishxy/animation/gun/xmsb/Y_stay_10.png"],loadList3D:[]},e.bgxyby_gun_14UI=i,t("ui.fishxy.animation.gun.bgxyby_gun_14UI",i),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,Sn],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-238,x:-147.5,texture:"fishxy/animation/gun/ffwb/Buddha_stay01.png"},compId:3},{type:"Sprite",props:{y:-312,x:-144,texture:"fishxy/animation/gun/ffwb/Buddha_attack01.png"},compId:4},{type:"Label",props:{y:-2,x:-3,width:45,text:"10",name:"cannon_level",height:24,font:"bmfont_fireCoin",anchorY:.5,anchorX:.5,align:"center"},compId:5},{type:"Sprite",props:{y:-113,x:1,name:"muzzle"},compId:6}],animations:[{nodes:[{target:4,keyframes:{alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:4,key:"alpha",index:0}]}},{target:3,keyframes:{texture:[{value:"fishxy/animation/gun/ffwb/Buddha_stay01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/gun/ffwb/Buddha_stay02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/gun/ffwb/Buddha_stay03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/gun/ffwb/Buddha_stay04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/gun/ffwb/Buddha_stay05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/gun/ffwb/Buddha_stay06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10},{value:"fishxy/animation/gun/ffwb/Buddha_stay07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:12},{value:"fishxy/animation/gun/ffwb/Buddha_stay08.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:14},{value:"fishxy/animation/gun/ffwb/Buddha_stay09.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:16},{value:"fishxy/animation/gun/ffwb/Buddha_stay10.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:18}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:3,key:"alpha",index:0}]}}],name:"stay",id:1,frameRate:24,action:0},{nodes:[{target:3,keyframes:{alpha:[{value:0,tweenMethod:"linearNone",tween:!0,target:3,key:"alpha",index:0}]}},{target:4,keyframes:{texture:[{value:"fishxy/animation/gun/ffwb/Buddha_attack01.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:0},{value:"fishxy/animation/gun/ffwb/Buddha_attack02.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:1},{value:"fishxy/animation/gun/ffwb/Buddha_attack03.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:2},{value:"fishxy/animation/gun/ffwb/Buddha_attack04.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:3},{value:"fishxy/animation/gun/ffwb/Buddha_attack05.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:4},{value:"fishxy/animation/gun/ffwb/Buddha_attack06.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:5},{value:"fishxy/animation/gun/ffwb/Buddha_attack07.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:6},{value:"fishxy/animation/gun/ffwb/Buddha_attack08.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:7},{value:"fishxy/animation/gun/ffwb/Buddha_attack09.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:8},{value:"fishxy/animation/gun/ffwb/Buddha_attack10.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:9},{value:"fishxy/animation/gun/ffwb/Buddha_attack01.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:10}],alpha:[{value:1,tweenMethod:"linearNone",tween:!0,target:4,key:"alpha",index:0}]}}],name:"attack",id:2,frameRate:24,action:0}],loadList:["fishxy/animation/gun/ffwb/Buddha_stay01.png","fishxy/animation/gun/ffwb/Buddha_attack01.png","fishxy/animation/gun/ffwb/Buddha_stay02.png","fishxy/animation/gun/ffwb/Buddha_stay03.png","fishxy/animation/gun/ffwb/Buddha_stay04.png","fishxy/animation/gun/ffwb/Buddha_stay05.png","fishxy/animation/gun/ffwb/Buddha_stay06.png","fishxy/animation/gun/ffwb/Buddha_stay07.png","fishxy/animation/gun/ffwb/Buddha_stay08.png","fishxy/animation/gun/ffwb/Buddha_stay09.png","fishxy/animation/gun/ffwb/Buddha_stay10.png","fishxy/animation/gun/ffwb/Buddha_attack02.png","fishxy/animation/gun/ffwb/Buddha_attack03.png","fishxy/animation/gun/ffwb/Buddha_attack04.png","fishxy/animation/gun/ffwb/Buddha_attack05.png","fishxy/animation/gun/ffwb/Buddha_attack06.png","fishxy/animation/gun/ffwb/Buddha_attack07.png","fishxy/animation/gun/ffwb/Buddha_attack08.png","fishxy/animation/gun/ffwb/Buddha_attack09.png","fishxy/animation/gun/ffwb/Buddha_attack10.png"],loadList3D:[]},e.bgxyby_gun_15UI=i,t("ui.fishxy.animation.gun.bgxyby_gun_15UI",i),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,h,N,Sn],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Image",props:{y:-52,x:-42,width:26,skin:"fishxy/animation/gun/jclj/nine_02.png",rotation:-11,name:"bullet_5",height:105,anchorY:.5,anchorX:.5,alpha:.8},compId:28},{type:"Image",props:{y:-56,x:-8,width:26,skin:"fishxy/animation/gun/jclj/nine_02.png",rotation:-6,name:"bullet_6",height:105,anchorY:.5,anchorX:.5,alpha:.8},compId:29},{type:"Image",props:{y:-56,x:27,width:26,skin:"fishxy/animation/gun/jclj/nine_02.png",rotation:6,name:"bullet_7",height:105,anchorY:.5,anchorX:.5,alpha:.8},compId:30},{type:"Image",props:{y:-56,x:61,width:26,skin:"fishxy/animation/gun/jclj/nine_02.png",rotation:11,name:"bullet_8",height:105,anchorY:.5,anchorX:.5,alpha:.8},compId:31},{type:"Image",props:{y:-92,x:-69,width:26,skin:"fishxy/animation/gun/jclj/nine_02.png",rotation:-11,name:"bullet_0",height:105,anchorY:.5,anchorX:.5},compId:22},{type:"Image",props:{y:-91,x:-30,width:26,skin:"fishxy/animation/gun/jclj/nine_02.png",rotation:-6,name:"bullet_1",height:105,anchorY:.5,anchorX:.5},compId:24},{type:"Image",props:{y:-91,x:9,width:26,skin:"fishxy/animation/gun/jclj/nine_02.png",rotation:0,name:"bullet_2",height:105,anchorY:.5,anchorX:.5},compId:25},{type:"Image",props:{y:-91,x:45,width:26,skin:"fishxy/animation/gun/jclj/nine_02.png",rotation:6,name:"bullet_3",height:105,anchorY:.5,anchorX:.5},compId:26},{type:"Image",props:{y:-91,x:83,width:26,skin:"fishxy/animation/gun/jclj/nine_02.png",rotation:11,name:"bullet_4",height:105,anchorY:.5,anchorX:.5},compId:27},{type:"Sprite",props:{y:-71,x:-89,texture:"fishxy/animation/gun/jclj/nine_01.png"},compId:3},{type:"Label",props:{y:-5,x:0,width:45,text:"10",name:"cannon_level",height:24,font:"bmfont_fireCoin",anchorY:.5,anchorX:.5,align:"center"},compId:18},{type:"Sprite",props:{y:-10,x:-1,width:167,texture:"fishxy/animation/gun/jclj/nine_L08.png",pivotY:83,pivotX:84,height:165},compId:4}],animations:[{nodes:[{target:4,keyframes:{texture:[{value:"fishxy/animation/gun/jclj/nine_L01.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:0},{value:"fishxy/animation/gun/jclj/nine_L02.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:2},{value:"fishxy/animation/gun/jclj/nine_L03.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:4},{value:"fishxy/animation/gun/jclj/nine_L04.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:6},{value:"fishxy/animation/gun/jclj/nine_L05.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:8},{value:"fishxy/animation/gun/jclj/nine_L06.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:10},{value:"fishxy/animation/gun/jclj/nine_L07.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:12},{value:"fishxy/animation/gun/jclj/nine_L08.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:14}]}}],name:"stay",id:1,frameRate:24,action:0},{nodes:[{target:4,keyframes:{texture:[{value:"fishxy/animation/gun/jclj/nine_L01.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:0},{value:"fishxy/animation/gun/jclj/nine_L02.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:2},{value:"fishxy/animation/gun/jclj/nine_L03.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:4},{value:"fishxy/animation/gun/jclj/nine_L04.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:6},{value:"fishxy/animation/gun/jclj/nine_L05.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:8},{value:"fishxy/animation/gun/jclj/nine_L06.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:10},{value:"fishxy/animation/gun/jclj/nine_L07.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:12},{value:"fishxy/animation/gun/jclj/nine_L08.png",tweenMethod:"linearNone",tween:!1,target:4,key:"texture",index:14}]}}],name:"attack",id:2,frameRate:24,action:0}],loadList:["fishxy/animation/gun/jclj/nine_02.png","fishxy/animation/gun/jclj/nine_01.png","fishxy/animation/gun/jclj/nine_L08.png","fishxy/animation/gun/jclj/nine_L01.png","fishxy/animation/gun/jclj/nine_L02.png","fishxy/animation/gun/jclj/nine_L03.png","fishxy/animation/gun/jclj/nine_L04.png","fishxy/animation/gun/jclj/nine_L05.png","fishxy/animation/gun/jclj/nine_L06.png","fishxy/animation/gun/jclj/nine_L07.png"],loadList3D:[]},e.bgxyby_gun_16UI=i,t("ui.fishxy.animation.gun.bgxyby_gun_16UI",i),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,Sn],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-167,x:-79,texture:"fishxy/animation/gun/normal/room1/pig_lv1_01.png"},compId:3},{type:"Label",props:{y:8,x:-3,width:45,text:"10",name:"cannon_level",height:24,font:"bmfont_fireCoin",anchorY:.5,anchorX:.5,align:"center"},compId:4},{type:"Sprite",props:{y:-75,x:-3,name:"muzzle"},compId:5}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/gun/normal/room1/pig_lv1_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0}]}}],name:"stay",id:1,frameRate:24,action:0},{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/gun/normal/room1/pig_lv1_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/gun/normal/room1/pig_lv1_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:1},{value:"fishxy/animation/gun/normal/room1/pig_lv1_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/gun/normal/room1/pig_lv1_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:3},{value:"fishxy/animation/gun/normal/room1/pig_lv1_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/gun/normal/room1/pig_lv1_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:5},{value:"fishxy/animation/gun/normal/room1/pig_lv1_07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/gun/normal/room1/pig_lv1_08.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:7},{value:"fishxy/animation/gun/normal/room1/pig_lv1_09.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/gun/normal/room1/pig_lv1_10.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:9},{value:"fishxy/animation/gun/normal/room1/pig_lv1_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10}]}}],name:"attack",id:2,frameRate:24,action:0}],loadList:["fishxy/animation/gun/normal/room1/pig_lv1_01.png","fishxy/animation/gun/normal/room1/pig_lv1_02.png","fishxy/animation/gun/normal/room1/pig_lv1_03.png","fishxy/animation/gun/normal/room1/pig_lv1_04.png","fishxy/animation/gun/normal/room1/pig_lv1_05.png","fishxy/animation/gun/normal/room1/pig_lv1_06.png","fishxy/animation/gun/normal/room1/pig_lv1_07.png","fishxy/animation/gun/normal/room1/pig_lv1_08.png","fishxy/animation/gun/normal/room1/pig_lv1_09.png","fishxy/animation/gun/normal/room1/pig_lv1_10.png"],loadList3D:[]},e.bgxyby_gun_2UI=i,t("ui.fishxy.animation.gun.bgxyby_gun_2UI",i),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,Sn],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-214,x:-76,texture:"fishxy/animation/gun/normal/room1/wukong_lv1_01.png"},compId:3},{type:"Label",props:{y:7,x:-3,width:45,text:"10",name:"cannon_level",height:24,font:"bmfont_fireCoin",anchorY:.5,anchorX:.5,align:"center"},compId:4},{type:"Sprite",props:{y:-80,x:-3,name:"muzzle"},compId:5}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/gun/normal/room1/wukong_lv1_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0}]}}],name:"stay",id:1,frameRate:24,action:0},{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/gun/normal/room1/wukong_lv1_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/gun/normal/room1/wukong_lv1_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:1},{value:"fishxy/animation/gun/normal/room1/wukong_lv1_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/gun/normal/room1/wukong_lv1_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:3},{value:"fishxy/animation/gun/normal/room1/wukong_lv1_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/gun/normal/room1/wukong_lv1_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:5},{value:"fishxy/animation/gun/normal/room1/wukong_lv1_07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/gun/normal/room1/wukong_lv1_08.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:7},{value:"fishxy/animation/gun/normal/room1/wukong_lv1_09.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/gun/normal/room1/wukong_lv1_10.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:9},{value:"fishxy/animation/gun/normal/room1/wukong_lv1_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10}]}}],name:"attack",id:2,frameRate:24,action:0}],loadList:["fishxy/animation/gun/normal/room1/wukong_lv1_01.png","fishxy/animation/gun/normal/room1/wukong_lv1_02.png","fishxy/animation/gun/normal/room1/wukong_lv1_03.png","fishxy/animation/gun/normal/room1/wukong_lv1_04.png","fishxy/animation/gun/normal/room1/wukong_lv1_05.png","fishxy/animation/gun/normal/room1/wukong_lv1_06.png","fishxy/animation/gun/normal/room1/wukong_lv1_07.png","fishxy/animation/gun/normal/room1/wukong_lv1_08.png","fishxy/animation/gun/normal/room1/wukong_lv1_09.png","fishxy/animation/gun/normal/room1/wukong_lv1_10.png"],loadList3D:[]},e.bgxyby_gun_3UI=i,t("ui.fishxy.animation.gun.bgxyby_gun_3UI",i),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,Sn],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-163,x:-77,texture:"fishxy/animation/gun/normal/room2/sha_lv2_01.png"},compId:3},{type:"Label",props:{y:12,x:-2,width:45,text:"10",name:"cannon_level",height:24,font:"bmfont_fireCoin",anchorY:.5,anchorX:.5,align:"center"},compId:4},{type:"Sprite",props:{y:-71,x:0,name:"muzzle"},compId:5}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/gun/normal/room2/sha_lv2_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0}]}}],name:"stay",id:1,frameRate:24,action:0},{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/gun/normal/room2/sha_lv2_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/gun/normal/room2/sha_lv2_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:1},{value:"fishxy/animation/gun/normal/room2/sha_lv2_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/gun/normal/room2/sha_lv2_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:3},{value:"fishxy/animation/gun/normal/room2/sha_lv2_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/gun/normal/room2/sha_lv2_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:5},{value:"fishxy/animation/gun/normal/room2/sha_lv2_07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/gun/normal/room2/sha_lv2_08.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:7},{value:"fishxy/animation/gun/normal/room2/sha_lv2_09.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/gun/normal/room2/sha_lv2_10.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:9},{value:"fishxy/animation/gun/normal/room2/sha_lv2_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10}]}}],name:"attack",id:2,frameRate:24,action:0}],loadList:["fishxy/animation/gun/normal/room2/sha_lv2_01.png","fishxy/animation/gun/normal/room2/sha_lv2_02.png","fishxy/animation/gun/normal/room2/sha_lv2_03.png","fishxy/animation/gun/normal/room2/sha_lv2_04.png","fishxy/animation/gun/normal/room2/sha_lv2_05.png","fishxy/animation/gun/normal/room2/sha_lv2_06.png","fishxy/animation/gun/normal/room2/sha_lv2_07.png","fishxy/animation/gun/normal/room2/sha_lv2_08.png","fishxy/animation/gun/normal/room2/sha_lv2_09.png","fishxy/animation/gun/normal/room2/sha_lv2_10.png"],loadList3D:[]},e.bgxyby_gun_4UI=i,t("ui.fishxy.animation.gun.bgxyby_gun_4UI",i),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,Sn],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-177,x:-79,texture:"fishxy/animation/gun/normal/room2/pig_lv2_01.png"},compId:3},{type:"Label",props:{y:9,x:-1,width:45,text:"10",name:"cannon_level",height:24,font:"bmfont_fireCoin",anchorY:.5,anchorX:.5,align:"center"},compId:4},{type:"Sprite",props:{y:-75,x:-1,name:"muzzle"},compId:5}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/gun/normal/room2/pig_lv2_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0}]}}],name:"stay",id:1,frameRate:24,action:0},{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/gun/normal/room2/pig_lv2_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/gun/normal/room2/pig_lv2_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:1},{value:"fishxy/animation/gun/normal/room2/pig_lv2_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/gun/normal/room2/pig_lv2_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:3},{value:"fishxy/animation/gun/normal/room2/pig_lv2_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/gun/normal/room2/pig_lv2_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:5},{value:"fishxy/animation/gun/normal/room2/pig_lv2_07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/gun/normal/room2/pig_lv2_08.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:7},{value:"fishxy/animation/gun/normal/room2/pig_lv2_09.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/gun/normal/room2/pig_lv2_10.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:9},{value:"fishxy/animation/gun/normal/room2/pig_lv2_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10}]}}],name:"attack",id:2,frameRate:24,action:0}],loadList:["fishxy/animation/gun/normal/room2/pig_lv2_01.png","fishxy/animation/gun/normal/room2/pig_lv2_02.png","fishxy/animation/gun/normal/room2/pig_lv2_03.png","fishxy/animation/gun/normal/room2/pig_lv2_04.png","fishxy/animation/gun/normal/room2/pig_lv2_05.png","fishxy/animation/gun/normal/room2/pig_lv2_06.png","fishxy/animation/gun/normal/room2/pig_lv2_07.png","fishxy/animation/gun/normal/room2/pig_lv2_08.png","fishxy/animation/gun/normal/room2/pig_lv2_09.png","fishxy/animation/gun/normal/room2/pig_lv2_10.png"],loadList3D:[]},e.bgxyby_gun_5UI=i,t("ui.fishxy.animation.gun.bgxyby_gun_5UI",i),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,Sn],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:29,x:0,texture:"fishxy/animation/gun/normal/room2/wukong_lv2_01.png",pivotY:234,pivotX:87},compId:3},{type:"Label",props:{y:9,x:-3,width:45,text:"10",name:"cannon_level",height:24,font:"bmfont_fireCoin",anchorY:.5,anchorX:.5,align:"center"},compId:4},{type:"Sprite",props:{y:-70,x:0,name:"muzzle"},compId:5}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/gun/normal/room2/wukong_lv2_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0}]}}],name:"stay",id:1,frameRate:24,action:0},{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/gun/normal/room2/wukong_lv2_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/gun/normal/room2/wukong_lv2_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:1},{value:"fishxy/animation/gun/normal/room2/wukong_lv2_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/gun/normal/room2/wukong_lv2_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:3},{value:"fishxy/animation/gun/normal/room2/wukong_lv2_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/gun/normal/room2/wukong_lv2_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:5},{value:"fishxy/animation/gun/normal/room2/wukong_lv2_07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/gun/normal/room2/wukong_lv2_08.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:7},{value:"fishxy/animation/gun/normal/room2/wukong_lv2_09.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/gun/normal/room2/wukong_lv2_10.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:9},{value:"fishxy/animation/gun/normal/room2/wukong_lv2_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10}]}}],name:"attack",id:2,frameRate:24,action:0}],loadList:["fishxy/animation/gun/normal/room2/wukong_lv2_01.png","fishxy/animation/gun/normal/room2/wukong_lv2_02.png","fishxy/animation/gun/normal/room2/wukong_lv2_03.png","fishxy/animation/gun/normal/room2/wukong_lv2_04.png","fishxy/animation/gun/normal/room2/wukong_lv2_05.png","fishxy/animation/gun/normal/room2/wukong_lv2_06.png","fishxy/animation/gun/normal/room2/wukong_lv2_07.png","fishxy/animation/gun/normal/room2/wukong_lv2_08.png","fishxy/animation/gun/normal/room2/wukong_lv2_09.png","fishxy/animation/gun/normal/room2/wukong_lv2_10.png"],loadList3D:[]},e.bgxyby_gun_6UI=i,t("ui.fishxy.animation.gun.bgxyby_gun_6UI",i),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,Sn],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-178,x:-77,texture:"fishxy/animation/gun/normal/room3/sha_lv3_01.png"},compId:3},{type:"Label",props:{y:12,x:-2,width:45,text:"10",name:"cannon_level",height:24,font:"bmfont_fireCoin",anchorY:.5,anchorX:.5,align:"center"},compId:4},{type:"Sprite",props:{y:-81,x:0,name:"muzzle"},compId:5}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/gun/normal/room3/sha_lv3_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0}]}}],name:"stay",id:1,frameRate:24,action:0},{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/gun/normal/room3/sha_lv3_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/gun/normal/room3/sha_lv3_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:1},{value:"fishxy/animation/gun/normal/room3/sha_lv3_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/gun/normal/room3/sha_lv3_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:3},{value:"fishxy/animation/gun/normal/room3/sha_lv3_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/gun/normal/room3/sha_lv3_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:5},{value:"fishxy/animation/gun/normal/room3/sha_lv3_07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/gun/normal/room3/sha_lv3_08.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:7},{value:"fishxy/animation/gun/normal/room3/sha_lv3_09.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/gun/normal/room3/sha_lv3_10.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:9},{value:"fishxy/animation/gun/normal/room3/sha_lv3_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10}]}}],name:"attack",id:2,frameRate:24,action:0}],loadList:["fishxy/animation/gun/normal/room3/sha_lv3_01.png","fishxy/animation/gun/normal/room3/sha_lv3_02.png","fishxy/animation/gun/normal/room3/sha_lv3_03.png","fishxy/animation/gun/normal/room3/sha_lv3_04.png","fishxy/animation/gun/normal/room3/sha_lv3_05.png","fishxy/animation/gun/normal/room3/sha_lv3_06.png","fishxy/animation/gun/normal/room3/sha_lv3_07.png","fishxy/animation/gun/normal/room3/sha_lv3_08.png","fishxy/animation/gun/normal/room3/sha_lv3_09.png","fishxy/animation/gun/normal/room3/sha_lv3_10.png"],loadList3D:[]},e.bgxyby_gun_7UI=i,t("ui.fishxy.animation.gun.bgxyby_gun_7UI",i),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,Sn],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-200,x:-89,texture:"fishxy/animation/gun/normal/room3/pig_lv3_01.png"},compId:3},{type:"Label",props:{y:6,x:-2,width:45,text:"10",name:"cannon_level",height:24,font:"bmfont_fireCoin",anchorY:.5,anchorX:.5,align:"center"},compId:4},{type:"Sprite",props:{y:-88,x:0,name:"muzzle"},compId:5}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/gun/normal/room3/pig_lv3_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0}]}}],name:"stay",id:1,frameRate:24,action:0},{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/gun/normal/room3/pig_lv3_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/gun/normal/room3/pig_lv3_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:1},{value:"fishxy/animation/gun/normal/room3/pig_lv3_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/gun/normal/room3/pig_lv3_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:3},{value:"fishxy/animation/gun/normal/room3/pig_lv3_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/gun/normal/room3/pig_lv3_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:5},{value:"fishxy/animation/gun/normal/room3/pig_lv3_07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/gun/normal/room3/pig_lv3_08.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:7},{value:"fishxy/animation/gun/normal/room3/pig_lv3_09.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/gun/normal/room3/pig_lv3_10.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:9},{value:"fishxy/animation/gun/normal/room3/pig_lv3_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10}]}}],name:"attack",id:2,frameRate:24,action:0}],loadList:["fishxy/animation/gun/normal/room3/pig_lv3_01.png","fishxy/animation/gun/normal/room3/pig_lv3_02.png","fishxy/animation/gun/normal/room3/pig_lv3_03.png","fishxy/animation/gun/normal/room3/pig_lv3_04.png","fishxy/animation/gun/normal/room3/pig_lv3_05.png","fishxy/animation/gun/normal/room3/pig_lv3_06.png","fishxy/animation/gun/normal/room3/pig_lv3_07.png","fishxy/animation/gun/normal/room3/pig_lv3_08.png","fishxy/animation/gun/normal/room3/pig_lv3_09.png","fishxy/animation/gun/normal/room3/pig_lv3_10.png"],loadList3D:[]},e.bgxyby_gun_8UI=i,t("ui.fishxy.animation.gun.bgxyby_gun_8UI",i),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[l,a,N,Sn],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Sprite",props:{y:-209,x:-88.5,texture:"fishxy/animation/gun/normal/room3/wukong_lv3_01.png"},compId:3},{type:"Label",props:{y:7,x:-3,width:45,text:"10",name:"cannon_level",height:24,font:"bmfont_fireCoin",anchorY:.5,anchorX:.5,align:"center"},compId:4},{type:"Sprite",props:{y:-88,x:-2,name:"muzzle"},compId:5}],animations:[{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/gun/normal/room3/wukong_lv3_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0}]}}],name:"stay",id:1,frameRate:24,action:0},{nodes:[{target:3,keyframes:{texture:[{value:"fishxy/animation/gun/normal/room3/wukong_lv3_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:0},{value:"fishxy/animation/gun/normal/room3/wukong_lv3_02.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:1},{value:"fishxy/animation/gun/normal/room3/wukong_lv3_03.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:2},{value:"fishxy/animation/gun/normal/room3/wukong_lv3_04.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:3},{value:"fishxy/animation/gun/normal/room3/wukong_lv3_05.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:4},{value:"fishxy/animation/gun/normal/room3/wukong_lv3_06.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:5},{value:"fishxy/animation/gun/normal/room3/wukong_lv3_07.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:6},{value:"fishxy/animation/gun/normal/room3/wukong_lv3_08.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:7},{value:"fishxy/animation/gun/normal/room3/wukong_lv3_09.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:8},{value:"fishxy/animation/gun/normal/room3/wukong_lv3_10.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:9},{value:"fishxy/animation/gun/normal/room3/wukong_lv3_01.png",tweenMethod:"linearNone",tween:!1,target:3,key:"texture",index:10}]}}],name:"attack",id:2,frameRate:24,action:0}],loadList:["fishxy/animation/gun/normal/room3/wukong_lv3_01.png","fishxy/animation/gun/normal/room3/wukong_lv3_02.png","fishxy/animation/gun/normal/room3/wukong_lv3_03.png","fishxy/animation/gun/normal/room3/wukong_lv3_04.png","fishxy/animation/gun/normal/room3/wukong_lv3_05.png","fishxy/animation/gun/normal/room3/wukong_lv3_06.png","fishxy/animation/gun/normal/room3/wukong_lv3_07.png","fishxy/animation/gun/normal/room3/wukong_lv3_08.png","fishxy/animation/gun/normal/room3/wukong_lv3_09.png","fishxy/animation/gun/normal/room3/wukong_lv3_10.png"],loadList3D:[]},e.bgxyby_gun_9UI=i,t("ui.fishxy.animation.gun.bgxyby_gun_9UI",i),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[a],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"SkeletonPlayer",props:{y:0,x:0,url:"fishxy/animation/fish/dragonbones/Goldhoop.sk",runtime:"Laya.Skeleton"},compId:4}],loadList:["fishxy/animation/fish/dragonbones/Goldhoop.sk"],loadList3D:[]},e.bgxyby_gun_logo_13UI=i,t("ui.fishxy.animation.gun.bgxyby_gun_logo_13UI",i),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[a],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"SkeletonPlayer",props:{y:0,x:0,url:"fishxy/animation/fish/dragonbones/Water.sk",runtime:"Laya.Skeleton"},compId:3}],loadList:["fishxy/animation/fish/dragonbones/Water.sk"],loadList3D:[]},e.bgxyby_gun_logo_14UI=i,t("ui.fishxy.animation.gun.bgxyby_gun_logo_14UI",i),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[a],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"SkeletonPlayer",props:{y:0,x:0,url:"fishxy/animation/fish/dragonbones/FourFaName.sk",runtime:"Laya.Skeleton"},compId:5}],loadList:["fishxy/animation/fish/dragonbones/FourFaName.sk"],loadList3D:[]},e.bgxyby_gun_logo_15UI=i,t("ui.fishxy.animation.gun.bgxyby_gun_logo_15UI",i),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[a],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"SkeletonPlayer",props:{y:0,x:0,url:"fishxy/animation/fish/dragonbones/Night.sk",runtime:"Laya.Skeleton"},compId:3}],loadList:["fishxy/animation/fish/dragonbones/Night.sk"],loadList3D:[]},e.bgxyby_gun_logo_16UI=i,t("ui.fishxy.animation.gun.bgxyby_gun_logo_16UI",i),n=(n=(n=Ki=Ki||{}).fishxy||(n.fishxy={})).fight||(n.fight={}),(e=function(){f(i,oa);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[wn,Sn,oa,vn,h,N],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"Dialog",props:{},compId:2,child:[{type:"Box",props:{y:2,x:0,name:"bg"},compId:3,child:[{type:"Image",props:{y:47,x:0,width:1105,skin:"fishxy/fight/dialog/BG_01.png",sizeGrid:"0,43,52,39",height:537},compId:12},{type:"Image",props:{y:0,skin:"fishxy/fight/dialog/Titel_bg.png",sizeGrid:"0,95,0,88"},compId:13},{type:"Image",props:{y:123,x:34,width:1032,skin:"fishxy/fight/dialog/BG_02.png",sizeGrid:"18,22,18,22",height:411},compId:22},{type:"Label",props:{y:25.5,x:448.046875,text:"温馨提示",fontSize:50,color:"#ffffff",bold:!0},compId:16},{type:"Sprite",props:{y:25.5,x:1031,texture:"fishxy/fight/dialog/Bnt_Close.png",name:"close"},compId:23}]},{type:"Button",props:{y:417,x:435.5,var:"ok",stateNum:1,skin:"fishxy/fight/dialog/btn_ok.png",name:"ok"},compId:17,child:[{type:"Sprite",props:{y:25,x:79,texture:"fishxy/fight/dialog/confirm_word_Cn.png"},compId:24},{type:"Script",props:{y:0,x:0,runtime:"framework/view/ui/ButtonEffect.ts"},compId:20}]},{type:"Label",props:{y:175,x:17,wordWrap:!0,width:1066,var:"info_label",valign:"middle",text:"您距离青铜抽奖仅差19271金币\\n您确定继续抽奖吗？",leading:5,height:238,fontSize:40,color:"#ffffff",align:"center"},compId:18}],loadList:["fishxy/fight/dialog/BG_01.png","fishxy/fight/dialog/Titel_bg.png","fishxy/fight/dialog/BG_02.png","fishxy/fight/dialog/Bnt_Close.png","fishxy/fight/dialog/btn_ok.png","fishxy/fight/dialog/confirm_word_Cn.png"],loadList3D:[]},n.AlertDialog1UI=e,t("ui.fishxy.fight.AlertDialog1UI",e),(e=function(){f(i,oa);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[vn,Sn,oa,h,N],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"Dialog",props:{},compId:2,child:[{type:"Box",props:{y:-46,x:-106,width:1102,height:462},compId:5,child:[{type:"Image",props:{y:110,x:106,width:497,skin:"fishxy/fight/dialog/boss_win/bosswin_frame.png",sizeGrid:"70,72,89,403",height:346},compId:3},{type:"Image",props:{y:110,x:1087.5,width:485,skin:"fishxy/fight/dialog/boss_win/bosswin_frame.png",sizeGrid:"70,72,89,403",scaleX:-1,height:346},compId:27},{type:"Sprite",props:{y:30,x:1135,texture:"fishxy/fight/dialog/boss_win/bosswinStar.png",scaleX:-1},compId:6},{type:"Sprite",props:{y:30,x:85,texture:"fishxy/fight/dialog/boss_win/bosswinStar.png"},compId:7},{type:"Sprite",props:{y:387,x:894,texture:"fishxy/fight/dialog/boss_win/bosswin_Light02.png"},compId:8},{type:"Sprite",props:{y:-64,x:-46,width:485,texture:"fishxy/fight/dialog/boss_win/bosswin_light01.png",height:348},compId:9}]},{type:"Box",props:{y:8.5,x:112,var:"die"},compId:10,child:[{type:"Sprite",props:{y:169,x:0,texture:"fishxy/fight/dialog/boss_win/niumodj_Cn.png"},compId:11},{type:"Sprite",props:{y:282,x:0,texture:"fishxy/fight/dialog/boss_win/niumojl_Cn.png"},compId:13},{type:"Label",props:{y:181,x:276,var:"die_nickname",text:"GUEST121212",strokeColor:"#2c429a",stroke:2,fontSize:40,color:"#38a3e0",bold:!0},compId:14},{type:"Label",props:{y:272,x:265,width:574,var:"die_coin",text:"GUEST121212",height:79,font:"bmfont_bigCoin"},compId:15},{type:"Sprite",props:{y:0,x:36,texture:"fishxy/fight/dialog/boss_win/niumojs_Cn.png"},compId:16}]},{type:"Box",props:{y:2,x:31,var:"exact"},compId:17,child:[{type:"Label",props:{y:280,x:0,width:936,var:"exact_coin",text:"121212",font:"bmfont_bigCoin",align:"center"},compId:18},{type:"Sprite",props:{y:0,x:241,texture:"fishxy/fight/dialog/boss_win/niumojz_Cn.png"},compId:19},{type:"Sprite",props:{y:152.5,x:318,texture:"fishxy/fight/dialog/boss_win/niumogj_Cn.png"},compId:20}]},{type:"Box",props:{y:7,x:123.5,var:"run_away"},compId:21,child:[{type:"Sprite",props:{y:174.5,x:234,texture:"fishxy/fight/dialog/boss_win/niumosm_Cn.png"},compId:22},{type:"Sprite",props:{y:297,x:126.5,texture:"fishxy/fight/dialog/boss_win/niumoxc_Cn.png"},compId:23},{type:"Label",props:{y:180.5,x:462,var:"remain_blood",text:"1%",strokeColor:"#2c429a",stroke:2,font:"bmfont_bossTime"},compId:24},{type:"Sprite",props:{y:0,x:36,texture:"fishxy/fight/dialog/boss_win/niumot_Cn.png"},compId:26}]}],loadList:["fishxy/fight/dialog/boss_win/bosswin_frame.png","fishxy/fight/dialog/boss_win/bosswinStar.png","fishxy/fight/dialog/boss_win/bosswin_Light02.png","fishxy/fight/dialog/boss_win/bosswin_light01.png","fishxy/fight/dialog/boss_win/niumodj_Cn.png","fishxy/fight/dialog/boss_win/niumojl_Cn.png","fishxy/fight/dialog/boss_win/niumojs_Cn.png","fishxy/fight/dialog/boss_win/niumojz_Cn.png","fishxy/fight/dialog/boss_win/niumogj_Cn.png","fishxy/fight/dialog/boss_win/niumosm_Cn.png","fishxy/fight/dialog/boss_win/niumoxc_Cn.png","fishxy/fight/dialog/boss_win/niumot_Cn.png"],loadList3D:[]},n.BossWinDialogUI=e,t("ui.fishxy.fight.BossWinDialogUI",e),(e=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[Sn,a,h],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{width:155,height:125},compId:2,child:[{type:"Image",props:{y:0,x:0,width:155,skin:"fishxy/fight/mainui/img_card_bg.png",sizeGrid:"15,20,18,21",name:"tips",height:125},compId:3},{type:"Label",props:{y:6,x:0,width:155,var:"title",text:"芭蕉扇",height:20,fontSize:20,color:"#f60c08",align:"center"},compId:4},{type:"Label",props:{y:30,x:63,width:27.802734375,var:"num",text:"0/3",height:20,fontSize:20,color:"#ffffff",align:"center"},compId:5},{type:"Label",props:{y:58,x:9,wordWrap:!0,width:140,var:"content",text:"捕获福袋可随机获得‘月光宝盒’，集满自动兑换金币",leading:3,height:61,fontSize:17,color:"#20f10e"},compId:6}],loadList:["fishxy/fight/mainui/img_card_bg.png"],loadList3D:[]},n.CardTipsUI=e,t("ui.fishxy.fight.CardTipsUI",e),(e=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[h,vn,wn,Un,a,N,Sn],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Box",props:{top:0,right:0,name:"bg_layer",left:0,bottom:0},compId:718,child:[{type:"Image",props:{var:"bg",top:0,right:0,left:0,bottom:0},compId:484},{type:"Image",props:{y:0,x:0,var:"bg_temp",top:0,right:0,left:0,bottom:0},compId:719}]},{type:"Box",props:{y:0,x:0,var:"fish_layer"},compId:482},{type:"Box",props:{y:0,x:0,var:"warter_layer",top:0,right:0,left:0,bottom:0},compId:720},{type:"Box",props:{var:"fight_layer",top:0,right:0,left:0,bottom:0},compId:34},{type:"Box",props:{var:"user_layer",top:0,right:0,mouseThrough:!0,left:0,bottom:0},compId:10,child:[{type:"Box",props:{x:238.5,width:471,name:"seat_0",mouseThrough:!0,height:130,bottom:0,anchorY:1,anchorX:.5},compId:11,child:[{type:"Sprite",props:{y:-124,x:124,name:"fish_die_ui_pos"},compId:281},{type:"Image",props:{y:22,x:242,skin:"fishxy/fight/mainui/position.png"},compId:67},{type:"Location_Effect",props:{y:78,x:315,visible:!1,scaleY:1,scaleX:1,name:"location",runtime:"ui.fishxy.animation.Location_EffectUI"},compId:236},{type:"Image",props:{y:58,x:232,skin:"fishxy/fight/mainui/wait_Cn.png",name:"waiting"},compId:205},{type:"Box",props:{y:12,x:0,width:167,visible:!1,name:"user_info",height:117},compId:130,child:[{type:"Image",props:{y:57,x:0,skin:"fishxy/fight/mainui/UserUI.png",name:"bg"},compId:59},{type:"Label",props:{y:94,x:45.5,text:"小狗粮",name:"nickname",height:20,fontSize:18,color:"#6cdee2"},compId:69},{type:"Label",props:{y:62,x:46,text:"0.0",name:"money",fontSize:20,font:"bmfont_RoleGoldZi",color:"#f9f900"},compId:68},{type:"Box",props:{y:0,x:0,width:167,name:"props",height:54},compId:377,child:[{type:"Box",props:{y:0,x:0,width:0,name:"dont_not_remove",height:0},compId:516,child:[{type:"Script",props:{runtime:"games/fishxy/scenes/fight/user/PropsCard.ts"},compId:517}]},{type:"Clip",props:{y:27,x:27,width:54,skin:"fishxy/fight/mainui/clip_box_card.png",name:"box_prop_clip",index:0,height:54,clipY:2,anchorY:.5,anchorX:.5},compId:382,child:[{type:"Label",props:{y:35,x:26,text:"0/3",strokeColor:"#000000",stroke:2,name:"num",fontSize:18,color:"#ffffff"},compId:386},{type:"Script",props:{title:"月光宝盒",name:"捕获福袋可随机获得'月光宝盒'，集满自动兑换金币",content:"捕获福袋可随机获得‘月光宝盒’，集满自动兑换金币",runtime:"games/fishxy/scenes/fight/user/PropsCard.ts"},compId:513}]},{type:"Clip",props:{y:27,x:84,width:54,skin:"fishxy/fight/mainui/clip_mirror_card.png",name:"mirror_prop_clip",height:54,clipY:2,anchorY:.5,anchorX:.5},compId:380,child:[{type:"Label",props:{y:35,x:26,text:"0/3",strokeColor:"#000000",stroke:2,name:"num",fontSize:18,color:"#ffffff"},compId:387},{type:"Script",props:{title:"照妖镜",name:"捕获福袋可随机获得'照妖镜'，集满自动兑换金币",content:"捕获福袋可随机获得‘照妖镜’，集满自动兑换金币",runtime:"games/fishxy/scenes/fight/user/PropsCard.ts"},compId:514}]},{type:"Clip",props:{y:27,x:140,width:54,skin:"fishxy/fight/mainui/clip_fan_card.png",name:"fan_prop_clip",height:54,clipY:2,anchorY:.5,anchorX:.5},compId:379,child:[{type:"Label",props:{y:35,x:26,text:"0/3",strokeColor:"#000000",stroke:2,name:"num",fontSize:18,color:"#ffffff"},compId:388},{type:"Script",props:{title:"芭蕉扇",name:"捕获福袋可随机获得'芭蕉扇'，集满自动兑换金币",content:"捕获福袋可随机获得‘芭蕉扇’，集满自动兑换金币",runtime:"games/fishxy/scenes/fight/user/PropsCard.ts"},compId:515}]}]},{type:"Image",props:{y:75,x:19,width:29,skin:"fishxy/animation/common/coin_gold_0.png",name:"coin",height:29,anchorY:.5,anchorX:.5},compId:501}]},{type:"Box",props:{y:0,x:216,width:199,visible:!1,name:"weapon",height:130},compId:12,child:[{type:"Box",props:{y:0,x:0,visible:!1,name:"operation_btns"},compId:733,child:[{type:"Sprite",props:{y:90,x:421,texture:"fishxy/fight/mainui/position3.png",scaleX:-1},compId:725},{type:"Sprite",props:{y:22,x:-52,texture:"fishxy/fight/mainui/position2.png"},compId:375},{type:"Button",props:{y:78,x:-38,stateNum:2,skin:"fishxy/fight/mainui/btn_sub_gun.png",name:"sub_gun_btn"},compId:40,child:[{type:"Script",props:{clickSound:"SFX_UI_015.mp3",runtime:"framework/view/ui/ButtonEffect.ts"},compId:50}]},{type:"Button",props:{y:78,x:169,stateNum:2,skin:"fishxy/fight/mainui/btn_add_gun.png",name:"add_gun_btn"},compId:39,child:[{type:"Script",props:{clickSound:"SFX_UI_014.mp3",runtime:"framework/view/ui/ButtonEffect.ts"},compId:49}]},{type:"Clip",props:{y:61,x:297,width:70,stateNum:3,skin:"fishxy/fight/mainui/clip_fire_speed.png",scaleY:1.2,scaleX:1.2,name:"fire_speed_btn",mouseEnabled:!0,height:76,clipY:3,anchorY:.5,anchorX:.5},compId:734,child:[{type:"Script",props:{clickSound:"SFX_UI_004.mp3",runtime:"framework/view/ui/ButtonEffect.ts"},compId:736}]},{type:"Clip",props:{y:59,x:388,width:70,stateNum:1,skin:"fishxy/fight/mainui/clip_auto_fire.png",scaleY:1.2,scaleX:1.2,name:"auto_fire_btn",height:76,clipY:2,anchorY:.5,anchorX:.5},compId:735,child:[{type:"Script",props:{y:0,x:0,clickSound:"SFX_UI_004.mp3",runtime:"framework/view/ui/ButtonEffect.ts"},compId:737}]}]},{type:"bgxyby_gun_1",props:{y:85,x:100,width:62,rotation:0,name:"gun",height:54,runtime:"ui.fishxy.animation.gun.bgxyby_gun_1UI"},compId:374}]},{type:"Box",props:{y:-175,x:271,width:85,visible:!1,name:"count_down_fire",height:91},compId:341,child:[{type:"Image",props:{y:44.5,x:41.5,skin:"fishxy/fight/mainui/toFire.png",name:"type",anchorY:.5,anchorX:.5},compId:342},{type:"Label",props:{y:45,x:39,width:70,text:"30",scaleY:.8,scaleX:.8,name:"time",height:48,font:"bmfont_bossTime",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:344}]},{type:"Script",props:{runtime:"games/fishxy/scenes/fight/user/UserSeatScript.ts"},compId:370}]},{type:"Box",props:{x:1261.5,width:471,name:"seat_1",mouseThrough:!0,height:311,bottom:0,anchorY:1,anchorX:.5},compId:551,child:[{type:"Sprite",props:{y:60,x:278,name:"fish_die_ui_pos"},compId:552},{type:"Image",props:{y:205,x:79,skin:"fishxy/fight/mainui/position.png"},compId:553},{type:"Location_Effect",props:{y:251.5,x:152,visible:!1,scaleY:1,scaleX:1,name:"location",runtime:"ui.fishxy.animation.Location_EffectUI"},compId:554},{type:"Image",props:{y:247.5,x:67,skin:"fishxy/fight/mainui/wait_Cn.png",name:"waiting"},compId:555},{type:"Box",props:{y:193,x:306,width:167,visible:!1,name:"user_info",height:117},compId:556,child:[{type:"Image",props:{y:57,x:0,skin:"fishxy/fight/mainui/UserUI.png",name:"bg"},compId:557},{type:"Label",props:{y:94,x:45.5,text:"小狗粮",name:"nickname",height:20,fontSize:18,color:"#6cdee2"},compId:558},{type:"Label",props:{y:62,x:46,width:97,text:"0.0",name:"money",height:32,fontSize:20,font:"bmfont_RoleGoldZi",color:"#f9f900"},compId:559},{type:"Box",props:{y:0,x:0,width:167,name:"props",height:54},compId:560,child:[{type:"Box",props:{y:0,x:0,width:0,name:"dont_not_remove",height:0},compId:561,child:[{type:"Script",props:{runtime:"games/fishxy/scenes/fight/user/PropsCard.ts"},compId:562}]},{type:"Clip",props:{y:27,x:27,width:54,skin:"fishxy/fight/mainui/clip_box_card.png",name:"box_prop_clip",height:54,clipY:2,anchorY:.5,anchorX:.5},compId:563,child:[{type:"Label",props:{y:35,x:26,text:"0/3",strokeColor:"#000000",stroke:2,name:"num",fontSize:18,color:"#ffffff"},compId:564},{type:"Script",props:{title:"月光宝盒",name:"捕获福袋可随机获得'月光宝盒'，集满自动兑换金币",content:"捕获福袋可随机获得‘月光宝盒’，集满自动兑换金币",runtime:"games/fishxy/scenes/fight/user/PropsCard.ts"},compId:565}]},{type:"Clip",props:{y:27,x:84,width:54,skin:"fishxy/fight/mainui/clip_mirror_card.png",name:"mirror_prop_clip",height:54,clipY:2,anchorY:.5,anchorX:.5},compId:566,child:[{type:"Label",props:{y:35,x:26,text:"0/3",strokeColor:"#000000",stroke:2,name:"num",fontSize:18,color:"#ffffff"},compId:567},{type:"Script",props:{title:"照妖镜",name:"捕获福袋可随机获得'照妖镜'，集满自动兑换金币",content:"捕获福袋可随机获得‘照妖镜’，集满自动兑换金币",runtime:"games/fishxy/scenes/fight/user/PropsCard.ts"},compId:568}]},{type:"Clip",props:{y:27,x:140,width:54,skin:"fishxy/fight/mainui/clip_fan_card.png",name:"fan_prop_clip",height:54,clipY:2,anchorY:.5,anchorX:.5},compId:569,child:[{type:"Label",props:{y:35,x:26,text:"0/3",strokeColor:"#000000",stroke:2,name:"num",fontSize:18,color:"#ffffff"},compId:570},{type:"Script",props:{title:"芭蕉扇",name:"捕获福袋可随机获得'芭蕉扇'，集满自动兑换金币",content:"捕获福袋可随机获得‘芭蕉扇’，集满自动兑换金币",runtime:"games/fishxy/scenes/fight/user/PropsCard.ts"},compId:571}]}]},{type:"Image",props:{y:75,x:19,width:29,skin:"fishxy/animation/common/usdt_icon.png",name:"coin",height:29,anchorY:.5,anchorX:.5},compId:572}]},{type:"Box",props:{y:182.5,x:0,width:199,visible:!1,name:"weapon",height:130},compId:573,child:[{type:"Box",props:{y:1,x:0,visible:!1,name:"operation_btns"},compId:732,child:[{type:"Sprite",props:{y:88,x:-166,texture:"fishxy/fight/mainui/position3.png"},compId:731},{type:"Sprite",props:{y:21,x:0,texture:"fishxy/fight/mainui/position2.png"},compId:574},{type:"Button",props:{y:77,x:14,stateNum:2,skin:"fishxy/fight/mainui/btn_sub_gun.png",name:"sub_gun_btn"},compId:575,child:[{type:"Script",props:{clickSound:"SFX_UI_015.mp3",runtime:"framework/view/ui/ButtonEffect.ts"},compId:576}]},{type:"Button",props:{y:77,x:221,stateNum:2,skin:"fishxy/fight/mainui/btn_add_gun.png",name:"add_gun_btn"},compId:577,child:[{type:"Script",props:{clickSound:"SFX_UI_014.mp3",runtime:"framework/view/ui/ButtonEffect.ts"},compId:578}]},{type:"Clip",props:{y:59,x:-129,width:70,stateNum:3,skin:"fishxy/fight/mainui/clip_fire_speed.png",scaleY:1.2,scaleX:1.2,name:"fire_speed_btn",mouseEnabled:!0,height:76,clipY:3,anchorY:.5,anchorX:.5},compId:202,child:[{type:"Script",props:{clickSound:"SFX_UI_004.mp3",runtime:"framework/view/ui/ButtonEffect.ts"},compId:499}]},{type:"Clip",props:{y:59,x:-37,width:70,stateNum:1,skin:"fishxy/fight/mainui/clip_auto_fire.png",scaleY:1.2,scaleX:1.2,name:"auto_fire_btn",height:76,clipY:2,anchorY:.5,anchorX:.5},compId:361,child:[{type:"Script",props:{y:0,x:0,clickSound:"SFX_UI_004.mp3",runtime:"framework/view/ui/ButtonEffect.ts"},compId:364}]}]},{type:"bgxyby_gun_1",props:{y:85,x:151.5,name:"gun",runtime:"ui.fishxy.animation.gun.bgxyby_gun_1UI"},compId:579}]},{type:"Box",props:{y:-24,x:111.5,width:83,visible:!1,name:"count_down_fire",height:92},compId:580,child:[{type:"Image",props:{y:44.5,x:41.5,skin:"fishxy/fight/mainui/toFire.png",name:"type",anchorY:.5,anchorX:.5},compId:581},{type:"Label",props:{y:45,x:39,width:70,text:"30",scaleY:.8,scaleX:.8,name:"time",height:48,font:"bmfont_bossTime",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:582}]},{type:"Script",props:{y:155.5,x:272,runtime:"games/fishxy/scenes/fight/user/UserSeatScript.ts"},compId:583}]},{type:"Box",props:{x:1261.5,width:471,top:0,name:"seat_2",mouseThrough:!0,height:130,anchorX:.5},compId:587,child:[{type:"Sprite",props:{y:175,x:273,name:"fish_die_ui_pos"},compId:588},{type:"Image",props:{y:107,x:233,width:148,skin:"fishxy/fight/mainui/position.png",rotation:180,height:107},compId:589},{type:"Image",props:{y:13,x:73,skin:"fishxy/fight/mainui/wait_Cn.png",name:"waiting"},compId:591},{type:"Box",props:{y:0,x:302,width:167,visible:!1,name:"user_info",height:117},compId:592,child:[{type:"Image",props:{y:0,x:0,skin:"fishxy/fight/mainui/UserUI.png",name:"bg"},compId:593},{type:"Label",props:{y:36,x:46,text:"小狗粮",name:"nickname",height:20,fontSize:18,color:"#6cdee2"},compId:594},{type:"Label",props:{y:4,x:46,text:"0.0",name:"money",fontSize:20,font:"bmfont_RoleGoldZi",color:"#f9f900"},compId:595},{type:"Box",props:{y:63,x:0,width:167,name:"props",height:54},compId:596,child:[{type:"Box",props:{y:0,x:0,width:0,name:"dont_not_remove",height:0},compId:597,child:[{type:"Script",props:{runtime:"games/fishxy/scenes/fight/user/PropsCard.ts"},compId:598}]},{type:"Clip",props:{y:27,x:27,width:54,skin:"fishxy/fight/mainui/clip_box_card.png",name:"box_prop_clip",height:54,clipY:2,anchorY:.5,anchorX:.5},compId:599,child:[{type:"Label",props:{y:35,x:26,text:"0/3",strokeColor:"#000000",stroke:2,name:"num",fontSize:18,color:"#ffffff"},compId:600},{type:"Script",props:{title:"月光宝盒",name:"捕获福袋可随机获得'月光宝盒'，集满自动兑换金币",content:"捕获福袋可随机获得‘月光宝盒’，集满自动兑换金币",runtime:"games/fishxy/scenes/fight/user/PropsCard.ts"},compId:601}]},{type:"Clip",props:{y:27,x:84,width:54,skin:"fishxy/fight/mainui/clip_mirror_card.png",name:"mirror_prop_clip",height:54,clipY:2,anchorY:.5,anchorX:.5},compId:602,child:[{type:"Label",props:{y:35,x:26,text:"0/3",strokeColor:"#000000",stroke:2,name:"num",fontSize:18,color:"#ffffff"},compId:603},{type:"Script",props:{title:"照妖镜",name:"捕获福袋可随机获得'照妖镜'，集满自动兑换金币",content:"捕获福袋可随机获得‘照妖镜’，集满自动兑换金币",runtime:"games/fishxy/scenes/fight/user/PropsCard.ts"},compId:604}]},{type:"Clip",props:{y:27,x:140,width:54,skin:"fishxy/fight/mainui/clip_fan_card.png",name:"fan_prop_clip",height:54,clipY:2,anchorY:.5,anchorX:.5},compId:605,child:[{type:"Label",props:{y:35,x:26,text:"0/3",strokeColor:"#000000",stroke:2,name:"num",fontSize:18,color:"#ffffff"},compId:606},{type:"Script",props:{title:"芭蕉扇",name:"捕获福袋可随机获得'芭蕉扇'，集满自动兑换金币",content:"捕获福袋可随机获得‘芭蕉扇’，集满自动兑换金币",runtime:"games/fishxy/scenes/fight/user/PropsCard.ts"},compId:607}]}]},{type:"Image",props:{y:18,x:19,width:29,skin:"fishxy/animation/common/usdt_icon.png",name:"coin",height:29,anchorY:.5,anchorX:.5},compId:608}]},{type:"Box",props:{y:0,x:59,width:199,visible:!1,name:"weapon",height:130},compId:609,child:[{type:"Sprite",props:{y:22,x:-52,visible:!1,texture:"fishxy/fight/mainui/position2.png",name:"add_btn_bg"},compId:610},{type:"Button",props:{y:78,x:-38,visible:!1,stateNum:2,skin:"fishxy/fight/mainui/btn_sub_gun.png",name:"sub_gun_btn"},compId:611,child:[{type:"Script",props:{runtime:"framework/view/ui/ButtonEffect.ts"},compId:612}]},{type:"Button",props:{y:78,x:169,visible:!1,stateNum:2,skin:"fishxy/fight/mainui/btn_add_gun.png",name:"add_gun_btn"},compId:613,child:[{type:"Script",props:{runtime:"framework/view/ui/ButtonEffect.ts"},compId:614}]},{type:"bgxyby_gun_1",props:{y:45,x:99.5,width:62,rotation:180,name:"gun",height:54,runtime:"ui.fishxy.animation.gun.bgxyby_gun_1UI"},compId:615}]},{type:"Box",props:{y:175,x:116,width:85,visible:!1,name:"count_down_fire",height:91},compId:616,child:[{type:"Image",props:{y:44.5,x:41.5,skin:"fishxy/fight/mainui/toFire.png",name:"type",anchorY:.5,anchorX:.5},compId:617},{type:"Label",props:{y:45,x:39,width:70,text:"30",scaleY:.8,scaleX:.8,name:"time",height:48,font:"bmfont_bossTime",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:618}]},{type:"Script",props:{y:0,x:59,runtime:"games/fishxy/scenes/fight/user/UserSeatScript.ts"},compId:619}]},{type:"Box",props:{x:238.5,width:471,top:0,name:"seat_3",mouseThrough:!0,height:130,anchorX:.5},compId:686,child:[{type:"Sprite",props:{y:199,x:142,name:"fish_die_ui_pos"},compId:687},{type:"Image",props:{y:108,x:400,width:148,skin:"fishxy/fight/mainui/position.png",rotation:180,height:107},compId:688},{type:"Image",props:{y:14,x:240,skin:"fishxy/fight/mainui/wait_Cn.png",name:"waiting"},compId:689},{type:"Box",props:{y:0,x:0,width:167,visible:!1,name:"user_info",height:117},compId:690,child:[{type:"Image",props:{y:0,x:0,skin:"fishxy/fight/mainui/UserUI.png",name:"bg"},compId:691},{type:"Label",props:{y:36,x:46,text:"小狗粮",name:"nickname",height:20,fontSize:18,color:"#6cdee2"},compId:692},{type:"Label",props:{y:4,x:46,text:"0.0",name:"money",fontSize:20,font:"bmfont_RoleGoldZi",color:"#f9f900"},compId:693},{type:"Box",props:{y:63,x:0,width:167,name:"props",height:54},compId:694,child:[{type:"Box",props:{y:0,x:0,width:0,name:"dont_not_remove",height:0},compId:695,child:[{type:"Script",props:{runtime:"games/fishxy/scenes/fight/user/PropsCard.ts"},compId:696}]},{type:"Clip",props:{y:27,x:27,width:54,skin:"fishxy/fight/mainui/clip_box_card.png",name:"box_prop_clip",height:54,clipY:2,anchorY:.5,anchorX:.5},compId:697,child:[{type:"Label",props:{y:35,x:26,text:"0/3",strokeColor:"#000000",stroke:2,name:"num",fontSize:18,color:"#ffffff"},compId:698},{type:"Script",props:{title:"月光宝盒",name:"捕获福袋可随机获得'月光宝盒'，集满自动兑换金币",content:"捕获福袋可随机获得‘月光宝盒’，集满自动兑换金币",runtime:"games/fishxy/scenes/fight/user/PropsCard.ts"},compId:699}]},{type:"Clip",props:{y:27,x:84,width:54,skin:"fishxy/fight/mainui/clip_mirror_card.png",name:"mirror_prop_clip",height:54,clipY:2,anchorY:.5,anchorX:.5},compId:700,child:[{type:"Label",props:{y:35,x:26,text:"0/3",strokeColor:"#000000",stroke:2,name:"num",fontSize:18,color:"#ffffff"},compId:701},{type:"Script",props:{title:"照妖镜",name:"捕获福袋可随机获得'照妖镜'，集满自动兑换金币",content:"捕获福袋可随机获得‘照妖镜’，集满自动兑换金币",runtime:"games/fishxy/scenes/fight/user/PropsCard.ts"},compId:702}]},{type:"Clip",props:{y:27,x:140,width:54,skin:"fishxy/fight/mainui/clip_fan_card.png",name:"fan_prop_clip",height:54,clipY:2,anchorY:.5,anchorX:.5},compId:703,child:[{type:"Label",props:{y:35,x:26,text:"0/3",strokeColor:"#000000",stroke:2,name:"num",fontSize:18,color:"#ffffff"},compId:704},{type:"Script",props:{title:"芭蕉扇",name:"捕获福袋可随机获得'芭蕉扇'，集满自动兑换金币",content:"捕获福袋可随机获得‘芭蕉扇’，集满自动兑换金币",runtime:"games/fishxy/scenes/fight/user/PropsCard.ts"},compId:705}]}]},{type:"Image",props:{y:18,x:19,width:29,skin:"fishxy/animation/common/usdt_icon.png",name:"coin",height:29,anchorY:.5,anchorX:.5},compId:706}]},{type:"Box",props:{y:1,x:226,width:199,visible:!1,name:"weapon",height:130},compId:707,child:[{type:"Sprite",props:{y:22,x:-52,visible:!1,texture:"fishxy/fight/mainui/position2.png",name:"add_btn_bg"},compId:708},{type:"Button",props:{y:78,x:-38,visible:!1,stateNum:2,skin:"fishxy/fight/mainui/btn_sub_gun.png",name:"sub_gun_btn"},compId:709,child:[{type:"Script",props:{runtime:"framework/view/ui/ButtonEffect.ts"},compId:710}]},{type:"Button",props:{y:78,x:169,visible:!1,stateNum:2,skin:"fishxy/fight/mainui/btn_add_gun.png",name:"add_gun_btn"},compId:711,child:[{type:"Script",props:{runtime:"framework/view/ui/ButtonEffect.ts"},compId:712}]},{type:"bgxyby_gun_1",props:{y:45,x:99.5,width:62,rotation:180,name:"gun",height:54,runtime:"ui.fishxy.animation.gun.bgxyby_gun_1UI"},compId:713}]},{type:"Box",props:{y:176,x:283,width:85,visible:!1,name:"count_down_fire",height:91},compId:714,child:[{type:"Image",props:{y:44.5,x:41.5,skin:"fishxy/fight/mainui/toFire.png",name:"type",anchorY:.5,anchorX:.5},compId:715},{type:"Label",props:{y:45,x:39,width:70,text:"30",scaleY:.8,scaleX:.8,name:"time",height:48,font:"bmfont_bossTime",color:"#ffffff",anchorY:.5,anchorX:.5,align:"center"},compId:716}]},{type:"Script",props:{y:1,x:119,runtime:"games/fishxy/scenes/fight/user/UserSeatScript.ts"},compId:717}]}]},{type:"Box",props:{var:"ui_effect_layer",top:0,right:0,mouseThrough:!0,left:0,bottom:0},compId:369},{type:"Box",props:{var:"ui_layer",top:0,right:0,mouseThrough:!0,left:0,bottom:0},compId:195,child:[{type:"Box",props:{width:232,right:-134,height:401,centerY:-39},compId:722,child:[{type:"Box",props:{y:0,x:50,width:328,name:"top_box",mouseEnabled:!0,height:81},compId:243,child:[{type:"Box",props:{y:1,x:60,width:251,var:"right_box",height:81,anchorY:"",anchorX:""},compId:204,child:[{type:"Button",props:{y:41.199999999999996,x:37.199999999999996,width:"",var:"help_btn",stateNum:1,skin:"fishxy/fight/mainui/btn_right_help.png",scaleY:1.2,scaleX:1.2,height:"",anchorY:.5,anchorX:.5},compId:248,child:[{type:"Script",props:{runtime:"framework/view/ui/ButtonEffect.ts"},compId:253}]},{type:"Button",props:{y:40.199999999999996,x:213.2,width:"",var:"exit_btn",stateNum:1,skin:"fishxy/fight/mainui/btn_right_exit.png",scaleY:1.2,scaleX:1.2,height:"",anchorY:.5,anchorX:.5},compId:249,child:[{type:"Script",props:{runtime:"framework/view/ui/ButtonEffect.ts"},compId:252}]},{type:"Button",props:{y:40.199999999999996,x:125.19999999999999,width:"",var:"setting_btn",stateNum:1,skin:"fishxy/fight/mainui/btn_right_setting.png",scaleY:1.2,scaleX:1.2,height:"",anchorY:.5,anchorX:.5},compId:250,child:[{type:"Script",props:{runtime:"framework/view/ui/ButtonEffect.ts"},compId:251}]}]},{type:"Button",props:{y:40.199999999999996,x:21.599999999999998,width:"",visible:!1,var:"hide_group_btn",stateNum:1,skin:"fishxy/fight/mainui/btn_right_hide.png",scaleY:1.2,scaleX:1.2,height:"",anchorY:.5,anchorX:.5},compId:241,child:[{type:"Script",props:{clickSound:"SFX_UI_007.mp3",runtime:"framework/view/ui/ButtonEffect.ts"},compId:289}]},{type:"Button",props:{y:40.199999999999996,x:21.599999999999998,width:"",var:"show_group_btn",stateNum:1,skin:"fishxy/fight/mainui/btn_left_show.png",scaleY:1.2,scaleX:1.2,height:"",anchorY:.5,anchorX:.5},compId:246,child:[{type:"Script",props:{clickSound:"SFX_UI_008.mp3",runtime:"framework/view/ui/ButtonEffect.ts"},compId:247}]}]},{type:"Box",props:{y:114,x:0,width:92,name:"right_box",height:287},compId:196,child:[{type:"Clip",props:{y:46,x:47.4,width:70,var:"lock_special_clip",stateNum:1,skin:"fishxy/fight/mainui/clip_lock_special_fish.png",scaleY:1.2,scaleX:1.2,height:76,clipY:2,anchorY:.5,anchorX:.5},compId:197,child:[{type:"Script",props:{y:0,x:0,clickSound:"SFX_UI_004.mp3",runtime:"framework/view/ui/ButtonEffect.ts"},compId:199}]},{type:"Clip",props:{y:144,x:47.4,width:70,var:"lock_big_clip",stateNum:1,skin:"fishxy/fight/mainui/clip_lock_big_fish.png",scaleY:1.2,scaleX:1.2,height:76,clipY:2,anchorY:.5,anchorX:.5},compId:200,child:[{type:"Script",props:{y:0,x:0,clickSound:"SFX_UI_004.mp3",runtime:"framework/view/ui/ButtonEffect.ts"},compId:201}]},{type:"Button",props:{y:242,x:47.4,width:79,var:"lock_cancel_btn",stateNum:1,skin:"fishxy/fight/mainui/btn_cancel_lock.png",scaleY:1.2,scaleX:1.2,height:76,anchorY:.5,anchorX:.5},compId:365,child:[{type:"Script",props:{y:0,x:0,clickSound:"SFX_UI_004.mp3",runtime:"framework/view/ui/ButtonEffect.ts"},compId:368}]}]},{type:"Box",props:{y:15,var:"bottom_box"},compId:724}]}]}],loadList:["fishxy/fight/mainui/position.png","fishxy/fight/mainui/wait_Cn.png","fishxy/fight/mainui/UserUI.png","fishxy/fight/mainui/clip_box_card.png","fishxy/fight/mainui/clip_mirror_card.png","fishxy/fight/mainui/clip_fan_card.png","fishxy/animation/common/coin_gold_0.png","fishxy/fight/mainui/position3.png","fishxy/fight/mainui/position2.png","fishxy/fight/mainui/btn_sub_gun.png","fishxy/fight/mainui/btn_add_gun.png","fishxy/fight/mainui/clip_fire_speed.png","fishxy/fight/mainui/clip_auto_fire.png","fishxy/fight/mainui/toFire.png","fishxy/animation/common/usdt_icon.png","fishxy/fight/mainui/btn_right_help.png","fishxy/fight/mainui/btn_right_exit.png","fishxy/fight/mainui/btn_right_setting.png","fishxy/fight/mainui/btn_right_hide.png","fishxy/fight/mainui/btn_left_show.png","fishxy/fight/mainui/clip_lock_special_fish.png","fishxy/fight/mainui/clip_lock_big_fish.png","fishxy/fight/mainui/btn_cancel_lock.png"],loadList3D:[]},n.FightSceneUI=e,t("ui.fishxy.fight.FightSceneUI",e),(e=function(){f(i,oa);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[wn,Sn,N,Un,oa,vn,h,zn],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"Dialog",props:{},compId:2,child:[{type:"Box",props:{y:0,x:0,name:"bg"},compId:6,child:[{type:"Image",props:{y:29,x:3,width:1097,skin:"fishxy/fight/dialog/BG_01.png",sizeGrid:"9,40,52,41",height:574},compId:4},{type:"Image",props:{y:0,skin:"fishxy/fight/dialog/Titel_bg.png"},compId:5},{type:"Button",props:{y:24,x:1030,stateNum:1,skin:"fishxy/fight/dialog/Bnt_Close.png",name:"close"},compId:7,child:[{type:"Script",props:{runtime:"framework/view/ui/ButtonEffect.ts"},compId:27}]},{type:"Sprite",props:{y:13,x:403,texture:"fishxy/fight/dialog/Title_word_game_Cn.png"},compId:211}]},{type:"Image",props:{y:128,x:274,width:785,skin:"fishxy/fight/dialog/BG_02.png",sizeGrid:"15,18,18,20",height:427},compId:213},{type:"Box",props:{y:128,x:276,width:781,vScrollBarSkin:" ",name:"content_0",height:425,elasticEnabled:!0},compId:29,child:[{type:"List",props:{y:13,x:34.5,width:712,spaceY:10,spaceX:10,repeatY:2,repeatX:6,name:"page_0",height:346},compId:55,child:[{type:"Box",props:{y:-1,x:0,width:110,renderType:"render",height:167},compId:56,child:[{type:"Image",props:{y:117,x:0,width:112,skin:"fishxy/fight/dialog/BG_smile_normal_DN.png",sizeGrid:"5,18,25,29",height:53},compId:57},{type:"Image",props:{y:0,x:0,width:112,skin:"fishxy/fight/dialog/BG_smile_normal_UP.png",sizeGrid:"13,18,10,29",height:119},compId:214},{type:"Image",props:{y:46,x:54,skin:"fishxy/fight/fishicon/fish_1.png",scaleY:.9,scaleX:.9,name:"icon",anchorY:.5,anchorX:.5},compId:58},{type:"Label",props:{y:142,x:57,width:106,text:"x80-100",strokeColor:"#138e84",stroke:1,name:"rate",height:32,fontSize:20,font:"bmfont_fishBeiZi",color:"#ffcc20",anchorY:.5,anchorX:.5,align:"center"},compId:60},{type:"Image",props:{y:101,x:58,skin:"fishxy/fight/dialog/fish_1.png",name:"fish_name",anchorY:.5,anchorX:.5},compId:215}]}]},{type:"List",props:{y:13,x:34.5,width:712,spaceY:10,spaceX:10,repeatY:2,repeatX:6,name:"page_1",height:346},compId:222,child:[{type:"Box",props:{y:-1,x:0,width:110,renderType:"render",height:167},compId:223,child:[{type:"Image",props:{y:117,x:0,width:112,skin:"fishxy/fight/dialog/BG_smile_normal_DN.png",sizeGrid:"5,18,25,29",height:53},compId:224},{type:"Image",props:{y:0,x:0,width:112,skin:"fishxy/fight/dialog/BG_smile_normal_UP.png",sizeGrid:"13,18,10,29",height:119},compId:225},{type:"Image",props:{y:46,x:54,skin:"fishxy/fight/fishicon/fish_1.png",scaleY:.9,scaleX:.9,name:"icon",anchorY:.5,anchorX:.5},compId:226},{type:"Label",props:{y:142,x:57,width:106,text:"x50",strokeColor:"#138e84",stroke:1,name:"rate",height:32,fontSize:20,font:"bmfont_fishBeiZi",color:"#ffcc20",anchorY:.5,anchorX:.5,align:"center"},compId:227},{type:"Image",props:{y:101,x:58,skin:"fishxy/fight/dialog/fish_1.png",name:"fish_name",anchorY:.5,anchorX:.5},compId:228}]}]},{type:"List",props:{y:13,x:-7.399999999999977,spaceY:10,spaceX:10,repeatY:2,repeatX:6,name:"page_2",height:346},compId:229,child:[{type:"Box",props:{y:0,x:-5},compId:238,child:[{type:"Image",props:{y:50,x:35,width:177,skin:"fishxy/fight/dialog/BG_PageDown2_DN.png",sizeGrid:"3,24,26,27",height:288},compId:236},{type:"Image",props:{y:0,x:35,width:177,skin:"fishxy/fight/dialog/BG_PageDown2_UP.png",sizeGrid:"19,29,11,25",height:51},compId:237},{type:"Image",props:{y:89,x:5,skin:"fishxy/fight/dialog/BG_PageDown2_light.png",scaleY:.6,scaleX:.6},compId:243},{type:"Image",props:{y:14,x:64,skin:"fishxy/fight/dialog/Pao_1_word_Cn.png",scaleY:.8,scaleX:.8},compId:240},{type:"Image",props:{y:66,x:70,skin:"fishxy/fight/dialog/Pao_1.png",scaleY:.8,scaleX:.8},compId:241},{type:"Image",props:{y:214,x:50,skin:"fishxy/fight/dialog/Word_1_Cn.png",scaleY:.9,scaleX:.9},compId:242}]},{type:"Box",props:{y:0,x:182},compId:265,child:[{type:"Image",props:{y:50,x:35,width:177,skin:"fishxy/fight/dialog/BG_PageDown2_DN.png",sizeGrid:"3,24,26,27",height:288},compId:266},{type:"Image",props:{y:0,x:35,width:177,skin:"fishxy/fight/dialog/BG_PageDown2_UP.png",sizeGrid:"19,29,11,25",height:51},compId:267},{type:"Image",props:{y:89,x:5,skin:"fishxy/fight/dialog/BG_PageDown2_light.png",scaleY:.6,scaleX:.6},compId:268},{type:"Image",props:{y:25.5,x:126.5,skin:"fishxy/fight/dialog/Pao_2_word_Cn.png",scaleY:.8,scaleX:.8,anchorY:.5,anchorX:.5},compId:269},{type:"Image",props:{y:63,x:69,skin:"fishxy/fight/dialog/Pao_2.png",scaleY:.8,scaleX:.8},compId:270},{type:"Image",props:{y:214,x:49,skin:"fishxy/fight/dialog/Word_2_Cn.png",scaleY:.9,scaleX:.9},compId:271}]},{type:"Box",props:{y:1,x:368},compId:272,child:[{type:"Image",props:{y:50,x:35,width:177,skin:"fishxy/fight/dialog/BG_PageDown2_DN.png",sizeGrid:"3,24,26,27",height:288},compId:273},{type:"Image",props:{y:0,x:35,width:177,skin:"fishxy/fight/dialog/BG_PageDown2_UP.png",sizeGrid:"19,29,11,25",height:51},compId:274},{type:"Image",props:{y:89,x:5,skin:"fishxy/fight/dialog/BG_PageDown2_light.png",scaleY:.6,scaleX:.6},compId:275},{type:"Image",props:{y:25.5,x:125.5,skin:"fishxy/fight/dialog/Pao_3_word_Cn.png",scaleY:.8,scaleX:.8,anchorY:.5,anchorX:.5},compId:276},{type:"Image",props:{y:119,x:122.5,skin:"fishxy/fight/dialog/Pao_3.png",scaleY:.8,scaleX:.8,anchorY:.5,anchorX:.5},compId:277},{type:"Image",props:{y:213,x:124.5,skin:"fishxy/fight/dialog/Word_3_Cn.png",scaleY:.9,scaleX:.9,anchorX:.5},compId:278}]},{type:"Box",props:{y:0,x:555},compId:279,child:[{type:"Image",props:{y:50,x:35,width:177,skin:"fishxy/fight/dialog/BG_PageDown2_DN.png",sizeGrid:"3,24,26,27",height:288},compId:280},{type:"Image",props:{y:0,x:35,width:177,skin:"fishxy/fight/dialog/BG_PageDown2_UP.png",sizeGrid:"19,29,11,25",height:51},compId:281},{type:"Image",props:{y:89,x:5,skin:"fishxy/fight/dialog/BG_PageDown2_light.png",scaleY:.6,scaleX:.6},compId:282},{type:"Image",props:{y:14,x:76.5,skin:"fishxy/fight/dialog/Pao_4_word_Cn.png",scaleY:.8,scaleX:.8},compId:283},{type:"Image",props:{y:54,x:44,skin:"fishxy/fight/dialog/Pao_4.png",scaleY:.8,scaleX:.8},compId:284},{type:"Image",props:{y:214,x:49,skin:"fishxy/fight/dialog/Word_4_Cn.png",scaleY:.9,scaleX:.9},compId:285}]}]},{type:"List",props:{y:18,x:24.5,spaceY:10,spaceX:10,repeatY:2,repeatX:6,name:"page_3",height:346},compId:286,child:[{type:"Box",props:{y:0,width:233,height:357},compId:319,child:[{type:"Image",props:{y:0,x:0,width:236,skin:"fishxy/fight/dialog/BG_smile_normal_UP.png",sizeGrid:"16,25,8,24",height:223},compId:316},{type:"Image",props:{y:222,x:0,width:236,skin:"fishxy/fight/dialog/BG_smile_normal_DN.png",sizeGrid:"4,26,27,20",height:138},compId:315},{type:"Image",props:{y:199,x:118,skin:"fishxy/fight/dialog/fish24_word_Cn.png",anchorY:.5,anchorX:.5},compId:320},{type:"Image",props:{y:99.5,x:118,skin:"fishxy/fight/dialog/lansha_00.png",anchorY:.5,anchorX:.5},compId:331},{type:"Image",props:{y:285,x:118,skin:"fishxy/fight/dialog/Page_OddsFish_word4_Cn.png",anchorY:.5,anchorX:.5},compId:332}]},{type:"Box",props:{y:0,x:255,width:233,height:357},compId:333,child:[{type:"Image",props:{y:0,x:0,width:236,skin:"fishxy/fight/dialog/BG_smile_normal_UP.png",sizeGrid:"16,25,8,24",height:223},compId:334},{type:"Image",props:{y:222,x:0,width:236,skin:"fishxy/fight/dialog/BG_smile_normal_DN.png",sizeGrid:"4,26,27,20",height:138},compId:335},{type:"Image",props:{y:199,x:118,skin:"fishxy/fight/dialog/WaterBomb_00_word_Cn.png",anchorY:.5,anchorX:.5},compId:336},{type:"Image",props:{y:98.5,x:118,skin:"fishxy/fight/dialog/WaterBomb_00.png",anchorY:.5,anchorX:.5},compId:337},{type:"Image",props:{y:285,x:118,skin:"fishxy/fight/dialog/Page_OddsFish_word5_Cn.png",anchorY:.5,anchorX:.5},compId:338}]},{type:"Box",props:{y:0,x:502,width:233,height:357},compId:339,child:[{type:"Image",props:{y:0,x:0,width:236,skin:"fishxy/fight/dialog/BG_smile_normal_UP.png",sizeGrid:"16,25,8,24",height:223},compId:340},{type:"Image",props:{y:222,x:0,width:236,skin:"fishxy/fight/dialog/BG_smile_normal_DN.png",sizeGrid:"4,26,27,20",height:138},compId:341},{type:"Image",props:{y:199,x:118,skin:"fishxy/fight/dialog/lightning_00_word_Cn.png",anchorY:.5,anchorX:.5},compId:342},{type:"Image",props:{y:92.5,x:118,skin:"fishxy/fight/dialog/lightning_00.png",anchorY:.5,anchorX:.5},compId:343},{type:"Image",props:{y:285,x:118,skin:"fishxy/fight/dialog/Page_OddsFish_word7_Cn.png",anchorY:.5,anchorX:.5},compId:344}]}]},{type:"List",props:{y:18,x:24,spaceY:10,spaceX:10,repeatY:2,repeatX:6,name:"page_4",height:346},compId:345,child:[{type:"Box",props:{y:143,x:42,width:240,scaleY:.8,scaleX:.8,height:242},compId:358,child:[{type:"Image",props:{y:0,x:0,width:243,skin:"fishxy/fight/dialog/BG_smile_normal_UP.png",sizeGrid:"16,25,8,24",height:134},compId:359},{type:"Image",props:{y:134,x:0,width:243,skin:"fishxy/fight/dialog/BG_smile_normal_DN.png",sizeGrid:"4,26,27,20",height:113},compId:360},{type:"Image",props:{y:29,x:56,skin:"fishxy/fight/dialog/fan_word_Cn.png",anchorY:.5,anchorX:.5},compId:361},{type:"Image",props:{y:84,x:127.5,skin:"fishxy/fight/dialog/fan.png",anchorY:.5,anchorX:.5},compId:362},{type:"Image",props:{y:185,x:124.5,width:190,skin:"fishxy/fight/dialog/fudaijs3_Cn.png",height:83,anchorY:.5,anchorX:.5},compId:363}]},{type:"Image",props:{y:-31,x:16,width:174,skin:"fishxy/fight/dialog/fudai2.png",height:174},compId:364},{type:"Sprite",props:{y:0,x:204,texture:"fishxy/fight/dialog/fish24_10_word_Cn.png"},compId:366},{type:"Sprite",props:{y:43,x:205,texture:"fishxy/fight/dialog/Page_OddsFish_word8_Cn.png"},compId:367},{type:"Box",props:{y:143,x:262,width:240,scaleY:.8,scaleX:.8,height:242},compId:368,child:[{type:"Image",props:{y:0,x:0,width:243,skin:"fishxy/fight/dialog/BG_smile_normal_UP.png",sizeGrid:"16,25,8,24",height:134},compId:369},{type:"Image",props:{y:134,x:0,width:243,skin:"fishxy/fight/dialog/BG_smile_normal_DN.png",sizeGrid:"4,26,27,20",height:113},compId:370},{type:"Image",props:{y:29,x:56,skin:"fishxy/fight/dialog/mirror_word_Cn.png",anchorY:.5,anchorX:.5},compId:371},{type:"Image",props:{y:84,x:127.5,skin:"fishxy/fight/dialog/mirror.png",anchorY:.5,anchorX:.5},compId:372},{type:"Image",props:{y:185,x:124.5,width:190,skin:"fishxy/fight/dialog/fudaijs2_Cn.png",height:83,anchorY:.5,anchorX:.5},compId:373}]},{type:"Box",props:{y:143,x:481,width:240,scaleY:.8,scaleX:.8,height:242},compId:374,child:[{type:"Image",props:{y:0,x:0,width:243,skin:"fishxy/fight/dialog/BG_smile_normal_UP.png",sizeGrid:"16,25,8,24",height:134},compId:375},{type:"Image",props:{y:134,x:0,width:243,skin:"fishxy/fight/dialog/BG_smile_normal_DN.png",sizeGrid:"4,26,27,20",height:113},compId:376},{type:"Image",props:{y:29,x:72.5,skin:"fishxy/fight/dialog/month_box_word_Cn.png",anchorY:.5,anchorX:.5},compId:377},{type:"Image",props:{y:84,x:127.5,skin:"fishxy/fight/dialog/month_box.png",anchorY:.5,anchorX:.5},compId:378},{type:"Image",props:{y:185,x:124.5,width:190,skin:"fishxy/fight/dialog/fudaijs1_Cn.png",height:83,anchorY:.5,anchorX:.5},compId:379}]}]},{type:"List",props:{y:18,x:47,spaceY:10,spaceX:10,repeatY:2,repeatX:6,name:"page_5",height:346},compId:380,child:[{type:"Box",props:{y:10,x:10,scaleY:.8,scaleX:.8},compId:381,child:[{type:"Image",props:{y:0,x:0,width:414,skin:"fishxy/fight/dialog/BG_smile_normal_UP.png",sizeGrid:"16,25,8,24",height:217},compId:382},{type:"Image",props:{y:216,x:0,width:414,skin:"fishxy/fight/dialog/BG_smile_normal_DN.png",sizeGrid:"4,26,27,20",height:200},compId:383},{type:"Image",props:{y:35,x:84,skin:"fishxy/fight/dialog/JP_box_word_Cn.png",anchorY:.5,anchorX:.5},compId:384},{type:"Image",props:{y:26,x:132,skin:"fishxy/fight/dialog/JP_box.png"},compId:385},{type:"Image",props:{y:223,x:36,skin:"fishxy/fight/dialog/Page_OddsFish_word6_Cn.png"},compId:386}]},{type:"Box",props:{y:10,x:347.15999999999997,scaleY:.8,scaleX:.8},compId:408,child:[{type:"Image",props:{y:0,x:0,width:414,skin:"fishxy/fight/dialog/BG_smile_normal_UP.png",sizeGrid:"16,25,8,24",height:213},compId:409},{type:"Image",props:{y:213,x:0,width:414,skin:"fishxy/fight/dialog/BG_smile_normal_DN.png",sizeGrid:"4,26,27,20",height:200},compId:410},{type:"Image",props:{y:34,x:72,skin:"fishxy/fight/dialog/MoneyBoy_word_Cn.png",anchorY:.5,anchorX:.5},compId:411},{type:"Image",props:{y:19,x:142,skin:"fishxy/fight/dialog/MoneyBoy.png"},compId:412},{type:"Image",props:{y:222,x:40,skin:"fishxy/fight/dialog/Page_OddsFish_word15_Cn.png"},compId:413}]}]},{type:"List",props:{y:22.399999999999977,x:105.19999999999999,spaceY:10,spaceX:10,repeatY:2,repeatX:6,name:"page_6"},compId:414,child:[{type:"Box",props:{y:0,scaleY:.8,scaleX:.8},compId:415,child:[{type:"Image",props:{y:0,x:0,width:717,skin:"fishxy/fight/dialog/BG_smile_normal_UP.png",sizeGrid:"16,25,8,24",height:277},compId:416},{type:"Image",props:{y:277,x:0,width:717,skin:"fishxy/fight/dialog/BG_smile_normal_DN.png",sizeGrid:"4,26,27,20",height:150},compId:417},{type:"Image",props:{y:47,x:98,skin:"fishxy/fight/dialog/Cow_devil_Cn.png",anchorY:.5,anchorX:.5},compId:418},{type:"Image",props:{y:0,x:10.5,skin:"fishxy/fight/dialog/help_boss.png"},compId:419},{type:"Image",props:{y:283,x:19,skin:"fishxy/fight/dialog/Page_OddsFish_word9_Cn.png"},compId:420}]}]},{type:"Box",props:{y:395,x:390.5,scaleY:.8,scaleX:.8,name:"pager",anchorY:.5,anchorX:.5},compId:216,child:[{type:"Button",props:{y:1,x:219,var:"next_page_btn",stateNum:2,skin:"fishxy/fight/dialog/btn_pager.png"},compId:218},{type:"Button",props:{y:0,x:49,var:"prev_page_btn",stateNum:2,skin:"fishxy/fight/dialog/btn_pager.png",scaleX:-1},compId:219},{type:"Sprite",props:{y:3,x:63,texture:"fishxy/fight/dialog/BG_PageShow.png"},compId:220},{type:"Label",props:{y:12,x:102.5,width:71,var:"page_label",text:"1/7",height:32,font:"bmfont_gold",align:"center"},compId:221}]}]},{type:"Box",props:{y:141,x:314,name:"content_1"},compId:427,child:[{type:"Box",props:{y:3,x:77},compId:435,child:[{type:"Image",props:{y:0,x:0,width:195,skin:"fishxy/fight/dialog/BG_PageDown2_UP.png",sizeGrid:"22,27,14,32",height:62},compId:430},{type:"Image",props:{y:60,x:0,width:195,skin:"fishxy/fight/dialog/BG_PageDown2_DN.png",sizeGrid:"4,30,26,30",height:164},compId:431},{type:"Sprite",props:{y:12.5,x:41.5,texture:"fishxy/fight/dialog/Pao5_word_Cn.png"},compId:433},{type:"Sprite",props:{y:69,x:36,texture:"fishxy/fight/dialog/Pao5.png"},compId:434},{type:"Image",props:{y:226,x:0,width:195,skin:"fishxy/fight/dialog/BG_PageShow1.png",sizeGrid:"15,39,20,56",height:172},compId:437},{type:"Label",props:{y:233,x:2,width:192,text:"0.01   /   0.03",height:32,font:"bmfont_zongFen",align:"center"},compId:436},{type:"Label",props:{y:261,x:3,width:192,text:"0.1   /   0.3",height:32,font:"bmfont_zongFen",align:"center"},compId:441},{type:"Label",props:{y:289,x:4,width:192,text:"1   /  3",height:32,font:"bmfont_zongFen",align:"center"},compId:443},{type:"Label",props:{y:318,x:4,width:192,text:"5   /   15",height:32,font:"bmfont_zongFen",align:"center"},compId:445},{type:"Label",props:{y:346,x:1.5,width:192,text:"10   /   30",height:32,font:"bmfont_zongFen",align:"center"},compId:446},{type:"Label",props:{y:374,x:1.5,width:192,text:"50   /   150",height:32,font:"bmfont_zongFen",align:"center"},compId:447}]},{type:"Box",props:{y:3,x:293},compId:461,child:[{type:"Image",props:{y:0,x:0,width:195,skin:"fishxy/fight/dialog/BG_PageDown2_UP.png",sizeGrid:"22,27,14,32",height:62},compId:462},{type:"Image",props:{y:60,x:0,width:195,skin:"fishxy/fight/dialog/BG_PageDown2_DN.png",sizeGrid:"4,30,26,30",height:164},compId:463},{type:"Sprite",props:{y:12.5,x:41.5,texture:"fishxy/fight/dialog/Pao6_word_Cn.png"},compId:464},{type:"Sprite",props:{y:64,x:30,width:140,texture:"fishxy/fight/dialog/Pao6.png",height:147},compId:465},{type:"Image",props:{y:226,x:0,width:195,skin:"fishxy/fight/dialog/BG_PageShow1.png",sizeGrid:"15,39,20,56",height:172},compId:466},{type:"Label",props:{y:233,x:2,width:192,text:"0.04   /   0.06",height:32,font:"bmfont_zongFen",align:"center"},compId:467},{type:"Label",props:{y:261,x:3,width:192,text:"0.4   /   0.6",height:32,font:"bmfont_zongFen",align:"center"},compId:468},{type:"Label",props:{y:289,x:4,width:192,text:"4   /  6",height:32,font:"bmfont_zongFen",align:"center"},compId:469},{type:"Label",props:{y:318,x:4,width:192,text:"20   /   30",height:32,font:"bmfont_zongFen",align:"center"},compId:470},{type:"Label",props:{y:346,x:1.5,width:192,text:"40   /   60",height:32,font:"bmfont_zongFen",align:"center"},compId:471},{type:"Label",props:{y:374,x:1.5,width:192,text:"200   /   300",height:32,font:"bmfont_zongFen",align:"center"},compId:472}]},{type:"Box",props:{y:3,x:509},compId:473,child:[{type:"Image",props:{y:0,x:0,width:195,skin:"fishxy/fight/dialog/BG_PageDown2_UP.png",sizeGrid:"22,27,14,32",height:62},compId:474},{type:"Image",props:{y:60,x:0,width:195,skin:"fishxy/fight/dialog/BG_PageDown2_DN.png",sizeGrid:"4,30,26,30",height:164},compId:475},{type:"Sprite",props:{y:12.5,x:41.5,texture:"fishxy/fight/dialog/Pao7_word_Cn.png"},compId:476},{type:"Sprite",props:{y:64.5,x:12,width:171,texture:"fishxy/fight/dialog/Pao7.png",height:147},compId:477},{type:"Image",props:{y:226,x:0,width:195,skin:"fishxy/fight/dialog/BG_PageShow1.png",sizeGrid:"15,39,20,56",height:172},compId:478},{type:"Label",props:{y:233,x:2,width:192,text:"0.07   /   0.1",height:32,font:"bmfont_zongFen",align:"center"},compId:479},{type:"Label",props:{y:261,x:3,width:192,text:"0.7   /   1",height:32,font:"bmfont_zongFen",align:"center"},compId:480},{type:"Label",props:{y:289,x:4,width:192,text:"7   /   10",height:32,font:"bmfont_zongFen",align:"center"},compId:481},{type:"Label",props:{y:318,x:4,width:192,text:"35   /   50",height:32,font:"bmfont_zongFen",align:"center"},compId:482},{type:"Label",props:{y:346,x:1.5,width:192,text:"70   /   100",height:32,font:"bmfont_zongFen",align:"center"},compId:483},{type:"Label",props:{y:374,x:1.5,width:192,text:"350   /   500",height:32,font:"bmfont_zongFen",align:"center"},compId:484}]},{type:"Box",props:{y:231,x:0,width:68,height:168},compId:541,child:[{type:"Image",props:{y:13,x:34,skin:"fishxy/fight/dialog/BG_PageShow2.png",scaleY:.5,scaleX:.5,anchorY:.5,anchorX:.5},compId:542,child:[{type:"Sprite",props:{y:5,x:14,texture:"fishxy/fight/dialog/room_1.png"},compId:543}]},{type:"Image",props:{y:41,x:34,skin:"fishxy/fight/dialog/BG_PageShow2.png",scaleY:.5,scaleX:.5,anchorY:.5,anchorX:.5},compId:544,child:[{type:"Sprite",props:{y:5,x:14,texture:"fishxy/fight/dialog/room_2.png"},compId:545}]},{type:"Image",props:{y:70,x:34,skin:"fishxy/fight/dialog/BG_PageShow2.png",scaleY:.5,scaleX:.5,anchorY:.5,anchorX:.5},compId:546,child:[{type:"Sprite",props:{y:5,x:14,texture:"fishxy/fight/dialog/room_3.png"},compId:547}]},{type:"Image",props:{y:98,x:34,skin:"fishxy/fight/dialog/BG_PageShow2.png",scaleY:.5,scaleX:.5,anchorY:.5,anchorX:.5},compId:548,child:[{type:"Sprite",props:{y:5,x:14,texture:"fishxy/fight/dialog/room_4.png"},compId:549}]},{type:"Image",props:{y:127,x:34,skin:"fishxy/fight/dialog/BG_PageShow2.png",scaleY:.5,scaleX:.5,anchorY:.5,anchorX:.5},compId:550,child:[{type:"Sprite",props:{y:5,x:14,texture:"fishxy/fight/dialog/room_5.png"},compId:551}]},{type:"Image",props:{y:155,x:34,skin:"fishxy/fight/dialog/BG_PageShow2.png",scaleY:.5,scaleX:.5,anchorY:.5,anchorX:.5},compId:552,child:[{type:"Sprite",props:{y:5,x:14,texture:"fishxy/fight/dialog/room_6.png"},compId:553}]}]}]},{type:"Box",props:{y:155.5,x:300,name:"content_2"},compId:428,child:[{type:"Label",props:{text:"1.  这是一款提供",fontSize:25,color:"#ffffff"},compId:486},{type:"Label",props:{y:0,x:189,text:"不同倍数",strokeColor:"#ff3828",stroke:5,fontSize:25,color:"#fffcb4"},compId:487},{type:"Label",props:{y:0,x:296,text:"炮弹和近30多种鱼类的休闲射击游戏。",fontSize:25,color:"#ffffff"},compId:488},{type:"Label",props:{y:37,x:0,text:"2.  玩家先选择要使用的",fontSize:25,color:"#ffffff"},compId:489},{type:"Label",props:{y:37,x:265,text:"不同倍数",strokeColor:"#ff3828",stroke:5,fontSize:25,color:"#fffcb4"},compId:490},{type:"Label",props:{y:37,x:368,text:"，然后点击目标发射炮弹。",fontSize:25,color:"#ffffff"},compId:491},{type:"Label",props:{y:75,text:"3.  在同一倍数中，越多的炮弹射中同一条鱼，会",fontSize:25,color:"#ffffff"},compId:492},{type:"Label",props:{y:75,x:540,text:"增加捕获机会",strokeColor:"#ff3828",stroke:5,fontSize:25,color:"#fffcb4"},compId:493},{type:"Label",props:{y:75,x:695,text:"。",fontSize:25,color:"#ffffff"},compId:495},{type:"Label",props:{y:110,x:0,text:"4.  当鱼被捕获时，玩家会根据",fontSize:25,color:"#ffffff"},compId:496},{type:"Label",props:{y:110,x:339,text:"鱼的倍数",strokeColor:"#ff3828",stroke:5,fontSize:25,color:"#fffcb4"},compId:497},{type:"Label",props:{y:110,x:443,text:"和",fontSize:25,color:"#ffffff"},compId:498},{type:"Label",props:{y:110,x:474,text:"炮弹分数",strokeColor:"#ff3828",stroke:5,fontSize:25,color:"#fffcb4"},compId:499},{type:"Label",props:{y:110,x:579,text:"获得对应金额。",fontSize:25,color:"#ffffff"},compId:500},{type:"Label",props:{y:146,x:0,text:"5.  当炮弹打到屏幕边框时，会",fontSize:25,color:"#ffffff"},compId:501},{type:"Label",props:{y:146,x:339,text:"自动折射",strokeColor:"#ff3828",stroke:5,fontSize:25,color:"#fffcb4"},compId:502},{type:"Label",props:{y:146,x:443,text:"，直到打中鱼为止。",fontSize:25,color:"#ffffff"},compId:503},{type:"Label",props:{y:181,x:0,text:"6.  当玩家发射炮弹时，玩家额度就会扣除",fontSize:25,color:"#ffffff"},compId:504},{type:"Label",props:{y:181,x:466,text:"该炮弹的金额",strokeColor:"#ff3828",stroke:5,fontSize:25,color:"#fffcb4"},compId:505},{type:"Label",props:{y:181,x:623,text:"。",fontSize:25,color:"#ffffff"},compId:506},{type:"Label",props:{y:215,x:0,text:"7.  牛魔王采用血量机制并有",fontSize:25,color:"#ffffff"},compId:507},{type:"Label",props:{y:215,x:313,text:"限定时间3分钟",strokeColor:"#ff3828",stroke:5,fontSize:25,color:"#fffcb4"},compId:508},{type:"Label",props:{y:215,x:481,text:"，若时间内无法击杀则",fontSize:25,color:"#ffffff"},compId:509},{type:"Label",props:{y:250,x:35,text:"会逃跑。",fontSize:25,color:"#ffffff"},compId:510},{type:"Label",props:{y:286,x:0,text:"8.  由于",fontSize:25,color:"#ffffff"},compId:511},{type:"Label",props:{y:286,x:87.418701171875,text:"网络延迟",strokeColor:"#ff3828",stroke:5,fontSize:25,color:"#fffcb4"},compId:512},{type:"Label",props:{y:286,x:193,text:"等原因，如服务器",fontSize:25,color:"#ffffff"},compId:513},{type:"Label",props:{y:322,x:35,text:"，玩家能够在界面上看到金额被加回去，但报表中不会有记录。",fontSize:25,color:"#ffffff"},compId:514},{type:"Label",props:{y:286,x:398.951904296875,text:"监测无效",strokeColor:"#ff3828",stroke:5,fontSize:25,color:"#fffcb4"},compId:515},{type:"Label",props:{y:286,x:503,text:"，会",fontSize:25,color:"#ffffff"},compId:516},{type:"Label",props:{y:287,x:557,text:"退回该炮弹金额",strokeColor:"#ff3828",stroke:5,fontSize:25,color:"#fffcb4"},compId:517}]},{type:"Box",props:{y:246,x:500,name:"content_3"},compId:429,child:[{type:"Sprite",props:{y:10,x:0,var:"mmm",texture:"fishxy/fight/dialog/Music_Cn.png"},compId:518},{type:"Sprite",props:{y:119.5,x:0,texture:"fishxy/fight/dialog/Sound_Cn.png"},compId:519},{type:"Clip",props:{y:0,x:139,var:"music",skin:"fishxy/fight/dialog/clip_switch.png",name:"music",index:1,clipY:2},compId:554},{type:"Clip",props:{y:109.5,x:139,var:"sound",skin:"fishxy/fight/dialog/clip_switch.png",name:"sound",index:1,clipY:2},compId:555}]},{type:"Clip",props:{y:135,x:35,skin:"fishxy/fight/dialog/OddsFish_0_Cn.png",name:"tab_0",index:0,clipY:2},compId:33},{type:"Clip",props:{y:241,x:35,skin:"fishxy/fight/dialog/GunExplain_0_Cn.png",name:"tab_1",clipY:2},compId:34},{type:"Clip",props:{y:349,x:35,skin:"fishxy/fight/dialog/PlayExplain_0_Cn.png",name:"tab_2",clipY:2},compId:35},{type:"Clip",props:{y:455,x:35,skin:"fishxy/fight/dialog/SoundOption_0_Cn.png",name:"tab_3",clipY:2},compId:212}],loadList:["fishxy/fight/dialog/BG_01.png","fishxy/fight/dialog/Titel_bg.png","fishxy/fight/dialog/Bnt_Close.png","fishxy/fight/dialog/Title_word_game_Cn.png","fishxy/fight/dialog/BG_02.png","fishxy/fight/dialog/BG_smile_normal_DN.png","fishxy/fight/dialog/BG_smile_normal_UP.png","fishxy/fight/fishicon/fish_1.png","fishxy/fight/dialog/fish_1.png","fishxy/fight/dialog/BG_PageDown2_DN.png","fishxy/fight/dialog/BG_PageDown2_UP.png","fishxy/fight/dialog/BG_PageDown2_light.png","fishxy/fight/dialog/Pao_1_word_Cn.png","fishxy/fight/dialog/Pao_1.png","fishxy/fight/dialog/Word_1_Cn.png","fishxy/fight/dialog/Pao_2_word_Cn.png","fishxy/fight/dialog/Pao_2.png","fishxy/fight/dialog/Word_2_Cn.png","fishxy/fight/dialog/Pao_3_word_Cn.png","fishxy/fight/dialog/Pao_3.png","fishxy/fight/dialog/Word_3_Cn.png","fishxy/fight/dialog/Pao_4_word_Cn.png","fishxy/fight/dialog/Pao_4.png","fishxy/fight/dialog/Word_4_Cn.png","fishxy/fight/dialog/fish24_word_Cn.png","fishxy/fight/dialog/lansha_00.png","fishxy/fight/dialog/Page_OddsFish_word4_Cn.png","fishxy/fight/dialog/WaterBomb_00_word_Cn.png","fishxy/fight/dialog/WaterBomb_00.png","fishxy/fight/dialog/Page_OddsFish_word5_Cn.png","fishxy/fight/dialog/lightning_00_word_Cn.png","fishxy/fight/dialog/lightning_00.png","fishxy/fight/dialog/Page_OddsFish_word7_Cn.png","fishxy/fight/dialog/fan_word_Cn.png","fishxy/fight/dialog/fan.png","fishxy/fight/dialog/fudaijs3_Cn.png","fishxy/fight/dialog/fudai2.png","fishxy/fight/dialog/fish24_10_word_Cn.png","fishxy/fight/dialog/Page_OddsFish_word8_Cn.png","fishxy/fight/dialog/mirror_word_Cn.png","fishxy/fight/dialog/mirror.png","fishxy/fight/dialog/fudaijs2_Cn.png","fishxy/fight/dialog/month_box_word_Cn.png","fishxy/fight/dialog/month_box.png","fishxy/fight/dialog/fudaijs1_Cn.png","fishxy/fight/dialog/JP_box_word_Cn.png","fishxy/fight/dialog/JP_box.png","fishxy/fight/dialog/Page_OddsFish_word6_Cn.png","fishxy/fight/dialog/MoneyBoy_word_Cn.png","fishxy/fight/dialog/MoneyBoy.png","fishxy/fight/dialog/Page_OddsFish_word15_Cn.png","fishxy/fight/dialog/Cow_devil_Cn.png","fishxy/fight/dialog/help_boss.png","fishxy/fight/dialog/Page_OddsFish_word9_Cn.png","fishxy/fight/dialog/btn_pager.png","fishxy/fight/dialog/BG_PageShow.png","fishxy/fight/dialog/Pao5_word_Cn.png","fishxy/fight/dialog/Pao5.png","fishxy/fight/dialog/BG_PageShow1.png","fishxy/fight/dialog/Pao6_word_Cn.png","fishxy/fight/dialog/Pao6.png","fishxy/fight/dialog/Pao7_word_Cn.png","fishxy/fight/dialog/Pao7.png","fishxy/fight/dialog/BG_PageShow2.png","fishxy/fight/dialog/room_1.png","fishxy/fight/dialog/room_2.png","fishxy/fight/dialog/room_3.png","fishxy/fight/dialog/room_4.png","fishxy/fight/dialog/room_5.png","fishxy/fight/dialog/room_6.png","fishxy/fight/dialog/Music_Cn.png","fishxy/fight/dialog/Sound_Cn.png","fishxy/fight/dialog/clip_switch.png","fishxy/fight/dialog/OddsFish_0_Cn.png","fishxy/fight/dialog/GunExplain_0_Cn.png","fishxy/fight/dialog/PlayExplain_0_Cn.png","fishxy/fight/dialog/SoundOption_0_Cn.png"],loadList3D:[]},n.HelpDialogUI=e,t("ui.fishxy.fight.HelpDialogUI",e),(e=function(){f(i,oa);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[Sn,oa,vn,h,N],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"Dialog",props:{},compId:2,child:[{type:"Box",props:{y:2,x:0,name:"bg"},compId:13,child:[{type:"Image",props:{y:47,x:0,width:1105,skin:"fishxy/fight/dialog/BG_01.png",sizeGrid:"0,43,52,39",height:537},compId:14},{type:"Image",props:{y:0,skin:"fishxy/fight/dialog/Titel_bg.png",sizeGrid:"0,95,0,88"},compId:15},{type:"Image",props:{y:123,x:34,width:1032,skin:"fishxy/fight/dialog/BG_02.png",sizeGrid:"18,22,18,22",height:411},compId:16},{type:"Label",props:{y:25.5,x:448.046875,text:"温馨提示",fontSize:50,color:"#ffffff",bold:!0},compId:17},{type:"Sprite",props:{y:25.5,x:1031,texture:"fishxy/fight/dialog/Bnt_Close.png",name:"close"},compId:18}]},{type:"Label",props:{y:218,x:165.5,wordWrap:!0,width:774,text:"您长时间未发射子弹，倒计时结束后将会被系统请出房间",leading:5,height:100,fontSize:50,color:"#ffffff",align:"center"},compId:5},{type:"Label",props:{y:396,x:458,wordWrap:!0,width:189,var:"timer_label",text:"15",leading:5,height:69,fontSize:50,color:"#ef5f5f",bold:!0,align:"center"},compId:6}],loadList:["fishxy/fight/dialog/BG_01.png","fishxy/fight/dialog/Titel_bg.png","fishxy/fight/dialog/BG_02.png","fishxy/fight/dialog/Bnt_Close.png"],loadList3D:[]},n.NoActionCountDownDilaogUI=e,t("ui.fishxy.fight.NoActionCountDownDilaogUI",e),i=(i=(i=Ki=Ki||{}).fishxy||(i.fishxy={})).loading||(i.loading={}),(n=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[h,Xn,a],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Image",props:{var:"bg",top:0,skin:"fishxy/loading/loading_bg.jpg",right:0,left:0,bottom:0},compId:3},{type:"Image",props:{skin:"fishxy/loading/logo.png",centerY:-74,centerX:0},compId:29},{type:"Image",props:{width:639,skin:"fishxy/loading/loading_bar_bg.png",sizeGrid:"0,23,0,26",height:32,centerY:237,centerX:-1},compId:30,child:[{type:"Panel",props:{y:6,x:5,width:659,var:"progress",height:100},compId:32,child:[{type:"Image",props:{skin:"fishxy/loading/loading_bar.png"},compId:31}]}]}],loadList:["fishxy/loading/loading_bg.jpg","fishxy/loading/logo.png","fishxy/loading/loading_bar_bg.png","fishxy/loading/loading_bar.png"],loadList3D:[]},i.LoadingSceneUI=n,t("ui.fishxy.loading.LoadingSceneUI",n),(n=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[h,In,Sn,a],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{},compId:2,child:[{type:"Image",props:{width:1136,var:"bg",skin:"fishxy/loading/loading_bg.jpg",height:640,centerY:0,centerX:0},compId:3},{type:"ProgressBar",props:{width:823,var:"progress",value:0,skin:"fishxy/loading/progress.png",sizeGrid:"10,20,10,10",height:18,centerX:0,bottom:55},compId:5},{type:"Label",props:{width:379,var:"txt",text:"加载中  0%",height:22,fontSize:18,color:"#ffffff",centerX:10,bottom:78,bold:!0,align:"center"},compId:9}],loadList:["fishxy/loading/loading_bg.jpg","fishxy/loading/progress.png"],loadList3D:[]},i.LoadingViewUI=n,t("ui.fishxy.loading.LoadingViewUI",n),e=(e=(e=Ki=Ki||{}).fishxy||(e.fishxy={})).lobby||(e.lobby={}),(i=function(){f(i,a);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).referenceClass=[a],e}return y(i,[{key:"createChildren",value:function(){m(g(i.prototype),"createChildren",this).call(this),this.createView(i.uiView)}}]),i}()).uiView={type:"View",props:{width:1280,height:720},loadList:[],loadList3D:[]},e.LobbySceneUI=i,t("ui.fishxy.lobby.LobbySceneUI",i),y(function e(t,i){b(this,e),this.url=t,this.loadType=i})),la=((n=Qi=Qi||{})[n.Sync=1]="Sync",n[n.Async=2]="Async",function(){function i(){b(this,i),this.textureName=null,this.textureCount=1,this.maxPartices=100,this.duration=1,this.ageAddScale=0,this.emitterVelocitySensitivity=1,this.minStartSize=100,this.maxStartSize=100,this.minEndSize=100,this.maxEndSize=100,this.minHorizontalVelocity=0,this.maxHorizontalVelocity=0,this.minVerticalVelocity=0,this.maxVerticalVelocity=0,this.endVelocity=1,this.gravity=new Float32Array([0,0,0]),this.minRotateSpeed=0,this.maxRotateSpeed=0,this.minStartRadius=0,this.maxStartRadius=0,this.minEndRadius=0,this.maxEndRadius=0,this.minHorizontalStartRadian=0,this.maxHorizontalStartRadian=0,this.minVerticalStartRadian=0,this.maxVerticalStartRadian=0,this.useEndRadian=!0,this.minHorizontalEndRadian=0,this.maxHorizontalEndRadian=0,this.minVerticalEndRadian=0,this.maxVerticalEndRadian=0,this.minStartColor=new Float32Array([1,1,1,1]),this.maxStartColor=new Float32Array([1,1,1,1]),this.minEndColor=new Float32Array([1,1,1,1]),this.maxEndColor=new Float32Array([1,1,1,1]),this.colorComponentInter=!1,this.disableColor=!1,this.blendState=0,this.emitterType="null",this.emissionRate=0,this.pointEmitterPosition=new Float32Array([0,0,0]),this.pointEmitterPositionVariance=new Float32Array([0,0,0]),this.pointEmitterVelocity=new Float32Array([0,0,0]),this.pointEmitterVelocityAddVariance=new Float32Array([0,0,0]),this.boxEmitterCenterPosition=new Float32Array([0,0,0]),this.boxEmitterSize=new Float32Array([0,0,0]),this.boxEmitterVelocity=new Float32Array([0,0,0]),this.boxEmitterVelocityAddVariance=new Float32Array([0,0,0]),this.sphereEmitterCenterPosition=new Float32Array([0,0,0]),this.sphereEmitterRadius=1,this.sphereEmitterVelocity=0,this.sphereEmitterVelocityAddVariance=0,this.ringEmitterCenterPosition=new Float32Array([0,0,0]),this.ringEmitterRadius=30,this.ringEmitterVelocity=0,this.ringEmitterVelocityAddVariance=0,this.ringEmitterUp=2,this.positionVariance=new Float32Array([0,0,0])}return y(i,null,[{key:"checkSetting",value:function(e){for(var t in i._defaultSetting)t in e||(e[t]=i._defaultSetting[t]);e.endVelocity=+e.endVelocity,e.gravity[0]=+e.gravity[0],e.gravity[1]=+e.gravity[1],e.gravity[2]=+e.gravity[2]}}]),i}()),ua=(la._defaultSetting=new la,function(){function e(){b(this,e)}return y(e,[{key:"addParticleArray",value:function(e,t){}}]),e}()),ca=function(){function r(){b(this,r)}return y(r,null,[{key:"Create",value:function(e,t,i,n){var a,s=new r,t=(s.position=t,Ri.scaleVector3(i,e.emitterVelocitySensitivity,r._tempVelocity),Ri.lerp(e.minHorizontalVelocity,e.maxHorizontalVelocity,Math.random())),i=Math.random()*Math.PI*2;if(r._tempVelocity[0]+=t*Math.cos(i),r._tempVelocity[2]+=t*Math.sin(i),r._tempVelocity[1]+=Ri.lerp(e.minVerticalVelocity,e.maxVerticalVelocity,Math.random()),s.velocity=r._tempVelocity,s.startColor=r._tempStartColor,s.endColor=r._tempEndColor,e.disableColor){for(a=0;a<3;a++)s.startColor[a]=1,s.endColor[a]=1;s.startColor[a]=Ri.lerp(e.minStartColor[a],e.maxStartColor[a],Math.random()),s.endColor[a]=Ri.lerp(e.minEndColor[a],e.maxEndColor[a],Math.random())}else if(e.colorComponentInter)for(a=0;a<4;a++)s.startColor[a]=Ri.lerp(e.minStartColor[a],e.maxStartColor[a],Math.random()),s.endColor[a]=Ri.lerp(e.minEndColor[a],e.maxEndColor[a],Math.random());else Ri.lerpVector4(e.minStartColor,e.maxStartColor,Math.random(),s.startColor),Ri.lerpVector4(e.minEndColor,e.maxEndColor,Math.random(),s.endColor);s.sizeRotation=r._tempSizeRotation;t=Math.random(),s.sizeRotation[0]=Ri.lerp(e.minStartSize,e.maxStartSize,t),s.sizeRotation[1]=Ri.lerp(e.minEndSize,e.maxEndSize,t),s.sizeRotation[2]=Ri.lerp(e.minRotateSpeed,e.maxRotateSpeed,Math.random()),s.radius=r._tempRadius,i=Math.random(),s.radius[0]=Ri.lerp(e.minStartRadius,e.maxStartRadius,i),s.radius[1]=Ri.lerp(e.minEndRadius,e.maxEndRadius,i),s.radian=r._tempRadian,s.radian[0]=Ri.lerp(e.minHorizontalStartRadian,e.maxHorizontalStartRadian,Math.random()),s.radian[1]=Ri.lerp(e.minVerticalStartRadian,e.maxVerticalStartRadian,Math.random()),t=e.useEndRadian;return s.radian[2]=t?Ri.lerp(e.minHorizontalEndRadian,e.maxHorizontalEndRadian,Math.random()):s.radian[0],s.radian[3]=t?Ri.lerp(e.minVerticalEndRadian,e.maxVerticalEndRadian,Math.random()):s.radian[1],s.durationAddScale=e.ageAddScale*Math.random(),s.time=n,s}}]),r}(),_a=(ca._tempVelocity=new Float32Array(3),ca._tempStartColor=new Float32Array(4),ca._tempEndColor=new Float32Array(4),ca._tempSizeRotation=new Float32Array(3),ca._tempRadius=new Float32Array(2),ca._tempRadian=new Float32Array(4),function(){f(n,ua);var i=T(n);function n(e){var t;return b(this,n),(t=i.call(this))._floatCountPerVertex=29,t._firstActiveElement=0,t._firstNewElement=0,t._firstFreeElement=0,t._firstRetiredElement=0,t._currentTime=0,t.settings=e,t}return y(n,[{key:"reUse",value:function(e,t){return 0}},{key:"initialize",value:function(){this._vertices=this._mesh._vb.getFloat32Array(),e=this._mesh._stride/4;for(var e,t=0,i=0,n=0;n<this.settings.maxPartices;n++){for(var a=Math.random(),s=this.settings.textureCount?1/this.settings.textureCount:1,r=0;r<this.settings.textureCount&&!(a<r+s);r+=s);this._vertices[t++]=-1,this._vertices[t++]=-1,this._vertices[t++]=0,this._vertices[t++]=r,t=i+=e,this._vertices[t++]=1,this._vertices[t++]=-1,this._vertices[t++]=1,this._vertices[t++]=r,t=i+=e,this._vertices[t++]=1,this._vertices[t++]=1,this._vertices[t++]=1,this._vertices[t++]=r+s,t=i+=e,this._vertices[t++]=-1,this._vertices[t++]=1,this._vertices[t++]=0,this._vertices[t++]=r+s,t=i+=e}}},{key:"update",value:function(e){this._currentTime+=e/1e3,this.retireActiveParticles(),this.freeRetiredParticles(),this._firstActiveElement==this._firstFreeElement&&(this._currentTime=0),this._firstRetiredElement==this._firstActiveElement&&(this._drawCounter=0)}},{key:"retireActiveParticles",value:function(){for(var e=this.settings.duration;this._firstActiveElement!=this._firstNewElement;){var t=this._firstActiveElement*this._floatCountPerVertex*4,i=28+t,n=this._currentTime-this._vertices[i];if(1e-4+(n*=1+this._vertices[27+t])<e)break;this._vertices[i]=this._drawCounter,this._firstActiveElement++,this._firstActiveElement>=this.settings.maxPartices&&(this._firstActiveElement=0)}}},{key:"freeRetiredParticles",value:function(){for(;this._firstRetiredElement!=this._firstActiveElement;){if(this._drawCounter-this._vertices[this._firstRetiredElement*this._floatCountPerVertex*4+28]<3)break;this._firstRetiredElement++,this._firstRetiredElement>=this.settings.maxPartices&&(this._firstRetiredElement=0)}}},{key:"addNewParticlesToVertexBuffer",value:function(){}},{key:"addParticleArray",value:function(e,t){var i=this._firstFreeElement+1;if((i=i>=this.settings.maxPartices?0:i)!==this._firstRetiredElement){for(var n=ca.Create(this.settings,e,t,this._currentTime),a=this._firstFreeElement*this._floatCountPerVertex*4,s=0;s<4;s++){for(var r=0,o=4;r<3;r++)this._vertices[a+s*this._floatCountPerVertex+o+r]=n.position[r];for(r=0,o=7;r<3;r++)this._vertices[a+s*this._floatCountPerVertex+o+r]=n.velocity[r];for(r=0,o=10;r<4;r++)this._vertices[a+s*this._floatCountPerVertex+o+r]=n.startColor[r];for(r=0,o=14;r<4;r++)this._vertices[a+s*this._floatCountPerVertex+o+r]=n.endColor[r];for(r=0,o=18;r<3;r++)this._vertices[a+s*this._floatCountPerVertex+o+r]=n.sizeRotation[r];for(r=0,o=21;r<2;r++)this._vertices[a+s*this._floatCountPerVertex+o+r]=n.radius[r];for(r=0,o=23;r<4;r++)this._vertices[a+s*this._floatCountPerVertex+o+r]=n.radian[r];this._vertices[a+s*this._floatCountPerVertex+27]=n.durationAddScale,this._vertices[a+s*this._floatCountPerVertex+28]=n.time}this._firstFreeElement=i}}}]),n}()),fa="attribute vec4 a_CornerTextureCoordinate;\r\nattribute vec3 a_Position;\r\nattribute vec3 a_Velocity;\r\nattribute vec4 a_StartColor;\r\nattribute vec4 a_EndColor;\r\nattribute vec3 a_SizeRotation;\r\nattribute vec2 a_Radius;\r\nattribute vec4 a_Radian;\r\nattribute float a_AgeAddScale;\r\nattribute float a_Time;\r\n\r\nvarying vec4 v_Color;\r\nvarying vec2 v_TextureCoordinate;\r\n\r\nuniform float u_CurrentTime;\r\nuniform float u_Duration;\r\nuniform float u_EndVelocity;\r\nuniform vec3 u_Gravity;\r\n\r\nuniform vec2 size;\r\nuniform mat4 u_mmat;\r\n\r\nvec4 ComputeParticlePosition(in vec3 position, in vec3 velocity,in float age,in float normalizedAge)\r\n{\r\n\r\n   float startVelocity = length(velocity);//起始标量速度\r\n   float endVelocity = startVelocity * u_EndVelocity;//结束标量速度\r\n\r\n   float velocityIntegral = startVelocity * normalizedAge +(endVelocity - startVelocity) * normalizedAge *normalizedAge/2.0;//计算当前速度的标量（单位空间），vt=v0*t+(1/2)*a*(t^2)\r\n   \r\n   vec3 addPosition = normalize(velocity) * velocityIntegral * u_Duration;//计算受自身速度影响的位置，转换标量到矢量    \r\n   addPosition += u_Gravity * age * normalizedAge;//计算受重力影响的位置\r\n   \r\n   float radius=mix(a_Radius.x, a_Radius.y, normalizedAge); //计算粒子受半径和角度影响（无需计算角度和半径时，可用宏定义优化屏蔽此计算）\r\n   float radianHorizontal =mix(a_Radian.x,a_Radian.z,normalizedAge);\r\n   float radianVertical =mix(a_Radian.y,a_Radian.w,normalizedAge);\r\n   \r\n   float r =cos(radianVertical)* radius;\r\n   addPosition.y += sin(radianVertical) * radius;\r\n\t\r\n   addPosition.x += cos(radianHorizontal) *r;\r\n   addPosition.z += sin(radianHorizontal) *r;\r\n  \r\n   addPosition.y=-addPosition.y;//2D粒子位置更新需要取负，2D粒子坐标系Y轴正向朝上\r\n   position+=addPosition;\r\n   return  vec4(position,1.0);\r\n}\r\n\r\nfloat ComputeParticleSize(in float startSize,in float endSize, in float normalizedAge)\r\n{    \r\n    float size = mix(startSize, endSize, normalizedAge);\r\n    return size;\r\n}\r\n\r\nmat2 ComputeParticleRotation(in float rot,in float age)\r\n{    \r\n    float rotation =rot * age;\r\n    //计算2x2旋转矩阵.\r\n    float c = cos(rotation);\r\n    float s = sin(rotation);\r\n    return mat2(c, -s, s, c);\r\n}\r\n\r\nvec4 ComputeParticleColor(in vec4 startColor,in vec4 endColor,in float normalizedAge)\r\n{\r\n\tvec4 color=mix(startColor,endColor,normalizedAge);\r\n    //硬编码设置，使粒子淡入很快，淡出很慢,6.7的缩放因子把置归一在0到1之间，可以谷歌x*(1-x)*(1-x)*6.7的制图表\r\n    color.a *= normalizedAge * (1.0-normalizedAge) * (1.0-normalizedAge) * 6.7;\r\n   \r\n    return color;\r\n}\r\n\r\nvoid main()\r\n{\r\n   float age = u_CurrentTime - a_Time;\r\n   age *= 1.0 + a_AgeAddScale;\r\n   float normalizedAge = clamp(age / u_Duration,0.0,1.0);\r\n   gl_Position = ComputeParticlePosition(a_Position, a_Velocity, age, normalizedAge);//计算粒子位置\r\n   float pSize = ComputeParticleSize(a_SizeRotation.x,a_SizeRotation.y, normalizedAge);\r\n   mat2 rotation = ComputeParticleRotation(a_SizeRotation.z, age);\r\n\t\r\n    mat4 mat=u_mmat;\r\n    gl_Position=vec4((mat*gl_Position).xy,0.0,1.0);\r\n    gl_Position.xy += (rotation*a_CornerTextureCoordinate.xy) * pSize*vec2(mat[0][0],mat[1][1]);\r\n    gl_Position=vec4((gl_Position.x/size.x-0.5)*2.0,(0.5-gl_Position.y/size.y)*2.0,0.0,1.0);\r\n   \r\n   v_Color = ComputeParticleColor(a_StartColor,a_EndColor, normalizedAge);\r\n   v_TextureCoordinate =a_CornerTextureCoordinate.zw;\r\n}\r\n\r\n",da="#ifdef GL_FRAGMENT_PRECISION_HIGH\r\nprecision highp float;\r\n#else\r\nprecision mediump float;\r\n#endif\r\n\r\nvarying vec4 v_Color;\r\nvarying vec2 v_TextureCoordinate;\r\nuniform sampler2D u_texture;\r\n\r\nvoid main()\r\n{\t\r\n\tgl_FragColor=texture2D(u_texture,v_TextureCoordinate)*v_Color;\r\n\tgl_FragColor.xyz *= v_Color.w;\r\n}",pa=function(){f(t,me);var e=T(t);function t(){return b(this,t),e.call(this,fa,da,"ParticleShader",null,["a_CornerTextureCoordinate",0,"a_Position",1,"a_Velocity",2,"a_StartColor",3,"a_EndColor",4,"a_SizeRotation",5,"a_Radius",6,"a_Radian",7,"a_AgeAddScale",8,"a_Time",9])}return y(t)}(),ya=(pa.vs=fa,pa.ps=da,function(){f(i,xe);var t=T(i);function i(){var e;return b(this,i),e=t.call(this,0,0),i.pShader||(i.pShader=new pa),e}return y(i,[{key:"upload",value:function(){var e=this.size;e[0]=_e.width,e[1]=_e.height,this.alpha=this.ALPHA*_e.worldAlpha,i.pShader.upload(this)}}]),i}()),ga=(ya.pShader=null,function(){f(a,_a);var n=T(a);function a(e){b(this,a),(t=n.call(this,e)).x=0,t.y=0,t.sv=new ya,t._key={};var t,i=O(t);return L.loader.load(t.settings.textureName,x.create(null,function(e){i.texture=e}),null,E.IMAGE),t.sv.u_Duration=t.settings.duration,t.sv.u_Gravity=t.settings.gravity,t.sv.u_EndVelocity=t.settings.endVelocity,t._blendFn=pe.fns[e.blendState],t._mesh=Hi.getAMesh(t.settings.maxPartices),t.initialize(),t}return y(a,[{key:"getRenderType",value:function(){return-111}},{key:"releaseRender",value:function(){}},{key:"addParticleArray",value:function(e,t){e[0]+=this.x,e[1]+=this.y,m(g(a.prototype),"addParticleArray",this).call(this,e,t)}},{key:"addNewParticlesToVertexBuffer",value:function(){var e,t=this._mesh._vb;t.clear(),t.append(this._vertices),this._firstNewElement<this._firstFreeElement?(e=4*this._firstNewElement*this._floatCountPerVertex*4,t.subUpload(e,e,e+4*(this._firstFreeElement-this._firstNewElement)*this._floatCountPerVertex*4)):(e=4*this._firstNewElement*this._floatCountPerVertex*4,t.subUpload(e,e,e+4*(this.settings.maxPartices-this._firstNewElement)*this._floatCountPerVertex*4),0<this._firstFreeElement&&(t.setNeedUpload(),t.subUpload(0,0,4*this._firstFreeElement*this._floatCountPerVertex*4))),this._firstNewElement=this._firstFreeElement}},{key:"renderSubmit",value:function(){var e;return this.texture&&this.texture.getIsReady()&&(this.update(L.timer._delta),this.sv.u_CurrentTime=this._currentTime,this._firstNewElement!=this._firstFreeElement&&this.addNewParticlesToVertexBuffer(),this.blend(),this._firstActiveElement!=this._firstFreeElement&&(e=v.mainContext,this._mesh.useMesh(e),this.sv.u_texture=this.texture._getSource(),this.sv.upload(),this._firstActiveElement<this._firstFreeElement?e.drawElements(e.TRIANGLES,6*(this._firstFreeElement-this._firstActiveElement),e.UNSIGNED_SHORT,6*this._firstActiveElement*2):(v.mainContext.drawElements(e.TRIANGLES,6*(this.settings.maxPartices-this._firstActiveElement),e.UNSIGNED_SHORT,6*this._firstActiveElement*2),0<this._firstFreeElement&&e.drawElements(e.TRIANGLES,6*this._firstFreeElement,e.UNSIGNED_SHORT,0)),k.renderBatches++),this._drawCounter++),1}},{key:"updateParticleForNative",value:function(){this.texture&&this.texture.getIsReady()&&(this.update(L.timer._delta),this.sv.u_CurrentTime=this._currentTime,this._firstNewElement!=this._firstFreeElement&&(this._firstNewElement=this._firstFreeElement))}},{key:"getMesh",value:function(){return this._mesh}},{key:"getConchMesh",value:function(){return this._conchMesh}},{key:"getFirstNewElement",value:function(){return this._firstNewElement}},{key:"getFirstFreeElement",value:function(){return this._firstFreeElement}},{key:"getFirstActiveElement",value:function(){return this._firstActiveElement}},{key:"getFirstRetiredElement",value:function(){return this._firstRetiredElement}},{key:"setFirstFreeElement",value:function(e){this._firstFreeElement=e}},{key:"setFirstNewElement",value:function(e){this._firstNewElement=e}},{key:"addDrawCounter",value:function(){this._drawCounter++}},{key:"blend",value:function(){var e;pe.activeBlendFunction!==this._blendFn&&((e=v.mainContext).enable(e.BLEND),this._blendFn(e),pe.activeBlendFunction=this._blendFn)}},{key:"dispose",value:function(){this._mesh.releaseMesh()}}]),a}()),ma=(ga.activeBlendType=-1,function(){function e(){b(this,e),this._frameTime=0,this._emissionRate=60,this._emissionTime=0,this.minEmissionTime=1/60}return y(e,[{key:"particleTemplate",set:function(e){this._particleTemplate=e}},{key:"emissionRate",get:function(){return this._emissionRate},set:function(e){e<=0||0<(this._emissionRate=e)&&(this.minEmissionTime=1/e)}},{key:"start",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:Number.MAX_VALUE;0!=this._emissionRate&&(this._emissionTime=e)}},{key:"stop",value:function(){this._emissionTime=0}},{key:"clear",value:function(){this._emissionTime=0}},{key:"emit",value:function(){}},{key:"advanceTime",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;if(this._emissionTime-=e,!(this._emissionTime<0||(this._frameTime+=e,this._frameTime<this.minEmissionTime)))for(;this._frameTime>this.minEmissionTime;)this._frameTime-=this.minEmissionTime,this.emit()}}]),e}()),va=function(){f(n,ma);var i=T(n);function n(e){var t;return b(this,n),(t=i.call(this)).template=e,t}return y(n,[{key:"template",get:function(){return this._particleTemplate},set:function(e){(this._particleTemplate=e)||(this._emitFun=null,this.setting=null,this._posRange=null),this.setting=e.settings,this._posRange=this.setting.positionVariance,this._particleTemplate instanceof ga&&(this._emitFun=this.webGLEmit)}},{key:"emit",value:function(){m(g(n.prototype),"emit",this).call(this),null!=this._emitFun&&this._emitFun()}},{key:"getRandom",value:function(e){return(2*Math.random()-1)*e}},{key:"webGLEmit",value:function(){var e=new Float32Array(3),t=(e[0]=this.getRandom(this._posRange[0]),e[1]=this.getRandom(this._posRange[1]),e[2]=this.getRandom(this._posRange[2]),new Float32Array(3));t[0]=0,t[1]=0,t[2]=0,this._particleTemplate.addParticleArray(e,t)}},{key:"canvasEmit",value:function(){var e=new Float32Array(3),t=(e[0]=this.getRandom(this._posRange[0]),e[1]=this.getRandom(this._posRange[1]),e[2]=this.getRandom(this._posRange[2]),new Float32Array(3));t[0]=0,t[1]=0,t[2]=0,this._particleTemplate.addParticleArray(e,t)}}]),n}(),xa=function(){function i(){b(this,i)}return y(i,[{key:"recover",value:function(){this._templ=null,p.recover("DrawParticleCmd",this)}},{key:"run",value:function(e,t,i){e.drawParticle(t,i,this._templ)}},{key:"cmdID",get:function(){return i.ID}}],[{key:"create",value:function(e){var t=p.getItemByClass("DrawParticleCmd",i);return t._templ=e,t}}]),i}(),ka=(xa.ID="DrawParticleCmd",function(){f(n,N);var i=T(n);function n(e){var t;return b(this,n),(t=i.call(this))._matrix4=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),t.autoPlay=!0,t.customRenderEnable=!0,e&&t.setParticleSetting(e),t}return y(n,[{key:"url",set:function(e){this.load(e)}},{key:"load",value:function(e){L.loader.load(e,x.create(this,this.setParticleSetting),null,L.Loader.JSON)}},{key:"setParticleSetting",value:function(e){if(!e)return this.stop();la.checkSetting(e),this.customRenderEnable=!0,this._particleTemplate=new ga(e),this.graphics._saveToCmd(null,xa.create(this._particleTemplate)),this._emitter?this._emitter.template=this._particleTemplate:this._emitter=new va(this._particleTemplate),this.autoPlay&&(this.emitter.start(),this.play())}},{key:"emitter",get:function(){return this._emitter}},{key:"play",value:function(){L.timer.frameLoop(1,this,this._loop)}},{key:"stop",value:function(){L.timer.clear(this,this._loop)}},{key:"_loop",value:function(){this.advanceTime(1/60)}},{key:"advanceTime",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;this._canvasTemplate&&this._canvasTemplate.advanceTime(e),this._emitter&&this._emitter.advanceTime(e)}},{key:"customRender",value:function(e,t,i){this._matrix4[0]=e._curMat.a,this._matrix4[1]=e._curMat.b,this._matrix4[4]=e._curMat.c,this._matrix4[5]=e._curMat.d,this._matrix4[12]=e._curMat.tx,this._matrix4[13]=e._curMat.ty,this._particleTemplate.sv.u_mmat=this._matrix4,this._canvasTemplate&&this._canvasTemplate.render(e,t,i)}},{key:"destroy",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this._particleTemplate instanceof ga&&this._particleTemplate.dispose(),m(g(n.prototype),"destroy",this).call(this,e)}}]),n}()),wa=(L.regClass(ka),function(){function i(){b(this,i)}return y(i,null,[{key:"isZero",value:function(e){return Math.abs(e)<i.zeroTolerance}},{key:"nearEqual",value:function(e,t){return!!i.isZero(e-t)}},{key:"fastInvSqrt",value:function(e){return i.isZero(e)?e:1/Math.sqrt(e)}}]),i}()),ba=(wa.zeroTolerance=1e-6,wa.MaxValue=340282347e30,wa.MinValue=-340282347e30,function(){function i(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;b(this,i),this.x=e,this.y=t}return y(i,[{key:"setValue",value:function(e,t){this.x=e,this.y=t}},{key:"fromArray",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this.x=e[t+0],this.y=e[t+1]}},{key:"cloneTo",value:function(e){e.x=this.x,e.y=this.y}},{key:"clone",value:function(){var e=new i;return this.cloneTo(e),e}},{key:"forNativeElement",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;e?(this.elements=e,this.elements[0]=this.x,this.elements[1]=this.y):this.elements=new Float32Array([this.x,this.y]),i.rewriteNumProperty(this,"x",0),i.rewriteNumProperty(this,"y",1)}}],[{key:"scale",value:function(e,t,i){i.x=e.x*t,i.y=e.y*t}},{key:"dot",value:function(e,t){return e.x*t.x+e.y*t.y}},{key:"normalize",value:function(e,t){var i=e.x,e=e.y,n=i*i+e*e;0<n&&(n=1/Math.sqrt(n),t.x=i*n,t.y=e*n)}},{key:"scalarLength",value:function(e){var t=e.x,e=e.y;return Math.sqrt(t*t+e*e)}},{key:"rewriteNumProperty",value:function(e,t,i){Object.defineProperty(e,t,{get:function(){return this.elements[i]},set:function(e){this.elements[i]=e}})}}]),i}()),Sa=(ba.ZERO=new ba(0,0),ba.ONE=new ba(1,1),function(){function a(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;b(this,a),this.x=e,this.y=t,this.z=i,this.w=n}return y(a,[{key:"setValue",value:function(e,t,i,n){this.x=e,this.y=t,this.z=i,this.w=n}},{key:"fromArray",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this.x=e[t+0],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3]}},{key:"cloneTo",value:function(e){e.x=this.x,e.y=this.y,e.z=this.z,e.w=this.w}},{key:"clone",value:function(){var e=new a;return this.cloneTo(e),e}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}},{key:"lengthSquared",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}},{key:"forNativeElement",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;e?(this.elements=e,this.elements[0]=this.x,this.elements[1]=this.y,this.elements[2]=this.z,this.elements[3]=this.w):this.elements=new Float32Array([this.x,this.y,this.z,this.w]),ba.rewriteNumProperty(this,"x",0),ba.rewriteNumProperty(this,"y",1),ba.rewriteNumProperty(this,"z",2),ba.rewriteNumProperty(this,"w",3)}}],[{key:"lerp",value:function(e,t,i,n){var a=e.x,s=e.y,r=e.z,e=e.w;n.x=a+i*(t.x-a),n.y=s+i*(t.y-s),n.z=r+i*(t.z-r),n.w=e+i*(t.w-e)}},{key:"transformByM4x4",value:function(e,t,i){var n=e.x,a=e.y,s=e.z,e=e.w,t=t.elements;i.x=n*t[0]+a*t[4]+s*t[8]+e*t[12],i.y=n*t[1]+a*t[5]+s*t[9]+e*t[13],i.z=n*t[2]+a*t[6]+s*t[10]+e*t[14],i.w=n*t[3]+a*t[7]+s*t[11]+e*t[15]}},{key:"equals",value:function(e,t){return wa.nearEqual(Math.abs(e.x),Math.abs(t.x))&&wa.nearEqual(Math.abs(e.y),Math.abs(t.y))&&wa.nearEqual(Math.abs(e.z),Math.abs(t.z))&&wa.nearEqual(Math.abs(e.w),Math.abs(t.w))}},{key:"normalize",value:function(e,t){var i=e.length();0<i&&(t.x=e.x*(i=1/i),t.y=e.y*i,t.z=e.z*i,t.w=e.w*i)}},{key:"add",value:function(e,t,i){i.x=e.x+t.x,i.y=e.y+t.y,i.z=e.z+t.z,i.w=e.w+t.w}},{key:"subtract",value:function(e,t,i){i.x=e.x-t.x,i.y=e.y-t.y,i.z=e.z-t.z,i.w=e.w-t.w}},{key:"multiply",value:function(e,t,i){i.x=e.x*t.x,i.y=e.y*t.y,i.z=e.z*t.z,i.w=e.w*t.w}},{key:"scale",value:function(e,t,i){i.x=e.x*t,i.y=e.y*t,i.z=e.z*t,i.w=e.w*t}},{key:"Clamp",value:function(e,t,i,n){var a=e.x,s=e.y,r=e.z,e=e.w,o=t.x,h=t.y,l=t.z,t=t.w,u=i.x,c=i.y,_=i.z,i=i.w,a=u<a?u:a,s=(s=c<s?c:s)<h?h:s,r=(r=_<r?_:r)<l?l:r,e=(e=i<e?i:e)<t?t:e;n.x=a=a<o?o:a,n.y=s,n.z=r,n.w=e}},{key:"distanceSquared",value:function(e,t){var i=e.x-t.x,n=e.y-t.y,a=e.z-t.z,e=e.w-t.w;return i*i+n*n+a*a+e*e}},{key:"distance",value:function(e,t){var i=e.x-t.x,n=e.y-t.y,a=e.z-t.z,e=e.w-t.w;return Math.sqrt(i*i+n*n+a*a+e*e)}},{key:"dot",value:function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w}},{key:"min",value:function(e,t,i){i.x=Math.min(e.x,t.x),i.y=Math.min(e.y,t.y),i.z=Math.min(e.z,t.z),i.w=Math.min(e.w,t.w)}},{key:"max",value:function(e,t,i){i.x=Math.max(e.x,t.x),i.y=Math.max(e.y,t.y),i.z=Math.max(e.z,t.z),i.w=Math.max(e.w,t.w)}}]),a}()),R=(Sa.ZERO=new Sa,Sa.ONE=new Sa(1,1,1,1),Sa.UnitX=new Sa(1,0,0,0),Sa.UnitY=new Sa(0,1,0,0),Sa.UnitZ=new Sa(0,0,1,0),Sa.UnitW=new Sa(0,0,0,1),function(){function a(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;b(this,a),this.x=e,this.y=t,this.z=i}return y(a,[{key:"setValue",value:function(e,t,i){this.x=e,this.y=t,this.z=i}},{key:"fromArray",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this.x=e[t+0],this.y=e[t+1],this.z=e[t+2]}},{key:"cloneTo",value:function(e){e.x=this.x,e.y=this.y,e.z=this.z}},{key:"clone",value:function(){var e=new a;return this.cloneTo(e),e}},{key:"toDefault",value:function(){this.x=0,this.y=0,this.z=0}},{key:"forNativeElement",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;e?(this.elements=e,this.elements[0]=this.x,this.elements[1]=this.y,this.elements[2]=this.z):this.elements=new Float32Array([this.x,this.y,this.z]),ba.rewriteNumProperty(this,"x",0),ba.rewriteNumProperty(this,"y",1),ba.rewriteNumProperty(this,"z",2)}}],[{key:"distanceSquared",value:function(e,t){var i=e.x-t.x,n=e.y-t.y,e=e.z-t.z;return i*i+n*n+e*e}},{key:"distance",value:function(e,t){var i=e.x-t.x,n=e.y-t.y,e=e.z-t.z;return Math.sqrt(i*i+n*n+e*e)}},{key:"min",value:function(e,t,i){i.x=Math.min(e.x,t.x),i.y=Math.min(e.y,t.y),i.z=Math.min(e.z,t.z)}},{key:"max",value:function(e,t,i){i.x=Math.max(e.x,t.x),i.y=Math.max(e.y,t.y),i.z=Math.max(e.z,t.z)}},{key:"transformQuat",value:function(e,t,i){var n=e.x,a=e.y,e=e.z,s=t.x,r=t.y,o=t.z,t=t.w,h=t*n+r*e-o*a,l=t*a+o*n-s*e,u=t*e+s*a-r*n,n=-s*n-r*a-o*e;i.x=h*t+n*-s+l*-o-u*-r,i.y=l*t+n*-r+u*-s-h*-o,i.z=u*t+n*-o+h*-r-l*-s}},{key:"scalarLength",value:function(e){var t=e.x,i=e.y,e=e.z;return Math.sqrt(t*t+i*i+e*e)}},{key:"scalarLengthSquared",value:function(e){var t=e.x,i=e.y,e=e.z;return t*t+i*i+e*e}},{key:"normalize",value:function(e,t){var i=e.x,n=e.y,e=e.z,a=i*i+n*n+e*e;0<a&&(a=1/Math.sqrt(a),t.x=i*a,t.y=n*a,t.z=e*a)}},{key:"multiply",value:function(e,t,i){i.x=e.x*t.x,i.y=e.y*t.y,i.z=e.z*t.z}},{key:"scale",value:function(e,t,i){i.x=e.x*t,i.y=e.y*t,i.z=e.z*t}},{key:"lerp",value:function(e,t,i,n){var a=e.x,s=e.y,e=e.z;n.x=a+i*(t.x-a),n.y=s+i*(t.y-s),n.z=e+i*(t.z-e)}},{key:"transformV3ToV3",value:function(e,t,i){var n=a._tempVector4;a.transformV3ToV4(e,t,n),i.x=n.x,i.y=n.y,i.z=n.z}},{key:"transformV3ToV4",value:function(e,t,i){var n=e.x,a=e.y,e=e.z,t=t.elements;i.x=n*t[0]+a*t[4]+e*t[8]+t[12],i.y=n*t[1]+a*t[5]+e*t[9]+t[13],i.z=n*t[2]+a*t[6]+e*t[10]+t[14],i.w=n*t[3]+a*t[7]+e*t[11]+t[15]}},{key:"TransformNormal",value:function(e,t,i){var n=e.x,a=e.y,e=e.z,t=t.elements;i.x=n*t[0]+a*t[4]+e*t[8],i.y=n*t[1]+a*t[5]+e*t[9],i.z=n*t[2]+a*t[6]+e*t[10]}},{key:"transformCoordinate",value:function(e,t,i){var n=e.x,a=e.y,e=e.z,t=t.elements,s=n*t[3]+a*t[7]+e*t[11]+t[15];i.x=n*t[0]+a*t[4]+e*t[8]+t[12]/s,i.y=n*t[1]+a*t[5]+e*t[9]+t[13]/s,i.z=n*t[2]+a*t[6]+e*t[10]+t[14]/s}},{key:"Clamp",value:function(e,t,i,n){var a=e.x,s=e.y,e=e.z,r=t.x,o=t.y,t=t.z,h=i.x,l=i.y,i=i.z,a=h<a?h:a,s=(s=l<s?l:s)<o?o:s,e=(e=i<e?i:e)<t?t:e;n.x=a=a<r?r:a,n.y=s,n.z=e}},{key:"add",value:function(e,t,i){i.x=e.x+t.x,i.y=e.y+t.y,i.z=e.z+t.z}},{key:"subtract",value:function(e,t,i){i.x=e.x-t.x,i.y=e.y-t.y,i.z=e.z-t.z}},{key:"cross",value:function(e,t,i){var n=e.x,a=e.y,e=e.z,s=t.x,r=t.y,t=t.z;i.x=a*t-e*r,i.y=e*s-n*t,i.z=n*r-a*s}},{key:"dot",value:function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z}},{key:"equals",value:function(e,t){return wa.nearEqual(e.x,t.x)&&wa.nearEqual(e.y,t.y)&&wa.nearEqual(e.z,t.z)}}]),a}()),Ia=(R._tempVector4=new Sa,R._ZERO=new R(0,0,0),R._ONE=new R(1,1,1),R._NegativeUnitX=new R(-1,0,0),R._UnitX=new R(1,0,0),R._UnitY=new R(0,1,0),R._UnitZ=new R(0,0,1),R._ForwardRH=new R(0,0,-1),R._ForwardLH=new R(0,0,1),R._Up=new R(0,1,0),function(){function a(){b(this,a);var e=this.elements=new Float32Array(9);e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1}return y(a,[{key:"determinant",value:function(){var e=this.elements,t=e[0],i=e[1],n=e[2],a=e[3],s=e[4],r=e[5],o=e[6],h=e[7],e=e[8];return t*(e*s-r*h)+i*(-e*a+r*o)+n*(h*a-s*o)}},{key:"translate",value:function(e,t){var t=t.elements,i=this.elements,n=i[0],a=i[1],s=i[2],r=i[3],o=i[4],h=i[5],l=i[6],u=i[7],i=i[8],c=e.x,e=e.y;t[0]=n,t[1]=a,t[2]=s,t[3]=r,t[4]=o,t[5]=h,t[6]=c*n+e*r+l,t[7]=c*a+e*o+u,t[8]=c*s+e*h+i}},{key:"rotate",value:function(e,t){var t=t.elements,i=this.elements,n=i[0],a=i[1],s=i[2],r=i[3],o=i[4],h=i[5],l=i[6],u=i[7],i=i[8],c=Math.sin(e),e=Math.cos(e);t[0]=e*n+c*r,t[1]=e*a+c*o,t[2]=e*s+c*h,t[3]=e*r-c*n,t[4]=e*o-c*a,t[5]=e*h-c*s,t[6]=l,t[7]=u,t[8]=i}},{key:"scale",value:function(e,t){var t=t.elements,i=this.elements,n=e.x,e=e.y;t[0]=n*i[0],t[1]=n*i[1],t[2]=n*i[2],t[3]=e*i[3],t[4]=e*i[4],t[5]=e*i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8]}},{key:"invert",value:function(e){var t=e.elements,i=this.elements,n=i[0],a=i[1],s=i[2],r=i[3],o=i[4],h=i[5],l=i[6],u=i[7],i=i[8],c=i*o-h*u,_=-i*r+h*l,f=u*r-o*l,d=n*c+a*_+s*f;d||(e=null),t[0]=c*(d=1/d),t[1]=(-i*a+s*u)*d,t[2]=(h*a-s*o)*d,t[3]=_*d,t[4]=(i*n-s*l)*d,t[5]=(-h*n+s*r)*d,t[6]=f*d,t[7]=(-u*n+a*l)*d,t[8]=(o*n-a*r)*d}},{key:"transpose",value:function(e){var t,i,n=e.elements,a=this.elements;e===this?(e=a[1],t=a[2],i=a[5],n[1]=a[3],n[2]=a[6],n[3]=e,n[5]=a[7],n[6]=t,n[7]=i):(n[0]=a[0],n[1]=a[3],n[2]=a[6],n[3]=a[1],n[4]=a[4],n[5]=a[7],n[6]=a[2],n[7]=a[5],n[8]=a[8])}},{key:"identity",value:function(){var e=this.elements;e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1}},{key:"cloneTo",value:function(e){var t,i=this.elements,n=e.elements;if(i!==n)for(t=0;t<9;++t)n[t]=i[t]}},{key:"clone",value:function(){var e=new a;return this.cloneTo(e),e}}],[{key:"createRotationQuaternion",value:function(e,t){var i=e.x,n=e.y,a=e.z,e=e.w,s=i*i,r=n*n,o=a*a,h=i*n,l=a*e,u=a*i,c=n*e,n=n*a,a=i*e,i=t.elements;i[0]=1-2*(r+o),i[1]=2*(h+l),i[2]=2*(u-c),i[3]=2*(h-l),i[4]=1-2*(o+s),i[5]=2*(n+a),i[6]=2*(u+c),i[7]=2*(n-a),i[8]=1-2*(r+s)}},{key:"createFromTranslation",value:function(e,t){t=t.elements;t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e.x,t[7]=e.y,t[8]=1}},{key:"createFromRotation",value:function(e,t){var t=t.elements,i=Math.sin(e),e=Math.cos(e);t[0]=e,t[1]=i,t[2]=0,t[3]=-i,t[4]=e,t[5]=0,t[6]=0,t[7]=0,t[8]=1}},{key:"createFromScaling",value:function(e,t){t=t.elements;t[0]=e.x,t[1]=0,t[2]=0,t[3]=0,t[4]=e.y,t[5]=0,t[6]=0,t[7]=0,t[8]=e.z}},{key:"createFromMatrix4x4",value:function(e,t){e=e.elements,t=t.elements;t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10]}},{key:"multiply",value:function(e,t,i){var e=e.elements,t=t.elements,i=i.elements,n=e[0],a=e[1],s=e[2],r=e[3],o=e[4],h=e[5],l=e[6],u=e[7],e=e[8],c=t[0],_=t[1],f=t[2],d=t[3],p=t[4],y=t[5],g=t[6],m=t[7],t=t[8];i[0]=c*n+_*r+f*l,i[1]=c*a+_*o+f*m,i[2]=c*s+_*h+f*e,i[3]=d*n+p*r+y*l,i[4]=d*a+p*o+y*u,i[5]=d*s+p*h+y*e,i[6]=g*n+m*r+t*l,i[7]=g*a+m*o+t*u,i[8]=g*s+m*h+t*e}},{key:"lookAt",value:function(e,t,i,n){R.subtract(e,t,a._tempV30),R.normalize(a._tempV30,a._tempV30),R.cross(i,a._tempV30,a._tempV31),R.normalize(a._tempV31,a._tempV31),R.cross(a._tempV30,a._tempV31,a._tempV32);e=a._tempV30,t=a._tempV31,i=a._tempV32,n=n.elements;n[0]=t.x,n[3]=t.y,n[6]=t.z,n[1]=i.x,n[4]=i.y,n[7]=i.z,n[2]=e.x,n[5]=e.y,n[8]=e.z}}]),a}()),Ta=(Ia.DEFAULT=new Ia,Ia._tempV30=new R,Ia._tempV31=new R,Ia._tempV32=new R,y(function e(){b(this,e)})),Ca=(Ta.Shader3D=null,Ta.Scene3D=null,Ta.MeshRenderStaticBatchManager=null,Ta.MeshRenderDynamicBatchManager=null,Ta.SubMeshDynamicBatch=null,Ta.Laya3D=null,Ta.Matrix4x4=null,function(){function s(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1;b(this,s),this.x=e,this.y=t,this.z=i,this.w=n}return y(s,[{key:"scaling",value:function(e,t){t.x=this.x*e,t.y=this.y*e,t.z=this.z*e,t.w=this.w*e}},{key:"normalize",value:function(e){var t=this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w;0<t&&(t=1/Math.sqrt(t),e.x=this.x*t,e.y=this.y*t,e.z=this.z*t,e.w=this.w*t)}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}},{key:"rotateX",value:function(e,t){e*=.5;var i=Math.sin(e),e=Math.cos(e);t.x=this.x*e+this.w*i,t.y=this.y*e+this.z*i,t.z=this.z*e-this.y*i,t.w=this.w*e-this.x*i}},{key:"rotateY",value:function(e,t){e*=.5;var i=Math.sin(e),e=Math.cos(e);t.x=this.x*e-this.z*i,t.y=this.y*e+this.w*i,t.z=this.z*e+this.x*i,t.w=this.w*e-this.y*i}},{key:"rotateZ",value:function(e,t){e*=.5;var i=Math.sin(e),e=Math.cos(e);t.x=this.x*e+this.y*i,t.y=this.y*e-this.x*i,t.z=this.z*e+this.w*i,t.w=this.w*e-this.z*i}},{key:"getYawPitchRoll",value:function(e){R.transformQuat(R._ForwardRH,this,s.TEMPVector31),R.transformQuat(R._Up,this,s.TEMPVector32);var t=s.TEMPVector32,i=(s.angleTo(R._ZERO,s.TEMPVector31,s.TEMPVector33),s.TEMPVector33),t=(i.x==Math.PI/2?(i.y=s.arcTanAngle(t.z,t.x),i.z=0):i.x==-Math.PI/2?(i.y=s.arcTanAngle(-t.z,-t.x),i.z=0):(Ta.Matrix4x4.createRotationY(-i.y,Ta.Matrix4x4.TEMPMatrix0),Ta.Matrix4x4.createRotationX(-i.x,Ta.Matrix4x4.TEMPMatrix1),R.transformCoordinate(s.TEMPVector32,Ta.Matrix4x4.TEMPMatrix0,s.TEMPVector32),R.transformCoordinate(s.TEMPVector32,Ta.Matrix4x4.TEMPMatrix1,s.TEMPVector32),i.z=s.arcTanAngle(t.y,-t.x)),i.y<=-Math.PI&&(i.y=Math.PI),i.z<=-Math.PI&&(i.z=Math.PI),i.y>=Math.PI&&i.z>=Math.PI&&(i.y=0,i.z=0,i.x=Math.PI-i.x),e);t.x=i.y,t.y=i.x,t.z=i.z}},{key:"invert",value:function(e){var t=this.x,i=this.y,n=this.z,a=this.w,s=t*t+i*i+n*n+a*a,s=s?1/s:0;e.x=-t*s,e.y=-i*s,e.z=-n*s,e.w=a*s}},{key:"identity",value:function(){this.x=0,this.y=0,this.z=0,this.w=1}},{key:"fromArray",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this.x=e[t+0],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3]}},{key:"cloneTo",value:function(e){this!==e&&(e.x=this.x,e.y=this.y,e.z=this.z,e.w=this.w)}},{key:"clone",value:function(){var e=new s;return this.cloneTo(e),e}},{key:"equals",value:function(e){return wa.nearEqual(this.x,e.x)&&wa.nearEqual(this.y,e.y)&&wa.nearEqual(this.z,e.z)&&wa.nearEqual(this.w,e.w)}},{key:"lengthSquared",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}},{key:"forNativeElement",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;e?(this.elements=e,this.elements[0]=this.x,this.elements[1]=this.y,this.elements[2]=this.z,this.elements[3]=this.w):this.elements=new Float32Array([this.x,this.y,this.z,this.w]),ba.rewriteNumProperty(this,"x",0),ba.rewriteNumProperty(this,"y",1),ba.rewriteNumProperty(this,"z",2),ba.rewriteNumProperty(this,"w",3)}}],[{key:"createFromYawPitchRoll",value:function(e,t,i,n){var i=.5*i,t=.5*t,e=.5*e,a=Math.sin(i),i=Math.cos(i),s=Math.sin(t),t=Math.cos(t),r=Math.sin(e),e=Math.cos(e);n.x=e*s*i+r*t*a,n.y=r*t*i-e*s*a,n.z=e*t*a-r*s*i,n.w=e*t*i+r*s*a}},{key:"multiply",value:function(e,t,i){var n=e.x,a=e.y,s=e.z,e=e.w,r=t.x,o=t.y,h=t.z,t=t.w,l=s*r-n*h,u=n*o-a*r,c=n*r+a*o+s*h;i.x=n*t+r*e+(a*h-s*o),i.y=a*t+o*e+l,i.z=s*t+h*e+u,i.w=e*t-c}},{key:"arcTanAngle",value:function(e,t){return 0==e?1==t?Math.PI/2:-Math.PI/2:0<e?Math.atan(t/e):e<0?0<t?Math.atan(t/e)+Math.PI:Math.atan(t/e)-Math.PI:0}},{key:"angleTo",value:function(e,t,i){R.subtract(t,e,s.TEMPVector30),R.normalize(s.TEMPVector30,s.TEMPVector30),i.x=Math.asin(s.TEMPVector30.y),i.y=s.arcTanAngle(-s.TEMPVector30.z,-s.TEMPVector30.x)}},{key:"createFromAxisAngle",value:function(e,t,i){t*=.5;var n=Math.sin(t);i.x=n*e.x,i.y=n*e.y,i.z=n*e.z,i.w=Math.cos(t)}},{key:"createFromMatrix4x4",value:function(e,t){var i,n,e=e.elements,a=e[0]+e[5]+e[10];0<a?(i=Math.sqrt(a+1),t.w=.5*i,t.x=(e[6]-e[9])*(i=.5/i),t.y=(e[8]-e[2])*i,t.z=(e[1]-e[4])*i):e[0]>=e[5]&&e[0]>=e[10]?(n=.5/(i=Math.sqrt(1+e[0]-e[5]-e[10])),t.x=.5*i,t.y=(e[1]+e[4])*n,t.z=(e[2]+e[8])*n,t.w=(e[6]-e[9])*n):e[5]>e[10]?(i=Math.sqrt(1+e[5]-e[0]-e[10]),t.x=(e[4]+e[1])*(n=.5/i),t.y=.5*i,t.z=(e[9]+e[6])*n,t.w=(e[8]-e[2])*n):(i=Math.sqrt(1+e[10]-e[0]-e[5]),t.x=(e[8]+e[2])*(n=.5/i),t.y=(e[9]+e[6])*n,t.z=.5*i,t.w=(e[1]-e[4])*n)}},{key:"slerp",value:function(e,t,i,n){var a,s,r=e.x,o=e.y,h=e.z,e=e.w,l=t.x,u=t.y,c=t.z,t=t.w,_=r*l+o*u+h*c+e*t;return _<0&&(_=-_,l=-l,u=-u,c=-c,t=-t),_=1e-6<1-_?(_=Math.acos(_),a=Math.sin(_),s=Math.sin((1-i)*_)/a,Math.sin(i*_)/a):(s=1-i,i),n.x=s*r+_*l,n.y=s*o+_*u,n.z=s*h+_*c,n.w=s*e+_*t,n}},{key:"lerp",value:function(e,t,i,n){var a=1-i;0<=s.dot(e,t)?(n.x=a*e.x+i*t.x,n.y=a*e.y+i*t.y,n.z=a*e.z+i*t.z,n.w=a*e.w+i*t.w):(n.x=a*e.x-i*t.x,n.y=a*e.y-i*t.y,n.z=a*e.z-i*t.z,n.w=a*e.w-i*t.w),n.normalize(n)}},{key:"add",value:function(e,t,i){i.x=e.x+t.x,i.y=e.y+t.y,i.z=e.z+t.z,i.w=e.w+t.w}},{key:"dot",value:function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w}},{key:"rotationLookAt",value:function(e,t,i){s.lookAt(R._ZERO,e,t,i)}},{key:"lookAt",value:function(e,t,i,n){Ia.lookAt(e,t,i,s._tempMatrix3x3),s.rotationMatrix(s._tempMatrix3x3,n)}},{key:"invert",value:function(e,t){var i=e.lengthSquared();wa.isZero(i)||(t.x=-e.x*(i=1/i),t.y=-e.y*i,t.z=-e.z*i,t.w=e.w*i)}},{key:"rotationMatrix",value:function(e,t){var i,n,e=e.elements,a=e[0],s=e[1],r=e[2],o=e[3],h=e[4],l=e[5],u=e[6],c=e[7],e=e[8],_=a+h+e;0<_?(i=Math.sqrt(_+1),t.w=.5*i,t.x=(l-c)*(i=.5/i),t.y=(u-r)*i,t.z=(s-o)*i):h<=a&&e<=a?(n=.5/(i=Math.sqrt(1+a-h-e)),t.x=.5*i,t.y=(s+o)*n,t.z=(r+u)*n,t.w=(l-c)*n):e<h?(i=Math.sqrt(1+h-a-e),t.x=(o+s)*(n=.5/i),t.y=.5*i,t.z=(c+l)*n,t.w=(u-r)*n):(i=Math.sqrt(1+e-a-h),t.x=(u+r)*(n=.5/i),t.y=(c+l)*n,t.z=.5*i,t.w=(s-o)*n)}}]),s}()),Ma=(Ca.TEMPVector30=new R,Ca.TEMPVector31=new R,Ca.TEMPVector32=new R,Ca.TEMPVector33=new R,Ca._tempMatrix3x3=new Ia,Ca.DEFAULT=new Ca,Ca.NAN=new Ca(NaN,NaN,NaN,NaN),function(){function e(){b(this,e)}return y(e,null,[{key:"lightAttenTexture",value:function(e,t,i,n,a,s){e/=i,i=1/(1+25*e);.64<=e&&(1<e?i=0:i*=1-(e-.64)/.36),s[a]=Math.floor(255*i+.5)}},{key:"haloTexture",value:function(e,t,i,n,a,s){e=(e-(i>>=1))/i,i=(t-(n>>=1))/n,t=e*e+i*i;1<t&&(t=1),s[a]=Math.floor(255*(1-t)+.5)}},{key:"_generateTexture2D",value:function(e,t,i,n){var a=0,s=0;switch(e.format){case G.R8G8B8:s=3;break;case G.R8G8B8A8:s=4;break;case G.Alpha8:s=1;break;default:throw"GeneratedTexture._generateTexture: unkonw texture format."}for(var r=new Uint8Array(t*i*s),o=0;o<i;o++)for(var h=0;h<t;h++)n(h,o,t,i,a,r),a+=s;e.setPixels(r)}}]),e}()),Ea=y(function e(){b(this,e)}),Ra=(Ea._bullet=null,Ea._enablePhysics=!1,function(){function T(){b(this,T)}return y(T,null,[{key:"_createFloatTextureBuffer",value:function(e,t){e=new ue(e,t,G.R32G32B32A32,!1,!1);return e.filterMode=le.FILTERMODE_POINT,e.wrapModeU=le.WARPMODE_CLAMP,e.wrapModeV=le.WARPMODE_CLAMP,e.anisoLevel=0,e}},{key:"_convertToLayaVec3",value:function(e,t,i){var n=Ea._bullet;t.x=i?-n.btVector3_x(e):n.btVector3_x(e),t.y=n.btVector3_y(e),t.z=n.btVector3_z(e)}},{key:"_convertToBulletVec3",value:function(e,t,i){Ea._bullet.btVector3_setValue(t,i?-e.x:e.x,e.y,e.z)}},{key:"_rotationTransformScaleSkinAnimation",value:function(e,t,i,n,a,s,r,o,h,l,u,c){var _,f,d,p,y,g=T._tempArray16_0,m=T._tempArray16_1,v=T._tempArray16_2,x=n+n,k=a+a,w=s+s,n=n*x,b=a*x,a=a*k,S=s*x,I=s*k,s=s*w,x=r*x,k=r*k,r=r*w;for(g[15]=1,g[0]=1-a-s,g[1]=b+r,g[2]=S-k,g[4]=b-r,g[5]=1-n-s,g[6]=I+x,g[8]=S+k,g[9]=I-x,g[10]=1-n-a,m[15]=1,m[0]=o,m[5]=h,m[10]=l,_=0;_<4;_++)f=g[_],d=g[_+4],p=g[_+8],y=g[_+12],v[_]=f,v[_+4]=d,v[_+8]=p,v[_+12]=f*e+d*t+p*i+y;for(_=0;_<4;_++)f=v[_],d=v[_+4],p=v[_+8],y=v[_+12],u[_+c]=f*m[0]+d*m[1]+p*m[2]+y*m[3],u[_+c+4]=f*m[4]+d*m[5]+p*m[6]+y*m[7],u[_+c+8]=f*m[8]+d*m[9]+p*m[10]+y*m[11],u[_+c+12]=f*m[12]+d*m[13]+p*m[14]+y*m[15]}},{key:"_computeBoneAndAnimationDatasByBindPoseMatrxix",value:function(e,t,i,n,a,s){for(var r,o=0,h=0,l=e.length,u=0;u<l;o+=e[u].keyframeWidth,h+=16,u++)T._rotationTransformScaleSkinAnimation(t[o+0],t[o+1],t[o+2],t[o+3],t[o+4],t[o+5],t[o+6],t[o+7],t[o+8],t[o+9],n,h),0!=u&&(r=16*e[u].parentIndex,T.mulMatrixByArray(n,r,n,h,n,h));var c=i.length;for(u=0;u<c;u++)T.mulMatrixByArrayAndMatrixFast(n,16*s[u],i[u],a,16*u)}},{key:"_computeAnimationDatasByArrayAndMatrixFast",value:function(e,t,i,n){for(var a=0,s=e.length;a<s;a++)T.mulMatrixByArrayAndMatrixFast(t,16*n[a],e[a],i,16*a)}},{key:"_computeBoneAndAnimationDatasByBindPoseMatrxixOld",value:function(e,t,i,n,a){for(var s,r=0,o=0,h=e.length,l=0;l<h;r+=e[l].keyframeWidth,o+=16,l++)T._rotationTransformScaleSkinAnimation(t[r+7],t[r+8],t[r+9],t[r+3],t[r+4],t[r+5],t[r+6],t[r+0],t[r+1],t[r+2],n,o),0!=l&&(s=16*e[l].parentIndex,T.mulMatrixByArray(n,s,n,o,n,o));var u=i.length;for(l=0;l<u;l++){var c=16*l;T.mulMatrixByArrayAndMatrixFast(n,c,i[l],a,c)}}},{key:"_computeAnimationDatasByArrayAndMatrixFastOld",value:function(e,t,i){for(var n=e.length,a=0;a<n;a++){var s=16*a;T.mulMatrixByArrayAndMatrixFast(t,s,e[a],i,s)}}},{key:"_computeRootAnimationData",value:function(e,t,i){for(var n=0,a=0,s=0,r=e.length;n<r;a+=e[n].keyframeWidth,s+=16,n++)T.createAffineTransformationArray(t[a+0],t[a+1],t[a+2],t[a+3],t[a+4],t[a+5],t[a+6],t[a+7],t[a+8],t[a+9],i,s)}},{key:"transformVector3ArrayByQuat",value:function(e,t,i,n,a){var s=e[t],r=e[t+1],e=e[t+2],t=i.x,o=i.y,h=i.z,i=i.w,l=i*s+o*e-h*r,u=i*r+h*s-t*e,c=i*e+t*r-o*s,s=-t*s-o*r-h*e;n[a]=l*i+s*-t+u*-h-c*-o,n[a+1]=u*i+s*-o+c*-t-l*-h,n[a+2]=c*i+s*-h+l*-o-u*-t}},{key:"mulMatrixByArray",value:function(e,t,i,n,a,s){var r,o,h,l,u;if(a===i){for(i=T._tempArray16_3,r=0;r<16;++r)i[r]=a[s+r];n=0}for(r=0;r<4;r++)o=e[t+r],h=e[t+r+4],l=e[t+r+8],u=e[t+r+12],a[s+r]=o*i[n+0]+h*i[n+1]+l*i[n+2]+u*i[n+3],a[s+r+4]=o*i[n+4]+h*i[n+5]+l*i[n+6]+u*i[n+7],a[s+r+8]=o*i[n+8]+h*i[n+9]+l*i[n+10]+u*i[n+11],a[s+r+12]=o*i[n+12]+h*i[n+13]+l*i[n+14]+u*i[n+15]}},{key:"mulMatrixByArrayFast",value:function(e,t,i,n,a,s){for(var r,o,h,l,u=0;u<4;u++)r=e[t+u],o=e[t+u+4],h=e[t+u+8],l=e[t+u+12],a[s+u]=r*i[n+0]+o*i[n+1]+h*i[n+2]+l*i[n+3],a[s+u+4]=r*i[n+4]+o*i[n+5]+h*i[n+6]+l*i[n+7],a[s+u+8]=r*i[n+8]+o*i[n+9]+h*i[n+10]+l*i[n+11],a[s+u+12]=r*i[n+12]+o*i[n+13]+h*i[n+14]+l*i[n+15]}},{key:"mulMatrixByArrayAndMatrixFast",value:function(e,t,i,n,a){for(var s,r,o,h,i=i.elements,l=i[0],u=i[1],c=i[2],_=i[3],f=i[4],d=i[5],p=i[6],y=i[7],g=i[8],m=i[9],v=i[10],x=i[11],k=i[12],w=i[13],b=i[14],S=i[15],I=t,T=t+4,C=t+8,M=t+12,E=a,R=a+4,A=a+8,L=a+12,N=0;N<4;N++)s=e[I+N],r=e[T+N],o=e[C+N],h=e[M+N],n[E+N]=s*l+r*u+o*c+h*_,n[R+N]=s*f+r*d+o*p+h*y,n[A+N]=s*g+r*m+o*v+h*x,n[L+N]=s*k+r*w+o*b+h*S}},{key:"createAffineTransformationArray",value:function(e,t,i,n,a,s,r,o,h,l,u,c){var _=n+n,f=a+a,d=s+s,p=n*_,y=n*f,n=n*d,g=a*f,a=a*d,s=s*d,_=r*_,f=r*f,r=r*d;u[c+0]=(1-(g+s))*o,u[c+1]=(y+r)*o,u[c+2]=(n-f)*o,u[c+3]=0,u[c+4]=(y-r)*h,u[c+5]=(1-(p+s))*h,u[c+6]=(a+_)*h,u[c+7]=0,u[c+8]=(n+f)*l,u[c+9]=(a-_)*l,u[c+10]=(1-(p+g))*l,u[c+11]=0,u[c+12]=e,u[c+13]=t,u[c+14]=i,u[c+15]=1}},{key:"transformVector3ArrayToVector3ArrayCoordinate",value:function(e,t,i,n,a){var s=e[t+0],r=e[t+1],e=e[t+2],t=i.elements,i=s*t[3]+r*t[7]+e*t[11]+t[15];n[a]=s*t[0]+r*t[4]+e*t[8]+t[12]/i,n[a+1]=s*t[1]+r*t[5]+e*t[9]+t[13]/i,n[a+2]=s*t[2]+r*t[6]+e*t[10]+t[14]/i}},{key:"transformVector3ArrayToVector3ArrayNormal",value:function(e,t,i,n,a){var s=e[t+0],r=e[t+1],e=e[t+2],t=i.elements;n[a]=s*t[0]+r*t[4]+e*t[8],n[a+1]=s*t[1]+r*t[5]+e*t[9],n[a+2]=s*t[2]+r*t[6]+e*t[10]}},{key:"transformLightingMapTexcoordArray",value:function(e,t,i,n,a){n[a+0]=e[t+0]*i.x+i.z,n[a+1]=1-((1-e[t+1])*i.y+i.w)}},{key:"getURLVerion",value:function(e){var t=e.indexOf("?");return 0<=t?e.substr(t):null}},{key:"_createAffineTransformationArray",value:function(e,t,i,n){var a=t.x,s=t.y,r=t.z,t=t.w,o=a+a,h=s+s,l=r+r,u=a*o,c=a*h,a=a*l,_=s*h,s=s*l,r=r*l,o=t*o,h=t*h,t=t*l,l=i.x,f=i.y,i=i.z;n[0]=(1-(_+r))*l,n[1]=(c+t)*l,n[2]=(a-h)*l,n[3]=0,n[4]=(c-t)*f,n[5]=(1-(u+r))*f,n[6]=(s+o)*f,n[7]=0,n[8]=(a+h)*i,n[9]=(s-o)*i,n[10]=(1-(u+_))*i,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1}},{key:"_mulMatrixArray",value:function(e,t,i,n){for(var a,s,r,o,t=t.elements,h=t[0],l=t[1],u=t[2],c=t[3],_=t[4],f=t[5],d=t[6],p=t[7],y=t[8],g=t[9],m=t[10],v=t[11],x=t[12],k=t[13],w=t[14],b=t[15],S=n,I=n+4,T=n+8,C=n+12,M=0;M<4;M++)a=e[M],s=e[M+4],r=e[M+8],o=e[M+12],i[S+M]=a*h+s*l+r*u+o*c,i[I+M]=a*_+s*f+r*d+o*p,i[T+M]=a*y+s*g+r*m+o*v,i[C+M]=a*x+s*k+r*w+o*b}},{key:"arcTanAngle",value:function(e,t){return 0==e?1==t?Math.PI/2:-Math.PI/2:0<e?Math.atan(t/e):e<0?0<t?Math.atan(t/e)+Math.PI:Math.atan(t/e)-Math.PI:0}},{key:"angleTo",value:function(e,t,i){R.subtract(t,e,Ca.TEMPVector30),R.normalize(Ca.TEMPVector30,Ca.TEMPVector30),i.x=Math.asin(Ca.TEMPVector30.y),i.y=T.arcTanAngle(-Ca.TEMPVector30.z,-Ca.TEMPVector30.x)}},{key:"transformQuat",value:function(e,t,i){var n=e.x,a=e.y,e=e.z,s=t[0],r=t[1],o=t[2],t=t[3],h=t*n+r*e-o*a,l=t*a+o*n-s*e,u=t*e+s*a-r*n,n=-s*n-r*a-o*e;i.x=h*t+n*-s+l*-o-u*-r,i.y=l*t+n*-r+u*-s-h*-o,i.z=u*t+n*-o+h*-r-l*-s}},{key:"quaternionWeight",value:function(e,t,i){i.x=e.x*t,i.y=e.y*t,i.z=e.z*t,i.w=e.w}},{key:"quaternionConjugate",value:function(e,t){t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=e.w}},{key:"scaleWeight",value:function(e,t,i){var n=e.x,a=e.y,e=e.z;i.x=0<n?Math.pow(Math.abs(n),t):-Math.pow(Math.abs(n),t),i.y=0<a?Math.pow(Math.abs(a),t):-Math.pow(Math.abs(a),t),i.z=0<e?Math.pow(Math.abs(e),t):-Math.pow(Math.abs(e),t)}},{key:"scaleBlend",value:function(e,t,i,n){var a=T._tempVector3_0,s=T._tempVector3_1,i=(T.scaleWeight(e,1-i,a),T.scaleWeight(t,i,s),.5<i?t:e);n.x=0<i.x?Math.abs(a.x*s.x):-Math.abs(a.x*s.x),n.y=0<i.y?Math.abs(a.y*s.y):-Math.abs(a.y*s.y),n.z=0<i.z?Math.abs(a.z*s.z):-Math.abs(a.z*s.z)}},{key:"matrix4x4MultiplyFFF",value:function(e,t,i){var n,a,s,r;if(i===t)for(t=new Float32Array(16),b=0;b<16;++b)t[b]=i[b];for(var o=t[0],h=t[1],l=t[2],u=t[3],c=t[4],_=t[5],f=t[6],d=t[7],p=t[8],y=t[9],g=t[10],m=t[11],v=t[12],x=t[13],k=t[14],w=t[15],b=0;b<4;b++)n=e[b],a=e[b+4],s=e[b+8],r=e[b+12],i[b]=n*o+a*h+s*l+r*u,i[b+4]=n*c+a*_+s*f+r*d,i[b+8]=n*p+a*y+s*g+r*m,i[b+12]=n*v+a*x+s*k+r*w}},{key:"matrix4x4MultiplyFFFForNative",value:function(e,t,i){S.instance.matrix4x4Multiply(e,t,i)}},{key:"matrix4x4MultiplyMFM",value:function(e,t,i){T.matrix4x4MultiplyFFF(e.elements,t,i.elements)}},{key:"_buildTexture2D",value:function(e,t,i,n){i=new ue(e,t,i,4<arguments.length&&void 0!==arguments[4]&&arguments[4],!0);return i.anisoLevel=1,i.filterMode=le.FILTERMODE_POINT,Ma._generateTexture2D(i,e,t,n),i}},{key:"_drawBound",value:function(e,t,i){e.lineCount+12>e.maxLineCount&&(e.maxLineCount+=12);var n=T._tempVector3_0,a=T._tempVector3_1,s=t.min,t=t.max;n.setValue(s.x,s.y,s.z),a.setValue(t.x,s.y,s.z),e.addLine(n,a,i,i),n.setValue(s.x,s.y,s.z),a.setValue(s.x,s.y,t.z),e.addLine(n,a,i,i),n.setValue(t.x,s.y,s.z),a.setValue(t.x,s.y,t.z),e.addLine(n,a,i,i),n.setValue(s.x,s.y,t.z),a.setValue(t.x,s.y,t.z),e.addLine(n,a,i,i),n.setValue(s.x,s.y,s.z),a.setValue(s.x,t.y,s.z),e.addLine(n,a,i,i),n.setValue(s.x,s.y,t.z),a.setValue(s.x,t.y,t.z),e.addLine(n,a,i,i),n.setValue(t.x,s.y,s.z),a.setValue(t.x,t.y,s.z),e.addLine(n,a,i,i),n.setValue(t.x,s.y,t.z),a.setValue(t.x,t.y,t.z),e.addLine(n,a,i,i),n.setValue(s.x,t.y,s.z),a.setValue(t.x,t.y,s.z),e.addLine(n,a,i,i),n.setValue(s.x,t.y,s.z),a.setValue(s.x,t.y,t.z),e.addLine(n,a,i,i),n.setValue(t.x,t.y,s.z),a.setValue(t.x,t.y,t.z),e.addLine(n,a,i,i),n.setValue(s.x,t.y,t.z),a.setValue(t.x,t.y,t.z),e.addLine(n,a,i,i)}},{key:"_getHierarchyPath",value:function(e,t,i){i.length=0;for(var n=t;n!==e;){var a=n._parent;if(!a)return null;i.push(a.getChildIndex(n)),n=a}return i}},{key:"_getNodeByHierarchyPath",value:function(e,t){for(var i=e,n=t.length-1;0<=n;n--)i=i.getChildAt(t[n]);return i}}]),T}()),Aa=(Ra._tempVector3_0=new R,Ra._tempVector3_1=new R,Ra._tempArray16_0=new Float32Array(16),Ra._tempArray16_1=new Float32Array(16),Ra._tempArray16_2=new Float32Array(16),Ra._tempArray16_3=new Float32Array(16),Ra._compIdToNode=new Object,function(){function e(){b(this,e),this._currentState=null}return y(e,[{key:"normalizedTime",get:function(){return this._normalizedTime}},{key:"duration",get:function(){return this._duration}},{key:"animatorState",get:function(){return this._currentState}},{key:"_resetPlayState",value:function(e){this._finish=!1,this._startPlayTime=e,this._elapsedTime=e,this._playEventIndex=0,this._lastIsFront=!0}},{key:"_cloneTo",value:function(e){e._finish=this._finish,e._startPlayTime=this._startPlayTime,e._elapsedTime=this._elapsedTime,e._playEventIndex=this._playEventIndex,e._lastIsFront=this._lastIsFront}}]),e}()),La=function(){function t(e){b(this,t),this._defaultState=null,this._referenceCount=0,this._playType=-1,this._crossDuration=-1,this._crossMark=0,this._crossNodesOwnersCount=0,this._crossNodesOwners=[],this._crossNodesOwnersIndicesMap={},this._srcCrossClipNodeIndices=[],this._destCrossClipNodeIndices=[],this._statesMap={},this._states=[],this._playStateInfo=new Aa,this._crossPlayStateInfo=new Aa,this.blendingMode=t.BLENDINGMODE_OVERRIDE,this.defaultWeight=1,this.playOnWake=!0,this.name=e}return y(t,[{key:"defaultState",get:function(){return this._defaultState},set:function(e){this._defaultState=e,this._statesMap[e.name]=e}},{key:"_removeClip",value:function(e,t,i,n){var a=n._clip,s=e[i];if(e.splice(i,1),delete t[n.name],this._animator){var r=a._nodes,o=s._nodeOwners;a._removeReference();for(var h=0,l=r.count;h<l;h++)this._animator._removeKeyframeNodeOwner(o,r.getNodeByIndex(h))}}},{key:"_getReferenceCount",value:function(){return this._referenceCount}},{key:"_addReference",value:function(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,t=0,i=this._states.length;t<i;t++)this._states[t]._addReference(e);this._referenceCount+=e}},{key:"_removeReference",value:function(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,t=0,i=this._states.length;t<i;t++)this._states[t]._removeReference(e);this._referenceCount-=e}},{key:"_clearReference",value:function(){this._removeReference(-this._referenceCount)}},{key:"getCurrentPlayState",value:function(){return this._playStateInfo}},{key:"getAnimatorState",value:function(e){e=this._statesMap[e];return e||null}},{key:"addState",value:function(e){var t=e.name;if(this._statesMap[t])throw"AnimatorControllerLayer:this stat's name has exist.";this._statesMap[t]=e,this._states.push(e),this._animator&&(e._clip._addReference(),this._animator._getOwnersByClip(e))}},{key:"removeState",value:function(e){for(var t=this._states,i=-1,n=0,a=t.length;n<a;n++)if(t[n]===e){i=n;break}-1!==i&&this._removeClip(t,this._statesMap,i,e)}},{key:"destroy",value:function(){this._clearReference(),this._statesMap=null,this._states=null,this._playStateInfo=null,this._crossPlayStateInfo=null,this._defaultState=null}},{key:"cloneTo",value:function(e){e.name=this.name,e.blendingMode=this.blendingMode,e.defaultWeight=this.defaultWeight,e.playOnWake=this.playOnWake}},{key:"clone",value:function(){var e=new t(this.name);return this.cloneTo(e),e}}]),t}(),e=(La.BLENDINGMODE_OVERRIDE=0,La.BLENDINGMODE_ADDTIVE=1,function(){function s(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,a=(b(this,s),this.elements=new Float32Array(4));a[0]=e,a[1]=t,a[2]=i,a[3]=n}return y(s,[{key:"x",get:function(){return this.elements[0]},set:function(e){this.elements[0]=e}},{key:"y",get:function(){return this.elements[1]},set:function(e){this.elements[1]=e}},{key:"z",get:function(){return this.elements[2]},set:function(e){this.elements[2]=e}},{key:"w",get:function(){return this.elements[3]},set:function(e){this.elements[3]=e}},{key:"fromArray",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this.elements[0]=e[t+0],this.elements[1]=e[t+1],this.elements[2]=e[t+2],this.elements[3]=e[t+3]}},{key:"cloneTo",value:function(e){var e=e.elements,t=this.elements;e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]}},{key:"clone",value:function(){var e=new s;return this.cloneTo(e),e}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}},{key:"lengthSquared",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}}],[{key:"lerp",value:function(e,t,i,n){var n=n.elements,e=e.elements,t=t.elements,a=e[0],s=e[1],r=e[2],e=e[3];n[0]=a+i*(t[0]-a),n[1]=s+i*(t[1]-s),n[2]=r+i*(t[2]-r),n[3]=e+i*(t[3]-e)}},{key:"transformByM4x4",value:function(e,t,i){var e=e.elements,n=e[0],a=e[1],s=e[2],e=e[3],t=t.elements,i=i.elements;i[0]=n*t[0]+a*t[4]+s*t[8]+e*t[12],i[1]=n*t[1]+a*t[5]+s*t[9]+e*t[13],i[2]=n*t[2]+a*t[6]+s*t[10]+e*t[14],i[3]=n*t[3]+a*t[7]+s*t[11]+e*t[15]}},{key:"equals",value:function(e,t){e=e.elements,t=t.elements;return wa.nearEqual(Math.abs(e[0]),Math.abs(t[0]))&&wa.nearEqual(Math.abs(e[1]),Math.abs(t[1]))&&wa.nearEqual(Math.abs(e[2]),Math.abs(t[2]))&&wa.nearEqual(Math.abs(e[3]),Math.abs(t[3]))}},{key:"normalize",value:function(e,t){var i=e.elements,t=t.elements,e=e.length();0<e&&(t[0]=i[0]*e,t[1]=i[1]*e,t[2]=i[2]*e,t[3]=i[3]*e)}},{key:"add",value:function(e,t,i){i=i.elements,e=e.elements,t=t.elements;i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i[3]=e[3]+t[3]}},{key:"subtract",value:function(e,t,i){i=i.elements,e=e.elements,t=t.elements;i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],i[3]=e[3]-t[3]}},{key:"multiply",value:function(e,t,i){i=i.elements,e=e.elements,t=t.elements;i[0]=e[0]*t[0],i[1]=e[1]*t[1],i[2]=e[2]*t[2],i[3]=e[3]*t[3]}},{key:"scale",value:function(e,t,i){i=i.elements,e=e.elements;i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i[3]=e[3]*t}},{key:"Clamp",value:function(e,t,i,n){var e=e.elements,a=e[0],s=e[1],r=e[2],e=e[3],t=t.elements,o=t[0],h=t[1],l=t[2],t=t[3],i=i.elements,u=i[0],c=i[1],_=i[2],i=i[3],n=n.elements,a=u<a?u:a,s=(s=c<s?c:s)<h?h:s,r=(r=_<r?_:r)<l?l:r,e=(e=i<e?i:e)<t?t:e;n[0]=a=a<o?o:a,n[1]=s,n[2]=r,n[3]=e}},{key:"distanceSquared",value:function(e,t){var e=e.elements,t=t.elements,i=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2],e=e[3]-t[3];return i*i+n*n+a*a+e*e}},{key:"distance",value:function(e,t){var e=e.elements,t=t.elements,i=e[0]-t[0],n=e[1]-t[1],a=e[2]-t[2],e=e[3]-t[3];return Math.sqrt(i*i+n*n+a*a+e*e)}},{key:"dot",value:function(e,t){e=e.elements,t=t.elements;return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}},{key:"min",value:function(e,t,i){i=i.elements,e=e.elements,t=t.elements;i[0]=Math.min(e[0],t[0]),i[1]=Math.min(e[1],t[1]),i[2]=Math.min(e[2],t[2]),i[3]=Math.min(e[3],t[3])}},{key:"max",value:function(e,t,i){i=i.elements,e=e.elements,t=t.elements;i[0]=Math.max(e[0],t[0]),i[1]=Math.max(e[1],t[1]),i[2]=Math.max(e[2],t[2]),i[3]=Math.max(e[3],t[3])}}]),s}()),Na=(e.ZERO=new e,e.ONE=new e(1,1,1,1),e.UnitX=new e(1,0,0,0),e.UnitY=new e(0,1,0,0),e.UnitZ=new e(0,0,1,0),e.UnitW=new e(0,0,0,1),function(){function a(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;b(this,a),n=n||new Float32Array(3),(this.elements=n)[0]=e,n[1]=t,n[2]=i}return y(a,[{key:"x",get:function(){return this.elements[0]},set:function(e){this.elements[0]=e}},{key:"y",get:function(){return this.elements[1]},set:function(e){this.elements[1]=e}},{key:"z",get:function(){return this.elements[2]},set:function(e){this.elements[2]=e}},{key:"setValue",value:function(e,t,i){this.elements[0]=e,this.elements[1]=t,this.elements[2]=i}},{key:"fromArray",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this.elements[0]=e[t+0],this.elements[1]=e[t+1],this.elements[2]=e[t+2]}},{key:"cloneTo",value:function(e){var e=e.elements,t=this.elements;e[0]=t[0],e[1]=t[1],e[2]=t[2]}},{key:"clone",value:function(){var e=new a;return this.cloneTo(e),e}},{key:"toDefault",value:function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0}}],[{key:"distanceSquared",value:function(e,t){var e=e.elements,t=t.elements,i=e[0]-t[0],n=e[1]-t[1],e=e[2]-t[2];return i*i+n*n+e*e}},{key:"distance",value:function(e,t){var e=e.elements,t=t.elements,i=e[0]-t[0],n=e[1]-t[1],e=e[2]-t[2];return Math.sqrt(i*i+n*n+e*e)}},{key:"min",value:function(e,t,i){i=i.elements,e=e.elements,t=t.elements;i[0]=Math.min(e[0],t[0]),i[1]=Math.min(e[1],t[1]),i[2]=Math.min(e[2],t[2])}},{key:"max",value:function(e,t,i){i=i.elements,e=e.elements,t=t.elements;i[0]=Math.max(e[0],t[0]),i[1]=Math.max(e[1],t[1]),i[2]=Math.max(e[2],t[2])}},{key:"transformQuat",value:function(e,t,i){var i=i.elements,e=e.elements,t=t.elements,n=e[0],a=e[1],e=e[2],s=t[0],r=t[1],o=t[2],t=t[3],h=t*n+r*e-o*a,l=t*a+o*n-s*e,u=t*e+s*a-r*n,n=-s*n-r*a-o*e;i[0]=h*t+n*-s+l*-o-u*-r,i[1]=l*t+n*-r+u*-s-h*-o,i[2]=u*t+n*-o+h*-r-l*-s}},{key:"scalarLength",value:function(e){var e=e.elements,t=e[0],i=e[1],e=e[2];return Math.sqrt(t*t+i*i+e*e)}},{key:"scalarLengthSquared",value:function(e){var e=e.elements,t=e[0],i=e[1],e=e[2];return t*t+i*i+e*e}},{key:"normalize",value:function(e,t){var e=e.elements,t=t.elements,i=e[0],n=e[1],a=e[2],i=i*i+n*n+a*a;0<i&&(i=1/Math.sqrt(i),t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i)}},{key:"multiply",value:function(e,t,i){i=i.elements,e=e.elements,t=t.elements;i[0]=e[0]*t[0],i[1]=e[1]*t[1],i[2]=e[2]*t[2]}},{key:"scale",value:function(e,t,i){i=i.elements,e=e.elements;i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t}},{key:"lerp",value:function(e,t,i,n){var n=n.elements,e=e.elements,t=t.elements,a=e[0],s=e[1],e=e[2];n[0]=a+i*(t[0]-a),n[1]=s+i*(t[1]-s),n[2]=e+i*(t[2]-e)}},{key:"transformV3ToV3",value:function(e,t,i){var n=a._tempVector4,e=(a.transformV3ToV4(e,t,n),n.elements),t=i.elements;t[0]=e[0],t[1]=e[1],t[2]=e[2]}},{key:"transformV3ToV4",value:function(e,t,i){var e=e.elements,n=e[0],a=e[1],e=e[2],t=t.elements,i=i.elements;i[0]=n*t[0]+a*t[4]+e*t[8]+t[12],i[1]=n*t[1]+a*t[5]+e*t[9]+t[13],i[2]=n*t[2]+a*t[6]+e*t[10]+t[14],i[3]=n*t[3]+a*t[7]+e*t[11]+t[15]}},{key:"TransformNormal",value:function(e,t,i){var e=e.elements,n=e[0],a=e[1],e=e[2],t=t.elements,i=i.elements;i[0]=n*t[0]+a*t[4]+e*t[8],i[1]=n*t[1]+a*t[5]+e*t[9],i[2]=n*t[2]+a*t[6]+e*t[10]}},{key:"transformCoordinate",value:function(e,t,i){var e=e.elements,n=e[0],a=e[1],e=e[2],t=t.elements,s=n*t[3]+a*t[7]+e*t[11]+t[15],i=i.elements;i[0]=n*t[0]+a*t[4]+e*t[8]+t[12]/s,i[1]=n*t[1]+a*t[5]+e*t[9]+t[13]/s,i[2]=n*t[2]+a*t[6]+e*t[10]+t[14]/s}},{key:"Clamp",value:function(e,t,i,n){var e=e.elements,a=e[0],s=e[1],e=e[2],t=t.elements,r=t[0],o=t[1],t=t[2],i=i.elements,h=i[0],l=i[1],i=i[2],n=n.elements,a=h<a?h:a,s=(s=l<s?l:s)<o?o:s,e=(e=i<e?i:e)<t?t:e;n[0]=a=a<r?r:a,n[1]=s,n[2]=e}},{key:"add",value:function(e,t,i){i=i.elements,e=e.elements,t=t.elements;i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2]}},{key:"subtract",value:function(e,t,i){i=i.elements,e=e.elements,t=t.elements;i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2]}},{key:"cross",value:function(e,t,i){var e=e.elements,t=t.elements,i=i.elements,n=e[0],a=e[1],e=e[2],s=t[0],r=t[1],t=t[2];i[0]=a*t-e*r,i[1]=e*s-n*t,i[2]=n*r-a*s}},{key:"dot",value:function(e,t){e=e.elements,t=t.elements;return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}},{key:"equals",value:function(e,t){e=e.elements,t=t.elements;return wa.nearEqual(e[0],t[0])&&wa.nearEqual(e[1],t[1])&&wa.nearEqual(e[2],t[2])}}]),a}()),Pa=(Na._tempVector4=new e,Na.ZERO=new Na(0,0,0),Na.ONE=new Na(1,1,1),Na.NegativeUnitX=new Na(-1,0,0),Na.UnitX=new Na(1,0,0),Na.UnitY=new Na(0,1,0),Na.UnitZ=new Na(0,0,1),Na.ForwardRH=new Na(0,0,-1),Na.ForwardLH=new Na(0,0,1),Na.Up=new Na(0,1,0),Na.NAN=new Na(NaN,NaN,NaN),function(){function g(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:1,r=6<arguments.length&&void 0!==arguments[6]?arguments[6]:0,o=7<arguments.length&&void 0!==arguments[7]?arguments[7]:0,h=8<arguments.length&&void 0!==arguments[8]?arguments[8]:0,l=9<arguments.length&&void 0!==arguments[9]?arguments[9]:0,u=10<arguments.length&&void 0!==arguments[10]?arguments[10]:1,c=11<arguments.length&&void 0!==arguments[11]?arguments[11]:0,_=12<arguments.length&&void 0!==arguments[12]?arguments[12]:0,f=13<arguments.length&&void 0!==arguments[13]?arguments[13]:0,d=14<arguments.length&&void 0!==arguments[14]?arguments[14]:0,p=15<arguments.length&&void 0!==arguments[15]?arguments[15]:1,y=16<arguments.length&&void 0!==arguments[16]?arguments[16]:null,y=(b(this,g),this.elements=y||new Float32Array(16));y[0]=e,y[1]=t,y[2]=i,y[3]=n,y[4]=a,y[5]=s,y[6]=r,y[7]=o,y[8]=h,y[9]=l,y[10]=u,y[11]=c,y[12]=_,y[13]=f,y[14]=d,y[15]=p}return y(g,[{key:"setRotation",value:function(e){var t=e.x,i=e.y,n=e.z,e=e.w,a=t*t,s=i*i,r=n*n,o=t*i,h=n*e,l=n*t,u=i*e,i=i*n,n=t*e,t=this.elements;t[0]=1-2*(s+r),t[1]=2*(o+h),t[2]=2*(l-u),t[4]=2*(o-h),t[5]=1-2*(r+a),t[6]=2*(i+n),t[8]=2*(l+u),t[9]=2*(i-n),t[10]=1-2*(s+a)}},{key:"setPosition",value:function(e){var t=this.elements;t[12]=e.x,t[13]=e.y,t[14]=e.z}},{key:"getElementByRowColumn",value:function(e,t){if(e<0||3<e)throw new Error("row Rows and columns for matrices run from 0 to 3, inclusive.");if(t<0||3<t)throw new Error("column Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*e+t]}},{key:"setElementByRowColumn",value:function(e,t,i){if(e<0||3<e)throw new Error("row Rows and columns for matrices run from 0 to 3, inclusive.");if(t<0||3<t)throw new Error("column Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*e+t]=i}},{key:"equalsOtherMatrix",value:function(e){var t=this.elements,e=e.elements;return wa.nearEqual(t[0],e[0])&&wa.nearEqual(t[1],e[1])&&wa.nearEqual(t[2],e[2])&&wa.nearEqual(t[3],e[3])&&wa.nearEqual(t[4],e[4])&&wa.nearEqual(t[5],e[5])&&wa.nearEqual(t[6],e[6])&&wa.nearEqual(t[7],e[7])&&wa.nearEqual(t[8],e[8])&&wa.nearEqual(t[9],e[9])&&wa.nearEqual(t[10],e[10])&&wa.nearEqual(t[11],e[11])&&wa.nearEqual(t[12],e[12])&&wa.nearEqual(t[13],e[13])&&wa.nearEqual(t[14],e[14])&&wa.nearEqual(t[15],e[15])}},{key:"decomposeTransRotScale",value:function(e,t,i){var n=g._tempMatrix4x4;return this.decomposeTransRotMatScale(e,n,i)?(Ca.createFromMatrix4x4(n,t),!0):(t.identity(),!1)}},{key:"decomposeTransRotMatScale",value:function(e,t,i){var n=this.elements,t=t.elements,e=(e.x=n[12],e.y=n[13],e.z=n[14],n[0]),a=n[1],s=n[2],r=n[4],o=n[5],h=n[6],l=n[8],u=n[9],n=n[10],c=i.x=Math.sqrt(e*e+a*a+s*s),_=i.y=Math.sqrt(r*r+o*o+h*h),f=i.z=Math.sqrt(l*l+u*u+n*n);if(wa.isZero(c)||wa.isZero(_)||wa.isZero(f))return t[1]=t[2]=t[3]=t[4]=t[6]=t[7]=t[8]=t[9]=t[11]=t[12]=t[13]=t[14]=0,!(t[0]=t[5]=t[10]=t[15]=1);var d=g._tempVector0,p=(d.x=l/f,d.y=u/f,d.z=n/f,g._tempVector1),y=(p.x=e/c,p.y=a/c,p.z=s/c,g._tempVector2),p=(R.cross(d,p,y),g._tempVector1);return R.cross(y,d,p),t[3]=t[7]=t[11]=t[12]=t[13]=t[14]=0,t[15]=1,t[0]=p.x,t[1]=p.y,t[2]=p.z,t[4]=y.x,t[5]=y.y,t[6]=y.z,t[8]=d.x,t[9]=d.y,t[10]=d.z,t[0]*e+t[1]*a+t[2]*s<0&&(i.x=-c),t[4]*r+t[5]*o+t[6]*h<0&&(i.y=-_),t[8]*l+t[9]*u+t[10]*n<0&&(i.z=-f),!0}},{key:"decomposeYawPitchRoll",value:function(e){var t=Math.asin(-this.elements[9]);e.y=t,Math.cos(t)>wa.zeroTolerance?(e.z=Math.atan2(this.elements[1],this.elements[5]),e.x=Math.atan2(this.elements[8],this.elements[10])):(e.z=Math.atan2(-this.elements[4],this.elements[0]),e.x=0)}},{key:"normalize",value:function(){var e=this.elements,t=e[0],i=e[1],n=e[2],a=Math.sqrt(t*t+i*i+n*n);if(!a)return e[0]=0,e[1]=0,void(e[2]=0);1!=a&&(e[0]=t*(a=1/a),e[1]=i*a,e[2]=n*a)}},{key:"transpose",value:function(){var e=this.elements,t=e[1];return e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}},{key:"invert",value:function(e){var t=this.elements,e=e.elements,i=t[0],n=t[1],a=t[2],s=t[3],r=t[4],o=t[5],h=t[6],l=t[7],u=t[8],c=t[9],_=t[10],f=t[11],d=t[12],p=t[13],y=t[14],t=t[15],g=i*o-n*r,m=i*h-a*r,v=i*l-s*r,x=n*h-a*o,k=n*l-s*o,w=a*l-s*h,b=u*p-c*d,S=u*y-_*d,I=u*t-f*d,T=c*y-_*p,C=c*t-f*p,M=_*t-f*y,E=g*M-m*C+v*T+x*I-k*S+w*b;0!==Math.abs(E)&&(e[0]=(o*M-h*C+l*T)*(E=1/E),e[1]=(a*C-n*M-s*T)*E,e[2]=(p*w-y*k+t*x)*E,e[3]=(_*k-c*w-f*x)*E,e[4]=(h*I-r*M-l*S)*E,e[5]=(i*M-a*I+s*S)*E,e[6]=(y*v-d*w-t*m)*E,e[7]=(u*w-_*v+f*m)*E,e[8]=(r*C-o*I+l*b)*E,e[9]=(n*I-i*C-s*b)*E,e[10]=(d*k-p*v+t*g)*E,e[11]=(c*v-u*k-f*g)*E,e[12]=(o*S-r*T-h*b)*E,e[13]=(i*T-n*S+a*b)*E,e[14]=(p*m-d*x-y*g)*E,e[15]=(u*x-c*m+_*g)*E)}},{key:"identity",value:function(){var e=this.elements;e[1]=e[2]=e[3]=e[4]=e[6]=e[7]=e[8]=e[9]=e[11]=e[12]=e[13]=e[14]=0,e[0]=e[5]=e[10]=e[15]=1}},{key:"cloneTo",value:function(e){var t,i=this.elements,n=e.elements;if(i!==n)for(t=0;t<16;++t)n[t]=i[t]}},{key:"clone",value:function(){var e=new g;return this.cloneTo(e),e}},{key:"getTranslationVector",value:function(e){var t=this.elements;e.x=t[12],e.y=t[13],e.z=t[14]}},{key:"setTranslationVector",value:function(e){var t=this.elements;t[12]=e.x,t[13]=e.y,t[14]=e.z}},{key:"getForward",value:function(e){var t=this.elements;e.x=-t[8],e.y=-t[9],e.z=-t[10]}},{key:"setForward",value:function(e){var t=this.elements;t[8]=-e.x,t[9]=-e.y,t[10]=-e.z}}],[{key:"createRotationX",value:function(e,t){var t=t.elements,i=Math.sin(e),e=Math.cos(e);t[1]=t[2]=t[3]=t[4]=t[7]=t[8]=t[11]=t[12]=t[13]=t[14]=0,t[0]=t[15]=1,t[5]=t[10]=e,t[6]=i,t[9]=-i}},{key:"createRotationY",value:function(e,t){var t=t.elements,i=Math.sin(e),e=Math.cos(e);t[1]=t[3]=t[4]=t[6]=t[7]=t[9]=t[11]=t[12]=t[13]=t[14]=0,t[5]=t[15]=1,t[0]=t[10]=e,t[2]=-i,t[8]=i}},{key:"createRotationZ",value:function(e,t){var t=t.elements,i=Math.sin(e),e=Math.cos(e);t[2]=t[3]=t[6]=t[7]=t[8]=t[9]=t[11]=t[12]=t[13]=t[14]=0,t[10]=t[15]=1,t[0]=t[5]=e,t[1]=i,t[4]=-i}},{key:"createRotationYawPitchRoll",value:function(e,t,i,n){Ca.createFromYawPitchRoll(e,t,i,g._tempQuaternion),g.createRotationQuaternion(g._tempQuaternion,n)}},{key:"createRotationAxis",value:function(e,t,i){var n=e.x,a=e.y,e=e.z,s=Math.cos(t),t=Math.sin(t),r=n*n,o=a*a,h=e*e,l=n*a,u=n*e,c=a*e,i=i.elements;i[3]=i[7]=i[11]=i[12]=i[13]=i[14]=0,i[15]=1,i[0]=r+s*(1-r),i[1]=l-s*l+t*e,i[2]=u-s*u-t*a,i[4]=l-s*l-t*e,i[5]=o+s*(1-o),i[6]=c-s*c+t*n,i[8]=u-s*u+t*a,i[9]=c-s*c-t*n,i[10]=h+s*(1-h)}},{key:"createRotationQuaternion",value:function(e,t){var t=t.elements,i=e.x,n=e.y,a=e.z,e=e.w,s=i*i,r=n*n,o=a*a,h=i*n,l=a*e,u=a*i,c=n*e,n=n*a,a=i*e;t[3]=t[7]=t[11]=t[12]=t[13]=t[14]=0,t[15]=1,t[0]=1-2*(r+o),t[1]=2*(h+l),t[2]=2*(u-c),t[4]=2*(h-l),t[5]=1-2*(o+s),t[6]=2*(n+a),t[8]=2*(u+c),t[9]=2*(n-a),t[10]=1-2*(r+s)}},{key:"createTranslate",value:function(e,t){t=t.elements;t[4]=t[8]=t[1]=t[9]=t[2]=t[6]=t[3]=t[7]=t[11]=0,t[0]=t[5]=t[10]=t[15]=1,t[12]=e.x,t[13]=e.y,t[14]=e.z}},{key:"createScaling",value:function(e,t){t=t.elements;t[0]=e.x,t[5]=e.y,t[10]=e.z,t[1]=t[4]=t[8]=t[12]=t[9]=t[13]=t[2]=t[6]=t[14]=t[3]=t[7]=t[11]=0,t[15]=1}},{key:"multiply",value:function(e,t,i){var t=t.elements,e=e.elements,i=i.elements,n=t[0],a=t[1],s=t[2],r=t[3],o=t[4],h=t[5],l=t[6],u=t[7],c=t[8],_=t[9],f=t[10],d=t[11],p=t[12],y=t[13],g=t[14],t=t[15],m=e[0],v=e[1],x=e[2],k=e[3],w=e[4],b=e[5],S=e[6],I=e[7],T=e[8],C=e[9],M=e[10],E=e[11],R=e[12],A=e[13],L=e[14],e=e[15];i[0]=n*m+a*w+s*T+r*R,i[1]=n*v+a*b+s*C+r*A,i[2]=n*x+a*S+s*M+r*L,i[3]=n*k+a*I+s*E+r*e,i[4]=o*m+h*w+l*T+u*R,i[5]=o*v+h*b+l*C+u*A,i[6]=o*x+h*S+l*M+u*L,i[7]=o*k+h*I+l*E+u*e,i[8]=c*m+_*w+f*T+d*R,i[9]=c*v+_*b+f*C+d*A,i[10]=c*x+_*S+f*M+d*L,i[11]=c*k+_*I+f*E+d*e,i[12]=p*m+y*w+g*T+t*R,i[13]=p*v+y*b+g*C+t*A,i[14]=p*x+y*S+g*M+t*L,i[15]=p*k+y*I+g*E+t*e}},{key:"multiplyForNative",value:function(e,t,i){S.instance.matrix4x4Multiply(e.elements,t.elements,i.elements)}},{key:"createFromQuaternion",value:function(e,t){var t=t.elements,i=e.x,n=e.y,a=e.z,e=e.w,s=i+i,r=n+n,o=a+a,i=i*s,h=n*s,n=n*r,l=a*s,u=a*r,a=a*o,s=e*s,r=e*r,e=e*o;t[0]=1-n-a,t[1]=h+e,t[2]=l-r,t[3]=0,t[4]=h-e,t[5]=1-i-a,t[6]=u+s,t[7]=0,t[8]=l+r,t[9]=u-s,t[10]=1-i-n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}},{key:"createAffineTransformation",value:function(e,t,i,n){var n=n.elements,a=t.x,s=t.y,r=t.z,t=t.w,o=a+a,h=s+s,l=r+r,u=a*o,c=a*h,a=a*l,_=s*h,s=s*l,r=r*l,o=t*o,h=t*h,t=t*l,l=i.x,f=i.y,i=i.z;n[0]=(1-(_+r))*l,n[1]=(c+t)*l,n[2]=(a-h)*l,n[3]=0,n[4]=(c-t)*f,n[5]=(1-(u+r))*f,n[6]=(s+o)*f,n[7]=0,n[8]=(a+h)*i,n[9]=(s-o)*i,n[10]=(1-(u+_))*i,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1}},{key:"createLookAt",value:function(e,t,i,n){var a=n.elements,s=g._tempVector0,r=g._tempVector1,o=g._tempVector2;R.subtract(e,t,o),R.normalize(o,o),R.cross(i,o,s),R.normalize(s,s),R.cross(o,s,r),n.identity(),a[0]=s.x,a[4]=s.y,a[8]=s.z,a[1]=r.x,a[5]=r.y,a[9]=r.z,a[2]=o.x,a[6]=o.y,a[10]=o.z,a[12]=-R.dot(s,e),a[13]=-R.dot(r,e),a[14]=-R.dot(o,e)}},{key:"createPerspective",value:function(e,t,i,n,a){e=1/Math.tan(.5*e),t=i/(e/t),e=i/e;g.createPerspectiveOffCenter(-t,t,-e,e,i,n,a)}},{key:"createPerspectiveOffCenter",value:function(e,t,i,n,a,s,r){r=r.elements,s/=s-a;r[1]=r[2]=r[3]=r[4]=r[6]=r[7]=r[12]=r[13]=r[15]=0,r[0]=2*a/(t-e),r[5]=2*a/(n-i),r[8]=(e+t)/(t-e),r[9]=(n+i)/(n-i),r[10]=-s,r[11]=-1,r[14]=-a*s}},{key:"createOrthoOffCenter",value:function(e,t,i,n,a,s,r){r=r.elements,s=1/(s-a);r[1]=r[2]=r[3]=r[4]=r[6]=r[8]=r[7]=r[9]=r[11]=0,r[15]=1,r[0]=2/(t-e),r[5]=2/(n-i),r[10]=-s,r[12]=(e+t)/(e-t),r[13]=(n+i)/(i-n),r[14]=-a*s}},{key:"billboard",value:function(e,t,i,n,a,s){R.subtract(e,t,g._tempVector0);t=R.scalarLengthSquared(g._tempVector0),wa.isZero(t)?(R.scale(a,-1,g._tempVector1),g._tempVector1.cloneTo(g._tempVector0)):R.scale(g._tempVector0,1/Math.sqrt(t),g._tempVector0),R.cross(n,g._tempVector0,g._tempVector2),R.normalize(g._tempVector2,g._tempVector2),R.cross(g._tempVector0,g._tempVector2,g._tempVector3),a=g._tempVector2,t=g._tempVector3,n=g._tempVector0,s=s.elements;s[0]=a.x,s[1]=a.y,s[2]=a.z,s[3]=0,s[4]=t.x,s[5]=t.y,s[6]=t.z,s[7]=0,s[8]=n.x,s[9]=n.y,s[10]=n.z,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1}},{key:"translation",value:function(e,t){t=t.elements;t[0]=t[5]=t[10]=t[15]=1,t[12]=e.x,t[13]=e.y,t[14]=e.z}}]),g}()),Ba=(Pa._tempMatrix4x4=new Pa,Pa.TEMPMatrix0=new Pa,Pa.TEMPMatrix1=new Pa,Pa._tempVector0=new R,Pa._tempVector1=new R,Pa._tempVector2=new R,Pa._tempVector3=new R,Pa._tempQuaternion=new Ca,Pa.DEFAULT=new Pa,Pa.ZERO=new Pa(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0),function(){function s(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null;b(this,s),(a=a||new Float32Array(4))[0]=e,a[1]=t,a[2]=i,a[3]=n,this.elements=a}return y(s,[{key:"x",get:function(){return this.elements[0]},set:function(e){this.elements[0]=e}},{key:"y",get:function(){return this.elements[1]},set:function(e){this.elements[1]=e}},{key:"z",get:function(){return this.elements[2]},set:function(e){this.elements[2]=e}},{key:"w",get:function(){return this.elements[3]},set:function(e){this.elements[3]=e}},{key:"scaling",value:function(e,t){var t=t.elements,i=this.elements;t[0]=i[0]*e,t[1]=i[1]*e,t[2]=i[2]*e,t[3]=i[3]*e}},{key:"normalize",value:function(e){s._normalizeArray(this.elements,e.elements)}},{key:"length",value:function(){var e=this.elements,t=e[0],i=e[1],n=e[2],e=e[3];return Math.sqrt(t*t+i*i+n*n+e*e)}},{key:"rotateX",value:function(e,t){var t=t.elements,i=this.elements,n=(e*=.5,i[0]),a=i[1],s=i[2],i=i[3],r=Math.sin(e),e=Math.cos(e);t[0]=n*e+i*r,t[1]=a*e+s*r,t[2]=s*e-a*r,t[3]=i*e-n*r}},{key:"rotateY",value:function(e,t){var t=t.elements,i=this.elements,n=(e*=.5,i[0]),a=i[1],s=i[2],i=i[3],r=Math.sin(e),e=Math.cos(e);t[0]=n*e-s*r,t[1]=a*e+i*r,t[2]=s*e+n*r,t[3]=i*e-a*r}},{key:"rotateZ",value:function(e,t){var t=t.elements,i=this.elements,n=(e*=.5,i[0]),a=i[1],s=i[2],i=i[3],r=Math.sin(e),e=Math.cos(e);t[0]=n*e+a*r,t[1]=a*e-n*r,t[2]=s*e+i*r,t[3]=i*e-s*r}},{key:"getYawPitchRoll",value:function(e){Na.transformQuat(Na.ForwardRH,this,s.TEMPVector31),Na.transformQuat(Na.Up,this,s.TEMPVector32);var t=s.TEMPVector32.elements,i=(s.angleTo(Na.ZERO,s.TEMPVector31,s.TEMPVector33),s.TEMPVector33.elements),t=(i[0]==Math.PI/2?(i[1]=s.arcTanAngle(t[2],t[0]),i[2]=0):i[0]==-Math.PI/2?(i[1]=s.arcTanAngle(-t[2],-t[0]),i[2]=0):(Pa.createRotationY(-i[1],s.TEMPMatrix0),Pa.createRotationX(-i[0],s.TEMPMatrix1),Na.transformCoordinate(s.TEMPVector32,s.TEMPMatrix0,s.TEMPVector32),Na.transformCoordinate(s.TEMPVector32,s.TEMPMatrix1,s.TEMPVector32),i[2]=s.arcTanAngle(t[1],-t[0])),i[1]<=-Math.PI&&(i[1]=Math.PI),i[2]<=-Math.PI&&(i[2]=Math.PI),i[1]>=Math.PI&&i[2]>=Math.PI&&(i[1]=0,i[2]=0,i[0]=Math.PI-i[0]),e.elements);t[0]=i[1],t[1]=i[0],t[2]=i[2]}},{key:"invert",value:function(e){var e=e.elements,t=this.elements,i=t[0],n=t[1],a=t[2],t=t[3],s=i*i+n*n+a*a+t*t,s=s?1/s:0;e[0]=-i*s,e[1]=-n*s,e[2]=-a*s,e[3]=t*s}},{key:"identity",value:function(){var e=this.elements;e[0]=0,e[1]=0,e[2]=0,e[3]=1}},{key:"fromArray",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;this.elements[0]=e[t+0],this.elements[1]=e[t+1],this.elements[2]=e[t+2],this.elements[3]=e[t+3]}},{key:"cloneTo",value:function(e){var t,i=this.elements,n=e.elements;if(i!==n)for(t=0;t<4;++t)n[t]=i[t]}},{key:"clone",value:function(){var e=new s;return this.cloneTo(e),e}},{key:"equals",value:function(e){var t=this.elements,e=e.elements;return wa.nearEqual(t[0],e[0])&&wa.nearEqual(t[1],e[1])&&wa.nearEqual(t[2],e[2])&&wa.nearEqual(t[3],e[3])}},{key:"lengthSquared",value:function(){var e=this.elements[0],t=this.elements[1],i=this.elements[2],n=this.elements[3];return e*e+t*t+i*i+n*n}}],[{key:"_dotArray",value:function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}},{key:"_normalizeArray",value:function(e,t){var i=e[0],n=e[1],a=e[2],e=e[3],s=i*i+n*n+a*a+e*e;0<s&&(s=1/Math.sqrt(s),t[0]=i*s,t[1]=n*s,t[2]=a*s,t[3]=e*s)}},{key:"_lerpArray",value:function(e,t,i,n){var a=1-i;0<=s._dotArray(e,t)?(n[0]=a*e[0]+i*t[0],n[1]=a*e[1]+i*t[1],n[2]=a*e[2]+i*t[2],n[3]=a*e[3]+i*t[3]):(n[0]=a*e[0]-i*t[0],n[1]=a*e[1]-i*t[1],n[2]=a*e[2]-i*t[2],n[3]=a*e[3]-i*t[3]),s._normalizeArray(n,n)}},{key:"createFromYawPitchRoll",value:function(e,t,i,n){var i=.5*i,t=.5*t,e=.5*e,a=Math.sin(i),i=Math.cos(i),s=Math.sin(t),t=Math.cos(t),r=Math.sin(e),e=Math.cos(e),n=n.elements;n[0]=e*s*i+r*t*a,n[1]=r*t*i-e*s*a,n[2]=e*t*a-r*s*i,n[3]=e*t*i+r*s*a}},{key:"multiply",value:function(e,t,i){var e=e.elements,t=t.elements,i=i.elements,n=e[0],a=e[1],s=e[2],e=e[3],r=t[0],o=t[1],h=t[2],t=t[3],l=s*r-n*h,u=n*o-a*r,c=n*r+a*o+s*h;i[0]=n*t+r*e+(a*h-s*o),i[1]=a*t+o*e+l,i[2]=s*t+h*e+u,i[3]=e*t-c}},{key:"arcTanAngle",value:function(e,t){return 0==e?1==t?Math.PI/2:-Math.PI/2:0<e?Math.atan(t/e):e<0?0<t?Math.atan(t/e)+Math.PI:Math.atan(t/e)-Math.PI:0}},{key:"angleTo",value:function(e,t,i){Na.subtract(t,e,s.TEMPVector30),Na.normalize(s.TEMPVector30,s.TEMPVector30),i.elements[0]=Math.asin(s.TEMPVector30.y),i.elements[1]=s.arcTanAngle(-s.TEMPVector30.z,-s.TEMPVector30.x)}},{key:"createFromAxisAngle",value:function(e,t,i){var i=i.elements,e=e.elements,n=(t*=.5,Math.sin(t));i[0]=n*e[0],i[1]=n*e[1],i[2]=n*e[2],i[3]=Math.cos(t)}},{key:"createFromMatrix3x3",value:function(e,t){var i,n,a,t=t.elements,e=e.elements,s=e[0]+e[4]+e[8];0<s?(a=Math.sqrt(s+1),t[3]=.5*a,t[0]=(e[5]-e[7])*(a=.5/a),t[1]=(e[6]-e[2])*a,t[2]=(e[1]-e[3])*a):(e[4]>e[s=0]&&(s=1),i=((s=e[8]>e[3*s+s]?2:s)+1)%3,n=(s+2)%3,a=Math.sqrt(e[3*s+s]-e[3*i+i]-e[3*n+n]+1),t[s]=.5*a,t[3]=(e[3*i+n]-e[3*n+i])*(a=.5/a),t[i]=(e[3*i+s]+e[3*s+i])*a,t[n]=(e[3*n+s]+e[3*s+n])*a)}},{key:"createFromMatrix4x4",value:function(e,t){var i,n,e=e.elements,t=t.elements,a=e[0]+e[5]+e[10];0<a?(i=Math.sqrt(a+1),t[3]=.5*i,t[0]=(e[6]-e[9])*(i=.5/i),t[1]=(e[8]-e[2])*i,t[2]=(e[1]-e[4])*i):e[0]>=e[5]&&e[0]>=e[10]?(n=.5/(i=Math.sqrt(1+e[0]-e[5]-e[10])),t[0]=.5*i,t[1]=(e[1]+e[4])*n,t[2]=(e[2]+e[8])*n,t[3]=(e[6]-e[9])*n):e[5]>e[10]?(i=Math.sqrt(1+e[5]-e[0]-e[10]),t[0]=(e[4]+e[1])*(n=.5/i),t[1]=.5*i,t[2]=(e[9]+e[6])*n,t[3]=(e[8]-e[2])*n):(i=Math.sqrt(1+e[10]-e[0]-e[5]),t[0]=(e[8]+e[2])*(n=.5/i),t[1]=(e[9]+e[6])*n,t[2]=.5*i,t[3]=(e[1]-e[4])*n)}},{key:"slerp",value:function(e,t,i,n){var a,s,e=e.elements,t=t.elements,n=n.elements,r=e[0],o=e[1],h=e[2],e=e[3],l=t[0],u=t[1],c=t[2],t=t[3],_=r*l+o*u+h*c+e*t;return _<0&&(_=-_,l=-l,u=-u,c=-c,t=-t),_=1e-6<1-_?(_=Math.acos(_),a=Math.sin(_),s=Math.sin((1-i)*_)/a,Math.sin(i*_)/a):(s=1-i,i),n[0]=s*r+_*l,n[1]=s*o+_*u,n[2]=s*h+_*c,n[3]=s*e+_*t,n}},{key:"lerp",value:function(e,t,i,n){s._lerpArray(e.elements,t.elements,i,n.elements)}},{key:"add",value:function(e,t,i){i=i.elements,e=e.elements,t=t.elements;i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i[3]=e[3]+t[3]}},{key:"dot",value:function(e,t){return s._dotArray(e.elements,t.elements)}},{key:"rotationLookAt",value:function(e,t,i){s.lookAt(Na.ZERO,e,t,i)}},{key:"lookAt",value:function(e,t,i,n){Ia.lookAt(e,t,i,s._tempMatrix3x3),s.rotationMatrix(s._tempMatrix3x3,n)}},{key:"invert",value:function(e,t){var i=e.elements,t=t.elements,e=e.lengthSquared();wa.isZero(e)||(t[0]=-i[0]*(e=1/e),t[1]=-i[1]*e,t[2]=-i[2]*e,t[3]=i[3]*e)}},{key:"rotationMatrix",value:function(e,t){var i,n,e=e.elements,a=e[0],s=e[1],r=e[2],o=e[3],h=e[4],l=e[5],u=e[6],c=e[7],e=e[8],t=t.elements,_=a+h+e;0<_?(i=Math.sqrt(_+1),t[3]=.5*i,t[0]=(l-c)*(i=.5/i),t[1]=(u-r)*i,t[2]=(s-o)*i):h<=a&&e<=a?(n=.5/(i=Math.sqrt(1+a-h-e)),t[0]=.5*i,t[1]=(s+o)*n,t[2]=(r+u)*n,t[3]=(l-c)*n):e<h?(i=Math.sqrt(1+h-a-e),t[0]=(o+s)*(n=.5/i),t[1]=.5*i,t[2]=(c+l)*n,t[3]=(u-r)*n):(i=Math.sqrt(1+e-a-h),t[0]=(u+r)*(n=.5/i),t[1]=(c+l)*n,t[2]=.5*i,t[3]=(s-o)*n)}}]),s}()),Da=(Ba.TEMPVector30=new Na,Ba.TEMPVector31=new Na,Ba.TEMPVector32=new Na,Ba.TEMPVector33=new Na,Ba.TEMPMatrix0=new Pa,Ba.TEMPMatrix1=new Pa,Ba._tempMatrix3x3=new Ia,Ba.DEFAULT=new Ba,Ba.NAN=new Ba(NaN,NaN,NaN,NaN),function(){function t(){b(this,t),this._referenceCount=0,this._clip=null,this._nodeOwners=[],this._currentFrameIndices=null,this._realtimeDatas=[],this._scripts=null,this.speed=1,this.clipStart=0,this.clipEnd=1}return y(t,[{key:"clip",get:function(){return this._clip},set:function(e){if(this._clip!==e){if(this._clip&&0<this._referenceCount&&this._clip._removeReference(this._referenceCount),e){var t=this._realtimeDatas,i=e._nodes,n=i.count;this._currentFrameIndices=new Int16Array(n),this._resetFrameIndices(),0<this._referenceCount&&e._addReference(this._referenceCount),this._realtimeDatas.length=n;for(var a=0;a<n;a++)switch(i.getNodeByIndex(a).type){case 0:break;case 1:case 3:case 4:t[a]=new(Bt.supportWebGLPlusAnimation?Na:R);break;case 2:t[a]=new(Bt.supportWebGLPlusAnimation?Ba:Ca);break;default:throw"AnimationClipParser04:unknown type."}}this._clip=e}}},{key:"_getReferenceCount",value:function(){return this._referenceCount}},{key:"_addReference",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;this._clip&&this._clip._addReference(e),this._referenceCount+=e}},{key:"_removeReference",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;this._clip&&this._clip._removeReference(e),this._referenceCount-=e}},{key:"_clearReference",value:function(){this._removeReference(-this._referenceCount)}},{key:"_resetFrameIndices",value:function(){for(var e=0,t=this._currentFrameIndices.length;e<t;e++)this._currentFrameIndices[e]=-1}},{key:"addScript",value:function(e){e=new e;return this._scripts=this._scripts||[],this._scripts.push(e),e}},{key:"getScript",value:function(e){if(this._scripts)for(var t=0,i=this._scripts.length;t<i;t++){var n=this._scripts[t];if(n instanceof e)return n}return null}},{key:"getScripts",value:function(e){var t;if(this._scripts)for(var i=0,n=this._scripts.length;i<n;i++){var a=this._scripts[i];a instanceof e&&(t=t||[]).push(a)}return t}},{key:"cloneTo",value:function(e){e.name=this.name,e.speed=this.speed,e.clipStart=this.clipStart,e.clipEnd=this.clipEnd,e.clip=this._clip}},{key:"clone",value:function(){var e=new t;return this.cloneTo(e),e}}]),t}()),Oa=function(){function e(){b(this,e),this.indexInList=-1,this.referenceCount=0,this.updateMark=-1,this.type=-1,this.fullPath=null,this.propertyOwner=null,this.property=null,this.defaultValue=null,this.crossFixedValue=null}return y(e,[{key:"saveCrossFixedValue",value:function(){var e=this.propertyOwner;if(e)switch(this.type){case 0:for(var t=this.property,i=t.length-1,n=0;n<i&&(e=e[t[n]]);n++);this.crossFixedValue=e[t[i]];break;case 1:var a=e.localPosition;this.crossFixedValue||(this.crossFixedValue=new R),this.crossFixedValue.x=a.x,this.crossFixedValue.y=a.y,this.crossFixedValue.z=a.z;break;case 2:a=e.localRotation;this.crossFixedValue||(this.crossFixedValue=new Ca),this.crossFixedValue.x=a.x,this.crossFixedValue.y=a.y,this.crossFixedValue.z=a.z,this.crossFixedValue.w=a.w;break;case 3:a=e.localScale;this.crossFixedValue||(this.crossFixedValue=new R),this.crossFixedValue.x=a.x,this.crossFixedValue.y=a.y,this.crossFixedValue.z=a.z;break;case 4:a=e.localRotationEuler;this.crossFixedValue||(this.crossFixedValue=new R),this.crossFixedValue.x=a.x,this.crossFixedValue.y=a.y,this.crossFixedValue.z=a.z;break;default:throw"Animator:unknown type."}}}]),e}(),Fa=function(){f(w,Mi);var t=T(w);function w(){var e;return b(this,w),(e=t.call(this))._keyframeNodeOwners=[],e._linkAvatarSpritesData={},e._linkAvatarSprites=[],e._renderableSprites=[],e.cullingMode=w.CULLINGMODE_CULLCOMPLETELY,e._controllerLayers=[],e._linkSprites={},e._speed=1,e._keyframeNodeOwnerMap={},e._updateMark=0,e}return y(w,[{key:"speed",get:function(){return this._speed},set:function(e){this._speed=e}},{key:"_linkToSprites",value:function(e){for(var t in e){for(var i=this.owner,n=e[t],a=0,s=n.length;a<s;a++){var r=n[a];if(""===r)break;if(!(i=i.getChildByName(r)))break}i&&this.linkSprite3DToAvatarNode(t,i)}}},{key:"_addKeyframeNodeOwner",value:function(e,t,i){var n=t._indexInList,a=t.fullPath,s=this._keyframeNodeOwnerMap[a];if(s)s.referenceCount++,e[n]=s;else{for(var r=i,o=0,h=t.propertyCount;o<h&&(r=r[t.getPropertyByIndex(o)]);o++);(s=this._keyframeNodeOwnerMap[a]=new Oa).fullPath=a,s.indexInList=this._keyframeNodeOwners.length,s.referenceCount=1,s.propertyOwner=i;for(var l=t.propertyCount,u=[],o=0;o<l;o++)u[o]=t.getPropertyByIndex(o);s.property=u,s.type=t.type,r&&(0===t.type?s.defaultValue=r:(a=new r.constructor,r.cloneTo(a),s.defaultValue=a)),this._keyframeNodeOwners.push(s),e[n]=s}}},{key:"_removeKeyframeNodeOwner",value:function(e,t){var i=t.fullPath,n=this._keyframeNodeOwnerMap[i];n&&(n.referenceCount--,0===n.referenceCount&&(delete this._keyframeNodeOwnerMap[i],this._keyframeNodeOwners.splice(this._keyframeNodeOwners.indexOf(n),1)),e[t._indexInList]=null)}},{key:"_getOwnersByClip",value:function(e){var t=e._clip._nodes,i=t.count,n=e._nodeOwners;n.length=i;for(var a=0;a<i;a++){for(var s,r=t.getNodeByIndex(a),o=this._avatar?this._avatarNodeMap[this._avatar._rootNode.name]:this.owner,h=0,l=r.ownerPathCount;h<l;h++){var u=r.getOwnerPathByIndex(h);if(""===u)break;if(!(o=o.getChildByName(u)))break}!o||(o=(s=r.propertyOwner)?o[s]:o)&&this._addKeyframeNodeOwner(n,r,o)}}},{key:"_updatePlayer",value:function(e,t,i,n){var a=e._clip._duration*(e.clipEnd-e.clipStart),s=t._elapsedTime,i=s+i,s=(t._lastElapsedTime=s,(t._elapsedTime=i)/a),s=(t._normalizedTime=s)%1,r=(t._normalizedPlayTime=s<0?1+s:s,t._duration=a,e._scripts);if(!n&&a<=i){if(t._finish=!0,t._elapsedTime=a,t._normalizedPlayTime=1,r)for(var o=0,h=r.length;o<h;o++)r[o].onStateExit()}else if(r)for(o=0,h=r.length;o<h;o++)r[o].onStateUpdate()}},{key:"_eventScript",value:function(e,t,i,n,a){if(a)for(var s=t.length;i<s;i++){var r=t[i];if(!(r.time<=n))break;for(var o=0,h=e.length;o<h;o++){var l=e[o],u=l[r.eventName];u&&u.apply(l,r.params)}}else for(;0<=i&&(r=t[i]).time>=n;i--)for(o=0,h=e.length;o<h;o++)(u=(l=e[o])[r.eventName])&&u.apply(l,r.params);return i}},{key:"_updateEventScript",value:function(e,t){var i=this.owner._scripts;if(i){var e=e._clip,n=e._animationEvents,a=e._duration,e=t._elapsedTime,s=e%a,e=Math.abs(Math.floor(e/a)-Math.floor(t._lastElapsedTime/a)),r=t._elapsedTime>=t._lastElapsedTime;if(t._lastIsFront!==r&&(r?t._playEventIndex++:t._playEventIndex--,t._lastIsFront=r),r){t._playEventIndex=this._eventScript(i,n,t._playEventIndex,0<e?a:s,!0);for(var o=0,h=e-1;o<h;o++)this._eventScript(i,n,0,a,!0);0<e&&0<s&&(t._playEventIndex=this._eventScript(i,n,0,s,!0))}else{t._playEventIndex=this._eventScript(i,n,t._playEventIndex,0<e?0:s,!1);for(var l=n.length-1,o=0,h=e-1;o<h;o++)this._eventScript(i,n,l,0,!1);0<e&&0<s&&(t._playEventIndex=this._eventScript(i,n,l,s,!1))}}}},{key:"_updateClipDatas",value:function(e,t,i,n){var a=e._clip,s=a._duration,s=e.clipStart*s+i._normalizedPlayTime*i._duration,r=e._currentFrameIndices,i=i._elapsedTime>i._lastElapsedTime;a._evaluateClipDatasRealTime(a._nodes,s,r,t,i,e._realtimeDatas)}},{key:"_applyFloat",value:function(e,t,i,n,a,s,r){var o;i.updateMark===this._updateMark?n?e[t]+=a*r:(o=e[t],e[t]=o+a*(r-o)):s?e[t]=n?i.defaultValue+r:r:n?e[t]=i.defaultValue+a*r:(o=i.defaultValue,e[t]=o+a*(r-o))}},{key:"_applyPositionAndRotationEuler",value:function(e,t,i,n,a,s){var r,o,h,l;e.updateMark===this._updateMark?t?(s.x+=i*a.x,s.y+=i*a.y,s.z+=i*a.z):(r=s.x,o=s.y,h=s.z,s.x=r+i*(a.x-r),s.y=o+i*(a.y-o),s.z=h+i*(a.z-h)):n?t?(l=e.defaultValue,s.x=l.x+a.x,s.y=l.y+a.y,s.z=l.z+a.z):(s.x=a.x,s.y=a.y,s.z=a.z):(l=e.defaultValue,t?(s.x=l.x+i*a.x,s.y=l.y+i*a.y,s.z=l.z+i*a.z):(r=l.x,o=l.y,h=l.z,s.x=r+i*(a.x-r),s.y=o+i*(a.y-o),s.z=h+i*(a.z-h)))}},{key:"_applyRotation",value:function(e,t,i,n,a,s){var r,o;e.updateMark===this._updateMark?t?(Ra.quaternionWeight(a,i,r=w._tempQuaternion1),r.normalize(r),Ca.multiply(s,r,s)):Ca.lerp(s,a,i,s):n?t?(o=e.defaultValue,Ca.multiply(o,a,s)):(s.x=a.x,s.y=a.y,s.z=a.z,s.w=a.w):(o=e.defaultValue,t?(Ra.quaternionWeight(a,i,r=w._tempQuaternion1),r.normalize(r),Ca.multiply(o,r,s)):Ca.lerp(o,a,i,s))}},{key:"_applyScale",value:function(e,t,i,n,a,s){var r,o;e.updateMark===this._updateMark?t?(Ra.scaleWeight(a,i,r=w._tempVector31),s.x=s.x*r.x,s.y=s.y*r.y,s.z=s.z*r.z):Ra.scaleBlend(s,a,i,s):n?t?(o=e.defaultValue,s.x=o.x*a.x,s.y=o.y*a.y,s.z=o.z*a.z):(s.x=a.x,s.y=a.y,s.z=a.z):(o=e.defaultValue,t?(Ra.scaleWeight(a,i,r=w._tempVector31),s.x=o.x*r.x,s.y=o.y*r.y,s.z=o.z*r.z):Ra.scaleBlend(o,a,i,s))}},{key:"_applyCrossData",value:function(e,t,i,n,a,s,r){var o=e.propertyOwner;if(o){switch(e.type){case 0:for(var h=e.property,l=h.length-1,u=0;u<l&&(o=o[h[u]]);u++);this._applyFloat(o,h[l],e,t,i,n,a+r*(s-a));break;case 1:var c=o.localPosition,_=w._tempVector30,f=a.x,d=a.y,p=a.z;_.x=f+r*(s.x-f),_.y=d+r*(s.y-d),_.z=p+r*(s.z-p),this._applyPositionAndRotationEuler(e,t,i,n,_,c),o.localPosition=c;break;case 2:_=o.localRotation,c=w._tempQuaternion0;Ca.lerp(a,s,r,c),this._applyRotation(e,t,i,n,c,_),o.localRotation=_;break;case 3:c=o.localScale,_=w._tempVector30;Ra.scaleBlend(a,s,r,_),this._applyScale(e,t,i,n,_,c),o.localScale=c;break;case 4:_=o.localRotationEuler,c=w._tempVector30,f=a.x,d=a.y,p=a.z;c.x=f+r*(s.x-f),c.y=d+r*(s.y-d),c.z=p+r*(s.z-p),this._applyPositionAndRotationEuler(e,t,i,n,c,_),o.localRotationEuler=_}e.updateMark=this._updateMark}}},{key:"_setClipDatasToNode",value:function(e,t,i,n){for(var a=e._realtimeDatas,s=e._clip._nodes,r=e._nodeOwners,o=0,h=s.count;o<h;o++){var l=r[o];if(l){var u=l.propertyOwner;if(u){switch(l.type){case 0:for(var c=l.property,_=c.length-1,f=0;f<_&&(u=u[c[f]]);f++);this._applyFloat(u,c[_],l,t,i,n,a[o]);break;case 1:var d=u.localPosition;this._applyPositionAndRotationEuler(l,t,i,n,a[o],d),u.localPosition=d;break;case 2:d=u.localRotation;this._applyRotation(l,t,i,n,a[o],d),u.localRotation=d;break;case 3:var p=u.localScale;this._applyScale(l,t,i,n,a[o],p),u.localScale=p;break;case 4:p=u.localRotationEuler;this._applyPositionAndRotationEuler(l,t,i,n,a[o],p),u.localRotationEuler=p}l.updateMark=this._updateMark}}}}},{key:"_setCrossClipDatasToNode",value:function(e,t,i,n,a){for(var s=e._crossNodesOwners,r=e._crossNodesOwnersCount,o=e.blendingMode!==La.BLENDINGMODE_OVERRIDE,h=e.defaultWeight,l=i._realtimeDatas,u=e._destCrossClipNodeIndices,c=i._nodeOwners,_=t._realtimeDatas,f=e._srcCrossClipNodeIndices,d=t._nodeOwners,p=0;p<r;p++){var y,g,m,v=s[p];v&&(y=f[p],m=u[p],g=-1!==y?_[y]:c[m].defaultValue,m=-1!==m?l[m]:d[y].defaultValue,this._applyCrossData(v,o,h,a,g,m,n))}}},{key:"_setFixedCrossClipDatasToNode",value:function(e,t,i,n){for(var a=e._crossNodesOwners,s=e._crossNodesOwnersCount,r=e.blendingMode!==La.BLENDINGMODE_OVERRIDE,o=e.defaultWeight,h=t._realtimeDatas,l=e._destCrossClipNodeIndices,u=0;u<s;u++){var c,_,f=a[u];f&&(_=l[u],c=f.crossFixedValue,_=-1!==_?h[_]:f.defaultValue,this._applyCrossData(f,r,o,n,c,_,i))}}},{key:"_revertDefaultKeyframeNodes",value:function(e){for(var t=e._nodeOwners,i=0,n=t.length;i<n;i++){var a=t[i];if(a){var s=a.propertyOwner;if(s)switch(a.type){case 0:for(var r=a.property,o=r.length-1,h=0;h<o&&(s=s[r[h]]);h++);s[r[o]]=a.defaultValue;break;case 1:var l=s.localPosition,u=a.defaultValue;l.x=u.x,l.y=u.y,l.z=u.z,s.localPosition=l;break;case 2:var l=s.localRotation,c=a.defaultValue;l.x=c.x,l.y=c.y,l.z=c.z,l.w=c.w,s.localRotation=l;break;case 3:c=s.localScale,u=a.defaultValue;c.x=u.x,c.y=u.y,c.z=u.z,s.localScale=c;break;case 4:var _=s.localRotationEuler;u=a.defaultValue,_.x=u.x,_.y=u.y,_.z=u.z,s.localRotationEuler=_;break;default:throw"Animator:unknown type."}}}}},{key:"_onAdded",value:function(){var e=this.owner._parent;this.owner._setHierarchyAnimator(this,e?e._hierarchyAnimator:null),this.owner._changeAnimatorToLinkSprite3DNoAvatar(this,!0,[])}},{key:"_onDestroy",value:function(){for(var e=0,t=this._controllerLayers.length;e<t;e++)this._controllerLayers[e]._removeReference();var i=this.owner._parent;this.owner._clearHierarchyAnimator(this,i?i._hierarchyAnimator:null)}},{key:"_onEnable",value:function(){this.owner._scene._animatorPool.add(this);for(var e=0,t=this._controllerLayers.length;e<t;e++)this._controllerLayers[e].playOnWake&&this.getDefaultState(e)&&this.play(null,e,0)}},{key:"_onDisable",value:function(){this.owner._scene._animatorPool.remove(this)}},{key:"_handleSpriteOwnersBySprite",value:function(e,t,i){for(var n=0,a=this._controllerLayers.length;n<a;n++)for(var s=this._controllerLayers[n]._states,r=0,o=s.length;r<o;r++){var h=s[r],l=h._clip,u=t.join("/"),c=l._nodesMap[u];if(c)for(var _=h._nodeOwners,f=0,d=c.length;f<d;f++)e?this._addKeyframeNodeOwner(_,c[f],i):this._removeKeyframeNodeOwner(_,c[f])}}},{key:"_parse",value:function(e){for(var t=e.avatar,i=(t&&(this.avatar=E.getRes(t.path),t=t.linkSprites,this._linkSprites=t,this._linkToSprites(t)),e.clipPaths,e.playOnWake),n=e.layers,a=0;a<n.length;a++){for(var s=n[a],r=new La(s.name),o=(r.defaultWeight=0===a?1:s.weight,s.blendingMode),h=(o&&(r.blendingMode=o),this.addControllerLayer(r),s.states),l=0,u=h.length;l<u;l++){var c,_=h[l],f=_.clipPath;f&&(_=_.name,(f=E.getRes(f))&&((c=new Da).name=_,c.clip=f,r.addState(c),0===l&&(this.getControllerLayer(a).defaultState=c)))}void 0!==i&&(r.playOnWake=i)}t=e.cullingMode;void 0!==t&&(this.cullingMode=t)}},{key:"_update",value:function(){var e=this.owner._scene.timer,t=e._delta/1e3;if(0!==this._speed&&0!=t){if(this.cullingMode===w.CULLINGMODE_CULLCOMPLETELY){for(var i=!1,n=0,a=this._renderableSprites.length;n<a;n++)if(this._renderableSprites[n]._render._visible){i=!0;break}}else i=!0;this._updateMark++;for(var s=e.scale,n=0,a=this._controllerLayers.length;n<a;n++){var r=this._controllerLayers[n],o=r._playStateInfo,h=r._crossPlayStateInfo,l=r.blendingMode!==La.BLENDINGMODE_OVERRIDE;switch(r._playType){case 0:var l,u=o._currentState,c=u._clip,_=this._speed*u.speed,f=o._finish;f||this._updatePlayer(u,o,t*_,c.islooping),i&&(l=r.blendingMode!==La.BLENDINGMODE_OVERRIDE,this._updateClipDatas(u,l,o,s*_),this._setClipDatasToNode(u,l,r.defaultWeight,0===n),f||this._updateEventScript(u,o));break;case 1:var c=(u=o._currentState)._clip,d=r._crossPlayState,p=d._clip,y=r._crossDuration,g=h._startPlayTime,m=p._duration-g,v=m<y?m/y:1,x=this._speed*d.speed,k=(this._updatePlayer(d,h,t*v*x,p.islooping),(h._elapsedTime-g)/v/y);1<=k?i&&(this._updateClipDatas(d,l,h,s*x),this._setClipDatasToNode(d,l,r.defaultWeight,0===n),r._playType=0,o._currentState=d,h._cloneTo(o)):(o._finish||(_=this._speed*u.speed,this._updatePlayer(u,o,t*_,c.islooping),i&&this._updateClipDatas(u,l,o,s*_)),i&&(this._updateClipDatas(d,l,h,s*v*x),this._setCrossClipDatasToNode(r,u,d,k,0===n))),i&&(this._updateEventScript(u,o),this._updateEventScript(d,h));break;case 2:p=(d=r._crossPlayState)._clip,y=r._crossDuration,g=h._startPlayTime,m=p._duration-g,x=this._speed*d.speed,this._updatePlayer(d,h,t*(v=m<y?m/y:1)*x,p.islooping),i&&(1<=(k=(h._elapsedTime-g)/v/y)?(this._updateClipDatas(d,l,h,s*x),this._setClipDatasToNode(d,l,1,0===n),r._playType=0,o._currentState=d,h._cloneTo(o)):(this._updateClipDatas(d,l,h,s*v*x),this._setFixedCrossClipDatasToNode(r,d,k,0===n)),this._updateEventScript(d,h))}}i&&this._avatar&&(Bt.supportWebGLPlusAnimation&&this._updateAnimationNodeWorldMatix(this._animationNodeLocalPositions,this._animationNodeLocalRotations,this._animationNodeLocalScales,this._animationNodeWorldMatrixs,this._animationNodeParentIndices),this._updateAvatarNodesToSprite())}}},{key:"_cloneTo",value:function(e){var t=e;t.avatar=this.avatar,t.cullingMode=this.cullingMode;for(var i=0,n=this._controllerLayers.length;i<n;i++)for(var a=this._controllerLayers[i],s=(t.addControllerLayer(a.clone()),a._states),r=0,o=s.length;r<o;r++){var h=s[r].clone(),l=t.getControllerLayer(i);l.addState(h),0==r&&(l.defaultState=h)}t._linkSprites=this._linkSprites,t._linkToSprites(this._linkSprites)}},{key:"getDefaultState",value:function(){return this._controllerLayers[0<arguments.length&&void 0!==arguments[0]?arguments[0]:0].defaultState}},{key:"addState",value:function(e){this._controllerLayers[1<arguments.length&&void 0!==arguments[1]?arguments[1]:0].addState(e),console.warn("Animator:this function is discard,please use animatorControllerLayer.addState() instead.")}},{key:"removeState",value:function(e){this._controllerLayers[1<arguments.length&&void 0!==arguments[1]?arguments[1]:0].removeState(e),console.warn("Animator:this function is discard,please use animatorControllerLayer.removeState() instead.")}},{key:"addControllerLayer",value:function(e){this._controllerLayers.push(e),e._animator=this,e._addReference();for(var t=e._states,i=0,n=t.length;i<n;i++)this._getOwnersByClip(t[i])}},{key:"getControllerLayer",value:function(){return this._controllerLayers[0<arguments.length&&void 0!==arguments[0]?arguments[0]:0]}},{key:"play",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:Number.NEGATIVE_INFINITY,n=this._controllerLayers[t];if(n){var a=n.defaultState;if(!e&&!a)throw new Error("Animator:must have default clip value,please set clip property.");var s=n._playStateInfo,r=s._currentState,e=e?n._statesMap[e]:a,a=e._clip._duration,o=(r!==e?(i!==Number.NEGATIVE_INFINITY?s._resetPlayState(a*i):s._resetPlayState(0),null!==r&&r!==e&&this._revertDefaultKeyframeNodes(r),n._playType=0,s._currentState=e):i!==Number.NEGATIVE_INFINITY&&(s._resetPlayState(a*i),n._playType=0),e._scripts);if(o)for(var h=0,l=o.length;h<l;h++)o[h].onStateEnter()}else console.warn("Invalid layerIndex "+t+".")}},{key:"crossFade",value:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:Number.NEGATIVE_INFINITY,a=this._controllerLayers[i];if(a){var s=a._statesMap[e];if(s){var r=a._playType;if(-1===r)this.play(e,i,n);else{var e=a._crossPlayStateInfo,o=a._crossNodesOwners,h=a._crossNodesOwnersIndicesMap,l=a._playStateInfo._currentState,u=s._nodeOwners,c=a._destCrossClipNodeIndices,_=s._clip,f=_._nodes,d=_._nodesDic;switch(r){case 0:for(var p=l._nodeOwners,y=a._srcCrossClipNodeIndices,g=l._clip,m=g._nodes,v=g._nodesDic,x=(a._playType=1,++a._crossMark),k=a._crossNodesOwnersCount=0,w=0,b=m.count;w<b;w++){var S=m.getNodeByIndex(w),I=S._indexInList,T=p[I];T&&(S=S.fullPath,y[k]=I,C=d[S],c[k]=C?C._indexInList:-1,h[S]=x,o[k]=T,k++)}for(w=0,b=f.count;w<b;w++){var C,M,E=(C=f.getNodeByIndex(w))._indexInList,R=u[E];!R||v[M=C.fullPath]||(y[k]=-1,c[k]=E,h[M]=x,o[k]=R,k++)}break;case 1:case 2:for(a._playType=2,w=0,b=o.length;w<b;w++){var A=o[w];A.saveCrossFixedValue(),C=d[A.fullPath],c[w]=C?C._indexInList:-1}for(k=a._crossNodesOwnersCount,x=a._crossMark,w=0,b=f.count;w<b;w++)(R=u[E=(C=f.getNodeByIndex(w))._indexInList])&&h[M=C.fullPath]!==x&&(c[k]=E,h[M]=x,A=u[E],(o[k]=A).saveCrossFixedValue(),k++)}a._crossNodesOwnersCount=k,a._crossPlayState=s,a._crossDuration=l._clip._duration*t,n!==Number.NEGATIVE_INFINITY?e._resetPlayState(_._duration*n):e._resetPlayState(0);var L=s._scripts;if(L)for(w=0,b=L.length;w<b;w++)L[w].onStateEnter()}}else console.warn("Invalid name "+i+".")}else console.warn("Invalid layerIndex "+i+".")}},{key:"avatar",get:function(){return this._avatar},set:function(e){this._avatar!==e&&((this._avatar=e)?(this._getAvatarOwnersAndInitDatasAsync(),this.owner._changeHierarchyAnimatorAvatar(this,e)):(e=this.owner._parent,this.owner._changeHierarchyAnimatorAvatar(this,e?e._hierarchyAnimator._avatar:null)))}},{key:"_getAvatarOwnersAndInitDatasAsync",value:function(){for(var e,t=0,i=this._controllerLayers.length;t<i;t++)for(var n=this._controllerLayers[t]._states,a=0,s=n.length;a<s;a++)this._getOwnersByClip(n[a]);for(e in this._avatar._cloneDatasToAnimator(this),this._linkAvatarSpritesData){var r=this._linkAvatarSpritesData[e];if(r)for(var o=0,h=r.length;o<h;o++)this._isLinkSpriteToAnimationNode(r[o],e,!0)}}},{key:"_isLinkSpriteToAnimationNode",value:function(e,t,i){if(this._avatar){t=this._avatarNodeMap[t];if(t)if(i){e._transform._dummy=t.transform,this._linkAvatarSprites.push(e);i=t.transform,t=e.transform;if(!t.owner.isStatic&&i){var n=t.worldMatrix,a=this.owner._transform._parent;if(a)Ra.matrix4x4MultiplyMFM(a.worldMatrix,i.getWorldMatrix(),n);else for(var s=n.elements,r=i.getWorldMatrix(),o=0;o<16;o++)s[o]=r[o];t.worldMatrix=n}}else e._transform._dummy=null,this._linkAvatarSprites.splice(this._linkAvatarSprites.indexOf(e),1)}}},{key:"_isLinkSpriteToAnimationNodeData",value:function(e,t,i){var n=this._linkAvatarSpritesData[t];i?(n||(this._linkAvatarSpritesData[t]=n=[]),n.push(e)):(i=n.indexOf(e),n.splice(i,1))}},{key:"_updateAvatarNodesToSprite",value:function(){for(var e=0,t=this._linkAvatarSprites.length;e<t;e++){var i,n,a=this._linkAvatarSprites[e],s=a.transform._dummy,a=a.transform;!a.owner.isStatic&&s&&(i=a.worldMatrix,n=this.owner._transform,Ra.matrix4x4MultiplyMFM(n.worldMatrix,s.getWorldMatrix(),i),a.worldMatrix=i)}}},{key:"linkSprite3DToAvatarNode",value:function(e,t){return this._isLinkSpriteToAnimationNodeData(t,e,!0),this._isLinkSpriteToAnimationNode(t,e,!0),!0}},{key:"unLinkSprite3DToAvatarNode",value:function(e){var t;if(e._hierarchyAnimator===this)return!!(t=e.transform._dummy)&&(t=t._owner.name,this._isLinkSpriteToAnimationNodeData(e,t,!1),this._isLinkSpriteToAnimationNode(e,t,!1),!0);throw"Animator:sprite3D must belong to this Animator"}},{key:"getCurrentAnimatorPlayState",value:function(){return this._controllerLayers[0<arguments.length&&void 0!==arguments[0]?arguments[0]:0]._playStateInfo}},{key:"_updateAnimationNodeWorldMatix",value:function(e,t,i,n,a){S.instance.updateAnimationNodeWorldMatix(e,t,i,a,n)}}],[{key:"_update",value:function(e){for(var e=e._animatorPool,t=e.elements,i=0,n=e.length;i<n;i++){var a=t[i];a&&a.enabled&&a._update()}}}]),w}(),Va=(Fa._tempVector30=new R,Fa._tempVector31=new R,Fa._tempQuaternion0=new Ca,Fa._tempQuaternion1=new Ca,Fa.CULLINGMODE_ALWAYSANIMATE=0,Fa.CULLINGMODE_CULLCOMPLETELY=2,function(){function t(){b(this,t),this._defaultPhysicsMemory=16,this._maxLightCount=32,this._lightClusterCount=new R(12,12,12),this._editerEnvironment=!1,this.isAntialias=!0,this.isAlpha=!1,this.premultipliedAlpha=!0,this.isStencil=!0,this.enableMultiLight=!0,this.octreeCulling=!1,this.octreeInitialSize=64,this.octreeInitialCenter=new R(0,0,0),this.octreeMinNodeSize=2,this.octreeLooseness=1.25,this.debugFrustumCulling=!1,this._maxAreaLightCountPerClusterAverage=Math.min(4*Math.floor(2048/this._lightClusterCount.z-1),this._maxLightCount)}return y(t,[{key:"defaultPhysicsMemory",get:function(){return this._defaultPhysicsMemory},set:function(e){if(e<16)throw"defaultPhysicsMemory must large than 16M";this._defaultPhysicsMemory=e}},{key:"maxLightCount",get:function(){return this._maxLightCount},set:function(e){2048<e?(this._maxLightCount=2048,console.warn("Config3D: maxLightCount must less equal 2048.")):this._maxLightCount=e}},{key:"lightClusterCount",get:function(){return this._lightClusterCount},set:function(e){128<e.x||128<e.y||128<e.z?(this._lightClusterCount.setValue(Math.min(e.x,128),Math.min(e.y,128),Math.min(e.z,128)),console.warn("Config3D: lightClusterCount X and Y、Z must less equal 128.")):e.cloneTo(this._lightClusterCount);e=4*Math.floor(2048/this._lightClusterCount.z-1);e<this._maxLightCount&&console.warn("Config3D: if the area light(PointLight、SpotLight) count is large than "+e+",maybe the far away culster will ingonre some light."),this._maxAreaLightCountPerClusterAverage=Math.min(e,this._maxLightCount)}},{key:"cloneTo",value:function(e){e._defaultPhysicsMemory=this._defaultPhysicsMemory,e._editerEnvironment=this._editerEnvironment,e.isAntialias=this.isAntialias,e.isAlpha=this.isAlpha,e.premultipliedAlpha=this.premultipliedAlpha,e.isStencil=this.isStencil,e.octreeCulling=this.octreeCulling,this.octreeInitialCenter.cloneTo(e.octreeInitialCenter),e.octreeInitialSize=this.octreeInitialSize,e.octreeMinNodeSize=this.octreeMinNodeSize,e.octreeLooseness=this.octreeLooseness,e.debugFrustumCulling=this.debugFrustumCulling,e.maxLightCount=this.maxLightCount,e.enableMultiLight=this.enableMultiLight;var t=e.lightClusterCount;this.lightClusterCount.cloneTo(t),e.lightClusterCount=t}},{key:"clone",value:function(){var e=new t;return this.cloneTo(e),e}}]),t}()),Ua=(Va._config=new Va,window.Config3D=Va,function(){function t(){b(this,t),this._mask=[],this._length=0}return y(t,[{key:"_intersectionDefineDatas",value:function(e){for(var t=e._mask,i=this._mask,n=this._length-1;0<=n;n--){var a=i[n]&t[n];0==a&&n==this._length-1?this._length--:i[n]=a}}},{key:"add",value:function(e){var t=e._index,i=t+1,n=this._mask,a=n.length;if(a<i){for(n.length=i;a<t;a++)n[a]=0;n[t]=e._value,this._length=i}else i>this._length?(n[t]=e._value,this._length=i):n[t]|=e._value}},{key:"remove",value:function(e){var t=e._index,i=this._mask,n=this._length-1;n<t||(e=i[t]&~e._value,t==n&&0==e?this._length--:i[t]=e)}},{key:"addDefineDatas",value:function(e){var t=e._mask,i=e._length,n=this._mask,a=n.length;if(a<i){n.length=i;for(var s=0;s<a;s++)n[s]|=t[s];for(;a<i;a++)n[a]=t[a];this._length=i}else{for(s=0;s<i;s++)n[s]|=t[s];this._length=Math.max(this._length,i)}}},{key:"removeDefineDatas",value:function(e){for(var t,i=e._mask,n=this._mask,a=this._length-1,s=e._length-1;0<=s;s--)a<s||(t=n[s]&~i[s],s==a&&0==t?(a--,this._length--):n[s]=t)}},{key:"has",value:function(e){var t=e._index;return!(t>=this._length)&&0!=(this._mask[t]&e._value)}},{key:"clear",value:function(){this._length=0}},{key:"cloneTo",value:function(e){var t=e._mask,i=this._mask,n=this._length;t.length=n;for(var a=0;a<n;a++)t[a]=i[a];e._length=n}},{key:"clone",value:function(){var e=new t;return this.cloneTo(e),e}}]),t}()),za=y(function e(t,i){b(this,e),this._index=t,this._value=i}),t=function(){function e(){b(this,e),this._allCompiled=!1,this._variants=[]}return y(e,[{key:"allCompiled",get:function(){return this._allCompiled}},{key:"variantCount",get:function(){return this._variants.length}},{key:"add",value:function(e){for(var t=0,i=this._variants.length;t<i;t++)if(this._variants[t].equal(e))return!1;return this._variants.push(e.clone()),!(this._allCompiled=!1)}},{key:"remove",value:function(e){for(var t=0,i=this._variants.length;t<i;t++)if(this._variants[t].equal(e))return this._variants.splice(t,1),!0;return!1}},{key:"contatins",value:function(e){for(var t=0,i=this._variants.length;t<i;t++)if(this._variants[t].equal(e))return!0;return!1}},{key:"getByIndex",value:function(e){return this._variants[e]}},{key:"clear",value:function(){this._variants.length=0}},{key:"compile",value:function(){if(!this._allCompiled){for(var e=this._variants,t=0,i=e.length;t<i;t++){var n=e[t];Ta.Shader3D.compileShaderByDefineNames(n._shader._name,n._subShaderIndex,n._passIndex,n._defineNames)}this._allCompiled=!0}}}]),e}(),A=function(){function u(e,t,i,n){b(this,u),this._attributeMap=null,this._uniformMap=null,this._enableInstancing=!1,this._subShaders=[],this._name=e,this._attributeMap=t,this._uniformMap=i,this._enableInstancing=n}return y(u,[{key:"name",get:function(){return this._name}},{key:"addSubShader",value:function(e){this._subShaders.push(e),e._owner=this}},{key:"getSubShaderAt",value:function(e){return this._subShaders[e]}}],[{key:"_getNamesByDefineData",value:function(e,t){for(var i=u._maskMap,n=e._mask,a=t.length=0,s=e._length;a<s;a++)for(var r=i[a],o=n[a],h=0;h<32;h++){var l=1<<h;if(0<o&&o<l)break;o&l&&t.push(r[l])}}},{key:"getDefineByName",value:function(e){var t,i,n,a=u._defineMap[e];return a||(t=u._maskMap,n=u._defineCounter,i=Math.floor(n/32),a=new za(i,n=1<<n%32),u._defineMap[e]=a,i==t.length&&(t.length++,t[i]={}),t[i][n]=e,u._defineCounter++),a}},{key:"propertyNameToID",value:function(e){var t;return null!=u._propertyNameMap[e]?u._propertyNameMap[e]:(t=u._propertyNameCounter++,u._propertyNameMap[e]=t)}},{key:"addInclude",value:function(e,t){t=t.replace(Xi._clearCR,""),Xi.addInclude(e,t)}},{key:"compileShaderByDefineNames",value:function(e,t,i,n){e=u.find(e);if(e){e=e.getSubShaderAt(t);if(e){t=e._passes[i];if(t){var a=u._compileDefineDatas;a.clear();for(var s=0,r=n.length;s<r;s++)a.add(u.getDefineByName(n[s]));Va._config._multiLighting||a.add(u.SHADERDEFINE_LEGACYSINGALLIGHTING),t.withCompile(a)}else console.warn("Shader3D: unknown passIndex.")}else console.warn("Shader3D: unknown subShaderIndex.")}else console.warn("Shader3D: unknown shader name.")}},{key:"add",value:function(e){return u._preCompileShader[e]=new u(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,3<arguments.length&&void 0!==arguments[3]&&arguments[3])}},{key:"find",value:function(e){return u._preCompileShader[e]}},{key:"compileShader",value:function(e,t,i){e=u.find(e);if(e){e=e.getSubShaderAt(t);if(e){t=e._passes[i];if(t){for(var e=u._compileDefineDatas,n=e._mask,a=n.length=0,s=arguments.length<=3?0:arguments.length-3;a<s;a++)n.push(a+3<3||arguments.length<=a+3?void 0:arguments[a+3]);e._length=arguments.length<=3?0:arguments.length-3,Va._config._multiLighting||e.add(u.SHADERDEFINE_LEGACYSINGALLIGHTING),t.withCompile(e)}else console.warn("Shader3D: unknown passIndex.")}else console.warn("Shader3D: unknown subShaderIndex.")}else console.warn("Shader3D: unknown shader name.")}}]),u}(),Ya=(A._compileDefineDatas=new Ua,A.RENDER_STATE_CULL=0,A.RENDER_STATE_BLEND=1,A.RENDER_STATE_BLEND_SRC=2,A.RENDER_STATE_BLEND_DST=3,A.RENDER_STATE_BLEND_SRC_RGB=4,A.RENDER_STATE_BLEND_DST_RGB=5,A.RENDER_STATE_BLEND_SRC_ALPHA=6,A.RENDER_STATE_BLEND_DST_ALPHA=7,A.RENDER_STATE_BLEND_CONST_COLOR=8,A.RENDER_STATE_BLEND_EQUATION=9,A.RENDER_STATE_BLEND_EQUATION_RGB=10,A.RENDER_STATE_BLEND_EQUATION_ALPHA=11,A.RENDER_STATE_DEPTH_TEST=12,A.RENDER_STATE_DEPTH_WRITE=13,A.PERIOD_CUSTOM=0,A.PERIOD_MATERIAL=1,A.PERIOD_SPRITE=2,A.PERIOD_CAMERA=3,A.PERIOD_SCENE=4,A._propertyNameCounter=0,A._propertyNameMap={},A._defineCounter=0,A._defineMap={},A._preCompileShader={},A._maskMap=[],A.debugMode=!0,A.debugShaderVariantCollection=new t,function(){f(s,ae);var i=T(s);function s(e){var t;return b(this,s),(t=i.call(this))._localPosition=new R(0,0,0),t._localRotation=new Ca(0,0,0,1),t._localScale=new R(1,1,1),t._localRotationEuler=new R(0,0,0),t._localMatrix=new Pa,t._position=new R(0,0,0),t._rotation=new Ca(0,0,0,1),t._scale=new R(1,1,1),t._rotationEuler=new R(0,0,0),t._worldMatrix=new Pa,t._children=null,t._parent=null,t._dummy=null,t._transformFlag=0,t._owner=e,t._children=[],t._setTransformFlag(s.TRANSFORM_LOCALQUATERNION|s.TRANSFORM_LOCALEULER|s.TRANSFORM_LOCALMATRIX,!1),t._setTransformFlag(s.TRANSFORM_WORLDPOSITION|s.TRANSFORM_WORLDQUATERNION|s.TRANSFORM_WORLDEULER|s.TRANSFORM_WORLDSCALE|s.TRANSFORM_WORLDMATRIX,!0),t}return y(s,[{key:"_isFrontFaceInvert",get:function(){var e=this.getWorldLossyScale(),t=e.x<0;return e.y<0&&(t=!t),t=e.z<0?!t:t}},{key:"owner",get:function(){return this._owner}},{key:"worldNeedUpdate",get:function(){return this._getTransformFlag(s.TRANSFORM_WORLDMATRIX)}},{key:"localPositionX",get:function(){return this._localPosition.x},set:function(e){this._localPosition.x=e,this.localPosition=this._localPosition}},{key:"localPositionY",get:function(){return this._localPosition.y},set:function(e){this._localPosition.y=e,this.localPosition=this._localPosition}},{key:"localPositionZ",get:function(){return this._localPosition.z},set:function(e){this._localPosition.z=e,this.localPosition=this._localPosition}},{key:"localPosition",get:function(){return this._localPosition},set:function(e){this._localPosition!==e&&e.cloneTo(this._localPosition),this._setTransformFlag(s.TRANSFORM_LOCALMATRIX,!0),this._onWorldPositionTransform()}},{key:"localRotationX",get:function(){return this.localRotation.x},set:function(e){this._localRotation.x=e,this.localRotation=this._localRotation}},{key:"localRotationY",get:function(){return this.localRotation.y},set:function(e){this._localRotation.y=e,this.localRotation=this._localRotation}},{key:"localRotationZ",get:function(){return this.localRotation.z},set:function(e){this._localRotation.z=e,this.localRotation=this._localRotation}},{key:"localRotationW",get:function(){return this.localRotation.w},set:function(e){this._localRotation.w=e,this.localRotation=this._localRotation}},{key:"localRotation",get:function(){var e;return this._getTransformFlag(s.TRANSFORM_LOCALQUATERNION)&&(e=this._localRotationEuler,Ca.createFromYawPitchRoll(e.y/s._angleToRandin,e.x/s._angleToRandin,e.z/s._angleToRandin,this._localRotation),this._setTransformFlag(s.TRANSFORM_LOCALQUATERNION,!1)),this._localRotation},set:function(e){this._localRotation!==e&&e.cloneTo(this._localRotation),this._localRotation.normalize(this._localRotation),this._setTransformFlag(s.TRANSFORM_LOCALEULER|s.TRANSFORM_LOCALMATRIX,!0),this._setTransformFlag(s.TRANSFORM_LOCALQUATERNION,!1),this._onWorldRotationTransform()}},{key:"localScaleX",get:function(){return this._localScale.x},set:function(e){this._localScale.x=e,this.localScale=this._localScale}},{key:"localScaleY",get:function(){return this._localScale.y},set:function(e){this._localScale.y=e,this.localScale=this._localScale}},{key:"localScaleZ",get:function(){return this._localScale.z},set:function(e){this._localScale.z=e,this.localScale=this._localScale}},{key:"localScale",get:function(){return this._localScale},set:function(e){this._localScale!==e&&e.cloneTo(this._localScale),this._setTransformFlag(s.TRANSFORM_LOCALMATRIX,!0),this._onWorldScaleTransform()}},{key:"localRotationEulerX",get:function(){return this.localRotationEuler.x},set:function(e){this._localRotationEuler.x=e,this.localRotationEuler=this._localRotationEuler}},{key:"localRotationEulerY",get:function(){return this.localRotationEuler.y},set:function(e){this._localRotationEuler.y=e,this.localRotationEuler=this._localRotationEuler}},{key:"localRotationEulerZ",get:function(){return this.localRotationEuler.z},set:function(e){this._localRotationEuler.z=e,this.localRotationEuler=this._localRotationEuler}},{key:"localRotationEuler",get:function(){var e,t;return this._getTransformFlag(s.TRANSFORM_LOCALEULER)&&(this._localRotation.getYawPitchRoll(s._tempVector30),(t=this._localRotationEuler).x=(e=s._tempVector30).y*s._angleToRandin,t.y=e.x*s._angleToRandin,t.z=e.z*s._angleToRandin,this._setTransformFlag(s.TRANSFORM_LOCALEULER,!1)),this._localRotationEuler},set:function(e){this._localRotationEuler!==e&&e.cloneTo(this._localRotationEuler),this._setTransformFlag(s.TRANSFORM_LOCALEULER,!1),this._setTransformFlag(s.TRANSFORM_LOCALQUATERNION|s.TRANSFORM_LOCALMATRIX,!0),this._onWorldRotationTransform()}},{key:"localMatrix",get:function(){return this._getTransformFlag(s.TRANSFORM_LOCALMATRIX)&&(Pa.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix),this._setTransformFlag(s.TRANSFORM_LOCALMATRIX,!1)),this._localMatrix},set:function(e){this._localMatrix!==e&&e.cloneTo(this._localMatrix),this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._setTransformFlag(s.TRANSFORM_LOCALEULER,!0),this._setTransformFlag(s.TRANSFORM_LOCALMATRIX,!1),this._onWorldTransform()}},{key:"position",get:function(){var e;return this._getTransformFlag(s.TRANSFORM_WORLDPOSITION)&&(null!=this._parent?(e=this.worldMatrix.elements,this._position.x=e[12],this._position.y=e[13],this._position.z=e[14]):this._localPosition.cloneTo(this._position),this._setTransformFlag(s.TRANSFORM_WORLDPOSITION,!1)),this._position},set:function(e){var t;null!=this._parent?(this._parent.worldMatrix.invert(t=s._tempMatrix0),R.transformCoordinate(e,t,this._localPosition)):e.cloneTo(this._localPosition),this.localPosition=this._localPosition,this._position!==e&&e.cloneTo(this._position),this._setTransformFlag(s.TRANSFORM_WORLDPOSITION,!1)}},{key:"rotation",get:function(){return this._getTransformFlag(s.TRANSFORM_WORLDQUATERNION)&&(null!=this._parent?Ca.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._setTransformFlag(s.TRANSFORM_WORLDQUATERNION,!1)),this._rotation},set:function(e){null!=this._parent?(this._parent.rotation.invert(s._tempQuaternion0),Ca.multiply(s._tempQuaternion0,e,this._localRotation)):e.cloneTo(this._localRotation),this.localRotation=this._localRotation,e!==this._rotation&&e.cloneTo(this._rotation),this._setTransformFlag(s.TRANSFORM_WORLDQUATERNION,!1)}},{key:"rotationEuler",get:function(){var e,t;return this._getTransformFlag(s.TRANSFORM_WORLDEULER)&&(this.rotation.getYawPitchRoll(s._tempVector30),(t=this._rotationEuler).x=(e=s._tempVector30).y*s._angleToRandin,t.y=e.x*s._angleToRandin,t.z=e.z*s._angleToRandin,this._setTransformFlag(s.TRANSFORM_WORLDEULER,!1)),this._rotationEuler},set:function(e){Ca.createFromYawPitchRoll(e.y/s._angleToRandin,e.x/s._angleToRandin,e.z/s._angleToRandin,this._rotation),this.rotation=this._rotation,this._rotationEuler!==e&&e.cloneTo(this._rotationEuler),this._setTransformFlag(s.TRANSFORM_WORLDEULER,!1)}},{key:"worldMatrix",get:function(){return this._getTransformFlag(s.TRANSFORM_WORLDMATRIX)&&(null!=this._parent?Pa.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._setTransformFlag(s.TRANSFORM_WORLDMATRIX,!1)),this._worldMatrix},set:function(e){null===this._parent?e.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),Pa.multiply(this._localMatrix,e,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix!==e&&e.cloneTo(this._worldMatrix),this._setTransformFlag(s.TRANSFORM_WORLDMATRIX,!1)}},{key:"_getScaleMatrix",value:function(){var e=s._tempQuaternion0,t=s._tempMatrix3x30,i=s._tempMatrix3x31,n=s._tempMatrix3x32;return Ia.createFromMatrix4x4(this.worldMatrix,i),this.rotation.invert(e),Ia.createRotationQuaternion(e,t),Ia.multiply(t,i,n),n}},{key:"_setTransformFlag",value:function(e,t){t?this._transformFlag|=e:this._transformFlag&=~e}},{key:"_getTransformFlag",value:function(e){return 0!=(this._transformFlag&e)}},{key:"_setParent",value:function(e){var t,i;this._parent!==e&&(this._parent&&(i=(t=this._parent._children).indexOf(this),t.splice(i,1)),e&&(e._children.push(this),e&&this._onWorldTransform()),this._parent=e)}},{key:"_onWorldPositionRotationTransform",value:function(){if(!(this._getTransformFlag(s.TRANSFORM_WORLDMATRIX)&&this._getTransformFlag(s.TRANSFORM_WORLDPOSITION)&&this._getTransformFlag(s.TRANSFORM_WORLDQUATERNION)&&this._getTransformFlag(s.TRANSFORM_WORLDEULER))){this._setTransformFlag(s.TRANSFORM_WORLDMATRIX|s.TRANSFORM_WORLDPOSITION|s.TRANSFORM_WORLDQUATERNION|s.TRANSFORM_WORLDEULER,!0),this.event(Me.TRANSFORM_CHANGED,this._transformFlag);for(var e=0,t=this._children.length;e<t;e++)this._children[e]._onWorldPositionRotationTransform()}}},{key:"_onWorldPositionScaleTransform",value:function(){if(!this._getTransformFlag(s.TRANSFORM_WORLDMATRIX)||!this._getTransformFlag(s.TRANSFORM_WORLDPOSITION)||!this._getTransformFlag(s.TRANSFORM_WORLDSCALE)){this._setTransformFlag(s.TRANSFORM_WORLDMATRIX|s.TRANSFORM_WORLDPOSITION|s.TRANSFORM_WORLDSCALE,!0),this.event(Me.TRANSFORM_CHANGED,this._transformFlag);for(var e=0,t=this._children.length;e<t;e++)this._children[e]._onWorldPositionScaleTransform()}}},{key:"_onWorldPositionTransform",value:function(){if(!this._getTransformFlag(s.TRANSFORM_WORLDMATRIX)||!this._getTransformFlag(s.TRANSFORM_WORLDPOSITION)){this._setTransformFlag(s.TRANSFORM_WORLDMATRIX|s.TRANSFORM_WORLDPOSITION,!0),this.event(Me.TRANSFORM_CHANGED,this._transformFlag);for(var e=0,t=this._children.length;e<t;e++)this._children[e]._onWorldPositionTransform()}}},{key:"_onWorldRotationTransform",value:function(){if(!this._getTransformFlag(s.TRANSFORM_WORLDMATRIX)||!this._getTransformFlag(s.TRANSFORM_WORLDQUATERNION)||!this._getTransformFlag(s.TRANSFORM_WORLDEULER)){this._setTransformFlag(s.TRANSFORM_WORLDMATRIX|s.TRANSFORM_WORLDQUATERNION|s.TRANSFORM_WORLDEULER,!0),this.event(Me.TRANSFORM_CHANGED,this._transformFlag);for(var e=0,t=this._children.length;e<t;e++)this._children[e]._onWorldPositionRotationTransform()}}},{key:"_onWorldScaleTransform",value:function(){if(!this._getTransformFlag(s.TRANSFORM_WORLDMATRIX)||!this._getTransformFlag(s.TRANSFORM_WORLDSCALE)){this._setTransformFlag(s.TRANSFORM_WORLDMATRIX|s.TRANSFORM_WORLDSCALE,!0),this.event(Me.TRANSFORM_CHANGED,this._transformFlag);for(var e=0,t=this._children.length;e<t;e++)this._children[e]._onWorldPositionScaleTransform()}}},{key:"_onWorldTransform",value:function(){if(!(this._getTransformFlag(s.TRANSFORM_WORLDMATRIX)&&this._getTransformFlag(s.TRANSFORM_WORLDPOSITION)&&this._getTransformFlag(s.TRANSFORM_WORLDQUATERNION)&&this._getTransformFlag(s.TRANSFORM_WORLDEULER)&&this._getTransformFlag(s.TRANSFORM_WORLDSCALE))){this._setTransformFlag(s.TRANSFORM_WORLDMATRIX|s.TRANSFORM_WORLDPOSITION|s.TRANSFORM_WORLDQUATERNION|s.TRANSFORM_WORLDEULER|s.TRANSFORM_WORLDSCALE,!0),this.event(Me.TRANSFORM_CHANGED,this._transformFlag);for(var e=0,t=this._children.length;e<t;e++)this._children[e]._onWorldTransform()}}},{key:"translate",value:function(e){!(1<arguments.length&&void 0!==arguments[1])||arguments[1]?(Pa.createFromQuaternion(this.localRotation,s._tempMatrix0),R.transformCoordinate(e,s._tempMatrix0,s._tempVector30),R.add(this.localPosition,s._tempVector30,this._localPosition),this.localPosition=this._localPosition):(R.add(this.position,e,this._position),this.position=this._position)}},{key:"rotate",value:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],e=!(2<arguments.length&&void 0!==arguments[2])||arguments[2]?e:(R.scale(e,Math.PI/180,s._tempVector30),s._tempVector30);Ca.createFromYawPitchRoll(e.y,e.x,e.z,s._tempQuaternion0),t?(Ca.multiply(this._localRotation,s._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):(Ca.multiply(s._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)}},{key:"getForward",value:function(e){var t=this.worldMatrix.elements;e.x=-t[8],e.y=-t[9],e.z=-t[10]}},{key:"getUp",value:function(e){var t=this.worldMatrix.elements;e.x=t[4],e.y=t[5],e.z=t[6]}},{key:"getRight",value:function(e){var t=this.worldMatrix.elements;e.x=t[0],e.y=t[1],e.z=t[2]}},{key:"lookAt",value:function(e,t){var i,n;2<arguments.length&&void 0!==arguments[2]&&arguments[2]?(n=this._localPosition,Math.abs(n.x-e.x)<wa.zeroTolerance&&Math.abs(n.y-e.y)<wa.zeroTolerance&&Math.abs(n.z-e.z)<wa.zeroTolerance||(Ca.lookAt(this._localPosition,e,t,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation)):(n=i=this.position,Math.abs(n.x-e.x)<wa.zeroTolerance&&Math.abs(n.y-e.y)<wa.zeroTolerance&&Math.abs(n.z-e.z)<wa.zeroTolerance||(Ca.lookAt(i,e,t,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation))}},{key:"getWorldLossyScale",value:function(){var e;return this._getTransformFlag(s.TRANSFORM_WORLDSCALE)&&(null!==this._parent?(e=this._getScaleMatrix().elements,this._scale.x=e[0],this._scale.y=e[4],this._scale.z=e[8]):this._localScale.cloneTo(this._scale),this._setTransformFlag(s.TRANSFORM_WORLDSCALE,!1)),this._scale}},{key:"setWorldLossyScale",value:function(e){var t,i,n,a;null!==this._parent?(n=(i=t=s._tempMatrix3x33).elements,(a=this._parent._getScaleMatrix()).invert(a),Ia.createFromScaling(e,t),Ia.multiply(a,t,i),this._localScale.x=n[0],this._localScale.y=n[4],this._localScale.z=n[8]):e.cloneTo(this._localScale),this.localScale=this._localScale,this._scale!==e&&e.cloneTo(this._scale),this._setTransformFlag(s.TRANSFORM_WORLDSCALE,!1)}},{key:"scale",get:function(){return console.warn("Transfrm3D: discard function,please use getWorldLossyScale instead."),this.getWorldLossyScale()},set:function(e){console.warn("Transfrm3D: discard function,please use setWorldLossyScale instead."),this.setWorldLossyScale(e)}}]),s}()),Ga=(Ya._tempVector30=new R,Ya._tempQuaternion0=new Ca,Ya._tempMatrix0=new Pa,Ya._tempMatrix3x30=new Ia,Ya._tempMatrix3x31=new Ia,Ya._tempMatrix3x32=new Ia,Ya._tempMatrix3x33=new Ia,Ya.TRANSFORM_LOCALQUATERNION=1,Ya.TRANSFORM_LOCALEULER=2,Ya.TRANSFORM_LOCALMATRIX=4,Ya.TRANSFORM_WORLDPOSITION=8,Ya.TRANSFORM_WORLDQUATERNION=16,Ya.TRANSFORM_WORLDSCALE=32,Ya.TRANSFORM_WORLDMATRIX=64,Ya.TRANSFORM_WORLDEULER=128,Ya._angleToRandin=180/Math.PI,function(){f(h,ei);var n=T(h);function h(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,i=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return b(this,h),(e=n.call(this))._needProcessCollisions=!1,e._needProcessTriggers=!1,e._id=++h._uniqueIDCounter,e._transform=new Ya(O(e)),e._isStatic=i,e.layer=0,e.name=t||"New Sprite3D",e}return y(h,[{key:"id",get:function(){return this._id}},{key:"layer",get:function(){return this._layer},set:function(e){if(this._layer!==e){if(!(0<=e&&e<=30))throw new Error("Layer value must be 0-30.");this._layer=e}}},{key:"url",get:function(){return this._url}},{key:"isStatic",get:function(){return this._isStatic}},{key:"transform",get:function(){return this._transform}},{key:"_setCreateURL",value:function(e){this._url=re.formatURL(e)}},{key:"_changeAnimatorsToLinkSprite3D",value:function(e,t,i){var n=this.getComponent(Fa);n&&!n.avatar&&e._changeAnimatorToLinkSprite3DNoAvatar(n,t,i),this._parent&&this._parent instanceof h&&(i.unshift(this._parent.name),(n=this._parent)._hierarchyAnimator&&n._changeAnimatorsToLinkSprite3D(e,t,i))}},{key:"_setHierarchyAnimator",value:function(e,t){this._changeHierarchyAnimator(e),this._changeAnimatorAvatar(e.avatar);for(var i=0,n=this._children.length;i<n;i++){var a=this._children[i];a._hierarchyAnimator==t&&a._setHierarchyAnimator(e,t)}}},{key:"_clearHierarchyAnimator",value:function(e,t){this._changeHierarchyAnimator(t),this._changeAnimatorAvatar(t?t.avatar:null);for(var i=0,n=this._children.length;i<n;i++){var a=this._children[i];a._hierarchyAnimator==e&&a._clearHierarchyAnimator(e,t)}}},{key:"_changeHierarchyAnimatorAvatar",value:function(e,t){this._changeAnimatorAvatar(t);for(var i=0,n=this._children.length;i<n;i++){var a=this._children[i];a._hierarchyAnimator==e&&a._changeHierarchyAnimatorAvatar(e,t)}}},{key:"_changeAnimatorToLinkSprite3DNoAvatar",value:function(e,t,i){e._handleSpriteOwnersBySprite(t,i,this);for(var n=0,a=this._children.length;n<a;n++){var s=this._children[n],r=i.length;i.push(s.name),s._changeAnimatorToLinkSprite3DNoAvatar(e,t,i),i.splice(r,1)}}},{key:"_changeHierarchyAnimator",value:function(e){this._hierarchyAnimator=e}},{key:"_changeAnimatorAvatar",value:function(e){}},{key:"_onAdded",value:function(){var e;this._parent instanceof h&&(e=this._parent,this.transform._setParent(e.transform),e._hierarchyAnimator&&(this._hierarchyAnimator||this._setHierarchyAnimator(e._hierarchyAnimator,null),e._changeAnimatorsToLinkSprite3D(this,!0,[this.name]))),m(g(h.prototype),"_onAdded",this).call(this)}},{key:"_onRemoved",value:function(){var e;m(g(h.prototype),"_onRemoved",this).call(this),this._parent instanceof h&&(e=this._parent,this.transform._setParent(null),e._hierarchyAnimator&&(this._hierarchyAnimator==e._hierarchyAnimator&&this._clearHierarchyAnimator(e._hierarchyAnimator,null),e._changeAnimatorsToLinkSprite3D(this,!1,[this.name])))}},{key:"_parse",value:function(e,t){var i;void 0!==e.isStatic&&(this._isStatic=e.isStatic),void 0!==e.active&&(this.active=e.active),null!=e.name&&(this.name=e.name),void 0!==e.position&&((i=this.transform.localPosition).fromArray(e.position),this.transform.localPosition=i),void 0!==e.rotationEuler&&((i=this.transform.localRotationEuler).fromArray(e.rotationEuler),this.transform.localRotationEuler=i),void 0!==e.rotation&&((i=this.transform.localRotation).fromArray(e.rotation),this.transform.localRotation=i),void 0!==e.scale&&((i=this.transform.localScale).fromArray(e.scale),this.transform.localScale=i),null!=e.layer&&(this.layer=e.layer)}},{key:"_cloneTo",value:function(e,t,i){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var n=this._transform,a=e._transform;e.name=this.name,e.destroyed=this.destroyed,e.active=this.active,a.localPosition=n.localPosition,a.localRotation=n.localRotation,a.localScale=n.localScale,e._isStatic=this._isStatic,e.layer=this.layer,m(g(h.prototype),"_cloneTo",this).call(this,e,t,i)}},{key:"clone",value:function(){var e=h._createSprite3DInstance(this);return h._parseSprite3DInstance(this,e,this,e),e}},{key:"destroy",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this.destroyed||(m(g(h.prototype),"destroy",this).call(this,e),this._transform=null,this._scripts=null,this._url&&E.clearRes(this._url))}},{key:"_create",value:function(){return new h}}],[{key:"__init__",value:function(){}},{key:"instantiate",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,i=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null,s=e.clone(),t=(t&&t.addChild(s),s.transform);return i?(i=t.worldMatrix,e.transform.worldMatrix.cloneTo(i),t.worldMatrix=i):(n&&(t.position=n),a&&(t.rotation=a)),s}},{key:"load",value:function(e,t){o.loader.create(e,t,null,h.HIERARCHY)}},{key:"_createSprite3DInstance",value:function(e){for(var t=e._create(),i=e._children,n=0,a=i.length;n<a;n++){var s=h._createSprite3DInstance(i[n]);t.addChild(s)}return t}},{key:"_parseSprite3DInstance",value:function(e,t,i,n){for(var a=i._children,s=n._children,r=0,o=a.length;r<o;r++)h._parseSprite3DInstance(e,t,a[r],s[r]);i._cloneTo(n,e,t)}}]),h}()),Xa=(Ga.HIERARCHY="HIERARCHY",Ga.WORLDMATRIX=A.propertyNameToID("u_WorldMat"),Ga.MVPMATRIX=A.propertyNameToID("u_MvpMatrix"),Ga._uniqueIDCounter=0,function(){function e(){b(this,e),this.elements=[],this.length=0}return y(e,[{key:"_add",value:function(e){this.length===this.elements.length?this.elements.push(e):this.elements[this.length]=e}},{key:"add",value:function(e){this.length===this.elements.length?this.elements.push(e):this.elements[this.length]=e,this.length++}}]),e}()),Wa=function(){f(t,Xa);var e=T(t);function t(){return b(this,t),e.call(this)}return y(t,[{key:"add",value:function(e){if(-1!==e._getIndexInList())throw"SimpleSingletonList:"+e+" has  in  SingletonList.";this._add(e),e._setIndexInList(this.length++)}},{key:"remove",value:function(e){var t,i=e._getIndexInList();this.length--,i!==this.length&&(t=this.elements[this.length],(this.elements[i]=t)._setIndexInList(i)),e._setIndexInList(-1)}},{key:"clear",value:function(){for(var e,t=this.elements,i=this.length;e<i;e++)t[e]._setIndexInList(-1);this.length=0}}]),t}(),i=function(){function a(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1;b(this,a),this.r=e,this.g=t,this.b=i,this.a=n}return y(a,[{key:"toLinear",value:function(e){e.r=a.gammaToLinearSpace(this.r),e.g=a.gammaToLinearSpace(this.g),e.b=a.gammaToLinearSpace(this.b)}},{key:"toGamma",value:function(e){e.r=a.linearToGammaSpace(this.r),e.g=a.linearToGammaSpace(this.g),e.b=a.linearToGammaSpace(this.b)}},{key:"cloneTo",value:function(e){e.r=this.r,e.g=this.g,e.b=this.b,e.a=this.a}},{key:"clone",value:function(){var e=new a;return this.cloneTo(e),e}},{key:"forNativeElement",value:function(){}}],[{key:"gammaToLinearSpace",value:function(e){return e<=.04045?e/12.92:e<1?Math.pow((e+.055)/1.055,2.4):Math.pow(e,2.4)}},{key:"linearToGammaSpace",value:function(e){return e<=0?0:e<=.0031308?12.92*e:e<=1?1.055*Math.pow(e,.41666)-.055:Math.pow(e,.41666)}}]),a}(),Ha=(i.RED=new i(1,0,0,1),i.GREEN=new i(0,1,0,1),i.BLUE=new i(0,0,1,1),i.CYAN=new i(0,1,1,1),i.YELLOW=new i(1,.92,.016,1),i.MAGENTA=new i(1,0,1,1),i.GRAY=new i(.5,.5,.5,1),i.WHITE=new i(1,1,1,1),i.BLACK=new i(0,0,0,1),function(){function t(){b(this,t),this._batchRenderElementPool=[]}return y(t,[{key:"_clear",value:function(){this._batchRenderElementPoolIndex=0}},{key:"_getBatchRenderElementFromPool",value:function(){throw"StaticBatch:must override this function."}},{key:"dispose",value:function(){}}],[{key:"_registerManager",value:function(e){t._managers.push(e)}}]),t}()),ja=(Ha._managers=[],function(){f(i,Ga);var t=T(i);function i(e){return b(this,i),t.call(this,e)}return y(i,[{key:"_onInActive",value:function(){m(g(i.prototype),"_onInActive",this).call(this),this._scene._removeRenderObject(this._render)}},{key:"_onActive",value:function(){m(g(i.prototype),"_onActive",this).call(this),this._scene._addRenderObject(this._render)}},{key:"_onActiveInScene",value:function(){var e,t;m(g(i.prototype),"_onActiveInScene",this).call(this),Ta.Laya3D._editerEnvironment&&(e=this._scene,t=new Sa,e._allotPickColorByID(this.id,t),(e._pickIdToSprite[this.id]=this)._render._shaderValues.setVector(i.PICKCOLOR,t))}},{key:"_addToInitStaticBatchManager",value:function(){}},{key:"_setBelongScene",value:function(e){m(g(i.prototype),"_setBelongScene",this).call(this,e),this._render._setBelongScene(e)}},{key:"_setUnBelongScene",value:function(){this._render._shaderValues.removeDefine(i.SAHDERDEFINE_LIGHTMAP),m(g(i.prototype),"_setUnBelongScene",this).call(this)}},{key:"_changeHierarchyAnimator",value:function(e){var t;this._hierarchyAnimator&&(t=this._hierarchyAnimator._renderableSprites).splice(t.indexOf(this),1),e&&e._renderableSprites.push(this),m(g(i.prototype),"_changeHierarchyAnimator",this).call(this,e)}},{key:"destroy",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];m(g(i.prototype),"destroy",this).call(this,e),this._render._destroy(),this._render=null}},{key:"_create",value:function(){return new i(this.name)}}],[{key:"__init__",value:function(){i.SHADERDEFINE_RECEIVE_SHADOW=A.getDefineByName("RECEIVESHADOW"),i.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=A.getDefineByName("SCALEOFFSETLIGHTINGMAPUV"),i.SAHDERDEFINE_LIGHTMAP=A.getDefineByName("LIGHTMAP")}}]),i}()),qa=(ja.LIGHTMAPSCALEOFFSET=A.propertyNameToID("u_LightmapScaleOffset"),ja.LIGHTMAP=A.propertyNameToID("u_LightMap"),ja.PICKCOLOR=A.propertyNameToID("u_PickColor"),function(){function o(){b(this,o),this._initBatchSprites=[],this._staticBatches={},this._batchRenderElementPoolIndex=0,this._batchRenderElementPool=[]}return y(o,[{key:"_partition",value:function(e,t,i){for(var n=e[Math.floor((i+t)/2)];t<=i;){for(;this._compare(e[t],n)<0;)t++;for(;0<this._compare(e[i],n);)i--;if(t<i){var a=e[t];e[t]=e[i],e[i]=a,t++,i--}else if(t===i){t++;break}}return t}},{key:"_quickSort",value:function(e,t,i){var n,a;1<e.length&&(t<(a=(n=this._partition(e,t,i))-1)&&this._quickSort(e,t,a),n<i&&this._quickSort(e,n,i))}},{key:"_compare",value:function(e,t){throw"StaticBatch:must override this function."}},{key:"_initStaticBatchs",value:function(e){throw"StaticBatch:must override this function."}},{key:"_getBatchRenderElementFromPool",value:function(){throw"StaticBatch:must override this function."}},{key:"_addBatchSprite",value:function(e){this._initBatchSprites.push(e)}},{key:"_clear",value:function(){this._batchRenderElementPoolIndex=0}},{key:"_garbageCollection",value:function(){throw"StaticBatchManager: must override it."}},{key:"dispose",value:function(){this._staticBatches=null}}],[{key:"_addToStaticBatchQueue",value:function(e,t){e instanceof ja&&t.push(e);for(var i=0,n=e.numChildren;i<n;i++)o._addToStaticBatchQueue(e._children[i],t)}},{key:"_registerManager",value:function(e){o._managers.push(e)}},{key:"combine",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,i=(t||(t=[],e&&o._addToStaticBatchQueue(e,t)),t.length);if(0<i){for(var n=0;n<i;n++){var a=t[n];a.destroyed||(a._render._isPartOfStaticBatch?console.warn("StaticBatchManager: Sprite "+a.name+" has a part of Static Batch,it will be ignore."):a._addToInitStaticBatchManager())}for(var s=0,r=o._managers.length;s<r;s++)o._managers[s]._initStaticBatchs(e)}}}]),o}()),Ka=(qa._managers=[],function(){function v(){b(this,v)}return y(v,null,[{key:"__init__",value:function(){Bt.supportWebGLPlusCulling&&(v._cullingBufferLength=0,v._cullingBuffer=new Float32Array(4096))}},{key:"_drawTraversalCullingBound",value:function(e,t){e.length;for(var i=e.elements,n=0,a=e.length;n<a;n++){var s=v._tempColor0;s.r=0,s.g=1,s.b=0,s.a=1,Ra._drawBound(t,i[n].bounds._getBoundBox(),s)}}},{key:"_traversalCulling",value:function(e,t,i,n,a,s,r){for(var o=n.elements,h=e.boundFrustum,l=e._transform.position,u=0,c=n.length;u<c;u++){var _=o[u],f=r?_._castShadow&&_._enable:e._isLayerVisible(_._owner._layer)&&_._enable;if(f)if(k.frustumCulling++,!e.useOcclusionCulling||_._needRender(h,i)){_._visible=!0,_._distanceForSort=R.distance(_.bounds.getCenter(),l);for(var d=_._renderElements,p=0,y=d.length;p<y;p++)d[p]._update(t,i,a,s)}else _._visible=!1;else _._visible=!1}}},{key:"renderObjectCulling",value:function(e,t,i,n,a,s){for(var r=t._opaqueQueue,o=t._transparentQueue,h=t._renders,l=(r.clear(),o.clear(),qa._managers),u=0,c=l.length;u<c;u++)l[u]._clear();var _=Ha._managers;for(u=0,c=_.length;u<c;u++)_[u]._clear();var f=t._octree,i=(f&&(f.updateMotionObjects(),f.shrinkRootIfPossible(),f.getCollidingWithFrustum(i,n,a,s)),v._traversalCulling(e,t,i,h,n,a,s),v.debugFrustumCulling&&((e=t._debugTool).clear(),f&&(f.drawAllBounds(e),f.drawAllObjects(e)),v._drawTraversalCullingBound(h,e)),r.elements.length);0<i&&r._quickSort(0,i-1),0<(i=o.elements.length)&&o._quickSort(0,i-1)}},{key:"renderObjectCullingNative",value:function(e,t,i,n,a,s){for(var r=t._opaqueQueue,o=t._transparentQueue,h=(r.clear(),o.clear(),qa._managers),l=0,u=h.length;l<u;l++)h[l]._clear();var c=Ha._managers;for(l=0,u=c.length;l<u;l++)c[l]._clear();var _=n.length,f=n.elements;for(l=0;l<_;l++)f[l].bounds,f[l]._updateForNative&&f[l]._updateForNative(i);e.boundFrustum;v.cullingNative(e._boundFrustumBuffer,v._cullingBuffer,t._cullingBufferIndices,_,t._cullingBufferResult);var d=i.camera._transform.position;for(l=0;l<_;l++){var p=f[l];if(!e.useOcclusionCulling||e._isLayerVisible(p._owner._layer)&&p._enable&&t._cullingBufferResult[l]){p._visible=!0,p._distanceForSort=R.distance(p.bounds.getCenter(),d);for(var y=p._renderElements,g=0,m=y.length;g<m;g++)y[g]._update(t,i,a,s)}else p._visible=!1}n=r.elements.length;0<n&&r._quickSort(0,n-1),0<(n=o.elements.length)&&o._quickSort(0,n-1)}},{key:"cullingNative",value:function(e,t,i,n,a){return S.instance.culling(e,t,i,n,a)}}]),v}()),n=(Ka._tempVector3=new R,Ka._tempColor0=new i,Ka.debugFrustumCulling=!1,y(function e(){b(this,e)})),Qa=y(function e(){b(this,e),this.updateMark=-1,this.pointLightCount=0,this.spotLightCount=0,this.indices=[]}),Za=function(){function p(e,t,i,n){b(this,p),this._updateMark=0,this._depthSliceParam=new ba;for(var e=(this._xSlices=e)*(this._ySlices=t),t=(this._zSlices=i)*(1+Math.ceil(n/4)),a=(this._clusterTexture=Ra._createFloatTextureBuffer(e,t),this._clusterTexture.lock=!0,this._clusterPixels=new Float32Array(e*t*4),new Array(this._zSlices)),s=0;s<this._zSlices;s++){a[s]=new Array(this._ySlices);for(var r=0;r<this._ySlices;r++){a[s][r]=new Array(this._xSlices);for(var o=0;o<this._xSlices;o++)a[s][r][o]=new Qa}}this._clusterDatas=a}return y(p,[{key:"_insertSpotLightSphere",value:function(e,t,i,n,a){var s=p._tempVector35,e=(s.x=a.x-e.x,s.y=a.y-e.y,s.z=a.z-e.z,R.dot(s,s)),a=a.w;if(!(a*a<e))return!1;s=R.dot(s,t);return!(a<Math.cos(n)*Math.sqrt(e-s*s)-s*Math.sin(n)||a+i<s||s<-a)}},{key:"_placePointLightToClusters",value:function(e,t){for(var i=this._clusterDatas,n=this._updateMark,a=t.zMin,s=t.zMax;a<s;a++)for(var r=t.yMin,o=t.yMax;r<o;r++)for(var h=t.xMin,l=t.xMax;h<l;h++){var u=i[a][r][h],c=(u.updateMark!=n&&(u.pointLightCount=0,u.spotLightCount=0,u.updateMark=n),u.indices),u=u.pointLightCount++;u<c.length?c[u]=e:c.push(e)}}},{key:"_placeSpotLightToClusters",value:function(e,t){for(var i=this._clusterDatas,n=this._updateMark,a=t.zMin,s=t.zMax;a<s;a++)for(var r=t.yMin,o=t.yMax;r<o;r++)for(var h=t.xMin,l=t.xMax;h<l;h++){var u=i[a][r][h],c=(u.updateMark!=n&&(u.pointLightCount=0,u.spotLightCount=0,u.updateMark=n),u.indices),u=u.pointLightCount+u.spotLightCount++;u<c.length?c[u]=e:c.push(e)}}},{key:"_insertConePlane",value:function(e,t,i,n,a){var s=p._tempVector36,r=p._tempVector37,s=(R.cross(a,t,s),R.cross(s,t,r),R.normalize(r,r),i*Math.tan(n)),n=e.x+i*t.x+s*r.x,o=e.y+i*t.y+s*r.y,i=e.z+i*t.z+s*r.z;return n*a.x+o*a.y+i*a.z<=0||e.x*a.x+e.y*a.y+e.z*a.z<=0}},{key:"_shrinkSphereLightZPerspective",value:function(e,t,i,n,a){var i=i.z,s=i-n,i=i+n;if(t<s||i<=e)return!1;n=this._depthSliceParam;return a.zMin=Math.floor(Math.log2(Math.max(s,e))*n.x-n.y),a.zMax=Math.min(Math.ceil(Math.log2(i)*n.x-n.y),this._zSlices),!0}},{key:"_shrinkSpotLightZPerspective",value:function(e,t,i,n,a,s,r){var o=n.x,h=n.y,n=n.z,s=Math.tan(s)*a,l=i.x,u=i.y,c=i.z,o=o-l,l=h-u,h=n-c,u=Math.sqrt(1-h*h/(o*o+l*l+h*h)),o=Math.max(Math.min(c,n-u*s),i.z-a),l=Math.min(Math.max(c,n+u*s),i.z+a);if(t<o||l<=e)return!1;h=this._depthSliceParam;return r.zMin=Math.floor(Math.log2(Math.max(o,e))*h.x-h.y),r.zMax=Math.min(Math.ceil(Math.log2(l)*h.x-h.y),this._zSlices),!0}},{key:"_shrinkSphereLightByBoundOrth",value:function(e,t,i,n,a,s,r){var o=a.z,h=o-s,o=o+s;if(n<h||o<=i)return!1;var n=a.x,l=n-s,n=n+s;if(e<l||n<=-e)return!1;var a=a.y,u=a-s,a=a+s;if(t<u||a<=-t)return!1;var s=this._xSlices,c=this._ySlices,_=this._depthSliceParam,f=2*e/s,d=2*t/c;return r.xMin=Math.max(Math.floor((l+e)/f),0),r.xMax=Math.min(Math.ceil((n+e)/f),s),r.yMin=Math.max(Math.floor((t-a)/d),0),r.yMax=Math.min(Math.ceil((t-u)/d),c),r.zMin=Math.floor(Math.log2(Math.max(h,i))*_.x-_.y),r.zMax=Math.min(Math.ceil(Math.log2(o)*_.x-_.y),this._zSlices),!0}},{key:"_shrinkSpotLightByBoundOrth",value:function(e,t,i,n,a,s,r,o,h){var l=s.x,u=s.y,s=s.z,o=Math.tan(o)*r,c=a.x,_=a.y,f=a.z,d=l-c,p=u-_,y=s-f,g=d*d+p*p+y*y,y=Math.sqrt(1-y*y/g),m=Math.max(Math.min(f,s-y*o),a.z-r),f=Math.min(Math.max(f,s+y*o),a.z+r);if(n<m||f<=i)return!1;s=Math.sqrt(1-d*d/g),y=Math.max(Math.min(c,l-s*o),a.x-r),n=Math.min(Math.max(c,l+s*o),a.x+r);if(e<y||n<=-e)return!1;d=Math.sqrt(1-p*p/g),c=Math.max(Math.min(_,u-d*o),a.y-r),l=Math.min(Math.max(_,u+d*o),a.y+r);if(t<c||l<=-t)return!1;s=this._xSlices,p=this._ySlices,g=this._depthSliceParam,_=2*e/s,u=2*t/p;return h.xMin=Math.max(Math.floor((y+e)/_),0),h.xMax=Math.min(Math.ceil((n+e)/_),s),h.yMin=Math.max(Math.floor((t-l)/u),0),h.yMax=Math.min(Math.ceil((t-c)/u),p),h.zMin=Math.floor(Math.log2(Math.max(m,i))*g.x-g.y),h.zMax=Math.min(Math.ceil(Math.log2(f)*g.x-g.y),this._zSlices),!0}},{key:"_shrinkXYByRadiusPerspective",value:function(e,t,i,n,a){for(var s,r,o,h,l,u=e.x,c=e.y,_=e.z,f=this._ySlices+1,d=0;d<f;d++)if(c*(l=a[d]).y+_*l.z<t){r=Math.max(0,d-1);break}if(d==f)return!1;for(h=this._ySlices,d=r+1;d<f;d++)if(c*(l=a[d]).y+_*l.z<=-t){h=Math.max(0,d);break}for(f=this._xSlices+1,d=0;d<f;d++)if(u*(l=n[d]).x+_*l.z<t){s=Math.max(0,d-1);break}for(o=this._xSlices,d=s+1;d<f;d++)if(u*(l=n[d]).x+_*l.z<=-t){o=Math.max(0,d);break}return i.xMin=s,i.xMax=o,i.yMin=r,i.yMax=h,!0}},{key:"_shrinkSpotXYByConePerspective",value:function(e,t,i,n,a,s,r){for(var o,h,l=p._tempVector32,u=a.yMax+1,c=a.yMin+1;c<u;c++)if(this._insertConePlane(e,t,i,n,r[c])){h=Math.max(0,c-1);break}for(var _=a.yMax,c=h+1;c<u;c++){var f=r[c];if(l.setValue(0,-f.y,-f.z),!this._insertConePlane(e,t,i,n,l)){_=Math.max(0,c);break}}for(u=a.xMax+1,c=a.xMin+1;c<u;c++)if(this._insertConePlane(e,t,i,n,s[c])){o=Math.max(0,c-1);break}for(var d=a.xMax,c=o+1;c<u;c++){f=s[c];if(l.setValue(-f.x,0,-f.z),!this._insertConePlane(e,t,i,n,l)){d=Math.max(0,c);break}}a.xMin=o,a.xMax=d,a.yMin=h,a.yMax=_}},{key:"_updatePointLightPerspective",value:function(e,t,i,n,a,s,r){var o=p._tempLightBound,h=p._tempVector30;R.transformV3ToV3(n._transform.position,i,h),h.z*=-1,this._shrinkSphereLightZPerspective(e,t,h,n.range,o)&&this._shrinkXYByRadiusPerspective(h,n.range,o,s,r)&&this._placePointLightToClusters(a,o)}},{key:"_updateSpotLightPerspective",value:function(e,t,i,n,a,s,r){var o=p._tempLightBound,h=p._tempVector30,l=p._tempVector31,u=p._tempVector34,c=n._transform.position,_=n.range,l=(n._transform.worldMatrix.getForward(l),R.normalize(l,l),R.scale(l,_,u),R.add(c,u,u),R.transformV3ToV3(c,i,h),R.transformV3ToV3(u,i,u),h.z*=-1,u.z*=-1,n.spotAngle/2*Math.PI/180);this._shrinkSpotLightZPerspective(e,t,h,u,_,l,o)&&this._shrinkXYByRadiusPerspective(h,_,o,s,r)&&((c=p._tempVector33).x=u.x-h.x,c.y=u.y-h.y,c.z=u.z-h.z,R.normalize(c,c),this._shrinkSpotXYByConePerspective(h,c,_,l,o,s,r),this._placeSpotLightToClusters(a,o))}},{key:"_updatePointLightOrth",value:function(e,t,i,n,a,s,r){var o=p._tempLightBound,h=p._tempVector30;R.transformV3ToV3(s._transform.position,a,h),h.z*=-1,this._shrinkSphereLightByBoundOrth(e,t,i,n,h,s.range,o)&&this._placePointLightToClusters(r,o)}},{key:"_updateSpotLightOrth",value:function(e,t,i,n,a,s,r){var o=p._tempLightBound,h=p._tempVector30,l=p._tempVector31,u=p._tempVector34,c=s._transform.position,_=s.range,l=(s._transform.worldMatrix.getForward(l),R.normalize(l,l),R.scale(l,_,u),R.add(c,u,u),R.transformV3ToV3(c,a,h),R.transformV3ToV3(u,a,u),h.z*=-1,u.z*=-1,s.spotAngle/2*Math.PI/180);this._shrinkSpotLightByBoundOrth(e,t,i,n,h,u,_,l,o)&&this._placeSpotLightToClusters(r,o)}},{key:"update",value:function(e,t){this._updateMark++;var i=e.nearPlane,n=(this._depthSliceParam.x=Va._config.lightClusterCount.z/Math.log2(e.farPlane/i),this._depthSliceParam.y=Math.log2(i)*this._depthSliceParam.x,e.nearPlane),a=e.farPlane,s=e.viewMatrix,r=t._directionLights._length,i=t._pointLights,o=i._length,h=i._elements,i=t._spotLights,l=i._length,u=i._elements;if(e.orthographic){for(var c=e.orthographicVerticalSize/2,_=c*e.aspectRatio,f=0;f<o;f++,r++)this._updatePointLightOrth(_,c,n,a,s,h[f],r);for(f=0;f<l;f++,r++)this._updateSpotLightOrth(_,c,n,a,s,u[f],r)}else{e._updateClusterPlaneXY();for(var d=e._clusterXPlanes,p=e._clusterYPlanes,f=0;f<o;f++,r++)this._updatePointLightPerspective(n,a,s,h[f],r,d,p);for(f=0;f<l;f++,r++)this._updateSpotLightPerspective(n,a,s,u[f],r,d,p)}if(0<o+l){for(var y=this._xSlices,g=this._ySlices,m=this._zSlices,v=y*g*4,x=v*m,k=this._clusterPixels,w=k.length,b=this._clusterDatas,S=this._updateMark,I=!0,T=0;T<m;T++)for(var C=0;C<g;C++)for(var M=0;M<y;M++){var E=b[T][C][M],R=4*(M+C*y+T*y*g);if(E.updateMark!==S)k[R]=0,k[1+R]=0;else if(I){var A=E.indices,L=E.pointLightCount,E=E.spotLightCount,N=L+E;if(x+N<w){k[R]=L,k[1+R]=E,k[2+R]=Math.floor(x/v),k[3+R]=x%v;for(f=0;f<N;f++)k[x++]=A[f]}else{N=w-(x+N),L=Math.min(L,N),k[R]=L,k[1+R]=Math.min(E,N-L),k[2+R]=Math.floor(x/v),k[3+R]=x%v;for(f=0;f<N;f++)k[x++]=A[f];I=!1}}}t=this._clusterTexture.width;this._clusterTexture.setSubPixels(0,0,t,Math.ceil(x/(4*t)),k)}}}]),p}(),Ja=(Za._tempVector30=new R,Za._tempVector31=new R,Za._tempVector32=new R,Za._tempVector33=new R,Za._tempVector34=new R,Za._tempVector35=new R,Za._tempVector36=new R,Za._tempVector37=new R,Za._tempLightBound=new n,y(function e(){b(this,e),this._pressedSprite=null,this._pressedLoopCount=-1,this.sprite=null,this.mousePositionX=0,this.mousePositionY=0})),$a=function(){function e(){b(this,e),this._indexInList=-1,this._identifier=-1,this._position=new ba}return y(e,[{key:"identifier",get:function(){return this._identifier}},{key:"position",get:function(){return this._position}},{key:"_getIndexInList",value:function(){return this._indexInList}},{key:"_setIndexInList",value:function(e){this._indexInList=e}}]),e}(),es=function(){function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;b(this,n),this._ownerResource=null,this._data=null,this._defineDatas=new Ua,this._runtimeCopyValues=[],this._ownerResource=e,this._initData()}return y(n,[{key:"_initData",value:function(){this._data=new Object}},{key:"getData",value:function(){return this._data}},{key:"addDefine",value:function(e){this._defineDatas.add(e)}},{key:"removeDefine",value:function(e){this._defineDatas.remove(e)}},{key:"hasDefine",value:function(e){return this._defineDatas.has(e)}},{key:"clearDefine",value:function(){this._defineDatas.clear()}},{key:"getBool",value:function(e){return this._data[e]}},{key:"setBool",value:function(e,t){this._data[e]=t}},{key:"getInt",value:function(e){return this._data[e]}},{key:"setInt",value:function(e,t){this._data[e]=t}},{key:"getNumber",value:function(e){return this._data[e]}},{key:"setNumber",value:function(e,t){this._data[e]=t}},{key:"getVector2",value:function(e){return this._data[e]}},{key:"setVector2",value:function(e,t){this._data[e]=t}},{key:"getVector3",value:function(e){return this._data[e]}},{key:"setVector3",value:function(e,t){this._data[e]=t}},{key:"getVector",value:function(e){return this._data[e]}},{key:"setVector",value:function(e,t){this._data[e]=t}},{key:"getQuaternion",value:function(e){return this._data[e]}},{key:"setQuaternion",value:function(e,t){this._data[e]=t}},{key:"getMatrix4x4",value:function(e){return this._data[e]}},{key:"setMatrix4x4",value:function(e,t){this._data[e]=t}},{key:"getBuffer",value:function(e){return this._data[e]}},{key:"setBuffer",value:function(e,t){this._data[e]=t}},{key:"setTexture",value:function(e,t){var i=this._data[e];this._data[e]=t,this._ownerResource&&0<this._ownerResource.referenceCount&&(i&&i._removeReference(),t&&t._addReference())}},{key:"getTexture",value:function(e){return this._data[e]}},{key:"setAttribute",value:function(e,t){this._data[e]=t}},{key:"getAttribute",value:function(e){return this._data[e]}},{key:"getLength",value:function(){return this._data.length}},{key:"setLength",value:function(e){this._data.length=e}},{key:"cloneTo",value:function(e){var t,i=e._data;for(t in this._data){var n,a,s=this._data[t];null!=s&&("number"==typeof s||"boolean"==typeof s?i[t]=s:s instanceof ba?(n=i[t]||(i[t]=new ba),s.cloneTo(n),i[t]=n):s instanceof R?(n=i[t]||(i[t]=new R),s.cloneTo(n),i[t]=n):s instanceof Sa?(a=i[t]||(i[t]=new Sa),s.cloneTo(a),i[t]=a):s instanceof Pa?(a=i[t]||(i[t]=new Pa),s.cloneTo(a),i[t]=a):s instanceof le&&(i[t]=s))}this._defineDatas.cloneTo(e._defineDatas)}},{key:"clone",value:function(){var e=new n;return this.cloneTo(e),e}},{key:"cloneToForNative",value:function(e){var t=e,i=(0<this._int32Data.length-t._int32Data.length&&t.needRenewArrayBufferForNative(this._int32Data.length),t._int32Data.set(this._int32Data,0),t._nativeArray),n=this._nativeArray.length;i.length=n;for(var a=0;a<n;a++){var s,r,o=this._nativeArray[a];o&&("number"==typeof o?(i[a]=o,t.setNumber(a,o)):"boolean"==typeof o?(i[a]=o,t.setBool(a,o)):o instanceof ba?(s=i[a]||(i[a]=new ba),o.cloneTo(s),i[a]=s,t.setVector2(a,s)):o instanceof R?(s=i[a]||(i[a]=new R),o.cloneTo(s),i[a]=s,t.setVector3(a,s)):o instanceof Sa?(r=i[a]||(i[a]=new Sa),o.cloneTo(r),i[a]=r,t.setVector(a,r)):o instanceof Pa?(r=i[a]||(i[a]=new Pa),o.cloneTo(r),i[a]=r,t.setMatrix4x4(a,r)):o instanceof le&&(i[a]=o,t.setTexture(a,o)))}this._defineDatas.cloneTo(t._defineDatas)}},{key:"_initDataForNative",value:function(){this._frameCount=-1,this._runtimeCopyValues.length=0,this._nativeArray=[],this._data=new ArrayBuffer(32),this._int32Data=new Int32Array(this._data),this._float32Data=new Float32Array(this._data),S.instance.createArrayBufferRef(this._data,S.ARRAY_BUFFER_TYPE_DATA,!0)}},{key:"needRenewArrayBufferForNative",value:function(e){var t,i,n;e>=this._int32Data.length&&(t=this._int32Data,i=this._data.conchRef,n=this._data._ptrID,this._data=new ArrayBuffer(4*(e+1)),this._int32Data=new Int32Array(this._data),this._float32Data=new Float32Array(this._data),this._data.conchRef=i,this._data._ptrID=n,t&&this._int32Data.set(t,0),((e=S.instance).updateArrayBufferRef?e:window.conch).updateArrayBufferRef(this._data._ptrID,i.isSyncToRender(),this._data))}},{key:"getDataForNative",value:function(){return this._nativeArray}},{key:"getIntForNative",value:function(e){return this._int32Data[e]}},{key:"setIntForNative",value:function(e,t){this.needRenewArrayBufferForNative(e),this._int32Data[e]=t,this._nativeArray[e]=t}},{key:"getBoolForNative",value:function(e){return 1==this._int32Data[e]}},{key:"setBoolForNative",value:function(e,t){this.needRenewArrayBufferForNative(e),this._int32Data[e]=t?1:0,this._nativeArray[e]=t}},{key:"getNumberForNative",value:function(e){return this._float32Data[e]}},{key:"setNumberForNative",value:function(e,t){this.needRenewArrayBufferForNative(e),this._float32Data[e]=t,this._nativeArray[e]=t}},{key:"getMatrix4x4ForNative",value:function(e){return this._nativeArray[e]}},{key:"setMatrix4x4ForNative",value:function(e,t){this.needRenewArrayBufferForNative(e),this._nativeArray[e]=t;t=this.setReferenceForNative(t.elements);this._int32Data[e]=t}},{key:"getVectorForNative",value:function(e){return this._nativeArray[e]}},{key:"setVectorForNative",value:function(e,t){this.needRenewArrayBufferForNative(e),(this._nativeArray[e]=t).elements||t.forNativeElement();t=this.setReferenceForNative(t.elements);this._int32Data[e]=t}},{key:"getVector2ForNative",value:function(e){return this._nativeArray[e]}},{key:"setVector2ForNative",value:function(e,t){this.needRenewArrayBufferForNative(e),(this._nativeArray[e]=t).elements||t.forNativeElement();t=this.setReferenceForNative(t.elements);this._int32Data[e]=t}},{key:"getVector3ForNative",value:function(e){return this._nativeArray[e]}},{key:"setVector3ForNative",value:function(e,t){this.needRenewArrayBufferForNative(e),(this._nativeArray[e]=t).elements||t.forNativeElement();t=this.setReferenceForNative(t.elements);this._int32Data[e]=t}},{key:"getQuaternionForNative",value:function(e){return this._nativeArray[e]}},{key:"setQuaternionForNative",value:function(e,t){this.needRenewArrayBufferForNative(e),(this._nativeArray[e]=t).elements||t.forNativeElement();t=this.setReferenceForNative(t.elements);this._int32Data[e]=t}},{key:"getBufferForNative",value:function(e){return this._nativeArray[e]}},{key:"setBufferForNative",value:function(e,t){this.needRenewArrayBufferForNative(e),this._nativeArray[e]=t;t=this.setReferenceForNative(t);this._int32Data[e]=t}},{key:"getAttributeForNative",value:function(e){return this._nativeArray[e]}},{key:"setAttributeForNative",value:function(e,t){(this._nativeArray[e]=t)._ptrID||S.instance.createArrayBufferRef(t,S.ARRAY_BUFFER_TYPE_DATA,!0),S.instance.syncBufferToRenderThread(t),this._int32Data[e]=t._ptrID}},{key:"getTextureForNative",value:function(e){return this._nativeArray[e]}},{key:"setTextureForNative",value:function(e,t){var i,n;t&&(this.needRenewArrayBufferForNative(e),i=this._nativeArray[e],n=(this._nativeArray[e]=t)._getSource()||t.defaulteTexture._getSource(),this._int32Data[e]=n.id,this._ownerResource&&0<this._ownerResource.referenceCount&&(i&&i._removeReference(),t&&t._addReference()))}},{key:"setReferenceForNative",value:function(e){this.clearRuntimeCopyArray();var t=0,i=0;return n._SET_RUNTIME_VALUE_MODE_REFERENCE_?(S.instance.createArrayBufferRefs(e,S.ARRAY_BUFFER_TYPE_DATA,!0,S.ARRAY_BUFFER_REF_REFERENCE),i=e.getPtrID(t=0)):(S.instance.createArrayBufferRefs(e,S.ARRAY_BUFFER_TYPE_DATA,!0,S.ARRAY_BUFFER_REF_COPY),t=e.getRefNum()-1,i=e.getPtrID(t),this._runtimeCopyValues.push({obj:e,refID:t,ptrID:i})),S.instance.syncBufferToRenderThread(e,t),i}},{key:"clearRuntimeCopyArray",value:function(){var e=k.loopCount;if(this._frameCount!=e){this._frameCount=e;for(var t=0,i=this._runtimeCopyValues.length;t<i;t++)this._runtimeCopyValues[t].obj.clearRefNum();this._runtimeCopyValues.length=0}}}],[{key:"setRuntimeValueMode",value:function(e){n._SET_RUNTIME_VALUE_MODE_REFERENCE_=e}}]),n}(),ts=(es._SET_RUNTIME_VALUE_MODE_REFERENCE_=!0,function(){f(t,je);var e=T(t);function t(){return b(this,t),e.call(this)}return y(t,[{key:"applyVertexBuffer",value:function(e){if(je._curBindedBufferState!==this)throw"BufferState: must call bind() function first.";var t,i=S.instance,n=e.vertexDeclaration,a=n._shaderValues.getData();for(t in this.vertexDeclaration=n,e.bind(),a){var s=parseInt(t),r=a[t];i.enableVertexAttribArray(s),i.vertexAttribPointer(s,r[0],r[1],!!r[2],r[3],r[4])}}},{key:"applyVertexBuffers",value:function(e){if(je._curBindedBufferState!==this)throw"BufferState: must call bind() function first.";for(var t=S.instance,i=0,n=e.length;i<n;i++){var a,s=e[i],r=s.vertexDeclaration._shaderValues.getData();for(a in s.bind(),r){var o=parseInt(a),h=r[a];t.enableVertexAttribArray(o),t.vertexAttribPointer(o,h[0],h[1],!!h[2],h[3],h[4])}}}},{key:"applyInstanceVertexBuffer",value:function(e){if(S.layaGPUInstance.supportInstance()){if(je._curBindedBufferState!==this)throw"BufferState: must call bind() function first.";var t,i=S.instance,n=e.vertexDeclaration._shaderValues.getData();for(t in e.bind(),n){var a=parseInt(t),s=n[t];i.enableVertexAttribArray(a),i.vertexAttribPointer(a,s[0],s[1],!!s[2],s[3],s[4]),S.layaGPUInstance.vertexAttribDivisor(a,1)}}}},{key:"applyIndexBuffer",value:function(e){if(je._curBindedBufferState!==this)throw"BufferState: must call bind() function first.";this._bindedIndexBuffer!==e&&(e._bindForVAO(),this._bindedIndexBuffer=e)}}]),t}()),is=((e=Zi=Zi||{})[e.UInt8=0]="UInt8",e[e.UInt16=1]="UInt16",e[e.UInt32=2]="UInt32",function(){f(o,Ke);var r=T(o);function o(e,t){var i,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:35044,a=3<arguments.length&&void 0!==arguments[3]&&arguments[3];switch(b(this,o),(i=r.call(this))._indexType=e,i._indexCount=t,i._bufferUsage=n,i._bufferType=S.instance.ELEMENT_ARRAY_BUFFER,i._canRead=a,e){case Zi.UInt32:i._indexTypeByteCount=4;break;case Zi.UInt16:i._indexTypeByteCount=2;break;case Zi.UInt8:i._indexTypeByteCount=1;break;default:throw new Error("unidentification index type.")}var n=i._indexTypeByteCount*t,s=je._curBindedBufferState;if(i._byteLength=n,s?s._bindedIndexBuffer===O(i)?S.instance.bufferData(i._bufferType,n,i._bufferUsage):(s.unBind(),i.bind(),S.instance.bufferData(i._bufferType,n,i._bufferUsage),s.bind()):(i.bind(),S.instance.bufferData(i._bufferType,n,i._bufferUsage)),a)switch(e){case Zi.UInt32:i._buffer=new Uint32Array(t);break;case Zi.UInt16:i._buffer=new Uint16Array(t);break;case Zi.UInt8:i._buffer=new Uint8Array(t)}return i}return y(o,[{key:"indexType",get:function(){return this._indexType}},{key:"indexTypeByteCount",get:function(){return this._indexTypeByteCount}},{key:"indexCount",get:function(){return this._indexCount}},{key:"canRead",get:function(){return this._canRead}},{key:"_bindForVAO",value:function(){if(!je._curBindedBufferState)throw"IndexBuffer3D: must bind current BufferState.";var e=S.instance;e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._glBuffer)}},{key:"bind",value:function(){var e;if(je._curBindedBufferState)throw"IndexBuffer3D: must unbind current BufferState.";return Ke._bindedIndexBuffer!==this._glBuffer&&((e=S.instance).bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._glBuffer),Ke._bindedIndexBuffer=this._glBuffer,!0)}},{key:"setData",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:4294967295,a=this._indexTypeByteCount;if(0!==i||4294967295!==n)switch(this._indexType){case Zi.UInt32:e=new Uint32Array(e.buffer,i*a,n);break;case Zi.UInt16:e=new Uint16Array(e.buffer,i*a,n);break;case Zi.UInt8:e=new Uint8Array(e.buffer,i*a,n)}var s=je._curBindedBufferState;if(s?s._bindedIndexBuffer===this?S.instance.bufferSubData(this._bufferType,t*a,e):(s.unBind(),this.bind(),S.instance.bufferSubData(this._bufferType,t*a,e),s.bind()):(this.bind(),S.instance.bufferSubData(this._bufferType,t*a,e)),this._canRead)if(0!==t||0!==i||4294967295!==n){s=this._buffer.length-t;s<n&&(n=s);for(var r=0;r<n;r++)this._buffer[t+r]=e[r]}else this._buffer=e}},{key:"getData",value:function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")}},{key:"destroy",value:function(){m(g(o.prototype),"destroy",this).call(this),this._buffer=null}}]),o}()),ns=function(){function t(){b(this,t)}return y(t,null,[{key:"__init__",value:function(){var e=S.instance;t._elementInfos={single:[1,e.FLOAT,0],vector2:[2,e.FLOAT,0],vector3:[3,e.FLOAT,0],vector4:[4,e.FLOAT,0],color:[4,e.FLOAT,0],byte4:[4,e.UNSIGNED_BYTE,0],short2:[2,e.FLOAT,0],short4:[4,e.FLOAT,0],normalizedshort2:[2,e.FLOAT,0],normalizedshort4:[4,e.FLOAT,0],halfvector2:[2,e.FLOAT,0],halfvector4:[4,e.FLOAT,0]}}},{key:"getElementInfos",value:function(e){e=t._elementInfos[e];if(e)return e;throw"VertexElementFormat: this vertexElementFormat is not implement."}}]),t}(),as=(ns.Single="single",ns.Vector2="vector2",ns.Vector3="vector3",ns.Vector4="vector4",ns.Color="color",ns.Byte4="byte4",ns.Short2="short2",ns.Short4="short4",ns.NormalizedShort2="normalizedshort2",ns.NormalizedShort4="normalizedshort4",ns.HalfVector2="halfvector2",ns.HalfVector4="halfvector4",function(){function h(e,t){b(this,h),this._id=++h._uniqueIDCounter,this._vertexElementsDic={},this._vertexStride=e;var i=(this._vertexElements=t).length;this._shaderValues=new es(null);for(var n=0;n<i;n++){var a=t[n],s=a._elementUsage,r=(this._vertexElementsDic[s]=a,new Int32Array(5)),o=ns.getElementInfos(a._elementFormat);r[0]=o[0],r[1]=o[1],r[2]=o[2],r[3]=this._vertexStride,r[4]=a._offset,this._shaderValues.setAttribute(s,r)}}return y(h,[{key:"id",get:function(){return this._id}},{key:"vertexStride",get:function(){return this._vertexStride}},{key:"vertexElementCount",get:function(){return this._vertexElements.length}},{key:"getVertexElementByIndex",value:function(e){return this._vertexElements[e]}},{key:"getVertexElementByUsage",value:function(e){return this._vertexElementsDic[e]}}]),h}()),ss=(as._uniqueIDCounter=1,function(){function n(e,t,i){b(this,n),this._offset=e,this._elementFormat=t,this._elementUsage=i}return y(n,[{key:"offset",get:function(){return this._offset}},{key:"elementFormat",get:function(){return this._elementFormat}},{key:"elementUsage",get:function(){return this._elementUsage}}]),n}()),rs=function(){function l(){b(this,l)}return y(l,null,[{key:"__init__",value:function(){l.instanceWorldMatrixDeclaration=new as(64,[new ss(0,ns.Vector4,l.MESH_WORLDMATRIX_ROW0),new ss(16,ns.Vector4,l.MESH_WORLDMATRIX_ROW1),new ss(32,ns.Vector4,l.MESH_WORLDMATRIX_ROW2),new ss(48,ns.Vector4,l.MESH_WORLDMATRIX_ROW3)]),l.instanceMVPMatrixDeclaration=new as(64,[new ss(0,ns.Vector4,l.MESH_MVPMATRIX_ROW0),new ss(16,ns.Vector4,l.MESH_MVPMATRIX_ROW1),new ss(32,ns.Vector4,l.MESH_MVPMATRIX_ROW2),new ss(48,ns.Vector4,l.MESH_MVPMATRIX_ROW3)])}},{key:"getVertexDeclaration",value:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],i=l._vertexDeclarationMap[e+(t?"_0":"_1")];if(!i){for(var n,a=e.split(","),s=0,r=[],o=0,h=a.length;o<h;o++){switch(a[o]){case"POSITION":n=new ss(s,ns.Vector3,l.MESH_POSITION0),s+=12;break;case"NORMAL":n=new ss(s,ns.Vector3,l.MESH_NORMAL0),s+=12;break;case"COLOR":n=new ss(s,ns.Vector4,l.MESH_COLOR0),s+=16;break;case"UV":n=new ss(s,ns.Vector2,l.MESH_TEXTURECOORDINATE0),s+=8;break;case"UV1":n=new ss(s,ns.Vector2,l.MESH_TEXTURECOORDINATE1),s+=8;break;case"BLENDWEIGHT":n=new ss(s,ns.Vector4,l.MESH_BLENDWEIGHT0),s+=16;break;case"BLENDINDICES":t?(n=new ss(s,ns.Vector4,l.MESH_BLENDINDICES0),s+=16):(n=new ss(s,ns.Byte4,l.MESH_BLENDINDICES0),s+=4);break;case"TANGENT":n=new ss(s,ns.Vector4,l.MESH_TANGENT0),s+=16;break;default:throw"VertexMesh: unknown vertex flag."}r.push(n)}i=new as(s,r),l._vertexDeclarationMap[e+(t?"_0":"_1")]=i}return i}}]),l}(),os=(rs.MESH_POSITION0=0,rs.MESH_COLOR0=1,rs.MESH_TEXTURECOORDINATE0=2,rs.MESH_NORMAL0=3,rs.MESH_TANGENT0=4,rs.MESH_BLENDINDICES0=5,rs.MESH_BLENDWEIGHT0=6,rs.MESH_TEXTURECOORDINATE1=7,rs.MESH_WORLDMATRIX_ROW0=8,rs.MESH_WORLDMATRIX_ROW1=9,rs.MESH_WORLDMATRIX_ROW2=10,rs.MESH_WORLDMATRIX_ROW3=11,rs.MESH_MVPMATRIX_ROW0=12,rs.MESH_MVPMATRIX_ROW1=13,rs.MESH_MVPMATRIX_ROW2=14,rs.MESH_MVPMATRIX_ROW3=15,rs._vertexDeclarationMap={},function(){f(r,Ke);var s=T(r);function r(e,t){var i,n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],a=(b(this,r),(i=s.call(this))._vertexDeclaration=null,i._float32Reader=null,S.instance);return i._bufferUsage=t,i._bufferType=a.ARRAY_BUFFER,i._canRead=n,i._byteLength=e,i.bind(),a.bufferData(i._bufferType,i._byteLength,i._bufferUsage),n&&(i._buffer=new Uint8Array(e),i._float32Reader=new Float32Array(i._buffer.buffer)),i}return y(r,[{key:"vertexDeclaration",get:function(){return this._vertexDeclaration},set:function(e){this._vertexDeclaration=e}},{key:"canRead",get:function(){return this._canRead}},{key:"bind",value:function(){var e;return Ke._bindedVertexBuffer!==this._glBuffer&&((e=S.instance).bindBuffer(e.ARRAY_BUFFER,this._glBuffer),Ke._bindedVertexBuffer=this._glBuffer,!0)}},{key:"setData",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:Number.MAX_SAFE_INTEGER;this.bind(),0!==i||n!==Number.MAX_SAFE_INTEGER?(i=new Uint8Array(e,i,n),S.instance.bufferSubData(this._bufferType,t,i),this._canRead&&this._buffer.set(i,t)):(S.instance.bufferSubData(this._bufferType,t,e),this._canRead&&this._buffer.set(new Uint8Array(e),t))}},{key:"getUint8Data",value:function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")}},{key:"getFloat32Data",value:function(){if(this._canRead)return this._float32Reader;throw new Error("Can't read data from VertexBuffer with only write flag!")}},{key:"markAsUnreadbale",value:function(){this._canRead=!1,this._buffer=null,this._float32Reader=null}},{key:"destroy",value:function(){m(g(r.prototype),"destroy",this).call(this),this._buffer=null,this._float32Reader=null,this._vertexDeclaration=null}}]),r}()),hs=(os.DATATYPE_FLOAT32ARRAY=0,os.DATATYPE_UINT8ARRAY=1,function(){function e(){b(this,e)}return y(e,[{key:"_render",value:function(e){}}]),e}()),ls=function(){f(r,hs);var s=T(r);function r(){b(this,r),e=s.call(this);var e,t=S.instance,i=new Float32Array([-1,1,-1,1,1,-1,1,1,1,-1,1,1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1]),n=new Uint8Array([0,1,2,2,3,0,4,7,6,6,5,4,0,3,7,7,4,0,1,5,6,6,2,1,3,2,6,6,7,3,0,4,5,5,1,0]),a=rs.getVertexDeclaration("POSITION"),a=(e._vertexBuffer=new os(8*a.vertexStride,t.STATIC_DRAW,!1),e._vertexBuffer.vertexDeclaration=a,e._indexBuffer=new is(Zi.UInt8,36,t.STATIC_DRAW,!1),e._vertexBuffer.setData(i.buffer),e._indexBuffer.setData(n),new ts);return a.bind(),a.applyVertexBuffer(e._vertexBuffer),a.applyIndexBuffer(e._indexBuffer),a.unBind(),e._bufferState=a,e}return y(r,[{key:"_render",value:function(e){var t=S.instance;t.drawElements(t.TRIANGLES,36,t.UNSIGNED_BYTE,0),k.trianglesFaces+=12,k.renderBatches++}}],[{key:"__init__",value:function(){r.instance=new r}}]),r}(),us=function(){function c(){b(this,c),this._mesh=ls.instance}return y(c,[{key:"material",get:function(){return this._material},set:function(e){this._material!==e&&(this._material&&this._material._removeReference(),e&&e._addReference(),this._material=e)}},{key:"mesh",get:function(){return this._mesh},set:function(e){this._mesh!==e&&(this._mesh=e)}},{key:"_isAvailable",value:function(){return!(!this._material||!this._mesh)}},{key:"_render",value:function(e){var t,i,n,a,s,r,o,h,l,u;this._material&&this._mesh&&(t=S.instance,l=e.scene,i=e.camera,n=es._SET_RUNTIME_VALUE_MODE_REFERENCE_,L.Render.supportWebGLPlusRendering&&es.setRuntimeValueMode(!1),v.setCullFace(t,!1),v.setDepthFunc(t,t.LEQUAL),v.setDepthMask(t,!1),this._material._shaderValues._defineDatas.cloneTo(a=c._compileDefine),s=(a=e.shader=this._material._shader.getSubShaderAt(0)._passes[0].withCompile(a)).bind(),r=k.loopCount!==a._uploadMark,((o=a._uploadScene!==l||r)||s)&&(a.uploadUniforms(a._sceneUniformParamsMap,l._shaderValues,o),a._uploadScene=l),i._getRenderTexture(),((o=a._uploadCamera!==i||r)||s)&&(l=c._tempMatrix1,i.viewMatrix.cloneTo(h=c._tempMatrix0),i.projectionMatrix.cloneTo(l),h.setTranslationVector(R._ZERO),i.orthographic&&Pa.createPerspective(i.fieldOfView,i.aspectRatio,i.nearPlane,i.farPlane,l),u=1/Math.tan(3.1416*i.fieldOfView/180*.5),l.elements[0]=u/i.aspectRatio,l.elements[5]=u,l.elements[10]=1e-6-1,l.elements[11]=-1,l.elements[14]=-0,i._applyViewProject(e,h,l),a.uploadUniforms(a._cameraUniformParamsMap,i._shaderValues,o),a._uploadCamera=i),((u=a._uploadMaterial!==this._material||r)||s)&&(a.uploadUniforms(a._materialUniformParamsMap,this._material._shaderValues,u),a._uploadMaterial=this._material),this._mesh._bufferState.bind(),this._mesh._render(e),L.Render.supportWebGLPlusRendering&&es.setRuntimeValueMode(n),v.setDepthFunc(t,t.LESS),v.setDepthMask(t,!0),i._applyViewProject(e,i.viewMatrix,i.projectionMatrix))}},{key:"destroy",value:function(){this._material&&(this._material._removeReference(),this._material=null)}}]),c}(),cs=(us._tempMatrix0=new Pa,us._tempMatrix1=new Pa,us._compileDefine=new Ua,function(){f(a,Ga);var n=T(a);function a(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:.3,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1e3;return b(this,a),(e=n.call(this))._skyRenderer=new us,e._forward=new R,e._up=new R,e.clearColor=new Sa(100/255,149/255,237/255,1),e._shaderValues=new es(null),e._fieldOfView=60,e._useUserProjectionMatrix=!1,e._orthographic=!1,e._orthographicVerticalSize=10,e.renderingOrder=0,e._nearPlane=t,e._farPlane=i,e.cullingMask=2147483647,e.useOcclusionCulling=!0,e}return y(a,[{key:"skyRenderer",get:function(){return this._skyRenderer}},{key:"fieldOfView",get:function(){return this._fieldOfView},set:function(e){this._fieldOfView=e,this._calculateProjectionMatrix()}},{key:"nearPlane",get:function(){return this._nearPlane},set:function(e){this._nearPlane=e,this._calculateProjectionMatrix()}},{key:"farPlane",get:function(){return this._farPlane},set:function(e){this._farPlane=e,this._calculateProjectionMatrix()}},{key:"orthographic",get:function(){return this._orthographic},set:function(e){this._orthographic=e,this._calculateProjectionMatrix()}},{key:"orthographicVerticalSize",get:function(){return this._orthographicVerticalSize},set:function(e){this._orthographicVerticalSize=e,this._calculateProjectionMatrix()}},{key:"renderingOrder",get:function(){return this._renderingOrder},set:function(e){this._renderingOrder=e,this._sortCamerasByRenderingOrder()}},{key:"_sortCamerasByRenderingOrder",value:function(){if(this.displayedInStage)for(var e,t=this.scene._cameraPool,i=t.length-1,n=0;n<i;n++)t[n].renderingOrder>t[i].renderingOrder&&(e=t[n],t[n]=t[i],t[i]=e)}},{key:"_calculateProjectionMatrix",value:function(){}},{key:"_onScreenSizeChanged",value:function(){this._calculateProjectionMatrix()}},{key:"_prepareCameraToRender",value:function(){var e=this._shaderValues;this.transform.getForward(this._forward),this.transform.getUp(this._up),e.setVector3(a.CAMERAPOS,this.transform.position),e.setVector3(a.CAMERADIRECTION,this._forward),e.setVector3(a.CAMERAUP,this._up)}},{key:"render",value:function(){}},{key:"addLayer",value:function(e){this.cullingMask|=Math.pow(2,e)}},{key:"removeLayer",value:function(e){this.cullingMask&=~Math.pow(2,e)}},{key:"addAllLayers",value:function(){this.cullingMask=2147483647}},{key:"removeAllLayers",value:function(){this.cullingMask=0}},{key:"resetProjectionMatrix",value:function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()}},{key:"_onActive",value:function(){this._scene._addCamera(this),m(g(a.prototype),"_onActive",this).call(this)}},{key:"_onInActive",value:function(){this._scene._removeCamera(this),m(g(a.prototype),"_onInActive",this).call(this)}},{key:"_parse",value:function(e,t){m(g(a.prototype),"_parse",this).call(this,e,t),this.orthographic=e.orthographic,void 0!==e.orthographicVerticalSize&&(this.orthographicVerticalSize=e.orthographicVerticalSize),void 0!==e.fieldOfView&&(this.fieldOfView=e.fieldOfView),this.nearPlane=e.nearPlane,this.farPlane=e.farPlane;t=e.clearColor,this.clearColor=new Sa(t[0],t[1],t[2],t[3]),t=e.skyboxMaterial;t&&(this._skyRenderer.material=E.getRes(t.path))}},{key:"destroy",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this._skyRenderer.destroy(),this._skyRenderer=null,o.stage.off(Me.RESIZE,this,this._onScreenSizeChanged),m(g(a.prototype),"destroy",this).call(this,e)}},{key:"_create",value:function(){return new a}}]),a}()),_s=(cs._tempMatrix4x40=new Pa,cs.CAMERAPOS=A.propertyNameToID("u_CameraPos"),cs.VIEWMATRIX=A.propertyNameToID("u_View"),cs.PROJECTMATRIX=A.propertyNameToID("u_Projection"),cs.VIEWPROJECTMATRIX=A.propertyNameToID("u_ViewProjection"),cs.CAMERADIRECTION=A.propertyNameToID("u_CameraDirection"),cs.CAMERAUP=A.propertyNameToID("u_CameraUp"),cs.VIEWPORT=A.propertyNameToID("u_Viewport"),cs.PROJECTION_PARAMS=A.propertyNameToID("u_ProjectionParams"),cs.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",cs.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",cs._invertYScaleMatrix=new Pa(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1),cs._invertYProjectionMatrix=new Pa,cs._invertYProjectionViewMatrix=new Pa,cs.CLEARFLAG_SOLIDCOLOR=0,cs.CLEARFLAG_SKY=1,cs.CLEARFLAG_DEPTHONLY=2,cs.CLEARFLAG_NONE=3,y(function e(t,i){b(this,e),this.origin=t,this.direction=i})),fs=y(function e(){b(this,e),this.succeeded=!1,this.collider=null,this.point=new R,this.normal=new R,this.hitFraction=0}),ds=function(){function e(){b(this,e)}return y(e,null,[{key:"setColliderCollision",value:function(e,t,i){}},{key:"getIColliderCollision",value:function(e,t){return!1}}]),e}(),ps=(ds.COLLISIONFILTERGROUP_DEFAULTFILTER=1,ds.COLLISIONFILTERGROUP_STATICFILTER=2,ds.COLLISIONFILTERGROUP_KINEMATICFILTER=4,ds.COLLISIONFILTERGROUP_DEBRISFILTER=8,ds.COLLISIONFILTERGROUP_SENSORTRIGGER=16,ds.COLLISIONFILTERGROUP_CHARACTERFILTER=32,ds.COLLISIONFILTERGROUP_CUSTOMFILTER1=64,ds.COLLISIONFILTERGROUP_CUSTOMFILTER2=128,ds.COLLISIONFILTERGROUP_CUSTOMFILTER3=256,ds.COLLISIONFILTERGROUP_CUSTOMFILTER4=512,ds.COLLISIONFILTERGROUP_CUSTOMFILTER5=1024,ds.COLLISIONFILTERGROUP_CUSTOMFILTER6=2048,ds.COLLISIONFILTERGROUP_CUSTOMFILTER7=4096,ds.COLLISIONFILTERGROUP_CUSTOMFILTER8=8192,ds.COLLISIONFILTERGROUP_CUSTOMFILTER9=16384,ds.COLLISIONFILTERGROUP_CUSTOMFILTER10=32768,ds.COLLISIONFILTERGROUP_ALLFILTER=-1,ds.gravity=new R(0,-9.81,0),function(){f(t,Xa);var e=T(t);function t(){return b(this,t),e.call(this)}return y(t,[{key:"add",value:function(e){if(-1!==e._inPhysicUpdateListIndex)throw"PhysicsUpdateList:element has  in  PhysicsUpdateList.";this._add(e),e._inPhysicUpdateListIndex=this.length++}},{key:"remove",value:function(e){var t,i=e._inPhysicUpdateListIndex;this.length--,i!==this.length&&(t=this.elements[this.length],(this.elements[i]=t)._inPhysicUpdateListIndex=i),e._inPhysicUpdateListIndex=-1}}]),t}()),ys=y(function e(){b(this,e),this._idCounter=0,this.colliderA=null,this.colliderB=null,this.distance=0,this.normal=new R,this.positionOnA=new R,this.positionOnB=new R,this._id=++this._idCounter}),gs=function(){function e(){b(this,e),this._lastUpdateFrame=-2147483648,this._updateFrame=-2147483648,this._isTrigger=!1,this.contacts=[]}return y(e,[{key:"_setUpdateFrame",value:function(e){this._lastUpdateFrame=this._updateFrame,this._updateFrame=e}}]),e}(),ms=function(){function e(){b(this,e),this._hitResultsPoolIndex=0,this._hitResultsPool=[],this._contactPonintsPoolIndex=0,this._contactPointsPool=[],this._collisionsPool=[],this._collisions={}}return y(e,[{key:"getHitResult",value:function(){var e=this._hitResultsPool[this._hitResultsPoolIndex++];return e||(e=new fs,this._hitResultsPool.push(e)),e}},{key:"recoverAllHitResultsPool",value:function(){this._hitResultsPoolIndex=0}},{key:"getContactPoints",value:function(){var e=this._contactPointsPool[this._contactPonintsPoolIndex++];return e||(e=new ys,this._contactPointsPool.push(e)),e}},{key:"recoverAllContactPointsPool",value:function(){this._contactPonintsPoolIndex=0}},{key:"getCollision",value:function(e,t){var i,n=e.id,a=t.id,s=this._collisions[n];return(i=s?s[a]:i)||(s||(this._collisions[n]=s={}),(i=0===this._collisionsPool.length?new gs:this._collisionsPool.pop())._colliderA=e,i._colliderB=t,s[a]=i),i}},{key:"recoverCollision",value:function(e){var t=e._colliderA.id,i=e._colliderB.id;this._collisions[t][i]=null,this._collisionsPool.push(e)}},{key:"garbageCollection",value:function(){for(var e in this._hitResultsPoolIndex=0,this._hitResultsPool.length=0,this._contactPonintsPoolIndex=0,this._contactPointsPool.length=0,this._collisionsPool.length=0,this._collisionsPool){var t,i=this._collisionsPool[e],n=!0;for(t in i)i[t]?n=!1:delete i[t];n&&delete this._collisionsPool[e]}}}]),e}(),vs=function(){function i(){b(this,i),this._scale=new R(1,1,1),this._centerMatrix=new Pa,this._attatched=!1,this._indexInCompound=-1,this._compoundParent=null,this._attatchedCollisionObject=null,this._referenceCount=0,this._localOffset=new R(0,0,0),this._localRotation=new Ca(0,0,0,1),this.needsCustomCollisionCallback=!1}return y(i,[{key:"type",get:function(){return this._type}},{key:"localOffset",get:function(){return this._localOffset},set:function(e){this._localOffset=e,this._compoundParent&&this._compoundParent._updateChildTransform(this)}},{key:"localRotation",get:function(){return this._localRotation},set:function(e){this._localRotation=e,this._compoundParent&&this._compoundParent._updateChildTransform(this)}},{key:"_setScale",value:function(e){var t;this._compoundParent?this.updateLocalTransformations():((t=Ea._bullet).btVector3_setValue(i._btScale,e.x,e.y,e.z),t.btCollisionShape_setLocalScaling(this._btShape,i._btScale))}},{key:"_addReference",value:function(){this._referenceCount++}},{key:"_removeReference",value:function(){this._referenceCount--}},{key:"updateLocalTransformations",value:function(){var e;this._compoundParent?(R.multiply(this.localOffset,this._scale,e=i._tempVector30),i._createAffineTransformation(e,this.localRotation,this._centerMatrix.elements)):i._createAffineTransformation(this.localOffset,this.localRotation,this._centerMatrix.elements)}},{key:"cloneTo",value:function(e){this._localOffset.cloneTo(e.localOffset),this._localRotation.cloneTo(e.localRotation),e.localOffset=e.localOffset,e.localRotation=e.localRotation}},{key:"clone",value:function(){return null}},{key:"destroy",value:function(){this._btShape&&(Ea._bullet.btCollisionShape_destroy(this._btShape),this._btShape=null)}}],[{key:"__init__",value:function(){var e=Ea._bullet;i._btScale=e.btVector3_create(1,1,1),i._btVector30=e.btVector3_create(0,0,0),i._btQuaternion0=e.btQuaternion_create(0,0,0,1),i._btTransform0=e.btTransform_create()}},{key:"_createAffineTransformation",value:function(e,t,i){var n=t.x,a=t.y,s=t.z,t=t.w,r=n+n,o=a+a,h=s+s,l=n*r,u=n*o,n=n*h,c=a*o,a=a*h,s=s*h,r=t*r,o=t*o,t=t*h;i[0]=1-(c+s),i[1]=u+t,i[2]=n-o,i[3]=0,i[4]=u-t,i[5]=1-(l+s),i[6]=a+r,i[7]=0,i[8]=n+o,i[9]=a-r,i[10]=1-(l+c),i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1}}]),i}(),xs=(vs.SHAPEORIENTATION_UPX=0,vs.SHAPEORIENTATION_UPY=1,vs.SHAPEORIENTATION_UPZ=2,vs.SHAPETYPES_BOX=0,vs.SHAPETYPES_SPHERE=1,vs.SHAPETYPES_CYLINDER=2,vs.SHAPETYPES_CAPSULE=3,vs.SHAPETYPES_CONVEXHULL=4,vs.SHAPETYPES_COMPOUND=5,vs.SHAPETYPES_STATICPLANE=6,vs.SHAPETYPES_CONE=7,vs._tempVector30=new R,function(){f(r,vs);var s=T(r);function r(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,a=(b(this,r),(e=s.call(this))._sizeX=t,e._sizeY=i,e._sizeZ=n,e._type=vs.SHAPETYPES_BOX,Ea._bullet);return a.btVector3_setValue(r._btSize,t/2,i/2,n/2),e._btShape=a.btBoxShape_create(r._btSize),e}return y(r,[{key:"sizeX",get:function(){return this._sizeX}},{key:"sizeY",get:function(){return this._sizeY}},{key:"sizeZ",get:function(){return this._sizeZ}},{key:"clone",value:function(){var e=new r(this._sizeX,this._sizeY,this._sizeZ);return this.cloneTo(e),e}}],[{key:"__init__",value:function(){r._btSize=Ea._bullet.btVector3_create(0,0,0)}}]),r}()),ks=function(){f(r,vs);var s=T(r);function r(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:.5,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1.25,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:vs.SHAPEORIENTATION_UPY,a=(b(this,r),(e=s.call(this))._radius=t,e._length=i,e._orientation=n,e._type=vs.SHAPETYPES_CAPSULE,Ea._bullet);switch(n){case vs.SHAPEORIENTATION_UPX:e._btShape=a.btCapsuleShapeX_create(t,i-2*t);break;case vs.SHAPEORIENTATION_UPY:e._btShape=a.btCapsuleShape_create(t,i-2*t);break;case vs.SHAPEORIENTATION_UPZ:e._btShape=a.btCapsuleShapeZ_create(t,i-2*t);break;default:throw"CapsuleColliderShape:unknown orientation."}return e}return y(r,[{key:"radius",get:function(){return this._radius}},{key:"length",get:function(){return this._length}},{key:"orientation",get:function(){return this._orientation}},{key:"_setScale",value:function(e){var t=r._tempVector30;switch(this.orientation){case vs.SHAPEORIENTATION_UPX:t.x=e.x,t.y=t.z=Math.max(e.y,e.z);break;case vs.SHAPEORIENTATION_UPY:t.y=e.y,t.x=t.z=Math.max(e.x,e.z);break;case vs.SHAPEORIENTATION_UPZ:t.z=e.z,t.x=t.y=Math.max(e.x,e.y);break;default:throw"CapsuleColliderShape:unknown orientation."}m(g(r.prototype),"_setScale",this).call(this,t)}},{key:"clone",value:function(){var e=new r(this._radius,this._length,this._orientation);return this.cloneTo(e),e}}]),r}(),ws=(ks._tempVector30=new R,function(){f(a,vs);var t=T(a);function a(){var e;return b(this,a),(e=t.call(this))._childColliderShapes=[],e._type=vs.SHAPETYPES_COMPOUND,e._btShape=Ea._bullet.btCompoundShape_create(),e}return y(a,[{key:"_clearChildShape",value:function(e){e._attatched=!1,e._compoundParent=null,e._indexInCompound=-1}},{key:"_addReference",value:function(){}},{key:"_removeReference",value:function(){}},{key:"_updateChildTransform",value:function(e){var t=Ea._bullet,i=e.localOffset,n=e.localRotation,a=vs._btVector30,s=vs._btQuaternion0,r=vs._btTransform0;t.btVector3_setValue(a,-i.x,i.y,i.z),t.btQuaternion_setValue(s,-n.x,n.y,n.z,-n.w),t.btTransform_setOrigin(r,a),t.btTransform_setRotation(r,s),t.btCompoundShape_updateChildTransform(this._btShape,e._indexInCompound,r,!0)}},{key:"addChildShape",value:function(e){if(e._attatched)throw"CompoundColliderShape: this shape has attatched to other entity.";e._attatched=!0,e._compoundParent=this,e._indexInCompound=this._childColliderShapes.length,this._childColliderShapes.push(e);var t=e.localOffset,i=e.localRotation,n=Ea._bullet,t=(n.btVector3_setValue(a._btOffset,-t.x,t.y,t.z),n.btQuaternion_setValue(a._btRotation,-i.x,i.y,i.z,-i.w),n.btTransform_setOrigin(a._btTransform,a._btOffset),n.btTransform_setRotation(a._btTransform,a._btRotation),n.btCollisionShape_getLocalScaling(this._btShape));n.btCollisionShape_setLocalScaling(this._btShape,a._btVector3One),n.btCompoundShape_addChildShape(this._btShape,a._btTransform,e._btShape),n.btCollisionShape_setLocalScaling(this._btShape,t),this._attatchedCollisionObject&&(this._attatchedCollisionObject.colliderShape=this)}},{key:"removeChildShape",value:function(e){var t;e._compoundParent===this&&(t=e._indexInCompound,this._clearChildShape(e),(e=this._childColliderShapes[this._childColliderShapes.length-1])._indexInCompound=t,this._childColliderShapes[t]=e,this._childColliderShapes.pop(),Ea._bullet.btCompoundShape_removeChildShapeByIndex(this._btShape,t))}},{key:"clearChildShape",value:function(){for(var e=0,t=this._childColliderShapes.length;e<t;e++)this._clearChildShape(this._childColliderShapes[e]),Ea._bullet.btCompoundShape_removeChildShapeByIndex(this._btShape,0);this._childColliderShapes.length=0}},{key:"getChildShapeCount",value:function(){return this._childColliderShapes.length}},{key:"cloneTo",value:function(e){var t=e;t.clearChildShape();for(var i=0,n=this._childColliderShapes.length;i<n;i++)t.addChildShape(this._childColliderShapes[i].clone())}},{key:"clone",value:function(){var e=new a;return this.cloneTo(e),e}},{key:"destroy",value:function(){m(g(a.prototype),"destroy",this).call(this);for(var e=0,t=this._childColliderShapes.length;e<t;e++){var i=this._childColliderShapes[e];0===i._referenceCount&&i.destroy()}}}],[{key:"__init__",value:function(){var e=Ea._bullet;a._btVector3One=e.btVector3_create(1,1,1),a._btTransform=e.btTransform_create(),a._btOffset=e.btVector3_create(0,0,0),a._btRotation=e.btQuaternion_create(0,0,0,1)}}]),a}()),bs=function(){f(r,vs);var s=T(r);function r(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:.5,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:vs.SHAPEORIENTATION_UPY,a=(b(this,r),(e=s.call(this))._radius=1,e._height=.5,e._radius=t,e._height=i,e._orientation=n,e._type=vs.SHAPETYPES_CYLINDER,Ea._bullet);switch(n){case vs.SHAPEORIENTATION_UPX:e._btShape=a.btConeShapeX_create(t,i);break;case vs.SHAPEORIENTATION_UPY:e._btShape=a.btConeShape_create(t,i);break;case vs.SHAPEORIENTATION_UPZ:e._btShape=a.btConeShapeZ_create(t,i);break;default:throw"ConeColliderShape:unknown orientation."}return e}return y(r,[{key:"radius",get:function(){return this._radius}},{key:"height",get:function(){return this._height}},{key:"orientation",get:function(){return this._orientation}},{key:"clone",value:function(){var e=new r(this._radius,this._height,this._orientation);return this.cloneTo(e),e}}]),r}(),Ss=function(){f(r,vs);var s=T(r);function r(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:.5,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:vs.SHAPEORIENTATION_UPY,a=(b(this,r),(e=s.call(this))._radius=1,e._height=.5,e._radius=t,e._height=i,e._orientation=n,e._type=vs.SHAPETYPES_CYLINDER,Ea._bullet);switch(n){case vs.SHAPEORIENTATION_UPX:a.btVector3_setValue(r._btSize,i/2,t,t),e._btShape=a.btCylinderShapeX_create(r._btSize);break;case vs.SHAPEORIENTATION_UPY:a.btVector3_setValue(r._btSize,t,i/2,t),e._btShape=a.btCylinderShape_create(r._btSize);break;case vs.SHAPEORIENTATION_UPZ:a.btVector3_setValue(r._btSize,t,t,i/2),e._btShape=a.btCylinderShapeZ_create(r._btSize);break;default:throw"CapsuleColliderShape:unknown orientation."}return e}return y(r,[{key:"radius",get:function(){return this._radius}},{key:"height",get:function(){return this._height}},{key:"orientation",get:function(){return this._orientation}},{key:"clone",value:function(){var e=new r(this._radius,this._height,this._orientation);return this.cloneTo(e),e}}],[{key:"__init__",value:function(){r._btSize=Ea._bullet.btVector3_create(0,0,0)}}]),r}(),Is=function(){f(i,vs);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this))._mesh=null,e._convex=!1,e}return y(i,[{key:"mesh",get:function(){return this._mesh},set:function(e){var t;this._mesh!==e&&(t=Ea._bullet,this._mesh&&t.destroy(this._btShape),e&&(this._btShape=t.btGImpactMeshShape_create(e._getPhysicMesh()),t.btGImpactShapeInterface_updateBound(this._btShape)),this._mesh=e)}},{key:"convex",get:function(){return this._convex},set:function(e){this._convex=e}},{key:"_setScale",value:function(e){var t;this._compoundParent?this.updateLocalTransformations():((t=Ea._bullet).btVector3_setValue(vs._btScale,e.x,e.y,e.z),t.btCollisionShape_setLocalScaling(this._btShape,vs._btScale),t.btGImpactShapeInterface_updateBound(this._btShape))}},{key:"cloneTo",value:function(e){var t=e;t.convex=this._convex,t.mesh=this._mesh,m(g(i.prototype),"cloneTo",this).call(this,e)}},{key:"clone",value:function(){var e=new i;return this.cloneTo(e),e}},{key:"destroy",value:function(){this._btShape&&(Ea._bullet.btCollisionShape_destroy(this._btShape),this._btShape=null)}}]),i}(),Ts=function(){f(n,vs);var i=T(n);function n(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:.5;return b(this,n),(e=i.call(this))._radius=t,e._type=vs.SHAPETYPES_SPHERE,e._btShape=Ea._bullet.btSphereShape_create(t),e}return y(n,[{key:"radius",get:function(){return this._radius}},{key:"clone",value:function(){var e=new n(this._radius);return this.cloneTo(e),e}}]),n}(),Cs=function(){f(c,Mi);var n=T(c);function c(e,t){var i;return b(this,c),(i=n.call(this))._restitution=0,i._friction=.5,i._rollingFriction=0,i._ccdMotionThreshold=0,i._ccdSweptSphereRadius=0,i._collisionGroup=ds.COLLISIONFILTERGROUP_DEFAULTFILTER,i._canCollideWith=ds.COLLISIONFILTERGROUP_ALLFILTER,i._colliderShape=null,i._transformFlag=2147483647,i._enableProcessCollisions=!0,i._inPhysicUpdateListIndex=-1,i.canScaleShape=!0,i._collisionGroup=e,i._canCollideWith=t,c._physicObjectsMap[i.id]=O(i),i}return y(c,[{key:"restitution",get:function(){return this._restitution},set:function(e){this._restitution=e,this._btColliderObject&&Ea._bullet.btCollisionObject_setRestitution(this._btColliderObject,e)}},{key:"friction",get:function(){return this._friction},set:function(e){this._friction=e,this._btColliderObject&&Ea._bullet.btCollisionObject_setFriction(this._btColliderObject,e)}},{key:"rollingFriction",get:function(){return this._rollingFriction},set:function(e){this._rollingFriction=e,this._btColliderObject&&Ea._bullet.btCollisionObject_setRollingFriction(this._btColliderObject,e)}},{key:"ccdMotionThreshold",get:function(){return this._ccdMotionThreshold},set:function(e){this._ccdMotionThreshold=e,this._btColliderObject&&Ea._bullet.btCollisionObject_setCcdMotionThreshold(this._btColliderObject,e)}},{key:"ccdSweptSphereRadius",get:function(){return this._ccdSweptSphereRadius},set:function(e){this._ccdSweptSphereRadius=e,this._btColliderObject&&Ea._bullet.btCollisionObject_setCcdSweptSphereRadius(this._btColliderObject,e)}},{key:"isActive",get:function(){return!!this._btColliderObject&&Ea._bullet.btCollisionObject_isActive(this._btColliderObject)}},{key:"enabled",get:function(){return m(g(c.prototype),"enabled",this)},set:function(e){this._enabled!=e&&(this._simulation&&this._colliderShape&&(e?(this._derivePhysicsTransformation(!0),this._addToSimulation()):this._removeFromSimulation()),U(g(c.prototype),"enabled",e,this,!0))}},{key:"colliderShape",get:function(){return this._colliderShape},set:function(e){var t,i=this._colliderShape;if(i&&(i._attatched=!1,i._attatchedCollisionObject=null),this._colliderShape=e){if(e._attatched)throw"PhysicsComponent: this shape has attatched to other entity.";e._attatched=!0,(e._attatchedCollisionObject=this)._btColliderObject&&(Ea._bullet.btCollisionObject_setCollisionShape(this._btColliderObject,e._btShape),(t=this._simulation&&this._enabled)&&i&&this._removeFromSimulation(),this._onShapeChange(e),t&&(this._derivePhysicsTransformation(!0),this._addToSimulation()))}else this._simulation&&this._enabled&&i&&this._removeFromSimulation()}},{key:"simulation",get:function(){return this._simulation}},{key:"collisionGroup",get:function(){return this._collisionGroup},set:function(e){this._collisionGroup!==e&&(this._collisionGroup=e,this._simulation&&this._colliderShape&&this._enabled&&(this._removeFromSimulation(),this._addToSimulation()))}},{key:"canCollideWith",get:function(){return this._canCollideWith},set:function(e){this._canCollideWith!==e&&(this._canCollideWith=e,this._simulation&&this._colliderShape&&this._enabled&&(this._removeFromSimulation(),this._addToSimulation()))}},{key:"_parseShape",value:function(e){var t=e.length;if(1===t){var i=c._creatShape(e[0]);this.colliderShape=i}else{for(var n=new ws,a=0;a<t;a++)i=c._creatShape(e[a]),n.addChildShape(i);this.colliderShape=n}}},{key:"_onScaleChange",value:function(e){this._colliderShape._setScale(e)}},{key:"_onEnable",value:function(){this._simulation=this.owner._scene.physicsSimulation,Ea._bullet.btCollisionObject_setContactProcessingThreshold(this._btColliderObject,1e30),this._colliderShape&&this._enabled&&(this._derivePhysicsTransformation(!0),this._addToSimulation())}},{key:"_onDisable",value:function(){this._colliderShape&&this._enabled&&(this._removeFromSimulation(),-1!==this._inPhysicUpdateListIndex&&this._simulation._physicsUpdateList.remove(this)),this._simulation=null}},{key:"_onDestroy",value:function(){delete c._physicObjectsMap[this.id],Ea._bullet.btCollisionObject_destroy(this._btColliderObject),this._colliderShape.destroy(),m(g(c.prototype),"_onDestroy",this).call(this),this._btColliderObject=null,this._colliderShape=null,this._simulation=null,this.owner.transform.off(Me.TRANSFORM_CHANGED,this,this._onTransformChanged)}},{key:"_isValid",value:function(){return this._simulation&&this._colliderShape&&this._enabled}},{key:"_parse",value:function(e){null!=e.collisionGroup&&(this.collisionGroup=e.collisionGroup),null!=e.canCollideWith&&(this.canCollideWith=e.canCollideWith),null!=e.ccdMotionThreshold&&(this.ccdMotionThreshold=e.ccdMotionThreshold),null!=e.ccdSweptSphereRadius&&(this.ccdSweptSphereRadius=e.ccdSweptSphereRadius)}},{key:"_setTransformFlag",value:function(e,t){t?this._transformFlag|=e:this._transformFlag&=~e}},{key:"_getTransformFlag",value:function(e){return 0!=(this._transformFlag&e)}},{key:"_addToSimulation",value:function(){}},{key:"_removeFromSimulation",value:function(){}},{key:"_derivePhysicsTransformation",value:function(e){this._innerDerivePhysicsTransformation(Ea._bullet.btCollisionObject_getWorldTransform(this._btColliderObject),e)}},{key:"_innerDerivePhysicsTransformation",value:function(e,t){var i,n,a,s,r=Ea._bullet,o=this.owner._transform;(t||this._getTransformFlag(Ya.TRANSFORM_WORLDPOSITION))&&(n=this._colliderShape.localOffset,a=o.position,s=c._btVector30,0!==n.x||0!==n.y||0!==n.z?(i=o.worldMatrix,R.transformCoordinate(n,i,n=c._tempVector30),r.btVector3_setValue(s,-n.x,n.y,n.z)):r.btVector3_setValue(s,-a.x,a.y,a.z),r.btTransform_setOrigin(e,s),this._setTransformFlag(Ya.TRANSFORM_WORLDPOSITION,!1)),(t||this._getTransformFlag(Ya.TRANSFORM_WORLDQUATERNION))&&(i=this._colliderShape.localRotation,n=c._btQuaternion0,a=o.rotation,0!==i.x||0!==i.y||0!==i.z||1!==i.w?(c.physicQuaternionMultiply(a.x,a.y,a.z,a.w,i,s=c._tempQuaternion0),r.btQuaternion_setValue(n,-s.x,s.y,s.z,-s.w)):r.btQuaternion_setValue(n,-a.x,a.y,a.z,-a.w),r.btTransform_setRotation(e,n),this._setTransformFlag(Ya.TRANSFORM_WORLDQUATERNION,!1)),(t||this._getTransformFlag(Ya.TRANSFORM_WORLDSCALE))&&(this._onScaleChange(o.getWorldLossyScale()),this._setTransformFlag(Ya.TRANSFORM_WORLDSCALE,!1))}},{key:"_updateTransformComponent",value:function(e){var t=Ea._bullet,i=this._colliderShape.localOffset,n=this._colliderShape.localRotation,a=this.owner._transform,s=a.position,r=a.rotation,o=t.btTransform_getOrigin(e),e=t.btTransform_getRotation(e),h=-t.btQuaternion_x(e),l=t.btQuaternion_y(e),u=t.btQuaternion_z(e),e=-t.btQuaternion_w(e);0!==i.x||0!==i.y||0!==i.z?(c.physicVector3TransformQuat(i,h,l,u,e,i=c._tempVector30),s.x=-t.btVector3_x(o)-i.x,s.y=t.btVector3_y(o)-i.y,s.z=t.btVector3_z(o)-i.z):(s.x=-t.btVector3_x(o),s.y=t.btVector3_y(o),s.z=t.btVector3_z(o)),a.position=s,0!==n.x||0!==n.y||0!==n.z||1!==n.w?(n.invert(i=c._tempQuaternion0),c.physicQuaternionMultiply(h,l,u,e,i,r)):(r.x=h,r.y=l,r.z=u,r.w=e),a.rotation=r}},{key:"_onShapeChange",value:function(e){var t=this._btColliderObject,i=Ea._bullet,n=i.btCollisionObject_getCollisionFlags(t);e.needsCustomCollisionCallback?0==(n&c.COLLISIONFLAGS_CUSTOM_MATERIAL_CALLBACK)&&i.btCollisionObject_setCollisionFlags(t,n|c.COLLISIONFLAGS_CUSTOM_MATERIAL_CALLBACK):0<(n&c.COLLISIONFLAGS_CUSTOM_MATERIAL_CALLBACK)&&i.btCollisionObject_setCollisionFlags(t,n^c.COLLISIONFLAGS_CUSTOM_MATERIAL_CALLBACK)}},{key:"_onAdded",value:function(){this.enabled=this._enabled,this.restitution=this._restitution,this.friction=this._friction,this.rollingFriction=this._rollingFriction,this.ccdMotionThreshold=this._ccdMotionThreshold,this.ccdSweptSphereRadius=this._ccdSweptSphereRadius,this.owner.transform.on(Me.TRANSFORM_CHANGED,this,this._onTransformChanged)}},{key:"_onTransformChanged",value:function(e){c._addUpdateList&&(e&=Ya.TRANSFORM_WORLDPOSITION|Ya.TRANSFORM_WORLDQUATERNION|Ya.TRANSFORM_WORLDSCALE)&&(this._transformFlag|=e,this._isValid()&&-1===this._inPhysicUpdateListIndex&&this._simulation._physicsUpdateList.add(this))}},{key:"_cloneTo",value:function(e){e.restitution=this._restitution,e.friction=this._friction,e.rollingFriction=this._rollingFriction,e.ccdMotionThreshold=this._ccdMotionThreshold,e.ccdSweptSphereRadius=this._ccdSweptSphereRadius,e.collisionGroup=this._collisionGroup,e.canCollideWith=this._canCollideWith,e.canScaleShape=this.canScaleShape,this._colliderShape&&(e.colliderShape=this._colliderShape.clone())}}],[{key:"__init__",value:function(){var e=Ea._bullet;c._btVector30=e.btVector3_create(0,0,0),c._btQuaternion0=e.btQuaternion_create(0,0,0,1)}},{key:"_createAffineTransformationArray",value:function(e,t,i,n,a,s,r,o,h){var l=n+n,u=a+a,c=s+s,_=n*l,f=n*u,n=n*c,d=a*u,a=a*c,s=s*c,l=r*l,u=r*u,r=r*c,c=o[0],p=o[1],o=o[2];h[0]=(1-(d+s))*c,h[1]=(f+r)*c,h[2]=(n-u)*c,h[3]=0,h[4]=(f-r)*p,h[5]=(1-(_+s))*p,h[6]=(a+l)*p,h[7]=0,h[8]=(n+u)*o,h[9]=(a-l)*o,h[10]=(1-(_+d))*o,h[11]=0,h[12]=e,h[13]=t,h[14]=i,h[15]=1}},{key:"_creatShape",value:function(e){var t;switch(e.type){case"BoxColliderShape":var i=e.size,n=i?new xs(i[0],i[1],i[2]):new xs;break;case"SphereColliderShape":n=new Ts(e.radius);break;case"CapsuleColliderShape":n=new ks(e.radius,e.height,e.orientation);break;case"MeshColliderShape":i=new Is;e.mesh&&(i.mesh=E.getRes(e.mesh)),n=i;break;case"ConeColliderShape":n=new bs(e.radius,e.height,e.orientation);break;case"CylinderColliderShape":n=new Ss(e.radius,e.height,e.orientation);break;default:throw"unknown shape type."}return e.center&&((t=n.localOffset).fromArray(e.center),n.localOffset=t),n}},{key:"physicVector3TransformQuat",value:function(e,t,i,n,a,s){var r=e.x,o=e.y,e=e.z,h=a*r+i*e-n*o,l=a*o+n*r-t*e,u=a*e+t*o-i*r,r=-t*r-i*o-n*e;s.x=h*a+r*-t+l*-n-u*-i,s.y=l*a+r*-i+u*-t-h*-n,s.z=u*a+r*-n+h*-i-l*-t}},{key:"physicQuaternionMultiply",value:function(e,t,i,n,a,s){var r=a.x,o=a.y,h=a.z,a=a.w,l=i*r-e*h,u=e*o-t*r,c=e*r+t*o+i*h;s.x=e*a+r*n+(t*h-i*o),s.y=t*a+o*n+l,s.z=i*a+h*n+u,s.w=n*a-c}}]),c}(),Ms=(Cs.ACTIVATIONSTATE_ACTIVE_TAG=1,Cs.ACTIVATIONSTATE_ISLAND_SLEEPING=2,Cs.ACTIVATIONSTATE_WANTS_DEACTIVATION=3,Cs.ACTIVATIONSTATE_DISABLE_DEACTIVATION=4,Cs.ACTIVATIONSTATE_DISABLE_SIMULATION=5,Cs.COLLISIONFLAGS_STATIC_OBJECT=1,Cs.COLLISIONFLAGS_KINEMATIC_OBJECT=2,Cs.COLLISIONFLAGS_NO_CONTACT_RESPONSE=4,Cs.COLLISIONFLAGS_CUSTOM_MATERIAL_CALLBACK=8,Cs.COLLISIONFLAGS_CHARACTER_OBJECT=16,Cs.COLLISIONFLAGS_DISABLE_VISUALIZE_OBJECT=32,Cs.COLLISIONFLAGS_DISABLE_SPU_COLLISION_PROCESSING=64,Cs._tempVector30=new R,Cs._tempQuaternion0=new Ca,Cs._tempQuaternion1=new Ca,Cs._tempMatrix4x40=new Pa,Cs._physicObjectsMap={},Cs._addUpdateList=!0,function(){function T(e){b(this,T),this._gravity=new R(0,-10,0),this._btVector3Zero=Ea._bullet.btVector3_create(0,0,0),this._btDefaultQuaternion=Ea._bullet.btQuaternion_create(0,0,0,-1),this._collisionsUtils=new ms,this._previousFrameCollisions=[],this._currentFrameCollisions=[],this._physicsUpdateList=new ps,this._characters=[],this._updatedRigidbodies=0,this.maxSubSteps=1,this.fixedTimeStep=1/60,this.maxSubSteps=e.maxSubSteps,this.fixedTimeStep=e.fixedTimeStep;var t=Ea._bullet,e=(this._btCollisionConfiguration=t.btDefaultCollisionConfiguration_create(),this._btDispatcher=t.btCollisionDispatcher_create(this._btCollisionConfiguration),this._btBroadphase=t.btDbvtBroadphase_create(),t.btOverlappingPairCache_setInternalGhostPairCallback(t.btDbvtBroadphase_getOverlappingPairCache(this._btBroadphase),t.btGhostPairCallback_create()),e.flags);if(e&T.PHYSICSENGINEFLAGS_COLLISIONSONLY)this._btCollisionWorld=new t.btCollisionWorld(this._btDispatcher,this._btBroadphase,this._btCollisionConfiguration);else{if(e&T.PHYSICSENGINEFLAGS_SOFTBODYSUPPORT)throw"PhysicsSimulation:SoftBody processing is not yet available";e=t.btSequentialImpulseConstraintSolver_create();this._btDiscreteDynamicsWorld=t.btDiscreteDynamicsWorld_create(this._btDispatcher,this._btBroadphase,e,this._btCollisionConfiguration),this._btCollisionWorld=this._btDiscreteDynamicsWorld}this._btDiscreteDynamicsWorld&&(this._btSolverInfo=t.btDynamicsWorld_getSolverInfo(this._btDiscreteDynamicsWorld),this._btDispatchInfo=t.btCollisionWorld_getDispatchInfo(this._btDiscreteDynamicsWorld)),this._btClosestRayResultCallback=t.ClosestRayResultCallback_create(this._btVector3Zero,this._btVector3Zero),this._btAllHitsRayResultCallback=t.AllHitsRayResultCallback_create(this._btVector3Zero,this._btVector3Zero),this._btClosestConvexResultCallback=t.ClosestConvexResultCallback_create(this._btVector3Zero,this._btVector3Zero),this._btAllConvexResultCallback=t.AllConvexResultCallback_create(this._btVector3Zero,this._btVector3Zero),t.btGImpactCollisionAlgorithm_RegisterAlgorithm(this._btDispatcher)}return y(T,[{key:"continuousCollisionDetection",get:function(){return Ea._bullet.btCollisionWorld_get_m_useContinuous(this._btDispatchInfo)},set:function(e){Ea._bullet.btCollisionWorld_set_m_useContinuous(this._btDispatchInfo,e)}},{key:"gravity",get:function(){if(this._btDiscreteDynamicsWorld)return this._gravity;throw"Simulation:Cannot perform this action when the physics engine is set to CollisionsOnly"},set:function(e){if(!this._btDiscreteDynamicsWorld)throw"Simulation:Cannot perform this action when the physics engine is set to CollisionsOnly";this._gravity=e;var t=Ea._bullet,i=T._btTempVector30;t.btVector3_setValue(i,-e.x,e.y,e.z),t.btDiscreteDynamicsWorld_setGravity(this._btDiscreteDynamicsWorld,i)}},{key:"speculativeContactRestitution",get:function(){if(this._btDiscreteDynamicsWorld)return Ea._bullet.btDiscreteDynamicsWorld_getApplySpeculativeContactRestitution(this._btDiscreteDynamicsWorld);throw"Simulation:Cannot Cannot perform this action when the physics engine is set to CollisionsOnly"},set:function(e){if(!this._btDiscreteDynamicsWorld)throw"Simulation:Cannot Cannot perform this action when the physics engine is set to CollisionsOnly";Ea._bullet.btDiscreteDynamicsWorld_setApplySpeculativeContactRestitution(this._btDiscreteDynamicsWorld,e)}},{key:"_simulate",value:function(e){this._updatedRigidbodies=0;var t=Ea._bullet;this._btDiscreteDynamicsWorld?t.btDiscreteDynamicsWorld_stepSimulation(this._btDiscreteDynamicsWorld,e,this.maxSubSteps,this.fixedTimeStep):t.PerformDiscreteCollisionDetection(this._btCollisionWorld)}},{key:"_destroy",value:function(){var e=Ea._bullet;this._btDiscreteDynamicsWorld?(e.btCollisionWorld_destroy(this._btDiscreteDynamicsWorld),this._btDiscreteDynamicsWorld=null):(e.btCollisionWorld_destroy(this._btCollisionWorld),this._btCollisionWorld=null),e.btDbvtBroadphase_destroy(this._btBroadphase),this._btBroadphase=null,e.btCollisionDispatcher_destroy(this._btDispatcher),this._btDispatcher=null,e.btDefaultCollisionConfiguration_destroy(this._btCollisionConfiguration),this._btCollisionConfiguration=null}},{key:"_addPhysicsCollider",value:function(e,t,i){Ea._bullet.btCollisionWorld_addCollisionObject(this._btCollisionWorld,e._btColliderObject,t,i)}},{key:"_removePhysicsCollider",value:function(e){Ea._bullet.btCollisionWorld_removeCollisionObject(this._btCollisionWorld,e._btColliderObject)}},{key:"_addRigidBody",value:function(e,t,i){if(!this._btDiscreteDynamicsWorld)throw"Simulation:Cannot perform this action when the physics engine is set to CollisionsOnly";Ea._bullet.btDiscreteDynamicsWorld_addRigidBody(this._btCollisionWorld,e._btColliderObject,t,i)}},{key:"_removeRigidBody",value:function(e){if(!this._btDiscreteDynamicsWorld)throw"Simulation:Cannot perform this action when the physics engine is set to CollisionsOnly";Ea._bullet.btDiscreteDynamicsWorld_removeRigidBody(this._btCollisionWorld,e._btColliderObject)}},{key:"_addCharacter",value:function(e,t,i){if(!this._btDiscreteDynamicsWorld)throw"Simulation:Cannot perform this action when the physics engine is set to CollisionsOnly";var n=Ea._bullet;n.btCollisionWorld_addCollisionObject(this._btCollisionWorld,e._btColliderObject,t,i),n.btDynamicsWorld_addAction(this._btCollisionWorld,e._btKinematicCharacter)}},{key:"_removeCharacter",value:function(e){if(!this._btDiscreteDynamicsWorld)throw"Simulation:Cannot perform this action when the physics engine is set to CollisionsOnly";var t=Ea._bullet;t.btCollisionWorld_removeCollisionObject(this._btCollisionWorld,e._btColliderObject),t.btDynamicsWorld_removeAction(this._btCollisionWorld,e._btKinematicCharacter)}},{key:"raycastFromTo",value:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:ds.COLLISIONFILTERGROUP_ALLFILTER,a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:ds.COLLISIONFILTERGROUP_ALLFILTER,s=Ea._bullet,r=this._btClosestRayResultCallback,o=T._btTempVector30,h=T._btTempVector31;return s.btVector3_setValue(o,-e.x,e.y,e.z),s.btVector3_setValue(h,-t.x,t.y,t.z),s.ClosestRayResultCallback_set_m_rayFromWorld(r,o),s.ClosestRayResultCallback_set_m_rayToWorld(r,h),s.RayResultCallback_set_m_collisionFilterGroup(r,n),s.RayResultCallback_set_m_collisionFilterMask(r,a),s.RayResultCallback_set_m_collisionObject(r,null),s.RayResultCallback_set_m_closestHitFraction(r,1),s.btCollisionWorld_rayTest(this._btCollisionWorld,o,h,r),s.RayResultCallback_hasHit(r)?(i&&(i.succeeded=!0,i.collider=Cs._physicObjectsMap[s.btCollisionObject_getUserIndex(s.RayResultCallback_get_m_collisionObject(r))],i.hitFraction=s.RayResultCallback_get_m_closestHitFraction(r),e=s.ClosestRayResultCallback_get_m_hitPointWorld(r),(t=i.point).x=-s.btVector3_x(e),t.y=s.btVector3_y(e),t.z=s.btVector3_z(e),n=s.ClosestRayResultCallback_get_m_hitNormalWorld(r),(a=i.normal).x=-s.btVector3_x(n),a.y=s.btVector3_y(n),a.z=s.btVector3_z(n)),!0):(i&&(i.succeeded=!1),!1)}},{key:"raycastAllFromTo",value:function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:ds.COLLISIONFILTERGROUP_ALLFILTER,a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:ds.COLLISIONFILTERGROUP_ALLFILTER,s=Ea._bullet,r=this._btAllHitsRayResultCallback,o=T._btTempVector30,h=T._btTempVector31,l=(i.length=0,s.btVector3_setValue(o,-e.x,e.y,e.z),s.btVector3_setValue(h,-t.x,t.y,t.z),s.AllHitsRayResultCallback_set_m_rayFromWorld(r,o),s.AllHitsRayResultCallback_set_m_rayToWorld(r,h),s.RayResultCallback_set_m_collisionFilterGroup(r,n),s.RayResultCallback_set_m_collisionFilterMask(r,a),s.AllHitsRayResultCallback_get_m_collisionObjects(r)),u=s.AllHitsRayResultCallback_get_m_hitPointWorld(r),c=s.AllHitsRayResultCallback_get_m_hitNormalWorld(r),_=s.AllHitsRayResultCallback_get_m_hitFractions(r),f=(s.tBtCollisionObjectArray_clear(l),s.tVector3Array_clear(u),s.tVector3Array_clear(c),s.tScalarArray_clear(_),s.btCollisionWorld_rayTest(this._btCollisionWorld,o,h,r),s.tBtCollisionObjectArray_size(l));if(0<f){this._collisionsUtils.recoverAllHitResultsPool();for(var d=0;d<f;d++){var p=this._collisionsUtils.getHitResult(),y=(i.push(p),p.succeeded=!0,p.collider=Cs._physicObjectsMap[s.btCollisionObject_getUserIndex(s.tBtCollisionObjectArray_at(l,d))],p.hitFraction=s.tScalarArray_at(_,d),s.tVector3Array_at(u,d)),g=p.point,g=(g.x=-s.btVector3_x(y),g.y=s.btVector3_y(y),g.z=s.btVector3_z(y),s.tVector3Array_at(c,d)),y=p.normal;y.x=-s.btVector3_x(g),y.y=s.btVector3_y(g),y.z=s.btVector3_z(g)}return!0}return!1}},{key:"rayCast",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:2147483647,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:ds.COLLISIONFILTERGROUP_ALLFILTER,a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:ds.COLLISIONFILTERGROUP_ALLFILTER,s=e.origin,r=T._tempVector30;return R.normalize(e.direction,r),R.scale(r,i,r),R.add(s,r,r),this.raycastFromTo(s,r,t,n,a)}},{key:"rayCastAll",value:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:2147483647,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:ds.COLLISIONFILTERGROUP_ALLFILTER,a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:ds.COLLISIONFILTERGROUP_ALLFILTER,s=e.origin,r=T._tempVector30;return R.normalize(e.direction,r),R.scale(r,i,r),R.add(s,r,r),this.raycastAllFromTo(s,r,t,n,a)}},{key:"shapeCast",value:function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null,s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:null,r=6<arguments.length&&void 0!==arguments[6]?arguments[6]:ds.COLLISIONFILTERGROUP_ALLFILTER,o=7<arguments.length&&void 0!==arguments[7]?arguments[7]:ds.COLLISIONFILTERGROUP_ALLFILTER,h=8<arguments.length&&void 0!==arguments[8]?arguments[8]:0,l=Ea._bullet,u=this._btClosestConvexResultCallback,c=T._btTempVector30,_=T._btTempVector31,f=T._btTempQuaternion0,d=T._btTempQuaternion1,p=T._btTempTransform0,y=T._btTempTransform1,e=e._btShape;return l.btVector3_setValue(c,-t.x,t.y,t.z),l.btVector3_setValue(_,-i.x,i.y,i.z),l.ConvexResultCallback_set_m_collisionFilterGroup(u,r),l.ConvexResultCallback_set_m_collisionFilterMask(u,o),l.btTransform_setOrigin(p,c),l.btTransform_setOrigin(y,_),a?(l.btQuaternion_setValue(f,-a.x,a.y,a.z,-a.w),l.btTransform_setRotation(p,f)):l.btTransform_setRotation(p,this._btDefaultQuaternion),s?(l.btQuaternion_setValue(d,-s.x,s.y,s.z,-s.w),l.btTransform_setRotation(y,d)):l.btTransform_setRotation(y,this._btDefaultQuaternion),l.ClosestConvexResultCallback_set_m_hitCollisionObject(u,null),l.ConvexResultCallback_set_m_closestHitFraction(u,1),l.btCollisionWorld_convexSweepTest(this._btCollisionWorld,e,p,y,u,h),l.ConvexResultCallback_hasHit(u)?(n&&(n.succeeded=!0,n.collider=Cs._physicObjectsMap[l.btCollisionObject_getUserIndex(l.ClosestConvexResultCallback_get_m_hitCollisionObject(u))],n.hitFraction=l.ConvexResultCallback_get_m_closestHitFraction(u),t=l.ClosestConvexResultCallback_get_m_hitPointWorld(u),i=l.ClosestConvexResultCallback_get_m_hitNormalWorld(u),r=n.point,o=n.normal,r.x=-l.btVector3_x(t),r.y=l.btVector3_y(t),r.z=l.btVector3_z(t),o.x=-l.btVector3_x(i),o.y=l.btVector3_y(i),o.z=l.btVector3_z(i)),!0):(n&&(n.succeeded=!1),!1)}},{key:"shapeCastAll",value:function(e,t,i,n){var a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null,s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:null,r=6<arguments.length&&void 0!==arguments[6]?arguments[6]:ds.COLLISIONFILTERGROUP_ALLFILTER,o=7<arguments.length&&void 0!==arguments[7]?arguments[7]:ds.COLLISIONFILTERGROUP_ALLFILTER,h=8<arguments.length&&void 0!==arguments[8]?arguments[8]:0,l=Ea._bullet,u=this._btAllConvexResultCallback,c=T._btTempVector30,_=T._btTempVector31,f=T._btTempQuaternion0,d=T._btTempQuaternion1,p=T._btTempTransform0,y=T._btTempTransform1,e=e._btShape,g=(n.length=0,l.btVector3_setValue(c,-t.x,t.y,t.z),l.btVector3_setValue(_,-i.x,i.y,i.z),l.ConvexResultCallback_set_m_collisionFilterGroup(u,r),l.ConvexResultCallback_set_m_collisionFilterMask(u,o),l.btTransform_setOrigin(p,c),l.btTransform_setOrigin(y,_),a?(l.btQuaternion_setValue(f,-a.x,a.y,a.z,-a.w),l.btTransform_setRotation(p,f)):l.btTransform_setRotation(p,this._btDefaultQuaternion),s?(l.btQuaternion_setValue(d,-s.x,s.y,s.z,-s.w),l.btTransform_setRotation(y,d)):l.btTransform_setRotation(y,this._btDefaultQuaternion),l.AllConvexResultCallback_get_m_collisionObjects(u)),m=(l.tBtCollisionObjectArray_clear(g),l.btCollisionWorld_convexSweepTest(this._btCollisionWorld,e,p,y,u,h),l.tBtCollisionObjectArray_size(g));if(0<m){for(var v=l.AllConvexResultCallback_get_m_hitPointWorld(u),x=l.AllConvexResultCallback_get_m_hitNormalWorld(u),k=l.AllConvexResultCallback_get_m_hitFractions(u),w=0;w<m;w++){var b=this._collisionsUtils.getHitResult(),S=(n.push(b),b.succeeded=!0,b.collider=Cs._physicObjectsMap[l.btCollisionObject_getUserIndex(l.tBtCollisionObjectArray_at(g,w))],b.hitFraction=l.tScalarArray_at(k,w),l.tVector3Array_at(v,w)),I=b.point,I=(I.x=-l.btVector3_x(S),I.y=l.btVector3_y(S),I.z=l.btVector3_z(S),l.tVector3Array_at(x,w)),S=b.normal;S.x=-l.btVector3_x(I),S.y=l.btVector3_y(I),S.z=l.btVector3_z(I)}return!0}return!1}},{key:"addConstraint",value:function(e){if(!this._btDiscreteDynamicsWorld)throw"Cannot perform this action when the physics engine is set to CollisionsOnly";e._simulation=this}},{key:"removeConstraint",value:function(e){if(!this._btDiscreteDynamicsWorld)throw"Cannot perform this action when the physics engine is set to CollisionsOnly"}},{key:"_updatePhysicsTransformFromRender",value:function(){for(var e=this._physicsUpdateList.elements,t=0,i=this._physicsUpdateList.length;t<i;t++){var n=e[t];n._derivePhysicsTransformation(!1),n._inPhysicUpdateListIndex=-1}this._physicsUpdateList.length=0}},{key:"_updateCharacters",value:function(){for(var e=0,t=this._characters.length;e<t;e++){var i=this._characters[e];i._updateTransformComponent(Ea._bullet.btCollisionObject_getWorldTransform(i._btColliderObject))}}},{key:"_updateCollisions",value:function(){this._collisionsUtils.recoverAllContactPointsPool();for(var e=this._currentFrameCollisions,t=(this._currentFrameCollisions=this._previousFrameCollisions,this._currentFrameCollisions.length=0,this._previousFrameCollisions=e,k.loopCount),i=Ea._bullet,n=i.btDispatcher_getNumManifolds(this._btDispatcher),a=0;a<n;a++){var s,r=i.btDispatcher_getManifoldByIndexInternal(this._btDispatcher,a),o=Cs._physicObjectsMap[i.btCollisionObject_getUserIndex(i.btPersistentManifold_getBody0(r))],h=Cs._physicObjectsMap[i.btCollisionObject_getUserIndex(i.btPersistentManifold_getBody1(r))],l=null,u=null;if((o.isTrigger||h.isTrigger)&&(o.owner._needProcessTriggers||h.owner._needProcessTriggers))for(var c=i.btPersistentManifold_getNumContacts(r),_=0;_<c;_++){var f=i.btPersistentManifold_getContactPoint(r,_),d=i.btManifoldPoint_getDistance(f);if(d<=0){u=(l=this._collisionsUtils.getCollision(o,h)).contacts,(s=l._updateFrame!==t)&&(l._isTrigger=!0,u.length=0);break}}else if((o.owner._needProcessCollisions||h.owner._needProcessCollisions)&&(o._enableProcessCollisions||h._enableProcessCollisions))for(c=i.btPersistentManifold_getNumContacts(r),_=0;_<c;_++){var p,y,g,f=i.btPersistentManifold_getContactPoint(r,_);(d=i.btManifoldPoint_getDistance(f))<=0&&((p=this._collisionsUtils.getContactPoints()).colliderA=o,p.colliderB=h,p.distance=d,y=i.btManifoldPoint_get_m_normalWorldOnB(f),(g=p.normal).x=-i.btVector3_x(y),g.y=i.btVector3_y(y),g.z=i.btVector3_z(y),g=i.btManifoldPoint_get_m_positionWorldOnA(f),(y=p.positionOnA).x=-i.btVector3_x(g),y.y=i.btVector3_y(g),y.z=i.btVector3_z(g),y=i.btManifoldPoint_get_m_positionWorldOnB(f),(g=p.positionOnB).x=-i.btVector3_x(y),g.y=i.btVector3_y(y),g.z=i.btVector3_z(y),l||(u=(l=this._collisionsUtils.getCollision(o,h)).contacts,(s=l._updateFrame!==t)&&(l._isTrigger=!1,u.length=0)),u.push(p))}l&&s&&(this._currentFrameCollisions.push(l),l._setUpdateFrame(t))}}},{key:"_eventScripts",value:function(){for(var e=k.loopCount,t=0,i=this._currentFrameCollisions.length;t<i;t++){var n=this._currentFrameCollisions[t],a=n._colliderA,s=n._colliderB;if(!a.destroyed&&!s.destroyed)if(e-n._lastUpdateFrame==1){var r=a.owner,o=r._scripts;if(o)if(n._isTrigger){if(r._needProcessTriggers)for(var h=0,l=o.length;h<l;h++)o[h].onTriggerStay(s)}else if(r._needProcessCollisions)for(h=0,l=o.length;h<l;h++)n.other=s,o[h].onCollisionStay(n);var u=s.owner,c=u._scripts;if(c)if(n._isTrigger){if(u._needProcessTriggers)for(h=0,l=c.length;h<l;h++)c[h].onTriggerStay(a)}else if(u._needProcessCollisions)for(h=0,l=c.length;h<l;h++)n.other=a,c[h].onCollisionStay(n)}else{if(o=(r=a.owner)._scripts)if(n._isTrigger){if(r._needProcessTriggers)for(h=0,l=o.length;h<l;h++)o[h].onTriggerEnter(s)}else if(r._needProcessCollisions)for(h=0,l=o.length;h<l;h++)n.other=s,o[h].onCollisionEnter(n);if(c=(u=s.owner)._scripts)if(n._isTrigger){if(u._needProcessTriggers)for(h=0,l=c.length;h<l;h++)c[h].onTriggerEnter(a)}else if(u._needProcessCollisions)for(h=0,l=c.length;h<l;h++)n.other=a,c[h].onCollisionEnter(n)}}for(t=0,i=this._previousFrameCollisions.length;t<i;t++){var _=this._previousFrameCollisions[t],f=_._colliderA,d=_._colliderB;if(!f.destroyed&&!d.destroyed&&e-_._updateFrame==1){if(this._collisionsUtils.recoverCollision(_),o=(r=f.owner)._scripts)if(_._isTrigger){if(r._needProcessTriggers)for(h=0,l=o.length;h<l;h++)o[h].onTriggerExit(d)}else if(r._needProcessCollisions)for(h=0,l=o.length;h<l;h++)_.other=d,o[h].onCollisionExit(_);if(c=(u=d.owner)._scripts)if(_._isTrigger){if(u._needProcessTriggers)for(h=0,l=c.length;h<l;h++)c[h].onTriggerExit(f)}else if(u._needProcessCollisions)for(h=0,l=c.length;h<l;h++)_.other=f,c[h].onCollisionExit(_)}}}},{key:"clearForces",value:function(){if(!this._btDiscreteDynamicsWorld)throw"Cannot perform this action when the physics engine is set to CollisionsOnly";Ea._bullet.btDiscreteDynamicsWorld_clearForces(this._btDiscreteDynamicsWorld)}}],[{key:"__init__",value:function(){var e=Ea._bullet;T._btTempVector30=e.btVector3_create(0,0,0),T._btTempVector31=e.btVector3_create(0,0,0),T._btTempQuaternion0=e.btQuaternion_create(0,0,0,1),T._btTempQuaternion1=e.btQuaternion_create(0,0,0,1),T._btTempTransform0=e.btTransform_create(),T._btTempTransform1=e.btTransform_create()}},{key:"createConstraint",value:function(){}}]),T}()),Es=(Ms.PHYSICSENGINEFLAGS_NONE=0,Ms.PHYSICSENGINEFLAGS_COLLISIONSONLY=1,Ms.PHYSICSENGINEFLAGS_SOFTBODYSUPPORT=2,Ms.PHYSICSENGINEFLAGS_MULTITHREADED=4,Ms.PHYSICSENGINEFLAGS_USEHARDWAREWHENPOSSIBLE=8,Ms.SOLVERMODE_RANDMIZE_ORDER=1,Ms.SOLVERMODE_FRICTION_SEPARATE=2,Ms.SOLVERMODE_USE_WARMSTARTING=4,Ms.SOLVERMODE_USE_2_FRICTION_DIRECTIONS=16,Ms.SOLVERMODE_ENABLE_FRICTION_DIRECTION_CACHING=32,Ms.SOLVERMODE_DISABLE_VELOCITY_DEPENDENT_FRICTION_DIRECTION=64,Ms.SOLVERMODE_CACHE_FRIENDLY=128,Ms.SOLVERMODE_SIMD=256,Ms.SOLVERMODE_INTERLEAVE_CONTACT_AND_FRICTION_CONSTRAINTS=512,Ms.SOLVERMODE_ALLOW_ZERO_LENGTH_FRICTION_DIRECTIONS=1024,Ms._tempVector30=new R,Ms.disableSimulation=!1,function(){function d(){var t=this;b(this,d),this._eventList=[],this._mouseTouch=new Ja,this._touchPool=[],this._touches=new Wa,this._multiTouchEnabled=!0,this._pushEventList=function(e){e.cancelable&&e.preventDefault(),t._eventList.push(e)}.bind(this)}return y(d,[{key:"__init__",value:function(e,t){this._scene=t,e.oncontextmenu=function(e){return!1}}},{key:"_onCanvasEvent",value:function(e){e.addEventListener("mousedown",this._pushEventList),e.addEventListener("mouseup",this._pushEventList,!0),e.addEventListener("mousemove",this._pushEventList,!0),e.addEventListener("touchstart",this._pushEventList),e.addEventListener("touchend",this._pushEventList,!0),e.addEventListener("touchmove",this._pushEventList,!0),e.addEventListener("touchcancel",this._pushEventList,!0)}},{key:"_offCanvasEvent",value:function(e){e.removeEventListener("mousedown",this._pushEventList),e.removeEventListener("mouseup",this._pushEventList,!0),e.removeEventListener("mousemove",this._pushEventList,!0),e.removeEventListener("touchstart",this._pushEventList),e.removeEventListener("touchend",this._pushEventList,!0),e.removeEventListener("touchmove",this._pushEventList,!0),e.removeEventListener("touchcancel",this._pushEventList,!0),this._eventList.length=0,this._touches.clear()}},{key:"touchCount",value:function(){return this._touches.length}},{key:"multiTouchEnabled",get:function(){return this._multiTouchEnabled},set:function(e){this._multiTouchEnabled=e}},{key:"_getTouch",value:function(e){var t=this._touchPool[e];return t||(t=new $a,(this._touchPool[e]=t)._identifier=e),t}},{key:"_mouseTouchDown",value:function(){var e=this._mouseTouch,t=e.sprite;if(e._pressedSprite=t,e._pressedLoopCount=k.loopCount,t){var i=t._scripts;if(i)for(var n=0,a=i.length;n<a;n++)i[n].onMouseDown()}}},{key:"_mouseTouchUp",value:function(){var e,t,i=this._mouseTouch,n=i._pressedSprite,i=(i._pressedSprite=null,i._pressedLoopCount=-1,i.sprite);if(i&&i===n){var a=i._scripts;if(a)for(e=0,t=a.length;e<t;e++)a[e].onMouseClick()}if(n){var s=n._scripts;if(s)for(e=0,t=s.length;e<t;e++)s[e].onMouseUp()}}},{key:"_mouseTouchRayCast",value:function(e){var t=d._tempHitResult0,i=d._tempVector20,n=d._tempRay0,a=(t.succeeded=!1,this._mouseTouch.mousePositionX),s=this._mouseTouch.mousePositionY;i.x=a,i.y=s;for(var r=e.length-1;0<=r;r--){var o=e[r],h=o.viewport;if(i.x>=h.x&&i.y>=h.y&&i.x<=h.width&&i.y<=h.height)if(o.viewportPointToRay(i,n),this._scene._physicsSimulation.rayCast(n,t)||o.clearFlag===cs.CLEARFLAG_SOLIDCOLOR||o.clearFlag===cs.CLEARFLAG_SKY)break}a=this._mouseTouch,s=a.sprite;if(t.succeeded){var l=t.collider.owner,u=(a.sprite=l)._scripts;if(s!==l&&u)for(var c=0,_=u.length;c<_;c++)u[c].onMouseEnter()}else a.sprite=null;if(s&&s!==l){var f=s._scripts;if(f)for(c=0,_=f.length;c<_;c++)f[c].onMouseOut()}}},{key:"_changeTouches",value:function(e,t){for(var i=0,n=0,a=this._touches.length,s=0,r=e.length;s<r;s++){var o=e[s],h=o.identifier;if(this._multiTouchEnabled||0===h){var l=this._getTouch(h),u=l._position,h=d._tempPoint,c=(h.setTo(o.pageX,o.pageY),L.stage._canvasTransform.invertTransformPoint(h),h.x),_=h.y;switch(t){case 0:this._touches.add(l),i+=c,n+=_;break;case 1:this._touches.remove(l),i-=c,n-=_;break;case 2:i=c-u.x,n=_-u.y}u.x=c,u.y=_}}var f=this._touches.length;0===f?(this._mouseTouch.mousePositionX=0,this._mouseTouch.mousePositionY=0):(this._mouseTouch.mousePositionX=(this._mouseTouch.mousePositionX*a+i)/f,this._mouseTouch.mousePositionY=(this._mouseTouch.mousePositionY*a+n)/f)}},{key:"_update",value:function(){var e,t,i=Ea._enablePhysics&&!Ms.disableSimulation,n=this._eventList.length,a=this._scene._cameraPool;if(0<n){for(var s=!1,r=0;r<n;r++){var o=this._eventList[r];switch(o.type){case"mousedown":i&&this._mouseTouchDown();break;case"mouseup":i&&this._mouseTouchUp();break;case"mousemove":var h=d._tempPoint;h.setTo(o.pageX,o.pageY),L.stage._canvasTransform.invertTransformPoint(h),this._mouseTouch.mousePositionX=h.x,this._mouseTouch.mousePositionY=h.y,i&&(s=!0);break;case"touchstart":h=this._touches.length;this._changeTouches(o.changedTouches,0),i&&(s=!0,0===h&&this._mouseTouchDown());break;case"touchend":case"touchcancel":this._changeTouches(o.changedTouches,1),i&&0===this._touches.length&&this._mouseTouchUp();break;case"touchmove":this._changeTouches(o.changedTouches,2),i&&(s=!0);break;default:throw"Input3D:unkonwn event type."}}s&&this._mouseTouchRayCast(a),this._eventList.length=0}if(i){var a=this._mouseTouch,l=a._pressedSprite;if(l&&k.loopCount>a._pressedLoopCount){var u=l._scripts;if(u)for(e=0,t=u.length;e<t;e++)u[e].onMouseDrag()}l=a.sprite;if(l){var c=l._scripts;if(c)for(e=0,t=c.length;e<t;e++)c[e].onMouseOver()}}}},{key:"getTouch",value:function(e){return e<this._touches.length?this._touches.elements[e]:null}}]),d}()),t=(Es._tempPoint=new ie,Es._tempVector20=new ba,Es._tempRay0=new _s(new R,new R),Es._tempHitResult0=new fs,y(function e(){b(this,e),this.flags=0,this.maxSubSteps=1,this.fixedTimeStep=1/60})),Rs=function(){function i(e,t){b(this,i),this._position=e,this._textureCoordinate0=t}return y(i,[{key:"position",get:function(){return this._position}},{key:"textureCoordinate0",get:function(){return this._textureCoordinate0}},{key:"vertexDeclaration",get:function(){return i._vertexDeclaration}}],[{key:"vertexDeclaration",get:function(){return i._vertexDeclaration}},{key:"__init__",value:function(){i._vertexDeclaration=new as(20,[new ss(0,ns.Vector3,rs.MESH_POSITION0),new ss(12,ns.Vector2,rs.MESH_TEXTURECOORDINATE0)])}}]),i}(),As=function(){f(x,hs);var v=T(x);function x(){for(var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:48,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:48,n=(b(this,x),e=v.call(this),S.instance),t=(e._stacks=t,e._slices=i,Rs.vertexDeclaration),a=t.vertexStride/4,i=(e._stacks+1)*(e._slices+1),s=3*e._stacks*(e._slices+1)*2,r=new Float32Array(i*a),o=new Uint16Array(s),h=Math.PI/e._stacks,l=2*Math.PI/e._slices,u=0,c=0,_=0,f=0;f<e._stacks+1;f++)for(var d=Math.sin(f*h),p=Math.cos(f*h),y=0;y<e._slices+1;y++){var g=d*Math.sin(y*l),m=d*Math.cos(y*l);r[c+0]=g*x._radius,r[c+1]=p*x._radius,r[c+2]=m*x._radius,r[c+3]=.75-y/e._slices,r[c+4]=f/e._stacks,c+=a,f!=e._stacks-1&&(o[_++]=u+1,o[_++]=u,o[_++]=u+(e._slices+1),o[_++]=u+(e._slices+1),o[_++]=u,o[_++]=u+e._slices,u++)}e._vertexBuffer=new os(4*r.length,n.STATIC_DRAW,!1),e._vertexBuffer.vertexDeclaration=t,e._indexBuffer=new is(Zi.UInt16,o.length,n.STATIC_DRAW,!1),e._vertexBuffer.setData(r.buffer),e._indexBuffer.setData(o);i=new ts;return i.bind(),i.applyVertexBuffer(e._vertexBuffer),i.applyIndexBuffer(e._indexBuffer),i.unBind(),e._bufferState=i,e}return y(x,[{key:"stacks",get:function(){return this._stacks}},{key:"slices",get:function(){return this._slices}},{key:"_render",value:function(e){var t=S.instance,i=this._indexBuffer.indexCount;t.drawElements(t.TRIANGLES,i,t.UNSIGNED_SHORT,0),k.trianglesFaces+=i/3,k.renderBatches++}}],[{key:"__init__",value:function(){x.instance=new x}}]),x}(),Ls=(As._radius=1,function(){function e(){b(this,e),this._length=0,this._elements=[]}return y(e,[{key:"add",value:function(e){this._length===this._elements.length?this._elements.push(e):this._elements[this._length]=e,this._length++}},{key:"remove",value:function(e){var t,e=this._elements.indexOf(e);this._length--,e!==this._length&&(t=this._elements[this._length],this._elements[e]=t)}},{key:"shift",value:function(){return this._length--,this._elements.shift()}}]),e}()),Ns=function(){f(t,Ls);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"getSunLight",value:function(){for(var e,t=-1,i=this._elements,n=0;n<this._length;n++){var a=i[n]._intensity;t<a&&(t=a,e=n)}return e}}]),t}(),Ps=function(){f(t,Ls);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"remove",value:function(e){e=this._elements.indexOf(e);this._elements.splice(e,1),this._length--}}]),t}(),Bs=function(){f(a,oe);var t=T(a);function a(){var e;return b(this,a),(e=t.call(this))._shaderValues=null,e._disablePublicDefineDatas=new Ua,e._shaderValues=new es(O(e)),e.renderQueue=a.RENDERQUEUE_OPAQUE,e._alphaTest=!1,e}return y(a,[{key:"shaderData",get:function(){return this._shaderValues}},{key:"alphaTestValue",get:function(){return this._shaderValues.getNumber(a.ALPHATESTVALUE)},set:function(e){this._shaderValues.setNumber(a.ALPHATESTVALUE,e)}},{key:"alphaTest",get:function(){return this._alphaTest},set:function(e){(this._alphaTest=e)?this._shaderValues.addDefine(a.SHADERDEFINE_ALPHATEST):this._shaderValues.removeDefine(a.SHADERDEFINE_ALPHATEST)}},{key:"_removeTetxureReference",value:function(){var e,t=this._shaderValues.getData();for(e in t){var i=t[e];i&&i instanceof le&&i._removeReference()}}},{key:"_disposeResource",value:function(){0<this._referenceCount&&this._removeTetxureReference(),this._shaderValues=null}},{key:"_addReference",value:function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,i=(m(g(a.prototype),"_addReference",this).call(this,t),this._shaderValues.getData());for(e in i){var n=i[e];n&&n instanceof le&&n._addReference()}}},{key:"_removeReference",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;m(g(a.prototype),"_removeReference",this).call(this,e),this._removeTetxureReference()}},{key:"setShaderName",value:function(e){if(this._shader=A.find(e),!this._shader)throw new Error("BaseMaterial: unknown shader name.")}},{key:"cloneTo",value:function(e){e.name=this.name,e.renderQueue=this.renderQueue,this._disablePublicDefineDatas.cloneTo(e._disablePublicDefineDatas),this._shaderValues.cloneTo(e._shaderValues)}},{key:"clone",value:function(){var e=new a;return this.cloneTo(e),e}},{key:"_defineDatas",get:function(){return this._shaderValues._defineDatas}}],[{key:"load",value:function(e,t){o.loader.create(e,t,null,a.MATERIAL)}},{key:"__initDefine__",value:function(){a.SHADERDEFINE_ALPHATEST=A.getDefineByName("ALPHATEST")}},{key:"_parse",value:function(e){var t,i,n=e,a=n.props,s=a.type,s=M.getRegClass(s);if(!s)throw"_getSprite3DHierarchyInnerUrls 错误: "+e.type+" 不是类";switch(t=new s,n.version){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(i in a)switch(i){case"vectors":for(var r=a[i],o=0,h=r.length;o<h;o++){var l=r[o],u=l.value;switch(u.length){case 2:t[l.name]=new ba(u[0],u[1]);break;case 3:t[l.name]=new R(u[0],u[1],u[2]);break;case 4:t[l.name]=new Sa(u[0],u[1],u[2],u[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var c=a[i];for(o=0,h=c.length;o<h;o++){var _=c[o],f=_.path;f&&(t[_.name]=E.getRes(f))}break;case"defines":var d=a[i];for(o=0,h=d.length;o<h;o++){var p=A.getDefineByName(d[o]);t._shaderValues.addDefine(p)}break;case"renderStates":var y=a[i][0],g=t;g.blend=y.blend,g.cull=y.cull,g.depthTest=y.depthTest,g.depthWrite=y.depthWrite,g.blendSrc=y.srcBlend,g.blendDst=y.dstBlend;break;case"cull":t.cull=a[i];break;case"blend":t.blend=a[i];break;case"depthWrite":t.depthWrite=a[i];break;case"srcBlend":t.blendSrc=a[i];break;case"dstBlend":t.blendDst=a[i];break;default:t[i]=a[i]}break;default:throw new Error("BaseMaterial:unkonwn version.")}return t}}]),a}(),Ds=(Bs.MATERIAL="MATERIAL",Bs.RENDERQUEUE_OPAQUE=2e3,Bs.RENDERQUEUE_ALPHATEST=2450,Bs.RENDERQUEUE_TRANSPARENT=3e3,Bs.ALPHATESTVALUE=A.propertyNameToID("u_AlphaTestValue"),Bs.SHADERDEFINE_ALPHATEST=null,function(){function t(){b(this,t),this.cull=t.CULL_BACK,this.blend=t.BLEND_DISABLE,this.srcBlend=t.BLENDPARAM_ONE,this.dstBlend=t.BLENDPARAM_ZERO,this.srcBlendRGB=t.BLENDPARAM_ONE,this.dstBlendRGB=t.BLENDPARAM_ZERO,this.srcBlendAlpha=t.BLENDPARAM_ONE,this.dstBlendAlpha=t.BLENDPARAM_ZERO,this.blendConstColor=new Sa(1,1,1,1),this.blendEquation=t.BLENDEQUATION_ADD,this.blendEquationRGB=t.BLENDEQUATION_ADD,this.blendEquationAlpha=t.BLENDEQUATION_ADD,this.depthTest=t.DEPTHTEST_LEQUAL,this.depthWrite=!0}return y(t,[{key:"cloneTo",value:function(e){e.cull=this.cull,e.blend=this.blend,e.srcBlend=this.srcBlend,e.dstBlend=this.dstBlend,e.srcBlendRGB=this.srcBlendRGB,e.dstBlendRGB=this.dstBlendRGB,e.srcBlendAlpha=this.srcBlendAlpha,e.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo(e.blendConstColor),e.blendEquation=this.blendEquation,e.blendEquationRGB=this.blendEquationRGB,e.blendEquationAlpha=this.blendEquationAlpha,e.depthTest=this.depthTest,e.depthWrite=this.depthWrite}},{key:"clone",value:function(){var e=new t;return this.cloneTo(e),e}}]),t}()),Os=(Ds.CULL_NONE=0,Ds.CULL_FRONT=1,Ds.CULL_BACK=2,Ds.BLEND_DISABLE=0,Ds.BLEND_ENABLE_ALL=1,Ds.BLEND_ENABLE_SEPERATE=2,Ds.BLENDPARAM_ZERO=0,Ds.BLENDPARAM_ONE=1,Ds.BLENDPARAM_SRC_COLOR=768,Ds.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,Ds.BLENDPARAM_DST_COLOR=774,Ds.BLENDPARAM_ONE_MINUS_DST_COLOR=775,Ds.BLENDPARAM_SRC_ALPHA=770,Ds.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,Ds.BLENDPARAM_DST_ALPHA=772,Ds.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,Ds.BLENDPARAM_SRC_ALPHA_SATURATE=776,Ds.BLENDEQUATION_ADD=32774,Ds.BLENDEQUATION_SUBTRACT=32778,Ds.BLENDEQUATION_REVERSE_SUBTRACT=32779,Ds.DEPTHTEST_OFF=0,Ds.DEPTHTEST_NEVER=512,Ds.DEPTHTEST_LESS=513,Ds.DEPTHTEST_EQUAL=514,Ds.DEPTHTEST_LEQUAL=515,Ds.DEPTHTEST_GREATER=516,Ds.DEPTHTEST_NOTEQUAL=517,Ds.DEPTHTEST_GEQUAL=518,Ds.DEPTHTEST_ALWAYS=519,function(){f(i,Bs);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).setShaderName("LineShader"),e._shaderValues.setVector(i.COLOR,new Sa(1,1,1,1)),e}return y(i,[{key:"color",get:function(){return this._shaderValues.getVector(i.COLOR)},set:function(e){this._shaderValues.setVector(i.COLOR,e)}},{key:"depthWrite",get:function(){return this._shaderValues.getBool(i.DEPTH_WRITE)},set:function(e){this._shaderValues.setBool(i.DEPTH_WRITE,e)}},{key:"cull",get:function(){return this._shaderValues.getInt(i.CULL)},set:function(e){this._shaderValues.setInt(i.CULL,e)}},{key:"blend",get:function(){return this._shaderValues.getInt(i.BLEND)},set:function(e){this._shaderValues.setInt(i.BLEND,e)}},{key:"blendSrc",get:function(){return this._shaderValues.getInt(i.BLEND_SRC)},set:function(e){this._shaderValues.setInt(i.BLEND_SRC,e)}},{key:"blendDst",get:function(){return this._shaderValues.getInt(i.BLEND_DST)},set:function(e){this._shaderValues.setInt(i.BLEND_DST,e)}},{key:"depthTest",get:function(){return this._shaderValues.getInt(i.DEPTH_TEST)},set:function(e){this._shaderValues.setInt(i.DEPTH_TEST,e)}},{key:"clone",value:function(){var e=new i;return this.cloneTo(e),e}}],[{key:"__initDefine__",value:function(){}}]),i}()),Fs=(Os.COLOR=A.propertyNameToID("u_Color"),Os.CULL=A.propertyNameToID("s_Cull"),Os.BLEND=A.propertyNameToID("s_Blend"),Os.BLEND_SRC=A.propertyNameToID("s_BlendSrc"),Os.BLEND_DST=A.propertyNameToID("s_BlendDst"),Os.DEPTH_TEST=A.propertyNameToID("s_DepthTest"),Os.DEPTH_WRITE=A.propertyNameToID("s_DepthWrite"),function(){function a(e,t){b(this,a),this.min=e,this.max=t}return y(a,[{key:"_rotateExtents",value:function(e,t,i){var n=e.x,a=e.y,e=e.z,t=t.elements;i.x=Math.abs(t[0]*n)+Math.abs(t[4]*a)+Math.abs(t[8]*e),i.y=Math.abs(t[1]*n)+Math.abs(t[5]*a)+Math.abs(t[9]*e),i.z=Math.abs(t[2]*n)+Math.abs(t[6]*a)+Math.abs(t[10]*e)}},{key:"getCorners",value:function(e){e.length=8;var t=this.min.x,i=this.min.y,n=this.min.z,a=this.max.x,s=this.max.y,r=this.max.z;e[0]=new R(t,s,r),e[1]=new R(a,s,r),e[2]=new R(a,i,r),e[3]=new R(t,i,r),e[4]=new R(t,s,n),e[5]=new R(a,s,n),e[6]=new R(a,i,n),e[7]=new R(t,i,n)}},{key:"getCenter",value:function(e){R.add(this.min,this.max,e),R.scale(e,.5,e)}},{key:"getExtent",value:function(e){R.subtract(this.max,this.min,e),R.scale(e,.5,e)}},{key:"setCenterAndExtent",value:function(e,t){R.subtract(e,t,this.min),R.add(e,t,this.max)}},{key:"tranform",value:function(e,t){var i=a._tempVector30,n=a._tempVector31;this.getCenter(i),this.getExtent(n),R.transformCoordinate(i,e,i),this._rotateExtents(n,e,n),t.setCenterAndExtent(i,n)}},{key:"toDefault",value:function(){this.min.toDefault(),this.max.toDefault()}},{key:"cloneTo",value:function(e){this.min.cloneTo(e.min),this.max.cloneTo(e.max)}},{key:"clone",value:function(){var e=new a(new R,new R);return this.cloneTo(e),e}}],[{key:"createfromPoints",value:function(e,t){if(null==e)throw new Error("points");var i=t.min,n=t.max;i.x=Number.MAX_VALUE,i.y=Number.MAX_VALUE,i.z=Number.MAX_VALUE,n.x=-Number.MAX_VALUE,n.y=-Number.MAX_VALUE,n.z=-Number.MAX_VALUE;for(var a=0,s=e.length;a<s;++a)R.min(i,e[a],i),R.max(n,e[a],n)}},{key:"merge",value:function(e,t,i){R.min(e.min,t.min,i.min),R.max(e.max,t.max,i.max)}}]),a}()),Vs=(Fs._tempVector30=new R,Fs._tempVector31=new R,function(){function i(e,t){b(this,i),this._updateFlag=0,this._center=new R,this._extent=new R,this._boundBox=new Fs(new R,new R),e.cloneTo(this._boundBox.min),t.cloneTo(this._boundBox.max),this._setUpdateFlag(i._UPDATE_CENTER|i._UPDATE_EXTENT,!0)}return y(i,[{key:"setMin",value:function(e){var t=this._boundBox.min;e!==t&&e.cloneTo(t),this._setUpdateFlag(i._UPDATE_CENTER|i._UPDATE_EXTENT,!0),this._setUpdateFlag(i._UPDATE_MIN,!1)}},{key:"getMin",value:function(){var e=this._boundBox.min;return this._getUpdateFlag(i._UPDATE_MIN)&&(this._getMin(this.getCenter(),this.getExtent(),e),this._setUpdateFlag(i._UPDATE_MIN,!1)),e}},{key:"setMax",value:function(e){var t=this._boundBox.max;e!==t&&e.cloneTo(t),this._setUpdateFlag(i._UPDATE_CENTER|i._UPDATE_EXTENT,!0),this._setUpdateFlag(i._UPDATE_MAX,!1)}},{key:"getMax",value:function(){var e=this._boundBox.max;return this._getUpdateFlag(i._UPDATE_MAX)&&(this._getMax(this.getCenter(),this.getExtent(),e),this._setUpdateFlag(i._UPDATE_MAX,!1)),e}},{key:"setCenter",value:function(e){e!==this._center&&e.cloneTo(this._center),this._setUpdateFlag(i._UPDATE_MIN|i._UPDATE_MAX,!0),this._setUpdateFlag(i._UPDATE_CENTER,!1)}},{key:"getCenter",value:function(){return this._getUpdateFlag(i._UPDATE_CENTER)&&(this._getCenter(this.getMin(),this.getMax(),this._center),this._setUpdateFlag(i._UPDATE_CENTER,!1)),this._center}},{key:"setExtent",value:function(e){e!==this._extent&&e.cloneTo(this._extent),this._setUpdateFlag(i._UPDATE_MIN|i._UPDATE_MAX,!0),this._setUpdateFlag(i._UPDATE_EXTENT,!1)}},{key:"getExtent",value:function(){return this._getUpdateFlag(i._UPDATE_EXTENT)&&(this._getExtent(this.getMin(),this.getMax(),this._extent),this._setUpdateFlag(i._UPDATE_EXTENT,!1)),this._extent}},{key:"_getUpdateFlag",value:function(e){return 0!=(this._updateFlag&e)}},{key:"_setUpdateFlag",value:function(e,t){t?this._updateFlag|=e:this._updateFlag&=~e}},{key:"_getCenter",value:function(e,t,i){R.add(e,t,i),R.scale(i,.5,i)}},{key:"_getExtent",value:function(e,t,i){R.subtract(t,e,i),R.scale(i,.5,i)}},{key:"_getMin",value:function(e,t,i){R.subtract(e,t,i)}},{key:"_getMax",value:function(e,t,i){R.add(e,t,i)}},{key:"_rotateExtents",value:function(e,t,i){var n=e.x,a=e.y,e=e.z,t=t.elements;i.x=Math.abs(t[0]*n)+Math.abs(t[4]*a)+Math.abs(t[8]*e),i.y=Math.abs(t[1]*n)+Math.abs(t[5]*a)+Math.abs(t[9]*e),i.z=Math.abs(t[2]*n)+Math.abs(t[6]*a)+Math.abs(t[10]*e)}},{key:"_tranform",value:function(e,t){var i=t._center,n=t._extent;R.transformCoordinate(this.getCenter(),e,i),this._rotateExtents(this.getExtent(),e,n),t._boundBox.setCenterAndExtent(i,n),t._updateFlag=0}},{key:"_getBoundBox",value:function(){var e;return this._updateFlag&i._UPDATE_MIN&&(e=this._boundBox.min,this._getMin(this.getCenter(),this.getExtent(),e),this._setUpdateFlag(i._UPDATE_MIN,!1)),this._updateFlag&i._UPDATE_MAX&&(e=this._boundBox.max,this._getMax(this.getCenter(),this.getExtent(),e),this._setUpdateFlag(i._UPDATE_MAX,!1)),this._boundBox}},{key:"cloneTo",value:function(e){this.getMin().cloneTo(e._boundBox.min),this.getMax().cloneTo(e._boundBox.max),this.getCenter().cloneTo(e._center),this.getExtent().cloneTo(e._extent),e._updateFlag=0}},{key:"clone",value:function(){var e=new i(new R,new R);return this.cloneTo(e),e}}]),i}()),Us=(Vs._UPDATE_MIN=1,Vs._UPDATE_MAX=2,Vs._UPDATE_CENTER=4,Vs._UPDATE_EXTENT=8,function(){function e(){b(this,e),this._destroyed=!1}return y(e,[{key:"destroyed",get:function(){return this._destroyed}},{key:"_getType",value:function(){throw"GeometryElement:must override it."}},{key:"_prepareRender",value:function(e){return!0}},{key:"_render",value:function(e){throw"GeometryElement:must override it."}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0)}}]),e}()),zs=(Us._typeCounter=0,function(){function e(){b(this,e)}return y(e,[{key:"vertexDeclaration",get:function(){return e._vertexDeclaration}}],[{key:"vertexDeclaration",get:function(){return e._vertexDeclaration}},{key:"__init__",value:function(){e._vertexDeclaration=new as(28,[new ss(0,ns.Vector3,rs.MESH_POSITION0),new ss(12,ns.Vector4,rs.MESH_COLOR0)])}}]),e}()),Ys=function(){f(h,Us);var a=T(h);function h(e,t){b(this,h),(i=a.call(this))._floatCountPerVertices=7,i._minUpdate=Number.MAX_VALUE,i._maxUpdate=Number.MIN_VALUE,i._bufferState=new ts,i._floatBound=new Float32Array(6),i._calculateBound=!1,i._maxLineCount=0,i._lineCount=0;var i,n=2*t,e=(i._owner=e,i._maxLineCount=t,i._vertices=new Float32Array(n*i._floatCountPerVertices),i._vertexBuffer=new os(zs.vertexDeclaration.vertexStride*n,S.instance.STATIC_DRAW,!1),i._vertexBuffer.vertexDeclaration=zs.vertexDeclaration,i._bufferState.bind(),i._bufferState.applyVertexBuffer(i._vertexBuffer),i._bufferState.unBind(),h._tempVector0),t=h._tempVector1;return e.setValue(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),t.setValue(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),i._bounds=new Vs(e,t),i}return y(h,[{key:"_getType",value:function(){return h._type}},{key:"_resizeLineData",value:function(e){var t=2*e,i=this._vertices,e=(this._vertexBuffer.destroy(),this._maxLineCount=e,t*this._floatCountPerVertices);this._vertices=new Float32Array(e),this._vertexBuffer=new os(zs.vertexDeclaration.vertexStride*t,S.instance.STATIC_DRAW,!1),this._vertexBuffer.vertexDeclaration=zs.vertexDeclaration,e<i.length?(this._vertices.set(new Float32Array(i.buffer,0,e)),this._vertexBuffer.setData(this._vertices.buffer,0,0,4*e)):(this._vertices.set(i),this._vertexBuffer.setData(this._vertices.buffer,0,0,4*i.length)),this._bufferState.bind(),this._bufferState.applyVertexBuffer(this._vertexBuffer),this._bufferState.unBind()}},{key:"_updateLineVertices",value:function(e,t,i,n,a){t&&(this._vertices[e+0]=t.x,this._vertices[e+1]=t.y,this._vertices[e+2]=t.z),n&&(this._vertices[e+3]=n.r,this._vertices[e+4]=n.g,this._vertices[e+5]=n.b,this._vertices[e+6]=n.a),i&&(this._vertices[e+7]=i.x,this._vertices[e+8]=i.y,this._vertices[e+9]=i.z),a&&(this._vertices[e+10]=a.r,this._vertices[e+11]=a.g,this._vertices[e+12]=a.b,this._vertices[e+13]=a.a),this._minUpdate=Math.min(this._minUpdate,e),this._maxUpdate=Math.max(this._maxUpdate,e+2*this._floatCountPerVertices);var n=this._bounds,a=this._floatBound,e=n.getMin(),s=n.getMax();R.min(e,t,e),R.min(e,i,e),R.max(s,t,s),R.max(s,i,s),n.setMin(e),n.setMax(s),a[0]=e.x,a[1]=e.y,a[2]=e.z,a[3]=s.x,a[4]=s.y,a[5]=s.z}},{key:"_reCalculateBound",value:function(){if(this._calculateBound){var e=this._vertices,t=h._tempVector0,i=h._tempVector1;t.setValue(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),i.setValue(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(var n=0;n<2*this._lineCount;++n){var a=this._floatCountPerVertices*n,s=e[0+a],r=e[1+a],a=e[2+a];t.x=Math.min(s,t.x),t.y=Math.min(r,t.y),t.z=Math.min(a,t.z),i.x=Math.max(s,i.x),i.y=Math.max(r,i.y),i.z=Math.max(a,i.z)}this._bounds.setMin(t),this._bounds.setMax(i);var o=this._floatBound;o[0]=t.x,o[1]=t.y,o[2]=t.z,o[3]=i.x,o[4]=i.y,o[5]=i.z,this._calculateBound=!1}}},{key:"_removeLineData",value:function(e){var t=2*this._floatCountPerVertices,i=e+1,e=e*t,n=this._vertices,i=new Float32Array(n.buffer,i*t*4,(this._lineCount-i)*t),t=(n.set(i,e),this._minUpdate=Math.min(this._minUpdate,e),this._maxUpdate=Math.max(this._maxUpdate,e+i.length),this._lineCount--,this._floatBound),i=n[e],a=n[1+e],s=n[2+e],r=n[7+e],o=n[8+e],n=n[9+e],e=t[0],h=t[1],l=t[2],u=t[3],c=t[4],t=t[5];i!==e&&i!==u&&a!==h&&a!==c&&s!==l&&s!==t&&r!==e&&r!==u&&o!==h&&o!==c&&n!==l&&n!==t||(this._calculateBound=!0)}},{key:"_updateLineData",value:function(e,t,i,n,a){var s=2*this._floatCountPerVertices;this._updateLineVertices(e*s,t,i,n,a)}},{key:"_updateLineDatas",value:function(e,t){for(var i=2*this._floatCountPerVertices,n=t.length,a=0;a<n;a++){var s=t[a];this._updateLineVertices((e+a)*i,s.startPosition,s.endPosition,s.startColor,s.endColor)}}},{key:"_getLineData",value:function(e,t){var i=t.startPosition,n=t.startColor,a=t.endPosition,t=t.endColor,s=this._vertices,e=e*this._floatCountPerVertices*2;i.x=s[0+e],i.y=s[1+e],i.z=s[2+e],n.r=s[3+e],n.g=s[4+e],n.b=s[5+e],n.a=s[6+e],a.x=s[7+e],a.y=s[8+e],a.z=s[9+e],t.r=s[10+e],t.g=s[11+e],t.b=s[12+e],t.a=s[13+e]}},{key:"_prepareRender",value:function(e){return!0}},{key:"_render",value:function(e){var t;this._minUpdate!==Number.MAX_VALUE&&this._maxUpdate!==Number.MIN_VALUE&&(this._vertexBuffer.setData(this._vertices.buffer,4*this._minUpdate,4*this._minUpdate,4*(this._maxUpdate-this._minUpdate)),this._minUpdate=Number.MAX_VALUE,this._maxUpdate=Number.MIN_VALUE),0<this._lineCount&&(this._bufferState.bind(),(t=S.instance).drawArrays(t.LINES,0,2*this._lineCount),k.renderBatches++)}},{key:"destroy",value:function(){this._destroyed||(m(g(h.prototype),"destroy",this).call(this),this._bufferState.destroy(),this._vertexBuffer.destroy(),this._bufferState=null,this._vertexBuffer=null,this._vertices=null)}}]),h}(),Gs=(Ys._tempVector0=new R,Ys._tempVector1=new R,Ys._type=Us._typeCounter++,y(function e(){b(this,e),this.updateMark=-1,this.indexInList=-1,this.batched=!1})),Xs=function(){f(n,Us);var i=T(n);function n(){b(this,n),(e=i.call(this)).maxInstanceCount=1024,e.instanceWorldMatrixData=new Float32Array(16*e.maxInstanceCount),e.instanceMVPMatrixData=new Float32Array(16*e.maxInstanceCount);var e,t=S.instance;return e.instanceWorldMatrixBuffer=new os(4*e.instanceWorldMatrixData.length,t.DYNAMIC_DRAW),e.instanceMVPMatrixBuffer=new os(4*e.instanceMVPMatrixData.length,t.DYNAMIC_DRAW),e.instanceWorldMatrixBuffer.vertexDeclaration=rs.instanceWorldMatrixDeclaration,e.instanceMVPMatrixBuffer.vertexDeclaration=rs.instanceMVPMatrixDeclaration,e}return y(n,[{key:"_render",value:function(e){var t=S.instance,e=e.renderElement,i=e.instanceSubMesh,e=e.instanceBatchElementList.length,n=i._indexCount;i._mesh._instanceBufferState.bind(),S.layaGPUInstance.drawElementsInstanced(t.TRIANGLES,n,t.UNSIGNED_SHORT,2*i._indexStart,e),k.renderBatches++,k.savedRenderBatches+=e-1,k.trianglesFaces+=n*e/3}}],[{key:"__init__",value:function(){n.instance=new n}}]),n}(),Ws=function(){function h(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;b(this,h),this.normal=e,this.distance=t}return y(h,[{key:"normalize",value:function(){var e=this.normal.x,t=this.normal.y,i=this.normal.z,n=1/Math.sqrt(e*e+t*t+i*i);this.normal.x=e*n,this.normal.y=t*n,this.normal.z=i*n,this.distance*=n}}],[{key:"createPlaneBy3P",value:function(e,t,i){var n=t.x-e.x,a=t.y-e.y,t=t.z-e.z,s=i.x-e.x,r=i.y-e.y,i=i.z-e.z,o=a*i-t*r,t=t*s-n*i,i=n*r-a*s,n=1/Math.sqrt(o*o+t*t+i*i),r=o*n,a=t*n,s=i*n,o=(h._TEMPVec3.x=r,h._TEMPVec3.y=a,h._TEMPVec3.z=s,-(r*e.x+a*e.y+s*e.z));return new h(h._TEMPVec3,o)}}]),h}(),Hs=(Ws._TEMPVec3=new R,Ws.PlaneIntersectionType_Back=0,Ws.PlaneIntersectionType_Front=1,Ws.PlaneIntersectionType_Intersecting=2,y(function e(){b(this,e)})),js=(Hs.Disjoint=0,Hs.Contains=1,Hs.Intersects=2,function(){function x(){b(this,x)}return y(x,null,[{key:"distancePlaneToPoint",value:function(e,t){return R.dot(e.normal,t)-e.distance}},{key:"distanceBoxToPoint",value:function(e,t){var i=e.min,n=i.x,a=i.y,i=i.z,e=e.max,s=e.x,r=e.y,e=e.z,o=t.x,h=t.y,t=t.z,l=0;return o<n&&(l+=(n-o)*(n-o)),s<o&&(l+=(s-o)*(s-o)),h<a&&(l+=(a-h)*(a-h)),r<h&&(l+=(r-h)*(r-h)),t<i&&(l+=(i-t)*(i-t)),e<t&&(l+=(e-t)*(e-t)),Math.sqrt(l)}},{key:"distanceBoxToBox",value:function(e,t){var i,n=e.min,a=n.x,s=n.y,n=n.z,e=e.max,r=e.x,o=e.y,e=e.z,h=t.min,l=h.x,u=h.y,h=h.z,t=t.max,c=t.x,_=t.y,t=t.z,f=0;return c<a?f+=(i=a-c)*i:r<l&&(f+=(i=l-r)*i),_<s?f+=(i=s-_)*i:o<u&&(f+=(i=u-o)*i),t<n?f+=(i=n-t)*i:e<h&&(f+=(i=h-e)*i),Math.sqrt(f)}},{key:"distanceSphereToPoint",value:function(e,t){t=Math.sqrt(R.distanceSquared(e.center,t));return t-=e.radius,Math.max(t,0)}},{key:"distanceSphereToSphere",value:function(e,t){var i=Math.sqrt(R.distanceSquared(e.center,t.center));return i-=e.radius+t.radius,Math.max(i,0)}},{key:"intersectsRayAndTriangleRD",value:function(e,t,i,n,a){var s=e.origin,r=s.x,o=s.y,s=s.z,e=e.direction,h=e.x,l=e.y,e=e.z,u=t.x,c=t.y,t=t.z,_=i.x,f=i.y,i=i.z,d=n.x,p=n.y,n=n.z,y=(x._tempV30.x,x._tempV30.y,x._tempV30.z,x._tempV31.x,x._tempV31.y,x._tempV31.z,x._tempV32.x,x._tempV32.y,x._tempV32.z,(_=_-u)*(g=l*(n=n-t)-e*(p=p-c))+(f=f-c)*(m=e*(d=d-u)-h*n)+(i=i-t)*(v=h*p-l*d));if(wa.isZero(y))return!1;var g,y=1/y,o=(x._tempV33.x,x._tempV33.y,x._tempV33.z,(r=r-u)*g+(u=o-c)*m+(g=s-t)*v);if((o*=y)<0||1<o)return!1;x._tempV34.x,x._tempV34.y,x._tempV34.z;var m,t=h*(c=u*i-g*f)+l*(m=g*_-r*i)+e*(s=r*f-u*_);if((t*=y)<0||1<o+t)return!1;var v=d*c+p*m+n*s;return!((v*=y)<0)}},{key:"intersectsRayAndTriangleRP",value:function(e,t,i,n,a){return x.intersectsRayAndTriangleRD(e,t,i,n,void 0)?(R.scale(e.direction,void 0,x._tempV30),R.add(e.origin,x._tempV30,a),!0):(a=R._ZERO,!1)}},{key:"intersectsRayAndPoint",value:function(e,t){R.subtract(e.origin,t,x._tempV30);t=R.dot(x._tempV30,e.direction),e=R.dot(x._tempV30,x._tempV30)-wa.zeroTolerance;return!(0<e&&0<t)&&!(t*t-e<0)}},{key:"intersectsRayAndRay",value:function(e,t,i){var n=e.origin,a=n.x,s=n.y,r=n.z,e=e.direction,o=(e.x,e.y,e.z,t.origin),h=o.x,l=o.y,u=o.z,t=t.direction,c=t.x,_=t.y,f=t.z,d=(R.cross(e,t,x._tempV30),x._tempV30),p=R.scalarLength(x._tempV30);if(wa.isZero(p)&&wa.nearEqual(h,a)&&wa.nearEqual(l,s)&&wa.nearEqual(u,r))return!0;h-=a,a=l-s,l=u-r,s=d.x,u=d.y,r=d.z,d=(h*_*r+a*f*s+l*c*u-h*f*u-a*c*r-l*_*s)/(p*=p),R.scale(e,d,x._tempV30),R.scale(t,d,x._tempV31),R.add(n,x._tempV30,x._tempV32),R.add(o,x._tempV31,x._tempV33),h=x._tempV32,f=x._tempV33;return!!(wa.nearEqual(f.x,h.x)&&wa.nearEqual(f.y,h.y)&&wa.nearEqual(f.z,h.z))}},{key:"intersectsPlaneAndTriangle",value:function(e,t,i,n){t=x.intersectsPlaneAndPoint(e,t),i=x.intersectsPlaneAndPoint(e,i),e=x.intersectsPlaneAndPoint(e,n);return t==Ws.PlaneIntersectionType_Front&&i==Ws.PlaneIntersectionType_Front&&e==Ws.PlaneIntersectionType_Front?Ws.PlaneIntersectionType_Front:t==Ws.PlaneIntersectionType_Back&&i==Ws.PlaneIntersectionType_Back&&e==Ws.PlaneIntersectionType_Back?Ws.PlaneIntersectionType_Back:Ws.PlaneIntersectionType_Intersecting}},{key:"intersectsRayAndPlaneRD",value:function(e,t){var i=t.normal,n=R.dot(i,e.direction);if(Math.abs(n)<wa.zeroTolerance)return-1;i=R.dot(i,e.origin),e=(-t.distance-i)/n;if(e<0){if(e<-wa.zeroTolerance)return-1;e=0}return e}},{key:"intersectsRayAndPlaneRP",value:function(e,t,i){t=x.intersectsRayAndPlaneRD(e,t);if(-1==t)return i.setValue(0,0,0),!1;var n=x._tempV30;return R.scale(e.direction,t,n),R.add(e.origin,n,i),!0}},{key:"intersectsRayAndBoxRD",value:function(e,t){var i=e.origin,n=i.x,a=i.y,i=i.z,e=e.direction,s=e.x,r=e.y,e=e.z,o=t.min,h=o.x,l=o.y,o=o.z,t=t.max,u=t.x,c=t.y,t=t.z,_=0,f=wa.MaxValue;if(wa.isZero(s)){if(n<h||u<n)return-1}else{s=1/s,h=(h-n)*s,u=(u-n)*s;if(u<h&&(n=h,h=u,u=n),_=Math.max(h,_),(f=Math.min(u,f))<_)return-1}if(wa.isZero(r)){if(a<l||c<a)return-1}else{s=1/r,n=(l-a)*s,h=(c-a)*s;if(h<n&&(u=n,n=h,h=u),_=Math.max(n,_),(f=Math.min(h,f))<_)return-1}if(wa.isZero(e)){if(i<o||t<i)return-1}else{r=1/e,l=(o-i)*r,c=(t-i)*r;if(c<l&&(a=l,l=c,c=a),_=Math.max(l,_),(f=Math.min(c,f))<_)return-1}return _}},{key:"intersectsRayAndBoxRP",value:function(e,t,i){t=x.intersectsRayAndBoxRD(e,t);return-1===t?R._ZERO.cloneTo(i):(R.scale(e.direction,t,x._tempV30),R.add(e.origin,x._tempV30,x._tempV31),x._tempV31.cloneTo(i)),t}},{key:"intersectsRayAndSphereRD",value:function(e,t){var i=t.radius,t=(R.subtract(e.origin,t.center,x._tempV30),R.dot(x._tempV30,e.direction)),e=R.dot(x._tempV30,x._tempV30)-i*i;if(0<e&&0<t)return-1;i=t*t-e;if(i<0)return-1;e=-t-Math.sqrt(i);return e=e<0?0:e}},{key:"intersectsRayAndSphereRP",value:function(e,t,i){t=x.intersectsRayAndSphereRD(e,t);return-1===t?R._ZERO.cloneTo(i):(R.scale(e.direction,t,x._tempV30),R.add(e.origin,x._tempV30,x._tempV31),x._tempV31.cloneTo(i)),t}},{key:"intersectsSphereAndTriangle",value:function(e,t,i,n){var a=e.center,e=e.radius;return x.closestPointPointTriangle(a,t,i,n,x._tempV30),R.subtract(x._tempV30,a,x._tempV31),R.dot(x._tempV31,x._tempV31)<=e*e}},{key:"intersectsPlaneAndPoint",value:function(e,t){t=R.dot(e.normal,t)+e.distance;return 0<t?Ws.PlaneIntersectionType_Front:t<0?Ws.PlaneIntersectionType_Back:Ws.PlaneIntersectionType_Intersecting}},{key:"intersectsPlaneAndPlane",value:function(e,t){R.cross(e.normal,t.normal,x._tempV30);e=R.dot(x._tempV30,x._tempV30);return!wa.isZero(e)}},{key:"intersectsPlaneAndPlaneRL",value:function(e,t,i){var n=e.normal,a=t.normal,s=(R.cross(n,a,x._tempV34),R.dot(x._tempV34,x._tempV34));return!wa.isZero(s)&&(R.scale(a,e.distance,x._tempV30),R.scale(n,t.distance,x._tempV31),R.subtract(x._tempV30,x._tempV31,x._tempV32),R.cross(x._tempV32,x._tempV34,x._tempV33),R.normalize(x._tempV34,x._tempV34),new _s(x._tempV33,x._tempV34),!0)}},{key:"intersectsPlaneAndBox",value:function(e,t){var i=e.distance,e=e.normal,n=e.x,a=e.y,s=e.z,r=t.min,o=r.x,h=r.y,r=r.z,t=t.max,l=t.x,u=t.y,t=t.z;return x._tempV30.x=0<n?o:l,x._tempV30.y=0<a?h:u,x._tempV30.z=0<s?r:t,x._tempV31.x=0<n?l:o,x._tempV31.y=0<a?u:h,x._tempV31.z=0<s?t:r,0<R.dot(e,x._tempV30)+i?Ws.PlaneIntersectionType_Front:R.dot(e,x._tempV31)+i<0?Ws.PlaneIntersectionType_Back:Ws.PlaneIntersectionType_Intersecting}},{key:"intersectsPlaneAndSphere",value:function(e,t){var i=t.radius,t=R.dot(e.normal,t.center)+e.distance;return i<t?Ws.PlaneIntersectionType_Front:t<-i?Ws.PlaneIntersectionType_Back:Ws.PlaneIntersectionType_Intersecting}},{key:"intersectsBoxAndBox",value:function(e,t){var i=e.min,e=e.max,n=t.min,t=t.max;return!(i.x>t.x||n.x>e.x)&&(!(i.y>t.y||n.y>e.y)&&!(i.z>t.z||n.z>e.z))}},{key:"intersectsBoxAndSphere",value:function(e,t){var i=t.center,t=t.radius;return R.Clamp(i,e.min,e.max,x._tempV30),R.distanceSquared(i,x._tempV30)<=t*t}},{key:"intersectsSphereAndSphere",value:function(e,t){var i=e.radius+t.radius;return R.distanceSquared(e.center,t.center)<=i*i}},{key:"boxContainsPoint",value:function(e,t){var i=e.min,e=e.max;return i.x<=t.x&&e.x>=t.x&&i.y<=t.y&&e.y>=t.y&&i.z<=t.z&&e.z>=t.z?Hs.Contains:Hs.Disjoint}},{key:"boxContainsBox",value:function(e,t){var i=e.min,n=i.x,a=i.y,i=i.z,e=e.max,s=e.x,r=e.y,e=e.z,o=t.min,h=o.x,l=o.y,o=o.z,t=t.max,u=t.x,c=t.y,t=t.z;return s<h||u<n||r<l||c<a||e<o||t<i?Hs.Disjoint:n<=h&&u<=s&&a<=l&&c<=r&&i<=o&&t<=e?Hs.Contains:Hs.Intersects}},{key:"boxContainsSphere",value:function(e,t){var i=e.min,n=i.x,a=i.y,s=i.z,e=e.max,r=e.x,o=e.y,h=e.z,l=t.center,u=l.x,c=l.y,_=l.z,t=t.radius;return R.Clamp(l,i,e,x._tempV30),t*t<R.distanceSquared(l,x._tempV30)?Hs.Disjoint:n+t<=u&&u<=r-t&&t<r-n&&a+t<=c&&c<=o-t&&t<o-a&&s+t<=_&&_<=h-t&&t<h-s?Hs.Contains:Hs.Intersects}},{key:"sphereContainsPoint",value:function(e,t){return R.distanceSquared(t,e.center)<=e.radius*e.radius?Hs.Contains:Hs.Disjoint}},{key:"sphereContainsTriangle",value:function(e,t,i,n){var a=x.sphereContainsPoint(e,t),s=x.sphereContainsPoint(e,i),r=x.sphereContainsPoint(e,n);return a==Hs.Contains&&s==Hs.Contains&&r==Hs.Contains?Hs.Contains:x.intersectsSphereAndTriangle(e,t,i,n)?Hs.Intersects:Hs.Disjoint}},{key:"sphereContainsBox",value:function(e,t){var i=e.center,i=(i.x,i.y,i.z,e.radius),n=t.min,n=(n.x,n.y,n.z,t.max),n=(n.x,n.y,n.z,x._tempV30);n.x,n.y,n.z;if(!x.intersectsBoxAndSphere(t,e))return Hs.Disjoint;n=i*i;return R.scalarLengthSquared(x._tempV30)>n||R.scalarLengthSquared(x._tempV30)>n?Hs.Intersects:R.scalarLengthSquared(x._tempV30)>n?Hs.Intersects:R.scalarLengthSquared(x._tempV30)>n?Hs.Intersects:R.scalarLengthSquared(x._tempV30)>n?Hs.Intersects:R.scalarLengthSquared(x._tempV30)>n?Hs.Intersects:R.scalarLengthSquared(x._tempV30)>n?Hs.Intersects:R.scalarLengthSquared(x._tempV30)>n?Hs.Intersects:Hs.Contains}},{key:"sphereContainsSphere",value:function(e,t){var i=e.radius,n=t.radius,e=R.distance(e.center,t.center);return i+n<e?Hs.Disjoint:i-n<e?Hs.Intersects:Hs.Contains}},{key:"closestPointPointTriangle",value:function(e,t,i,n,a){R.subtract(i,t,x._tempV30),R.subtract(n,t,x._tempV31),R.subtract(e,t,x._tempV32),R.subtract(e,i,x._tempV33),R.subtract(e,n,x._tempV34);var e=R.dot(x._tempV30,x._tempV32),s=R.dot(x._tempV31,x._tempV32),r=R.dot(x._tempV30,x._tempV33),o=R.dot(x._tempV31,x._tempV33),h=R.dot(x._tempV30,x._tempV34),l=R.dot(x._tempV31,x._tempV34);if(e<=0&&s<=0)t.cloneTo(a);else if(0<=r&&o<=r)i.cloneTo(a);else{var u=e*o-r*s;if(u<=0&&0<=e&&r<=0)return R.scale(x._tempV30,e/(e-r),a),void R.add(t,a,a);if(0<=l&&h<=l)n.cloneTo(a);else{e=h*s-e*l;if(e<=0&&0<=s&&l<=0)return R.scale(x._tempV31,s/(s-l),a),void R.add(t,a,a);s=r*l-h*o;if(s<=0&&0<=o-r&&0<=h-l)return o=(o-r)/(o-r+(h-l)),R.subtract(n,i,a),R.scale(a,o,a),void R.add(i,a,a);r=1/(s+e+u),h=u*r;R.scale(x._tempV30,e*r,x._tempV35),R.scale(x._tempV31,h,x._tempV36),R.add(x._tempV35,x._tempV36,a),R.add(t,a,a)}}}},{key:"closestPointPlanePoint",value:function(e,t,i){var n=e.normal,e=R.dot(n,t)-e.distance;R.scale(n,e,x._tempV30),R.subtract(t,x._tempV30,i)}},{key:"closestPointBoxPoint",value:function(e,t,i){R.max(t,e.min,x._tempV30),R.min(x._tempV30,e.max,i)}},{key:"closestPointSpherePoint",value:function(e,t,i){var n=e.center;R.subtract(t,n,i),R.normalize(i,i),R.scale(i,e.radius,i),R.add(i,n,i)}},{key:"closestPointSphereSphere",value:function(e,t,i){var n=e.center;R.subtract(t.center,n,i),R.normalize(i,i),R.scale(i,e.radius,i),R.add(i,n,i)}}]),x}()),qs=(js._tempV30=new R,js._tempV31=new R,js._tempV32=new R,js._tempV33=new R,js._tempV34=new R,js._tempV35=new R,js._tempV36=new R,function(){function l(e){b(this,l),this._matrix=e,this._near=new Ws(new R),this._far=new Ws(new R),this._left=new Ws(new R),this._right=new Ws(new R),this._top=new Ws(new R),this._bottom=new Ws(new R),l._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}return y(l,[{key:"matrix",get:function(){return this._matrix},set:function(e){this._matrix=e,l._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}},{key:"near",get:function(){return this._near}},{key:"far",get:function(){return this._far}},{key:"left",get:function(){return this._left}},{key:"right",get:function(){return this._right}},{key:"top",get:function(){return this._top}},{key:"bottom",get:function(){return this._bottom}},{key:"equalsBoundFrustum",value:function(e){return this._matrix.equalsOtherMatrix(e.matrix)}},{key:"equalsObj",value:function(e){return e instanceof l&&this.equalsBoundFrustum(e)}},{key:"getPlane",value:function(e){switch(e){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}}},{key:"getCorners",value:function(e){l._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo(e[0]),l._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo(e[1]),l._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo(e[2]),l._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo(e[3]),l._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo(e[4]),l._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo(e[5]),l._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo(e[6]),l._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo(e[7])}},{key:"containsPoint",value:function(e){for(var t=Ws.PlaneIntersectionType_Front,i=Ws.PlaneIntersectionType_Front,n=0;n<6;n++){switch(n){case 0:i=js.intersectsPlaneAndPoint(this._near,e);break;case 1:i=js.intersectsPlaneAndPoint(this._far,e);break;case 2:i=js.intersectsPlaneAndPoint(this._left,e);break;case 3:i=js.intersectsPlaneAndPoint(this._right,e);break;case 4:i=js.intersectsPlaneAndPoint(this._top,e);break;case 5:i=js.intersectsPlaneAndPoint(this._bottom,e)}switch(i){case Ws.PlaneIntersectionType_Back:return Hs.Disjoint;case Ws.PlaneIntersectionType_Intersecting:t=Ws.PlaneIntersectionType_Intersecting}}return t!==Ws.PlaneIntersectionType_Intersecting?Hs.Contains:Hs.Intersects}},{key:"intersects",value:function(e){var t=e.min,e=e.max,i=t.x,n=t.y,t=t.z,a=e.x,s=e.y,e=e.z,r=this._near.normal;if(this._near.distance+r.x*(r.x<0?i:a)+r.y*(r.y<0?n:s)+r.z*(r.z<0?t:e)<0)return!1;r=this._left.normal;if(this._left.distance+r.x*(r.x<0?i:a)+r.y*(r.y<0?n:s)+r.z*(r.z<0?t:e)<0)return!1;r=this._right.normal;if(this._right.distance+r.x*(r.x<0?i:a)+r.y*(r.y<0?n:s)+r.z*(r.z<0?t:e)<0)return!1;r=this._bottom.normal;if(this._bottom.distance+r.x*(r.x<0?i:a)+r.y*(r.y<0?n:s)+r.z*(r.z<0?t:e)<0)return!1;r=this._top.normal;if(this._top.distance+r.x*(r.x<0?i:a)+r.y*(r.y<0?n:s)+r.z*(r.z<0?t:e)<0)return!1;r=this._far.normal;return!(this._far.distance+r.x*(r.x<0?i:a)+r.y*(r.y<0?n:s)+r.z*(r.z<0?t:e)<0)}},{key:"containsBoundBox",value:function(e){for(var t=l._tempV30,i=l._tempV31,n=e.min,a=e.max,s=Hs.Contains,r=0;r<6;r++){var o=this.getPlane(r),h=o.normal;if(0<=h.x?(t.x=a.x,i.x=n.x):(t.x=n.x,i.x=a.x),0<=h.y?(t.y=a.y,i.y=n.y):(t.y=n.y,i.y=a.y),0<=h.z?(t.z=a.z,i.z=n.z):(t.z=n.z,i.z=a.z),js.intersectsPlaneAndPoint(o,t)===Ws.PlaneIntersectionType_Back)return Hs.Disjoint;js.intersectsPlaneAndPoint(o,i)===Ws.PlaneIntersectionType_Back&&(s=Hs.Intersects)}return s}},{key:"containsBoundSphere",value:function(e){for(var t=Ws.PlaneIntersectionType_Front,i=Ws.PlaneIntersectionType_Front,n=0;n<6;n++){switch(n){case 0:i=js.intersectsPlaneAndSphere(this._near,e);break;case 1:i=js.intersectsPlaneAndSphere(this._far,e);break;case 2:i=js.intersectsPlaneAndSphere(this._left,e);break;case 3:i=js.intersectsPlaneAndSphere(this._right,e);break;case 4:i=js.intersectsPlaneAndSphere(this._top,e);break;case 5:i=js.intersectsPlaneAndSphere(this._bottom,e)}switch(i){case Ws.PlaneIntersectionType_Back:return Hs.Disjoint;case Ws.PlaneIntersectionType_Intersecting:t=Ws.PlaneIntersectionType_Intersecting}}return t!==Ws.PlaneIntersectionType_Intersecting?Hs.Contains:Hs.Intersects}}],[{key:"_getPlanesFromMatrix",value:function(e,t,i,n,a,s,r){var e=e.elements,o=e[0],h=e[1],l=e[2],u=e[3],c=e[4],_=e[5],f=e[6],d=e[7],p=e[8],y=e[9],g=e[10],m=e[11],v=e[12],x=e[13],k=e[14],e=e[15],w=t.normal,w=(w.x=u+l,w.y=d+f,w.z=m+g,t.distance=e+k,t.normalize(),i.normal),t=(w.x=u-l,w.y=d-f,w.z=m-g,i.distance=e-k,i.normalize(),n.normal),l=(t.x=u+o,t.y=d+c,t.z=m+p,n.distance=e+v,n.normalize(),a.normal),f=(l.x=u-o,l.y=d-c,l.z=m-p,a.distance=e-v,a.normalize(),s.normal),w=(f.x=u-h,f.y=d-_,f.z=m-y,s.distance=e-x,s.normalize(),r.normal);w.x=u+h,w.y=d+_,w.z=m+y,r.distance=e+x,r.normalize()}},{key:"_get3PlaneInterPoint",value:function(e,t,i){var n=e.normal,a=t.normal,s=i.normal,n=(R.cross(a,s,l._tempV30),R.cross(s,n,l._tempV31),R.cross(n,a,l._tempV32),R.dot(n,l._tempV30)),a=R.dot(a,l._tempV31),s=R.dot(s,l._tempV32);return R.scale(l._tempV30,-e.distance/n,l._tempV33),R.scale(l._tempV31,-t.distance/a,l._tempV34),R.scale(l._tempV32,-i.distance/s,l._tempV35),R.add(l._tempV33,l._tempV34,l._tempV36),R.add(l._tempV35,l._tempV36,l._tempV37),l._tempV37}}]),l}()),Ks=(qs._tempV30=new R,qs._tempV31=new R,qs._tempV32=new R,qs._tempV33=new R,qs._tempV34=new R,qs._tempV35=new R,qs._tempV36=new R,qs._tempV37=new R,function(){function s(e,t,i,n){b(this,s),this.minDepth=0,this.maxDepth=1,this.x=e,this.y=t,this.width=i,this.height=n}return y(s,[{key:"project",value:function(e,t,i){var n=e.x,a=e.y,s=e.z,e=(R.transformV3ToV3(e,t,i),t.elements),t=n*e[3]+a*e[7]+s*e[11]+e[15];1!==t&&(i.x=i.x/t,i.y=i.y/t,i.z=i.z/t),i.x=.5*(i.x+1)*this.width+this.x,i.y=.5*(1-i.y)*this.height+this.y,i.z=i.z*(this.maxDepth-this.minDepth)+this.minDepth}},{key:"unprojectFromMat",value:function(e,t,i){var n=t.elements,a=(i.x=(e.x-this.x)/this.width*2-1,i.y=-((e.y-this.y)/this.height*2-1),(this.maxDepth-this.minDepth)/2),e=(i.z=(e.z-this.minDepth-a)/a,i.x*n[3]+i.y*n[7]+i.z*n[11]+n[15]);R.transformV3ToV3(i,t,i),1!==e&&(i.x=i.x/e,i.y=i.y/e,i.z=i.z/e)}},{key:"unprojectFromWVP",value:function(e,t,i,n,a){Pa.multiply(t,i,s._tempMatrix4x4),n&&Pa.multiply(s._tempMatrix4x4,n,s._tempMatrix4x4),s._tempMatrix4x4.invert(s._tempMatrix4x4),this.unprojectFromMat(e,s._tempMatrix4x4,a)}},{key:"cloneTo",value:function(e){e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e.minDepth=this.minDepth,e.maxDepth=this.maxDepth}}]),s}()),Qs=(Ks._tempMatrix4x4=new Pa,y(function e(){b(this,e),this.invertY=!1})),Zs=(Qs._instance=new Qs,function(){f(l,le);var a=T(l);function l(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:X.R8G8B8,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:W.DEPTH_16;return b(this,l),(i=a.call(this,i,!1))._inPool=!1,i._isCameraTarget=!1,i._glTextureType=S.instance.TEXTURE_2D,i._width=e,i._height=t,i._depthStencilFormat=n,i._create(e,t),i}return y(l,[{key:"depthStencilFormat",get:function(){return this._depthStencilFormat}},{key:"defaulteTexture",get:function(){return ue.grayTexture}},{key:"_texImage2D",value:function(e,t,i,n){switch(this._format){case X.R8G8B8:e.texImage2D(t,0,e.RGB,i,n,0,e.RGB,e.UNSIGNED_BYTE,null);break;case X.R8G8B8A8:e.texImage2D(t,0,e.RGBA,i,n,0,e.RGBA,e.UNSIGNED_BYTE,null);break;case X.Alpha8:e.texImage2D(t,0,e.ALPHA,i,n,0,e.ALPHA,e.UNSIGNED_BYTE,null);break;case X.R16G16B16A16:S.layaGPUInstance._isWebGL2?e.texImage2D(this._glTextureType,0,e.RGBA16F,i,n,0,e.RGBA,e.HALF_FLOAT,null):e.texImage2D(this._glTextureType,0,e.RGBA,i,n,0,e.RGBA,S.layaGPUInstance._oesTextureHalfFloat.HALF_FLOAT_OES,null)}}},{key:"_create",value:function(e,t){var i=S.instance;if(this._frameBuffer=i.createFramebuffer(),v.bindTexture(i,this._glTextureType,this._glTexture),this._texImage2D(i,this._glTextureType,e,t),this._setGPUMemory(e*t*4),i.bindFramebuffer(i.FRAMEBUFFER,this._frameBuffer),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,this._glTexture,0),this._depthStencilFormat!==W.DEPTHSTENCIL_NONE)switch(this._depthStencilBuffer=i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,this._depthStencilBuffer),this._depthStencilFormat){case W.DEPTH_16:i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_COMPONENT16,e,t),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,this._depthStencilBuffer);break;case W.STENCIL_8:i.renderbufferStorage(i.RENDERBUFFER,i.STENCIL_INDEX8,e,t),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.STENCIL_ATTACHMENT,i.RENDERBUFFER,this._depthStencilBuffer);break;case W.DEPTHSTENCIL_16_8:i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,e,t),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,this._depthStencilBuffer);break;default:throw"RenderTexture: unkonw depth format."}i.bindFramebuffer(i.FRAMEBUFFER,null),i.bindRenderbuffer(i.RENDERBUFFER,null),this._setWarpMode(i.TEXTURE_WRAP_S,this._wrapModeU),this._setWarpMode(i.TEXTURE_WRAP_T,this._wrapModeV),this._setFilterMode(this._filterMode),this._setAnisotropy(this._anisoLevel),this._readyed=!0,this._activeResource()}},{key:"_start",value:function(){var e=S.instance;e.bindFramebuffer(e.FRAMEBUFFER,this._frameBuffer),(l._currentActive=this)._isCameraTarget&&(Qs._instance.invertY=!0),this._readyed=!1}},{key:"_end",value:function(){var e=S.instance;e.bindFramebuffer(e.FRAMEBUFFER,null),l._currentActive=null,this._isCameraTarget&&(Qs._instance.invertY=!1),this._readyed=!0}},{key:"getData",value:function(e,t,i,n,a){if(Bt.isConchApp&&2==window.conchConfig.threadMode)throw"native 2 thread mode use getDataAsync";var s=S.instance;return s.bindFramebuffer(s.FRAMEBUFFER,this._frameBuffer),s.checkFramebufferStatus(s.FRAMEBUFFER)===s.FRAMEBUFFER_COMPLETE?(s.readPixels(e,t,i,n,s.RGBA,s.UNSIGNED_BYTE,a),s.bindFramebuffer(s.FRAMEBUFFER,null),a):(s.bindFramebuffer(s.FRAMEBUFFER,null),null)}},{key:"getDataAsync",value:function(e,t,i,n,a){var s=S.instance;s.bindFramebuffer(s.FRAMEBUFFER,this._frameBuffer),s.readPixelsAsync(e,t,i,n,s.RGBA,s.UNSIGNED_BYTE,function(e){a(new Uint8Array(e))}),s.bindFramebuffer(s.FRAMEBUFFER,null)}},{key:"_disposeResource",value:function(){var e;this._frameBuffer&&((e=S.instance).deleteTexture(this._glTexture),e.deleteFramebuffer(this._frameBuffer),e.deleteRenderbuffer(this._depthStencilBuffer),this._glTexture=null,this._frameBuffer=null,this._depthStencilBuffer=null,this._setGPUMemory(0))}}],[{key:"currentActive",get:function(){return l._currentActive}},{key:"createFromPool",value:function(e,t){for(var i,n,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:X.R8G8B8,s=3<arguments.length&&void 0!==arguments[3]?arguments[3]:W.DEPTH_16,r=4<arguments.length&&void 0!==arguments[4]?arguments[4]:le.FILTERMODE_BILINEAR,o=0,h=l._pool.length;o<h;o++)if((n=l._pool[o])._width==e&&n._height==t&&n._format==a&&n._depthStencilFormat==s&&n._filterMode==r)return n._inPool=!1,i=l._pool[h-1],l._pool[o]=i,--l._pool.length,n;return(n=new l(e,t,a,s)).filterMode=r,n.lock=!0,n}},{key:"recoverToPool",value:function(e){e._inPool||(l._pool.push(e),e._inPool=!0)}}]),l}()),Js=(Zs._pool=[],function(){function u(){b(this,u)}return y(u,null,[{key:"calculateCursorRay",value:function(e,t,i,n,a,s){var r=e.x,e=e.y,o=u._tempVector30,h=o,h=(h.x=r,h.y=e,h.z=t.minDepth,u._tempVector31),l=h,r=(l.x=r,l.y=e,l.z=t.maxDepth,s.origin),e=u._tempVector32,l=(t.unprojectFromWVP(o,i,n,a,r),t.unprojectFromWVP(h,i,n,a,e),s.direction);l.x=e.x-r.x,l.y=e.y-r.y,l.z=e.z-r.z,R.normalize(s.direction,s.direction)}},{key:"rayIntersectsTriangle",value:function(e,t,i,n){var a=u._tempVector30,s=u._tempVector31,i=(R.subtract(i,t,a),R.subtract(n,t,s),u._tempVector32);if(R.cross(e.direction,s,i),(n=R.dot(a,i))>-Number.MIN_VALUE&&n<Number.MIN_VALUE)return Number.NaN;var n=1/n,r=u._tempVector33;if(R.subtract(e.origin,t,r),t=R.dot(r,i),(t*=n)<0||1<t)return Number.NaN;i=u._tempVector34;return R.cross(r,a,i),r=R.dot(e.direction,i),(r*=n)<0||1<t+r?Number.NaN:(a=R.dot(s,i),(a*=n)<0?Number.NaN:a)}}]),u}()),$s=(Js._tempVector30=new R,Js._tempVector31=new R,Js._tempVector32=new R,Js._tempVector33=new R,Js._tempVector34=new R,function(){function e(){b(this,e)}return y(e,null,[{key:"supportTextureFormat",value:function(e){return e!==G.R32G32B32A32||!(!S.layaGPUInstance._isWebGL2&&!S.layaGPUInstance._oesTextureFloat)}},{key:"supportRenderTextureFormat",value:function(e){return e!==X.R16G16B16A16||!!(S.layaGPUInstance._isWebGL2||S.layaGPUInstance._oesTextureHalfFloat&&S.layaGPUInstance._oesTextureHalfFloatLinear)}}]),e}()),er=function(){f(n,oe);var i=T(n);function n(){b(this,n),(e=i.call(this))._bufferState=new ts,e._bufferStateInvertUV=new ts;var e,t=S.instance;return e._vertexBuffer=new os(64,t.STATIC_DRAW,!1),e._vertexBuffer.vertexDeclaration=n._vertexDeclaration,e._vertexBuffer.setData(n._vertices.buffer),e._bufferState.bind(),e._bufferState.applyVertexBuffer(e._vertexBuffer),e._bufferState.unBind(),e._vertexBufferInvertUV=new os(64,t.STATIC_DRAW,!1),e._vertexBufferInvertUV.vertexDeclaration=n._vertexDeclaration,e._vertexBufferInvertUV.setData(n._verticesInvertUV.buffer),e._bufferStateInvertUV.bind(),e._bufferStateInvertUV.applyVertexBuffer(e._vertexBufferInvertUV),e._bufferStateInvertUV.unBind(),e._setGPUMemory(e._vertexBuffer._byteLength+e._vertexBufferInvertUV._byteLength),e}return y(n,[{key:"render",value:function(){var e=S.instance;this._bufferState.bind(),e.drawArrays(e.TRIANGLE_STRIP,0,4),k.renderBatches++}},{key:"renderInvertUV",value:function(){var e=S.instance;this._bufferStateInvertUV.bind(),e.drawArrays(e.TRIANGLE_STRIP,0,4),k.renderBatches++}},{key:"destroy",value:function(){m(g(n.prototype),"destroy",this).call(this),this._bufferState.destroy(),this._vertexBuffer.destroy(),this._bufferStateInvertUV.destroy(),this._vertexBufferInvertUV.destroy(),this._setGPUMemory(0)}}],[{key:"__init__",value:function(){n._vertexDeclaration=new as(16,[new ss(0,ns.Vector4,n.SCREENQUAD_POSITION_UV)]),(n.instance=new n).lock=!0}}]),n}(),tr=(er.SCREENQUAD_POSITION_UV=0,er._vertices=new Float32Array([1,1,1,1,1,-1,1,0,-1,1,0,1,-1,-1,0,0]),er._verticesInvertUV=new Float32Array([1,1,1,0,1,-1,1,1,-1,1,0,0,-1,-1,0,1]),function(){f(n,oe);var i=T(n);function n(){b(this,n),(e=i.call(this))._bufferState=new ts,e._bufferStateInvertUV=new ts;var e,t=S.instance;return e._vertexBuffer=new os(48,t.STATIC_DRAW,!1),e._vertexBuffer.vertexDeclaration=n._vertexDeclaration,e._vertexBuffer.setData(n._vertices.buffer),e._bufferState.bind(),e._bufferState.applyVertexBuffer(e._vertexBuffer),e._bufferState.unBind(),e._vertexBufferInvertUV=new os(48,t.STATIC_DRAW,!1),e._vertexBufferInvertUV.vertexDeclaration=n._vertexDeclaration,e._vertexBufferInvertUV.setData(n._verticesInvertUV.buffer),e._bufferStateInvertUV.bind(),e._bufferStateInvertUV.applyVertexBuffer(e._vertexBufferInvertUV),e._bufferStateInvertUV.unBind(),e._setGPUMemory(e._vertexBuffer._byteLength+e._vertexBufferInvertUV._byteLength),e}return y(n,[{key:"render",value:function(){var e=S.instance;this._bufferState.bind(),e.drawArrays(e.TRIANGLES,0,3),k.renderBatches++}},{key:"renderInvertUV",value:function(){var e=S.instance;this._bufferStateInvertUV.bind(),e.drawArrays(e.TRIANGLES,0,3),k.renderBatches++}},{key:"destroy",value:function(){m(g(n.prototype),"destroy",this).call(this),this._bufferState.destroy(),this._vertexBuffer.destroy(),this._bufferStateInvertUV.destroy(),this._vertexBufferInvertUV.destroy(),this._setGPUMemory(0)}}],[{key:"__init__",value:function(){n._vertexDeclaration=new as(16,[new ss(0,ns.Vector4,n.SCREENTRIANGLE_POSITION_UV)]),(n.instance=new n).lock=!0}}]),n}()),ir=(tr.SCREENTRIANGLE_POSITION_UV=0,tr._vertices=new Float32Array([-1,-1,0,0,-1,3,0,2,3,-1,2,0]),tr._verticesInvertUV=new Float32Array([-1,-1,0,1,-1,3,0,-1,3,-1,2,1]),function(){function e(){b(this,e),this._commandBuffer=null}return y(e,[{key:"run",value:function(){}},{key:"recover",value:function(){this._commandBuffer=null}}],[{key:"__init__",value:function(){e._screenShaderData=new es,e._screenShader=A.find("BlitScreen")}}]),e}()),nr=(ir.SCREENTEXTURE_NAME="u_MainTex",ir.SCREENTEXTUREOFFSETSCALE_NAME="u_OffsetScale",ir.MAINTEXTURE_TEXELSIZE_NAME="u_MainTex_TexelSize",ir.SCREENTEXTURE_ID=A.propertyNameToID(ir.SCREENTEXTURE_NAME),ir.SCREENTEXTUREOFFSETSCALE_ID=A.propertyNameToID(ir.SCREENTEXTUREOFFSETSCALE_NAME),ir.MAINTEXTURE_TEXELSIZE_ID=A.propertyNameToID(ir.MAINTEXTURE_TEXELSIZE_NAME),function(){f(h,ir);var t=T(h);function h(){var e;return b(this,h),(e=t.apply(this,arguments))._source=null,e._dest=null,e._offsetScale=null,e._shader=null,e._shaderData=null,e._subShader=0,e._sourceTexelSize=new Sa,e._screenType=0,e}return y(h,[{key:"run",value:function(){var e=this._shader||ir._screenShader,t=this._shaderData||ir._screenShaderData,i=this._dest;S.instance.viewport(0,0,i?i.width:Qs.clientWidth,i?i.height:Qs.clientHeight),t.setTexture(ir.SCREENTEXTURE_ID,this._source),t.setVector(ir.SCREENTEXTUREOFFSETSCALE_ID,this._offsetScale||h._defaultOffsetScale),this._sourceTexelSize.setValue(1/this._source.width,1/this._source.height,this._source.width,this._source.height),t.setVector(ir.MAINTEXTURE_TEXELSIZE_ID,this._sourceTexelSize),i&&i._start();for(var n=e.getSubShaderAt(this._subShader)._passes,a=0,s=n.length;a<s;a++){var r=h._compileDefine,r=(t._defineDatas.cloneTo(r),n[a].withCompile(r));switch(r.bind(),r.uploadUniforms(r._materialUniformParamsMap,t,!0),r.uploadRenderStateBlendDepth(t),r.uploadRenderStateFrontFace(t,!1,null),this._screenType){case h._SCREENTYPE_QUAD:Qs._instance.invertY?er.instance.renderInvertUV():er.instance.render();break;case h._SCREENTYPE_TRIANGLE:Qs._instance.invertY?tr.instance.renderInvertUV():tr.instance.render();break;default:throw"BlitScreenQuadCMD:unknown screen Type."}}i&&i._end()}},{key:"recover",value:function(){h._pool.push(this),this._source=null,this._dest=null,this._offsetScale=null,this._shader=null,this._shaderData=null,m(g(h.prototype),"recover",this).call(this)}}],[{key:"create",value:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:null,s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,r=6<arguments.length&&void 0!==arguments[6]?arguments[6]:h._SCREENTYPE_QUAD,o=0<h._pool.length?h._pool.pop():new h;return o._source=e,o._dest=t,o._offsetScale=i,o._shader=n,o._shaderData=a,o._subShader=s,o._screenType=r,o}}]),h}()),ar=(nr._SCREENTYPE_QUAD=0,nr._SCREENTYPE_TRIANGLE=1,nr._compileDefine=new Ua,nr._pool=[],nr._defaultOffsetScale=new Sa(0,0,1,1),function(){f(i,ir);var t=T(i);function i(){var e;return b(this,i),(e=t.apply(this,arguments))._renderTexture=null,e}return y(i,[{key:"run",value:function(){this._renderTexture._start()}},{key:"recover",value:function(){i._pool.push(this),this._renderTexture=null}}],[{key:"create",value:function(e){var t=0<i._pool.length?i._pool.pop():new i;return t._renderTexture=e,t}}]),i}()),sr=(ar._pool=[],function(){f(a,ir);var t=T(a);function a(){var e;return b(this,a),(e=t.apply(this,arguments))._shaderData=null,e._nameID=0,e._texture=null,e}return y(a,[{key:"run",value:function(){this._shaderData.setTexture(this._nameID,this._texture)}},{key:"recover",value:function(){a._pool.push(this),this._shaderData=null,this._nameID=0,this._texture=null}}],[{key:"create",value:function(e,t,i){var n=0<a._pool.length?a._pool.pop():new a;return n._shaderData=e,n._nameID=t,n._texture=i,n}}]),a}()),rr=(sr._pool=[],function(){function e(){b(this,e),this._camera=null,this._commands=[]}return y(e,[{key:"_apply",value:function(){for(var e=0,t=this._commands.length;e<t;e++)this._commands[e].run()}},{key:"setShaderDataTexture",value:function(e,t,i){this._commands.push(sr.create(e,t,i))}},{key:"blitScreenQuad",value:function(e,t){this._commands.push(nr.create(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,4<arguments.length&&void 0!==arguments[4]?arguments[4]:null,5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,nr._SCREENTYPE_QUAD))}},{key:"blitScreenTriangle",value:function(e,t){this._commands.push(nr.create(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,4<arguments.length&&void 0!==arguments[4]?arguments[4]:null,5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,nr._SCREENTYPE_TRIANGLE))}},{key:"setRenderTarget",value:function(e){this._commands.push(ar.create(e))}},{key:"clear",value:function(){for(var e=0,t=this._commands.length;e<t;e++)this._commands[e].recover();this._commands.length=0}}]),e}()),or=y(function e(){b(this,e)}),hr=((n=Ji=Ji||{})[n.SolidColor=0]="SolidColor",n[n.Sky=1]="Sky",n[n.DepthOnly=2]="DepthOnly",n[n.Nothing=3]="Nothing",function(){f(d,cs);var n=T(d);function d(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:.3,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1e3;return b(this,d),(t=n.call(this,t,i))._updateViewMatrix=!0,t._postProcess=null,t._enableHDR=!1,t._viewportParams=new Sa,t._projectionParams=new Sa,t._offScreenRenderTexture=null,t._internalRenderTexture=null,t._postProcessCommandBuffers=[],t._clusterPlaneCacheFlag=new ba(-1,-1),t._screenOffsetScale=new Sa,t.enableRender=!0,t.clearFlag=Ji.SolidColor,t._viewMatrix=new Pa,t._projectionMatrix=new Pa,t._projectionViewMatrix=new Pa,t._viewport=new Ks(0,0,0,0),t._normalizedViewport=new Ks(0,0,1,1),t._aspectRatio=e,t._boundFrustum=new qs(Pa.DEFAULT),Bt.supportWebGLPlusCulling&&(t._boundFrustumBuffer=new Float32Array(24)),t._calculateProjectionMatrix(),o.stage.on(Me.RESIZE,O(t),t._onScreenSizeChanged),t.transform.on(Me.TRANSFORM_CHANGED,O(t),t._onTransformChanged),t}return y(d,[{key:"aspectRatio",get:function(){var e;return 0===this._aspectRatio?(e=this.viewport).width/e.height:this._aspectRatio},set:function(e){if(e<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=e,this._calculateProjectionMatrix()}},{key:"viewport",get:function(){return this._offScreenRenderTexture?this._calculationViewport(this._normalizedViewport,this._offScreenRenderTexture.width,this._offScreenRenderTexture.height):this._calculationViewport(this._normalizedViewport,Qs.clientWidth,Qs.clientHeight),this._viewport},set:function(e){var t,i=this._offScreenRenderTexture?(t=this._offScreenRenderTexture.width,this._offScreenRenderTexture.height):(t=Qs.clientWidth,Qs.clientHeight);this._normalizedViewport.x=e.x/t,this._normalizedViewport.y=e.y/i,this._normalizedViewport.width=e.width/t,this._normalizedViewport.height=e.height/i,this._calculationViewport(this._normalizedViewport,t,i),this._calculateProjectionMatrix()}},{key:"normalizedViewport",get:function(){return this._normalizedViewport},set:function(e){var t,i=this._offScreenRenderTexture?(t=this._offScreenRenderTexture.width,this._offScreenRenderTexture.height):(t=Qs.clientWidth,Qs.clientHeight);this._normalizedViewport!==e&&e.cloneTo(this._normalizedViewport),this._calculationViewport(e,t,i),this._calculateProjectionMatrix()}},{key:"viewMatrix",get:function(){var e,t,i,n;return this._updateViewMatrix&&(e=(i=this.transform.getWorldLossyScale()).x,t=i.y,i=i.z,n=this._viewMatrix.elements,this.transform.worldMatrix.cloneTo(this._viewMatrix),n[0]/=e,n[1]/=e,n[2]/=e,n[4]/=t,n[5]/=t,n[6]/=t,n[8]/=i,n[9]/=i,n[10]/=i,this._viewMatrix.invert(this._viewMatrix),this._updateViewMatrix=!1),this._viewMatrix}},{key:"projectionMatrix",get:function(){return this._projectionMatrix},set:function(e){this._projectionMatrix=e,this._useUserProjectionMatrix=!0}},{key:"projectionViewMatrix",get:function(){return Pa.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}},{key:"boundFrustum",get:function(){var e,t,i,n,a,s,r,o,h,l,u,c,_;return this._boundFrustum.matrix=this.projectionViewMatrix,Bt.supportWebGLPlusCulling&&(e=this._boundFrustum.near,t=this._boundFrustum.far,i=this._boundFrustum.left,n=this._boundFrustum.right,a=this._boundFrustum.top,s=this._boundFrustum.bottom,r=e.normal,o=t.normal,h=i.normal,l=n.normal,u=a.normal,c=s.normal,(_=this._boundFrustumBuffer)[0]=r.x,_[1]=r.y,_[2]=r.z,_[3]=e.distance,_[4]=o.x,_[5]=o.y,_[6]=o.z,_[7]=t.distance,_[8]=h.x,_[9]=h.y,_[10]=h.z,_[11]=i.distance,_[12]=l.x,_[13]=l.y,_[14]=l.z,_[15]=n.distance,_[16]=u.x,_[17]=u.y,_[18]=u.z,_[19]=a.distance,_[20]=c.x,_[21]=c.y,_[22]=c.z,_[23]=s.distance),this._boundFrustum}},{key:"renderTarget",get:function(){return this._offScreenRenderTexture},set:function(e){var t=this._offScreenRenderTexture;t!==e&&(t&&(t._isCameraTarget=!1),e&&(e._isCameraTarget=!0),this._offScreenRenderTexture=e,this._calculateProjectionMatrix())}},{key:"postProcess",get:function(){return this._postProcess},set:function(e){this._postProcess=e;var t=new rr;this.addCommandBuffer(d.CAMERAEVENT_POSTPROCESS,t),e._init(this,t)}},{key:"enableHDR",get:function(){return this._enableHDR},set:function(e){e&&!$s.supportRenderTextureFormat(X.R16G16B16A16)?console.warn("Camera:can't enable HDR in this device."):this._enableHDR=e}},{key:"_calculationViewport",value:function(e,t,i){var n=e.x*t,a=e.y*i,t=n+Math.max(e.width*t,0),e=a+Math.max(e.height*i,0),i=Math.ceil(n),s=Math.ceil(a),r=Math.floor(t),o=Math.floor(e),n=.5<=i-n?Math.floor(n):i,i=.5<=s-a?Math.floor(a):s,a=.5<=t-r?Math.ceil(t):r,s=.5<=e-o?Math.ceil(e):o;this._viewport.x=n,this._viewport.y=i,this._viewport.width=a-n,this._viewport.height=s-i}},{key:"_calculateProjectionMatrix",value:function(){var e,t;this._useUserProjectionMatrix||(this._orthographic?(t=(e=.5*this.orthographicVerticalSize)*this.aspectRatio,Pa.createOrthoOffCenter(-t,t,-e,e,this.nearPlane,this.farPlane,this._projectionMatrix)):Pa.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix))}},{key:"_isLayerVisible",value:function(e){return 0!=(Math.pow(2,e)&this.cullingMask)}},{key:"_onTransformChanged",value:function(e){(e&=Ya.TRANSFORM_WORLDMATRIX)&&(this._updateViewMatrix=!0)}},{key:"_parse",value:function(e,t){m(g(d.prototype),"_parse",this).call(this,e,t);t=e.clearFlag,void 0!==t&&(this.clearFlag=t),t=e.viewport,this.normalizedViewport=new Ks(t[0],t[1],t[2],t[3]),t=e.enableHDR;void 0!==t&&(this.enableHDR=t)}},{key:"_getCanvasWidth",value:function(){return this._offScreenRenderTexture?this._offScreenRenderTexture.width:Qs.clientWidth}},{key:"_getCanvasHeight",value:function(){return this._offScreenRenderTexture?this._offScreenRenderTexture.height:Qs.clientHeight}},{key:"_getRenderTexture",value:function(){return this._internalRenderTexture||this._offScreenRenderTexture}},{key:"_needInternalRenderTexture",value:function(){return!(!this._postProcess&&!this._enableHDR)}},{key:"_applyPostProcessCommandBuffers",value:function(){for(var e=0,t=this._postProcessCommandBuffers.length;e<t;e++)this._postProcessCommandBuffers[e]._apply()}},{key:"_getRenderTextureFormat",value:function(){return this._enableHDR?X.R16G16B16A16:X.R8G8B8}},{key:"_prepareCameraToRender",value:function(){m(g(d.prototype),"_prepareCameraToRender",this).call(this);var e=this.viewport;this._viewportParams.setValue(e.x,e.y,e.width,e.height),this._projectionParams.setValue(this._nearPlane,this._farPlane,Qs._instance.invertY?-1:1,0),this._shaderValues.setVector(cs.VIEWPORT,this._viewportParams),this._shaderValues.setVector(cs.PROJECTION_PARAMS,this._projectionParams)}},{key:"_applyViewProject",value:function(e,t,i){var n=this._shaderValues,a=e.invertY?(Pa.multiply(cs._invertYScaleMatrix,i,cs._invertYProjectionMatrix),Pa.multiply(cs._invertYProjectionMatrix,t,cs._invertYProjectionViewMatrix),i=cs._invertYProjectionMatrix,cs._invertYProjectionViewMatrix):(Pa.multiply(i,t,this._projectionViewMatrix),this._projectionViewMatrix);e.viewMatrix=t,e.projectionMatrix=i,e.projectionViewMatrix=a,n.setMatrix4x4(cs.VIEWMATRIX,t),n.setMatrix4x4(cs.PROJECTMATRIX,i),n.setMatrix4x4(cs.VIEWPROJECTMATRIX,a)}},{key:"_updateClusterPlaneXY",value:function(){var e=this.fieldOfView,t=this.aspectRatio;if(this._clusterPlaneCacheFlag.x!==e||this._clusterPlaneCacheFlag.y!==t){var i=Va._config.lightClusterCount,n=i.x,i=i.y,a=n+1,s=i+1,r=this._clusterXPlanes,o=this._clusterYPlanes;if(!r){for(var r=this._clusterXPlanes=new Array(a),o=this._clusterYPlanes=new Array(s),h=0;h<a;h++)r[h]=new R;for(h=0;h<s;h++)o[h]=new R}for(var l=Math.tan(this.fieldOfView/2*Math.PI/180),u=this.aspectRatio*l,c=2*l/n,_=2*u/i,h=0;h<a;h++){var f=_*h-u,d=1/Math.sqrt(1+f*f);r[h].setValue(d,0,-f*d)}for(h=0;h<s;h++){var f=l-c*h,p=-1/Math.sqrt(1+f*f);o[h].setValue(0,p,-f*p)}this._clusterPlaneCacheFlag.x=e,this._clusterPlaneCacheFlag.y=t}}},{key:"render",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if(this.activeInHierarchy){var i=this.viewport,n=this._needInternalRenderTexture(),a=S.instance,s=Qs._instance,r=s.scene=this._scene;if(this._internalRenderTexture=n?Zs.createFromPool(i.width,i.height,this._getRenderTextureFormat(),W.DEPTH_16,le.FILTERMODE_BILINEAR):null,r.parallelSplitShadowMaps[0]){es.setRuntimeValueMode(!1);var o=r.parallelSplitShadowMaps[0];o._calcAllLightCameraInfo(this),r._shaderValues.addDefine(or.SHADERDEFINE_CAST_SHADOW);for(var h=0,l=o.shadowMapCount;h<l;h++){var u=o.cameras[h],c=(s.camera=u,Ka.renderObjectCulling(u,r,s,e,t,!0),o.cameras[h+1].renderTarget);c._start(),Qs._instance.invertY=!1,s.camera=u,d._updateMark++,s.viewport=u.viewport,u._prepareCameraToRender(),u._applyViewProject(s,u.viewMatrix,u.projectionMatrix),r._clear(a,s),r._opaqueQueue._render(s),c._end()}r._shaderValues.removeDefine(or.SHADERDEFINE_CAST_SHADOW),es.setRuntimeValueMode(!0)}s.camera=this,d._updateMark++,r._preRenderScript(),!n||this._offScreenRenderTexture||this.clearFlag!=Ji.DepthOnly&&this.clearFlag!=Ji.Nothing||(this._enableHDR?(f=Zs.createFromPool(i.width,i.height,X.R8G8B8,W.DEPTH_16,le.FILTERMODE_BILINEAR),v.bindTexture(a,a.TEXTURE_2D,f._getSource()),a.copyTexSubImage2D(a.TEXTURE_2D,0,0,0,i.x,Qs.clientHeight-(i.y+i.height),i.width,i.height),(_=nr.create(f,this._internalRenderTexture)).run(),_.recover(),Zs.recoverToPool(f)):(v.bindTexture(a,a.TEXTURE_2D,this._internalRenderTexture._getSource()),a.copyTexSubImage2D(a.TEXTURE_2D,0,0,0,i.x,Qs.clientHeight-(i.y+i.height),i.width,i.height)));var _,f=this._getRenderTexture();f&&f._start(),s.viewport=i,this._prepareCameraToRender(),Va._config._multiLighting&&Za.instance.update(this,this._scene),this._applyViewProject(s,this.viewMatrix,this._projectionMatrix),r._preCulling(s,this,e,t),r._clear(a,s),r._renderScene(s),r._postRenderScript(),f&&f._end(),n&&(this._postProcess?(this._postProcess._render(),this._applyPostProcessCommandBuffers()):this._enableHDR&&(f=this._getCanvasWidth(),n=this._getCanvasHeight(),this._screenOffsetScale.setValue(i.x/f,i.y/n,i.width/f,i.height/n),(_=nr.create(this._internalRenderTexture,this._offScreenRenderTexture||null,this._screenOffsetScale)).run(),_.recover()),Zs.recoverToPool(this._internalRenderTexture))}}},{key:"viewportPointToRay",value:function(e,t){Js.calculateCursorRay(e,this.viewport,this._projectionMatrix,this.viewMatrix,null,t)}},{key:"normalizedViewportPointToRay",value:function(e,t){var i=d._tempVector20,n=this.viewport;i.x=e.x*n.width,i.y=e.y*n.height,Js.calculateCursorRay(i,this.viewport,this._projectionMatrix,this.viewMatrix,null,t)}},{key:"worldToViewportPoint",value:function(e,t){Pa.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project(e,this._projectionViewMatrix,t),t.x=t.x/o.stage.clientScaleX,t.y=t.y/o.stage.clientScaleY}},{key:"worldToNormalizedViewportPoint",value:function(e,t){Pa.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project(e,this._projectionViewMatrix,t),t.x=t.x/o.stage.clientScaleX,t.y=t.y/o.stage.clientScaleY}},{key:"convertScreenCoordToOrthographicCoord",value:function(e,t){var i,n,a,s;return!!this._orthographic&&(i=Qs.clientWidth,n=Qs.clientHeight,a=this.orthographicVerticalSize*this.aspectRatio/i,s=this.orthographicVerticalSize/n,t.x=(-i/2+e.x*o.stage.clientScaleX)*a,t.y=(n/2-e.y*o.stage.clientScaleY)*s,t.z=(this.nearPlane-this.farPlane)*(e.z+1)/2-this.nearPlane,R.transformCoordinate(t,this.transform.worldMatrix,t),!0)}},{key:"destroy",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this._offScreenRenderTexture=null,this.transform.off(Me.TRANSFORM_CHANGED,this,this._onTransformChanged),m(g(d.prototype),"destroy",this).call(this,e)}},{key:"addCommandBuffer",value:function(e,t){if(e!==d.CAMERAEVENT_POSTPROCESS)throw"Camera:unknown event.";this._postProcessCommandBuffers.push(t),t._camera=this}},{key:"removeCommandBuffer",value:function(e,t){if(e!==d.CAMERAEVENT_POSTPROCESS)throw"Camera:unknown event.";e=this._postProcessCommandBuffers.indexOf(t);-1!==e&&this._postProcessCommandBuffers.splice(e,1)}},{key:"removeCommandBuffers",value:function(e){if(e!==d.CAMERAEVENT_POSTPROCESS)throw"Camera:unknown event.";this._postProcessCommandBuffers.length=0}},{key:"_create",value:function(){return new d}}]),d}()),lr=(hr.CAMERAEVENT_POSTPROCESS=0,hr._tempVector20=new ba,hr._updateMark=0,function(){function m(){b(this,m),this.renderSubShader=null,this.renderType=m.RENDERTYPE_NORMAL}return y(m,[{key:"getInvertFront",value:function(){return this._transform._isFrontFaceInvert}},{key:"setTransform",value:function(e){this._transform=e}},{key:"setGeometry",value:function(e){this._geometry=e}},{key:"addToOpaqueRenderQueue",value:function(e,t){t.elements.add(this)}},{key:"addToTransparentRenderQueue",value:function(e,t){t.elements.add(this),t.lastTransparentBatched=!1,t.lastTransparentRenderElement=this}},{key:"_update",value:function(e,t,i,n){if(this.material){var a=this.material._shader.getSubShaderAt(0);if(this.renderSubShader=null,i)if(n){var s=a.getFlag(n);if(!s)return;for(var r=i._subShaders,o=0,h=r.length;o<h;o++){var l=r[o];if(s===l.getFlag(n)){this.renderSubShader=l;break}}if(!this.renderSubShader)return}else this.renderSubShader=i.getSubShaderAt(0);else this.renderSubShader=a;i=e._getRenderQueue(this.material.renderQueue);i.isTransparent?this.addToTransparentRenderQueue(t,i):this.addToOpaqueRenderQueue(t,i)}}},{key:"_render",value:function(e){var t,i,n,a=e.invertY,s=hr._updateMark,r=e.scene,o=e.camera,h=this._transform,l=this._geometry,u=s!==(e.renderElement=this).render._updateMark||this.renderType!==this.render._updateRenderType;if(u?(this.render._renderUpdate(e,h),this.render._renderUpdateWithCamera(e,h),this.render._updateMark=s,this.render._updateRenderType=this.renderType):this.renderType==m.RENDERTYPE_INSTANCEBATCH&&(this.render._renderUpdate(e,h),this.render._renderUpdateWithCamera(e,h)),l._prepareRender(e))for(var c=this.renderSubShader._passes,_=0,f=c.length;_<f;_++){var d=m._compileDefine,d=(r._shaderValues._defineDatas.cloneTo(d),d.removeDefineDatas(this.material._disablePublicDefineDatas),d.addDefineDatas(this.render._shaderValues._defineDatas),d.addDefineDatas(this.material._shaderValues._defineDatas),e.shader=c[_].withCompile(d)),p=d.bind(),y=s!==d._uploadMark,g=d._uploadScene!==r||y,g=((g||p)&&(d.uploadUniforms(d._sceneUniformParamsMap,r._shaderValues,g),d._uploadScene=r),d._uploadRender!==this.render||d._uploadRenderType!==this.renderType||y),g=((g||p)&&(d.uploadUniforms(d._spriteUniformParamsMap,this.render._shaderValues,g),d._uploadRender=this.render,d._uploadRenderType=this.renderType),d._uploadCamera!==o||y),g=((g||p)&&(d.uploadUniforms(d._cameraUniformParamsMap,o._shaderValues,g),d._uploadCamera=o),d._uploadMaterial!==this.material||y),y=((g||p)&&(d.uploadUniforms(d._materialUniformParamsMap,this.material._shaderValues,g),d._uploadMaterial=this.material),this.material._shaderValues);t!==this.material||i!==d?(d.uploadRenderStateBlendDepth(y),d.uploadRenderStateFrontFace(y,a,this.getInvertFront()),t=this.material,i=d,n=this.render):n!==this.render&&(d.uploadRenderStateFrontFace(y,a,this.getInvertFront()),n=this.render),l._render(e),d._uploadMark=s}u&&this.renderType!==m.RENDERTYPE_NORMAL&&this.render._revertBatchRenderUpdate(e)}},{key:"destroy",value:function(){this._transform=null,this._geometry=null,this.material=null,this.render=null}}]),m}()),ur=(lr.RENDERTYPE_NORMAL=0,lr.RENDERTYPE_STATICBATCH=1,lr.RENDERTYPE_INSTANCEBATCH=2,lr.RENDERTYPE_VERTEXBATCH=3,lr._compileDefine=new Ua,function(){f(i,lr);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this))._dynamicWorldPositionNormalNeedUpdate=!0,e}return y(i,[{key:"_onWorldMatrixChanged",value:function(){this._dynamicWorldPositionNormalNeedUpdate=!0}},{key:"_computeWorldPositionsAndNormals",value:function(e,t,i,n){if(this._dynamicWorldPositionNormalNeedUpdate){for(var a=this._geometry,s=a._vertexBuffer,r=s.vertexDeclaration.vertexStride/4,o=s.getFloat32Data(),h=this._transform.worldMatrix,l=this._transform.rotation,u=a._indices,c=0;c<n;c++){var _=(i?u[c]:c)*r,f=3*c;Ra.transformVector3ArrayToVector3ArrayCoordinate(o,_+e,h,this._dynamicWorldPositions,f),-1!==t&&Ra.transformVector3ArrayByQuat(o,_+t,l,this._dynamicWorldNormals,f)}this._dynamicWorldPositionNormalNeedUpdate=!1}}},{key:"setTransform",value:function(e){this._transform!==e&&(this._transform&&this._transform.off(Me.TRANSFORM_CHANGED,this,this._onWorldMatrixChanged),e&&e.on(Me.TRANSFORM_CHANGED,this,this._onWorldMatrixChanged),this._dynamicWorldPositionNormalNeedUpdate=!0,this._transform=e)}},{key:"setGeometry",value:function(e){var t,i,n;this._geometry!==e&&((i=e._mesh)&&((i=(t=1<i._subMeshes.length)?e._indexCount:i._vertexCount)<=Ta.SubMeshDynamicBatch.maxAllowVertexCount?(n=3*i,this._dynamicVertexBatch=!0,this._dynamicWorldPositions=new Float32Array(n),this._dynamicWorldNormals=new Float32Array(n),this._dynamicVertexCount=i,this._dynamicMultiSubMesh=t):this._dynamicVertexBatch=!1),this._geometry=e)}},{key:"addToOpaqueRenderQueue",value:function(e,t){var i,n,a,s,r,o,h=this.staticBatch,t=t.elements,l=t.elements;h?(a=(n=Ta.MeshRenderStaticBatchManager.instance).getBatchOpaquaMark(this.render.lightmapIndex+1,this.render.receiveShadow,this.material.id,h._batchID),n._updateCountMark===a.updateMark?(s=a.indexInList,a.batched?l[s].staticBatchElementList.add(this):(i=(o=l[s]).render,(r=n._getBatchRenderElementFromPool()).renderType=lr.RENDERTYPE_STATICBATCH,r.setGeometry(h),r.material=o.material,h=(h=h.batchOwner)?h._transform:null,r.setTransform(h),r.render=i,r.renderSubShader=o.renderSubShader,(h=r.staticBatchElementList).length=0,h.add(o),h.add(this),l[s]=r,a.batched=!0)):(a.updateMark=n._updateCountMark,a.indexInList=t.length,a.batched=!1,t.add(this))):this.renderSubShader._owner._enableInstancing&&S.layaGPUInstance.supportInstance()&&this.render.lightmapIndex<0?(i=this._geometry,h=(o=Ta.MeshRenderDynamicBatchManager.instance).getInstanceBatchOpaquaMark(this.render.receiveShadow,this.material.id,i._id,this._transform._isFrontFaceInvert),o._updateCountMark===h.updateMark?(s=h.indexInList,h.batched?(r=l[s].instanceBatchElementList).length===Xs.instance.maxInstanceCount?(h.updateMark=o._updateCountMark,h.indexInList=t.length,h.batched=!1,t.add(this)):r.add(this):(a=(n=l[s]).render,(r=o._getBatchRenderElementFromPool()).renderType=lr.RENDERTYPE_INSTANCEBATCH,r.setGeometry(Xs.instance),r.material=n.material,r.setTransform(null),r.render=a,r.instanceSubMesh=i,r.renderSubShader=n.renderSubShader,(a=r.instanceBatchElementList).length=0,a.add(n),a.add(this),l[s]=r,h.batched=!0)):(h.updateMark=o._updateCountMark,h.indexInList=t.length,h.batched=!1,t.add(this))):this._dynamicVertexBatch?(i=this._geometry._vertexBuffer.vertexDeclaration,a=(n=Ta.MeshRenderDynamicBatchManager.instance).getVertexBatchOpaquaMark(this.render.lightmapIndex+1,this.render.receiveShadow,this.material.id,i.id),n._updateCountMark===a.updateMark?(s=a.indexInList,a.batched?l[s].vertexBatchElementList.add(this):(o=(r=l[s]).render,(h=n._getBatchRenderElementFromPool()).renderType=lr.RENDERTYPE_VERTEXBATCH,h.setGeometry(Ta.SubMeshDynamicBatch.instance),h.material=r.material,h.setTransform(null),h.render=o,h.vertexBatchVertexDeclaration=i,h.renderSubShader=r.renderSubShader,(o=h.vertexBatchElementList).length=0,o.add(r),o.add(this),l[s]=h,a.batched=!0)):(a.updateMark=n._updateCountMark,a.indexInList=t.length,a.batched=!1,t.add(this))):t.add(this)}},{key:"addToTransparentRenderQueue",value:function(e,t){var i,n,a,s=this.staticBatch,r=t.elements,o=r.elements;s?(a=Ta.MeshRenderStaticBatchManager.instance,(i=t.lastTransparentRenderElement)?(n=i.render,i._geometry._getType()!==this._geometry._getType()||i.staticBatch!==s||i.material!==this.material||n.receiveShadow!==this.render.receiveShadow||n.lightmapIndex!==this.render.lightmapIndex?(r.add(this),t.lastTransparentBatched=!1):(t.lastTransparentBatched?o[r.length-1].staticBatchElementList.add(this):((n=a._getBatchRenderElementFromPool()).renderType=lr.RENDERTYPE_STATICBATCH,n.setGeometry(s),n.material=i.material,s=(a=s.batchOwner)?a._transform:null,n.setTransform(s),n.render=this.render,n.renderSubShader=i.renderSubShader,(a=n.staticBatchElementList).length=0,a.add(i),a.add(this),o[r.length-1]=n),t.lastTransparentBatched=!0)):(r.add(this),t.lastTransparentBatched=!1)):this.renderSubShader._owner._enableInstancing&&S.layaGPUInstance.supportInstance()&&this.render.lightmapIndex<0?(s=this._geometry,i=Ta.MeshRenderDynamicBatchManager.instance,(a=t.lastTransparentRenderElement)?(n=a.render,a._geometry._getType()!==this._geometry._getType()||a._geometry!==s||a.material!==this.material||n.receiveShadow!==this.render.receiveShadow?(r.add(this),t.lastTransparentBatched=!1):t.lastTransparentBatched?(n=o[r.length-1].instanceBatchElementList).length===Xs.instance.maxInstanceCount?(r.add(this),t.lastTransparentBatched=!1):(n.add(this),t.lastTransparentBatched=!0):((n=i._getBatchRenderElementFromPool()).renderType=lr.RENDERTYPE_INSTANCEBATCH,n.setGeometry(Xs.instance),n.material=a.material,n.setTransform(null),n.render=this.render,n.instanceSubMesh=s,n.renderSubShader=a.renderSubShader,(i=n.instanceBatchElementList).length=0,i.add(a),i.add(this),o[r.length-1]=n,t.lastTransparentBatched=!0)):(r.add(this),t.lastTransparentBatched=!1)):this._dynamicVertexBatch?(s=this._geometry._vertexBuffer.vertexDeclaration,a=Ta.MeshRenderDynamicBatchManager.instance,(i=t.lastTransparentRenderElement)?(n=i.render,i._geometry._getType()!==this._geometry._getType()||i._geometry._vertexBuffer._vertexDeclaration!==s||i.material!==this.material||n.receiveShadow!==this.render.receiveShadow||n.lightmapIndex!==this.render.lightmapIndex?(r.add(this),t.lastTransparentBatched=!1):(t.lastTransparentBatched?o[r.length-1].vertexBatchElementList.add(this):((n=a._getBatchRenderElementFromPool()).renderType=lr.RENDERTYPE_VERTEXBATCH,n.setGeometry(Ta.SubMeshDynamicBatch.instance),n.material=i.material,n.setTransform(null),n.render=this.render,n.vertexBatchVertexDeclaration=s,n.renderSubShader=i.renderSubShader,(a=n.vertexBatchElementList).length=0,a.add(i),a.add(this),o[r.length-1]=n),t.lastTransparentBatched=!0)):(r.add(this),t.lastTransparentBatched=!1)):r.add(this),t.lastTransparentRenderElement=this}},{key:"getInvertFront",value:function(){switch(this.renderType){case lr.RENDERTYPE_NORMAL:return this._transform._isFrontFaceInvert;case lr.RENDERTYPE_STATICBATCH:case lr.RENDERTYPE_VERTEXBATCH:return!1;case lr.RENDERTYPE_INSTANCEBATCH:return this.instanceBatchElementList.elements[0]._transform._isFrontFaceInvert;default:throw"SubMeshRenderElement: unknown renderType"}}},{key:"destroy",value:function(){m(g(i.prototype),"destroy",this).call(this),this._dynamicWorldPositions=null,this._dynamicWorldNormals=null,this.staticBatch=null,this.staticBatchElementList=null,this.vertexBatchElementList=null,this.vertexBatchVertexDeclaration=null}}]),i}()),cr=function(){f(E,Us);var n=T(E);function E(e,t){var i;return b(this,E),(i=n.call(this))._bufferState=new ts,i._batchID=E._batchIDCounter++,i._batchElements=[],i._currentBatchVertexCount=0,i._currentBatchIndexCount=0,i._vertexDeclaration=t,i.batchOwner=e,i}return y(E,[{key:"_getStaticBatchBakedVertexs",value:function(e,t,i,n,a,s){for(var r,o=s._vertexBuffer,h=o.vertexDeclaration,l=h.getVertexElementByUsage(rs.MESH_POSITION0)._offset/4,u=h.getVertexElementByUsage(rs.MESH_NORMAL0),c=u?u._offset/4:-1,u=h.getVertexElementByUsage(rs.MESH_COLOR0),_=u?u._offset/4:-1,u=h.getVertexElementByUsage(rs.MESH_TEXTURECOORDINATE0),f=u?u._offset/4:-1,u=h.getVertexElementByUsage(rs.MESH_TEXTURECOORDINATE1),d=u?u._offset/4:-1,u=h.getVertexElementByUsage(rs.MESH_TANGENT0),p=u?u._offset/4:-1,y=h.vertexStride/4,g=o.getFloat32Data(),m=(i?(i.worldMatrix.invert(E._tempMatrix4x40),Pa.multiply(E._tempMatrix4x40,n.worldMatrix,r=E._tempMatrix4x41)):r=n.worldMatrix,E._tempMatrix4x42),u=(r.invert(m),m.transpose(),E._tempQuaternion0),v=(r.decomposeTransRotScale(E._tempVector30,u,E._tempVector31),a.lightmapScaleOffset),x=s.vertexCount,k=0;k<x;k++){var w,b=k*y,S=18*(k+t),I=(Ra.transformVector3ArrayToVector3ArrayCoordinate(g,b+l,r,e,0+S),-1!=c&&Ra.transformVector3ArrayToVector3ArrayNormal(g,b+c,m,e,3+S),6+S);if(-1!=_)for(var T=b+_,C=0,M=4;C<M;C++)e[I+C]=g[T+C];else for(C=0,M=4;C<M;C++)e[I+C]=1;-1!=f&&(e[10+S]=g[w=b+f],e[11+S]=g[1+w]),v&&(-1!=d?Ra.transformLightingMapTexcoordArray(g,b+d,v,e,12+S):Ra.transformLightingMapTexcoordArray(g,b+f,v,e,12+S)),-1!=p&&(e[14+S]=g[w=b+p],e[15+S]=g[1+w],e[16+S]=g[2+w],e[17+S]=g[3+w])}return x}},{key:"addTest",value:function(e){e=e.meshFilter.sharedMesh.vertexCount,e=this._currentBatchVertexCount+e;return!(E.maxBatchVertexCount<e)}},{key:"add",value:function(e){for(var t=e.meshFilter.sharedMesh,i=t.vertexCount,e=(this._batchElements.push(e),e._render),n=(e._isPartOfStaticBatch=!0,e._staticBatch=this,e._renderElements),a=0,s=n.length;a<s;a++)n[a].staticBatch=this;this._currentBatchIndexCount+=t._indexBuffer.indexCount,this._currentBatchVertexCount+=i}},{key:"remove",value:function(e){var t=e.meshFilter.sharedMesh,i=this._batchElements.indexOf(e);if(-1!==i){this._batchElements.splice(i,1);for(var n=e._render._renderElements,a=0,s=n.length;a<s;a++)n[a].staticBatch=null;this._currentBatchIndexCount=this._currentBatchIndexCount-t._indexBuffer.indexCount,this._currentBatchVertexCount=this._currentBatchVertexCount-t.vertexCount,e._render._isPartOfStaticBatch=!1}}},{key:"finishInit",value:function(){this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy(),oe._addGPUMemory(-(this._vertexBuffer._byteLength+this._indexBuffer._byteLength)));var e=S.instance,t=0,i=0,n=this.batchOwner,a=this._vertexDeclaration.vertexStride/4,s=new Float32Array(a*this._currentBatchVertexCount),r=new Uint16Array(this._currentBatchIndexCount);this._vertexBuffer=new os(this._vertexDeclaration.vertexStride*this._currentBatchVertexCount,e.STATIC_DRAW),this._vertexBuffer.vertexDeclaration=this._vertexDeclaration,this._indexBuffer=new is(Zi.UInt16,this._currentBatchIndexCount,e.STATIC_DRAW);for(var o=0,h=this._batchElements.length;o<h;o++){for(var l,u=this._batchElements[o],c=u.meshFilter.sharedMesh,_=this._getStaticBatchBakedVertexs(s,t,n?n._transform:null,u._transform,u._render,c),f=c._indexBuffer.getData(),d=t,p=i+f.length,y=u._render._renderElements,g=0,m=c.subMeshCount;g<m;g++){var v=c._subMeshes[g],x=i+v._indexStart,k=y[g];k.staticBatchIndexStart=x,k.staticBatchIndexEnd=x+v._indexCount}if(r.set(f,i),n?u._transform._isFrontFaceInvert!==n.transform._isFrontFaceInvert:u._transform._isFrontFaceInvert)for(l=i;l<p;l+=3){r[l]=d+r[l];var w=r[l+1],b=r[l+2];r[l+1]=d+b,r[l+2]=d+w}else for(l=i;l<p;l+=3)r[l]=d+r[l],r[l+1]=d+r[l+1],r[l+2]=d+r[l+2];i+=f.length,t+=_}this._vertexBuffer.setData(s.buffer),this._indexBuffer.setData(r);a=this._vertexBuffer._byteLength+this._indexBuffer._byteLength;oe._addGPUMemory(a),this._bufferState.bind(),this._bufferState.applyVertexBuffer(this._vertexBuffer),this._bufferState.applyIndexBuffer(this._indexBuffer),this._bufferState.unBind()}},{key:"_render",value:function(e){this._bufferState.bind();for(var t,i,n=S.instance,e=e.renderElement.staticBatchElementList,a=e.elements,s=0,r=0,o=e.length,h=1;h<o;h++)a[h-1].staticBatchIndexEnd===a[h].staticBatchIndexStart?r++:(t=a[s].staticBatchIndexStart,i=a[r].staticBatchIndexEnd-t,n.drawElements(n.TRIANGLES,i,n.UNSIGNED_SHORT,2*t),s=++r,k.trianglesFaces+=i/3);t=a[s].staticBatchIndexStart,i=a[r].staticBatchIndexEnd-t,n.drawElements(n.TRIANGLES,i,n.UNSIGNED_SHORT,2*t),k.renderBatches++,k.savedRenderBatches+=o-1,k.trianglesFaces+=i/3}},{key:"dispose",value:function(){var e=this._vertexBuffer._byteLength+this._indexBuffer._byteLength;oe._addGPUMemory(-e),this._batchElements=null,this.batchOwner=null,this._vertexDeclaration=null,this._bufferState.destroy(),this._vertexBuffer.destroy(),this._indexBuffer.destroy(),this._vertexBuffer=null,this._indexBuffer=null,this._bufferState=null}}]),E}(),_r=(cr._tempVector30=new R,cr._tempVector31=new R,cr._tempQuaternion0=new Ca,cr._tempMatrix4x40=new Pa,cr._tempMatrix4x41=new Pa,cr._tempMatrix4x42=new Pa,cr.maxBatchVertexCount=65535,cr._batchIDCounter=0,function(){f(a,qa);var t=T(a);function a(){var e;return b(this,a),(e=t.call(this))._opaqueBatchMarks=[],e._updateCountMark=0,e}return y(a,[{key:"_compare",value:function(e,t){var i,n=e._render,a=t._render,e=e.meshFilter.sharedMesh,t=t.meshFilter.sharedMesh,s=n.lightmapIndex-a.lightmapIndex;return 0==s?0==(i=(n.receiveShadow?1:0)-(a.receiveShadow?1:0))?0==(n=n.sharedMaterial&&a.sharedMaterial?n.sharedMaterial.id-a.sharedMaterial.id:0)?0==(a=e._vertexBuffer.vertexDeclaration.id-t._vertexBuffer.vertexDeclaration.id)?t._indexBuffer.indexCount-e._indexBuffer.indexCount:a:n:i:s}},{key:"_getBatchRenderElementFromPool",value:function(){var e=this._batchRenderElementPool[this._batchRenderElementPoolIndex++];return e||(e=new ur,(this._batchRenderElementPool[this._batchRenderElementPoolIndex-1]=e).staticBatchElementList=new Xa),e}},{key:"_getStaticBatch",value:function(e,t,i){var n=e[i];return n||(n=e[i]=new cr(t,a._verDec),this._staticBatches[n._batchID]=n),n}},{key:"_initStaticBatchs",value:function(e){for(var t,i=this._initBatchSprites,n=(this._quickSort(i,0,i.length-1),[]),a=!1,s=0,r=0,o=i.length;r<o;r++){var h=i[r];a?t.addTest(h)?t.add(h):(a=!1,s++):r!==o-1&&((t=this._getStaticBatch(n,e,s)).add(h),a=!0)}for(r=0,o=n.length;r<o;r++){var l=n[r];l&&l.finishInit()}this._initBatchSprites.length=0}},{key:"_removeRenderSprite",value:function(e){var t=e._render,i=t._staticBatch,n=i._batchElements,e=n.indexOf(e);if(-1!==e){n.splice(e,1),t._staticBatch=null;for(var a=t._renderElements,s=0,r=a.length;s<r;s++)a[s].staticBatch=null}0===n.length&&(delete this._staticBatches[i._batchID],i.dispose())}},{key:"_clear",value:function(){m(g(a.prototype),"_clear",this).call(this),this._updateCountMark++}},{key:"_garbageCollection",value:function(){for(var e in this._staticBatches){var t=this._staticBatches[e];0===t._batchElements.length&&(t.dispose(),delete this._staticBatches[e])}}},{key:"getBatchOpaquaMark",value:function(e,t,i,n){t=t?1:0,e=this._opaqueBatchMarks[e]||(this._opaqueBatchMarks[e]=[]),e=e[t]||(e[t]=[]),t=e[i]||(e[i]=[]);return t[n]||(t[n]=new Gs)}}],[{key:"__init__",value:function(){a._verDec=rs.getVertexDeclaration("POSITION,NORMAL,COLOR,UV,UV1,TANGENT")}}]),a}()),fr=(_r.instance=new _r,function(){f(o,ae);var r=T(o);function o(e){var t,i,n,a,s;return b(this,o),(t=r.call(this))._indexInList=-1,t._indexInCastShadowList=-1,t._boundsChange=!0,t._castShadow=!1,t._supportOctree=!0,t._sharedMaterials=[],t._visible=!0,t._indexInOctreeMotionList=-1,t._updateMark=-1,t._updateRenderType=-1,t._isPartOfStaticBatch=!1,t._staticBatch=null,t._id=++o._uniqueIDCounter,t._indexInCastShadowList=-1,t._bounds=new Vs(R._ZERO,R._ZERO),Bt.supportWebGLPlusCulling&&(i=Ka._cullingBufferLength,(n=(t._cullingBufferIndex=i)+7)>=(s=Ka._cullingBuffer).length&&(a=s,(s=Ka._cullingBuffer=new Float32Array(s.length+4096)).set(a,0)),s[i]=2,Ka._cullingBufferLength=n),t._renderElements=[],t._owner=e,t._enable=!0,t._materialsInstance=[],t._shaderValues=new es(null),t.lightmapIndex=-1,t.receiveShadow=!1,t.sortingFudge=0,e&&t._owner.transform.on(Me.TRANSFORM_CHANGED,O(t),t._onWorldMatNeedChange),t}return y(o,[{key:"id",get:function(){return this._id}},{key:"lightmapIndex",get:function(){return this._lightmapIndex},set:function(e){this._lightmapIndex!==e&&(this._lightmapIndex=e,this._applyLightMapParams())}},{key:"lightmapScaleOffset",get:function(){return this._lightmapScaleOffset},set:function(e){this._lightmapScaleOffset=e,this._shaderValues.setVector(ja.LIGHTMAPSCALEOFFSET,e),this._shaderValues.addDefine(ja.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}},{key:"enable",get:function(){return this._enable},set:function(e){this._enable=!!e}},{key:"material",get:function(){var e,t=this._sharedMaterials[0];return t&&!this._materialsInstance[0]&&(t=this._getInstanceMaterial(t,0),(e=this._renderElements[0])&&(e.material=t)),this._sharedMaterials[0]},set:function(e){this.sharedMaterial=e}},{key:"materials",get:function(){for(var e,t,i=0,n=this._sharedMaterials.length;i<n;i++)this._materialsInstance[i]||(e=this._getInstanceMaterial(this._sharedMaterials[i],i),(t=this._renderElements[i])&&(t.material=e));return this._sharedMaterials.slice()},set:function(e){this.sharedMaterials=e}},{key:"sharedMaterial",get:function(){return this._sharedMaterials[0]},set:function(e){var t=this._sharedMaterials[0];t!==e&&(this._sharedMaterials[0]=e,this._materialsInstance[0]=!1,this._changeMaterialReference(t,e),(t=this._renderElements[0])&&(t.material=e))}},{key:"sharedMaterials",get:function(){return this._sharedMaterials.slice()},set:function(e){for(var t=this._materialsInstance,i=this._sharedMaterials,n=0,a=i.length;n<a;n++){var s=i[n];s&&s._removeReference()}if(!e)throw new Error("BaseRender: shadredMaterials value can't be null.");var r=e.length;for(t.length=r,i.length=r,n=0;n<r;n++){var o,s=i[n],h=e[n];s!==h&&(t[n]=!1,(o=this._renderElements[n])&&(o.material=h)),h&&h._addReference(),i[n]=h}}},{key:"bounds",get:function(){return this._boundsChange&&(this._calculateBoundingBox(),this._boundsChange=!1),this._bounds}},{key:"receiveShadow",get:function(){return this._receiveShadow},set:function(e){this._receiveShadow!==e&&((this._receiveShadow=e)?this._shaderValues.addDefine(ja.SHADERDEFINE_RECEIVE_SHADOW):this._shaderValues.removeDefine(ja.SHADERDEFINE_RECEIVE_SHADOW))}},{key:"castShadow",get:function(){return this._castShadow},set:function(e){this._castShadow=e}},{key:"isPartOfStaticBatch",get:function(){return this._isPartOfStaticBatch}},{key:"_getOctreeNode",value:function(){return this._octreeNode}},{key:"_setOctreeNode",value:function(e){this._octreeNode=e}},{key:"_getIndexInMotionList",value:function(){return this._indexInOctreeMotionList}},{key:"_setIndexInMotionList",value:function(e){this._indexInOctreeMotionList=e}},{key:"_changeMaterialReference",value:function(e,t){e&&e._removeReference(),t._addReference()}},{key:"_getInstanceMaterial",value:function(e,t){e=e.clone();return e.name=e.name+"(Instance)",this._materialsInstance[t]=!0,this._changeMaterialReference(this._sharedMaterials[t],e),this._sharedMaterials[t]=e}},{key:"_applyLightMapParams",value:function(){var e;this._scene&&0<=this._lightmapIndex?(e=this._scene.getlightmaps(),this._lightmapIndex<e.length?(this._shaderValues.addDefine(ja.SAHDERDEFINE_LIGHTMAP),this._shaderValues.setTexture(ja.LIGHTMAP,e[this._lightmapIndex])):this._shaderValues.removeDefine(ja.SAHDERDEFINE_LIGHTMAP)):this._shaderValues.removeDefine(ja.SAHDERDEFINE_LIGHTMAP)}},{key:"_onWorldMatNeedChange",value:function(e){this._boundsChange=!0,this._octreeNode&&(e&=Ya.TRANSFORM_WORLDPOSITION|Ya.TRANSFORM_WORLDQUATERNION|Ya.TRANSFORM_WORLDSCALE)&&-1===this._indexInOctreeMotionList&&this._octreeNode._octree.addMotionObject(this)}},{key:"_calculateBoundingBox",value:function(){throw"BaseRender: must override it."}},{key:"_getIndexInList",value:function(){return this._indexInList}},{key:"_setIndexInList",value:function(e){this._indexInList=e}},{key:"_setBelongScene",value:function(e){this._scene!==e&&(this._scene=e,this._applyLightMapParams())}},{key:"_needRender",value:function(e,t){return!0}},{key:"_renderUpdate",value:function(e,t){}},{key:"_renderUpdateWithCamera",value:function(e,t){}},{key:"_revertBatchRenderUpdate",value:function(e){}},{key:"_destroy",value:function(){-1!==this._indexInOctreeMotionList&&this._octreeNode._octree.removeMotionObject(this),this.offAll();for(var e=0,t=0,e=0,t=this._renderElements.length;e<t;e++)this._renderElements[e].destroy();for(e=0,t=this._sharedMaterials.length;e<t;e++)this._sharedMaterials[e].destroyed||this._sharedMaterials[e]._removeReference();this._renderElements=null,this._owner=null,this._sharedMaterials=null,this._bounds=null,this._lightmapScaleOffset=null}},{key:"markAsUnStatic",value:function(){this._isPartOfStaticBatch&&(_r.instance._removeRenderSprite(this._owner),this._isPartOfStaticBatch=!1)}}]),o}()),dr=(fr._tempBoundBoxCorners=[new R,new R,new R,new R,new R,new R,new R,new R],fr._uniqueIDCounter=0,function(){f(i,fr);var t=T(i);function i(e){return b(this,i),(e=t.call(this,e))._projectionViewWorldMatrix=new Pa,e}return y(i,[{key:"_calculateBoundingBox",value:function(){var e,t=this._owner.transform.worldMatrix,i=this._owner._geometryFilter;i._reCalculateBound(),i._bounds._tranform(t,this._bounds),Bt.supportWebGLPlusCulling&&(i=this._bounds.getMin(),t=this._bounds.getMax(),(e=Ka._cullingBuffer)[this._cullingBufferIndex+1]=i.x,e[this._cullingBufferIndex+2]=i.y,e[this._cullingBufferIndex+3]=i.z,e[this._cullingBufferIndex+4]=t.x,e[this._cullingBufferIndex+5]=t.y,e[this._cullingBufferIndex+6]=t.z)}},{key:"_renderUpdateWithCamera",value:function(e,t){var e=e.projectionViewMatrix,i=this._shaderValues;t?(t=t.worldMatrix,i.setMatrix4x4(Ga.WORLDMATRIX,t),Pa.multiply(e,t,this._projectionViewWorldMatrix),i.setMatrix4x4(Ga.MVPMATRIX,this._projectionViewWorldMatrix)):(i.setMatrix4x4(Ga.WORLDMATRIX,Pa.DEFAULT),i.setMatrix4x4(Ga.MVPMATRIX,e))}}]),i}()),pr=function(){f(n,ja);var i=T(n);function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:2,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return b(this,n),(t=i.call(this,t))._geometryFilter=new Ys(O(t),e),t._render=new dr(O(t)),t._changeRenderObjects(t._render,0,Os.defaultMaterial),t}return y(n,[{key:"maxLineCount",get:function(){return this._geometryFilter._maxLineCount},set:function(e){this._geometryFilter._resizeLineData(e),this._geometryFilter._lineCount=Math.min(this._geometryFilter._lineCount,e)}},{key:"lineCount",get:function(){return this._geometryFilter._lineCount},set:function(e){if(e>this.maxLineCount)throw"PixelLineSprite3D: lineCount can't large than maxLineCount";this._geometryFilter._lineCount=e}},{key:"pixelLineRenderer",get:function(){return this._render}},{key:"_changeRenderObjects",value:function(e,t,i){var n=this._render._renderElements,a=(i=i||Os.defaultMaterial,n[t]);(a=a||(n[t]=new lr)).setTransform(this._transform),a.setGeometry(this._geometryFilter),a.render=this._render,a.material=i}},{key:"addLine",value:function(e,t,i,n){if(this._geometryFilter._lineCount===this._geometryFilter._maxLineCount)throw"PixelLineSprite3D: lineCount has equal with maxLineCount.";this._geometryFilter._updateLineData(this._geometryFilter._lineCount++,e,t,i,n)}},{key:"addLines",value:function(e){var t=this._geometryFilter._lineCount,i=e.length;if(t+i>this._geometryFilter._maxLineCount)throw"PixelLineSprite3D: lineCount plus lines count must less than maxLineCount.";this._geometryFilter._updateLineDatas(t,e),this._geometryFilter._lineCount+=i}},{key:"removeLine",value:function(e){if(!(e<this._geometryFilter._lineCount))throw"PixelLineSprite3D: index must less than lineCount.";this._geometryFilter._removeLineData(e)}},{key:"setLine",value:function(e,t,i,n,a){if(!(e<this._geometryFilter._lineCount))throw"PixelLineSprite3D: index must less than lineCount.";this._geometryFilter._updateLineData(e,t,i,n,a)}},{key:"getLine",value:function(e,t){if(!(e<this.lineCount))throw"PixelLineSprite3D: index must less than lineCount.";this._geometryFilter._getLineData(e,t)}},{key:"clear",value:function(){this._geometryFilter._lineCount=0}},{key:"_create",value:function(){return new n}}]),n}(),yr=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];b(this,t),this.isTransparent=!1,this.elements=new Xa,this.lastTransparentRenderElement=null,this.lastTransparentBatched=!1,this.isTransparent=e}return y(t,[{key:"_compare",value:function(e,t){var i=e.material.renderQueue-t.material.renderQueue;return 0==i?(this.isTransparent?t.render._distanceForSort-e.render._distanceForSort:e.render._distanceForSort-t.render._distanceForSort)+t.render.sortingFudge-e.render.sortingFudge:i}},{key:"_partitionRenderObject",value:function(e,t){for(var i=this.elements.elements,n=i[Math.floor((t+e)/2)];e<=t;){for(;this._compare(i[e],n)<0;)e++;for(;0<this._compare(i[t],n);)t--;if(e<t){var a=i[e];i[e]=i[t],i[t]=a,e++,t--}else if(e===t){e++;break}}return e}},{key:"_quickSort",value:function(e,t){var i,n;1<this.elements.length&&(e<(n=(i=this._partitionRenderObject(e,t))-1)&&this._quickSort(e,n),i<t&&this._quickSort(i,t))}},{key:"_render",value:function(e){for(var t=this.elements.elements,i=0,n=this.elements.length;i<n;i++)t[i]._render(e)}},{key:"clear",value:function(){this.elements.length=0,this.lastTransparentRenderElement=null,this.lastTransparentBatched=!1}}]),t}(),gr=function(){function l(e,t,i,n){b(this,l),this._bounds=new Fs(new R,new R),this._objects=[],this._isContaion=!1,this.center=new R,this.baseLength=0,this._setValues(e,t,i,n)}return y(l,[{key:"_setValues",value:function(e,t,i,n){this._octree=e,this._parent=t,this.baseLength=i,n.cloneTo(this.center);var t=this._bounds.min,a=this._bounds.max,e=e._looseness*i/2;t.setValue(n.x-e,n.y-e,n.z-e),a.setValue(n.x+e,n.y+e,n.z+e)}},{key:"_getChildBound",value:function(e){if(null!=this._children&&this._children[e])return this._children[e]._bounds;var t=this.baseLength/4,i=this.baseLength/2*this._octree._looseness/2,n=l._tempBoundBox,a=n.min,s=n.max;switch(e){case 0:a.x=this.center.x-t-i,a.y=this.center.y+t-i,a.z=this.center.z-t-i,s.x=this.center.x-t+i,s.y=this.center.y+t+i,s.z=this.center.z-t+i;break;case 1:a.x=this.center.x+t-i,a.y=this.center.y+t-i,a.z=this.center.z-t-i,s.x=this.center.x+t+i,s.y=this.center.y+t+i,s.z=this.center.z-t+i;break;case 2:a.x=this.center.x-t-i,a.y=this.center.y+t-i,a.z=this.center.z+t-i,s.x=this.center.x-t+i,s.y=this.center.y+t+i,s.z=this.center.z+t+i;break;case 3:a.x=this.center.x+t-i,a.y=this.center.y+t-i,a.z=this.center.z+t-i,s.x=this.center.x+t+i,s.y=this.center.y+t+i,s.z=this.center.z+t+i;break;case 4:a.x=this.center.x-t-i,a.y=this.center.y-t-i,a.z=this.center.z-t-i,s.x=this.center.x-t+i,s.y=this.center.y-t+i,s.z=this.center.z-t+i;break;case 5:a.x=this.center.x+t-i,a.y=this.center.y-t-i,a.z=this.center.z-t-i,s.x=this.center.x+t+i,s.y=this.center.y-t+i,s.z=this.center.z-t+i;break;case 6:a.x=this.center.x-t-i,a.y=this.center.y-t-i,a.z=this.center.z+t-i,s.x=this.center.x-t+i,s.y=this.center.y-t+i,s.z=this.center.z+t+i;break;case 7:a.x=this.center.x+t-i,a.y=this.center.y-t-i,a.z=this.center.z+t-i,s.x=this.center.x+t+i,s.y=this.center.y-t+i,s.z=this.center.z+t+i}return n}},{key:"_getChildCenter",value:function(e){if(null!=this._children)return this._children[e].center;var t=this.baseLength/4,i=l._tempVector30;switch(e){case 0:i.x=this.center.x-t,i.y=this.center.y+t,i.z=this.center.z-t;break;case 1:i.x=this.center.x+t,i.y=this.center.y+t,i.z=this.center.z-t;break;case 2:i.x=this.center.x-t,i.y=this.center.y+t,i.z=this.center.z+t;break;case 3:i.x=this.center.x+t,i.y=this.center.y+t,i.z=this.center.z+t;break;case 4:i.x=this.center.x-t,i.y=this.center.y-t,i.z=this.center.z-t;break;case 5:i.x=this.center.x+t,i.y=this.center.y-t,i.z=this.center.z-t;break;case 6:i.x=this.center.x-t,i.y=this.center.y-t,i.z=this.center.z+t;break;case 7:i.x=this.center.x+t,i.y=this.center.y-t,i.z=this.center.z+t}return i}},{key:"_getChild",value:function(e){var t=this.baseLength/4;switch(this._children||(this._children=[]),e){case 0:return this._children[0]||(this._children[0]=new l(this._octree,this,this.baseLength/2,new R(this.center.x+-t,this.center.y+t,this.center.z-t)));case 1:return this._children[1]||(this._children[1]=new l(this._octree,this,this.baseLength/2,new R(this.center.x+t,this.center.y+t,this.center.z-t)));case 2:return this._children[2]||(this._children[2]=new l(this._octree,this,this.baseLength/2,new R(this.center.x-t,this.center.y+t,this.center.z+t)));case 3:return this._children[3]||(this._children[3]=new l(this._octree,this,this.baseLength/2,new R(this.center.x+t,this.center.y+t,this.center.z+t)));case 4:return this._children[4]||(this._children[4]=new l(this._octree,this,this.baseLength/2,new R(this.center.x-t,this.center.y-t,this.center.z-t)));case 5:return this._children[5]||(this._children[5]=new l(this._octree,this,this.baseLength/2,new R(this.center.x+t,this.center.y-t,this.center.z-t)));case 6:return this._children[6]||(this._children[6]=new l(this._octree,this,this.baseLength/2,new R(this.center.x-t,this.center.y-t,this.center.z+t)));case 7:return this._children[7]||(this._children[7]=new l(this._octree,this,this.baseLength/2,new R(this.center.x+t,this.center.y-t,this.center.z+t)));default:throw"BoundsOctreeNode: unknown index."}}},{key:"_shouldMerge",value:function(){for(var e=this._objects.length,t=0;t<8;t++){var i=this._children[t];if(i){if(null!=i._children)return!1;e+=i._objects.length}}return e<=l._NUM_OBJECTS_ALLOWED}},{key:"_mergeChildren",value:function(){for(var e=0;e<8;e++){var t=this._children[e];if(t){t._parent=null;for(var i=t._objects,n=i.length-1;0<=n;n--){var a=i[n];this._objects.push(a),a._setOctreeNode(this)}}}this._children=null}},{key:"_merge",value:function(){var e;null===this._children&&(e=this._parent)&&e._shouldMerge()&&(e._mergeChildren(),e._merge())}},{key:"_checkAddNode",value:function(e){if(null==this._children){if(this._objects.length<l._NUM_OBJECTS_ALLOWED||this.baseLength/2<this._octree._minSize)return this;for(var t=this._objects.length-1;0<=t;t--){var i=this._objects[t],n=this._bestFitChild(i.bounds.getCenter());l._encapsulates(this._getChildBound(n),i.bounds._getBoundBox())&&(this._objects.splice(this._objects.indexOf(i),1),this._getChild(n)._add(i))}}var a=this._bestFitChild(e.bounds.getCenter());return l._encapsulates(this._getChildBound(a),e.bounds._getBoundBox())?this._getChild(a)._checkAddNode(e):this}},{key:"_add",value:function(e){var t=this._checkAddNode(e);t._objects.push(e),e._setOctreeNode(t)}},{key:"_remove",value:function(e){var t=this._objects.indexOf(e);this._objects.splice(t,1),e._setOctreeNode(null),this._merge()}},{key:"_addUp",value:function(e){return js.boxContainsBox(this._bounds,e.bounds._getBoundBox())===Hs.Contains?(this._add(e),!0):!!this._parent&&this._parent._addUp(e)}},{key:"_getCollidingWithFrustum",value:function(e,t,i,n,a,s,r){if(i){var o=t.containsBoundBox(this._bounds);if(k.octreeNodeCulling++,o===Hs.Disjoint)return;i=o===Hs.Intersects}this._isContaion=!i;for(var h=e.camera,l=e.scene,u=0,c=this._objects.length;u<c;u++){var _=this._objects[u],f=r?_._castShadow&&_._enable:h._isLayerVisible(_._owner._layer)&&_._enable;if(f&&(!i||(k.frustumCulling++,_._needRender(t,e)))){_._distanceForSort=R.distance(_.bounds.getCenter(),n);for(var d=_._renderElements,p=0,y=d.length;p<y;p++)d[p]._update(l,e,a,s)}}if(null!=this._children)for(u=0;u<8;u++){var g=this._children[u];g&&g._getCollidingWithFrustum(e,t,i,n,a,s,r)}}},{key:"_getCollidingWithBoundBox",value:function(e,t,i){if(t){var n=js.boxContainsBox(this._bounds,e);if(n===Hs.Disjoint)return;t=n===Hs.Intersects}if(t)for(var a=0,s=this._objects.length;a<s;a++){var r=this._objects[a];js.intersectsBoxAndBox(r.bounds._getBoundBox(),e)&&i.push(r)}if(null!=this._children)for(a=0;a<8;a++)this._children[a]._getCollidingWithBoundBox(e,t,i)}},{key:"_bestFitChild",value:function(e){return(e.x<=this.center.x?0:1)+(e.y>=this.center.y?0:4)+(e.z<=this.center.z?0:2)}},{key:"_update",value:function(e){var t,i;return js.boxContainsBox(this._bounds,e.bounds._getBoundBox())===Hs.Contains?((i=this._checkAddNode(e))!==e._getOctreeNode()&&(i._objects.push(e),e._setOctreeNode(i),t=this._objects.indexOf(e),this._objects.splice(t,1),this._merge()),!0):!!this._parent&&((i=this._parent._addUp(e))&&(t=this._objects.indexOf(e),this._objects.splice(t,1),this._merge()),i)}},{key:"add",value:function(e){return!!l._encapsulates(this._bounds,e.bounds._getBoundBox())&&(this._add(e),!0)}},{key:"remove",value:function(e){return e._getOctreeNode()===this&&(this._remove(e),!0)}},{key:"update",value:function(e){return e._getOctreeNode()===this&&this._update(e)}},{key:"shrinkIfPossible",value:function(e){if(this.baseLength<2*e)return this;for(var t=-1,i=0,n=this._objects.length;i<n;i++){var a=this._objects[i],s=this._bestFitChild(a.bounds.getCenter());if(0!=i&&s!=t)return this;var r=this._getChildBound(s);if(!l._encapsulates(r,a.bounds._getBoundBox()))return this;0==i&&(t=s)}if(null==this._children)return-1!=t&&(e=this._getChildCenter(t),this._setValues(this._octree,null,this.baseLength/2,e)),this;for(var o=!1,i=0,n=this._children.length;i<n;i++){var h=this._children[i];if(h&&h.hasAnyObjects()){if(o)return this;if(0<=t&&t!=i)return this;o=!0,t=i}}return-1!=t?((e=this._children[t])._parent=null,e):this}},{key:"hasAnyObjects",value:function(){if(0<this._objects.length)return!0;if(null!=this._children)for(var e=0;e<8;e++){var t=this._children[e];if(t&&t.hasAnyObjects())return!0}return!1}},{key:"getCollidingWithBoundBox",value:function(e,t){this._getCollidingWithBoundBox(e,!0,t)}},{key:"getCollidingWithRay",value:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:Number.MAX_VALUE,n=js.intersectsRayAndBoxRD(e,this._bounds);if(!(-1==n||i<n)){for(var a=0,s=this._objects.length;a<s;a++){var r=this._objects[a];-1!==(n=js.intersectsRayAndBoxRD(e,r.bounds._getBoundBox()))&&n<=i&&t.push(r)}if(null!=this._children)for(a=0;a<8;a++)this._children[a].getCollidingWithRay(e,t,i)}}},{key:"getCollidingWithFrustum",value:function(e,t,i,n){var a=e.camera.transform.position,s=e.camera.boundFrustum;this._getCollidingWithFrustum(e,s,!0,a,t,i,n)}},{key:"isCollidingWithBoundBox",value:function(e){if(!js.intersectsBoxAndBox(this._bounds,e))return!1;for(var t=0,i=this._objects.length;t<i;t++){var n=this._objects[t];if(js.intersectsBoxAndBox(n.bounds._getBoundBox(),e))return!0}if(null!=this._children)for(t=0;t<8;t++)if(this._children[t].isCollidingWithBoundBox(e))return!0;return!1}},{key:"isCollidingWithRay",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Number.MAX_VALUE;if(-1==(a=js.intersectsRayAndBoxRD(e,this._bounds))||t<a)return!1;for(var i=0,n=this._objects.length;i<n;i++){var a,s=this._objects[i];if(-1!==(a=js.intersectsRayAndBoxRD(e,s.bounds._getBoundBox()))&&a<=t)return!0}if(null!=this._children)for(i=0;i<8;i++)if(this._children[i].isCollidingWithRay(e,t))return!0;return!1}},{key:"getBound",value:function(){return this._bounds}},{key:"drawAllBounds",value:function(e,t,i){if(null!==this._children||0!=this._objects.length){t++;var n,a=l._tempColor0;if(this._isContaion?(a.r=0,a.g=0,a.b=1):(a.r=1-(n=i?t/i:0),a.g=n,a.b=0),a.a=.3,Ra._drawBound(e,this._bounds,a),null!=this._children)for(var s=0;s<8;s++){var r=this._children[s];r&&r.drawAllBounds(e,t,i)}}}},{key:"drawAllObjects",value:function(e,t,i){t++;var n,a=l._tempColor0;this._isContaion?(a.r=0,a.g=0,a.b=1):(a.r=1-(n=i?t/i:0),a.g=n,a.b=0),a.a=1;for(var s=0,r=this._objects.length;s<r;s++)Ra._drawBound(e,this._objects[s].bounds._getBoundBox(),a);if(null!=this._children)for(s=0;s<8;s++){var o=this._children[s];o&&o.drawAllObjects(e,t,i)}}}],[{key:"_encapsulates",value:function(e,t){return js.boxContainsBox(e,t)==Hs.Contains}}]),l}(),mr=(gr._tempVector3=new R,gr._tempVector30=new R,gr._tempVector31=new R,gr._tempColor0=new i,gr._tempBoundBox=new Fs(new R,new R),gr._NUM_OBJECTS_ALLOWED=8,function(){f(t,Xa);var e=T(t);function t(){return b(this,t),e.call(this)}return y(t,[{key:"add",value:function(e){if(-1!==e._getIndexInMotionList())throw"OctreeMotionList:element has  in  PhysicsUpdateList.";this._add(e),e._setIndexInMotionList(this.length++)}},{key:"remove",value:function(e){var t,i=e._getIndexInMotionList();this.length--,i!==this.length&&(t=this.elements[this.length],(this.elements[i]=t)._setIndexInMotionList(i)),e._setIndexInMotionList(-1)}}]),t}()),vr=function(){function a(e,t,i,n){b(this,a),this._motionObjects=new mr,this.count=0,e<i&&(console.warn("Minimum node size must be at least as big as the initial world size. Was: "+i+" Adjusted to: "+e),i=e),this._initialSize=e,this._minSize=i,this._looseness=Math.min(Math.max(n,1),2),this._rootNode=new gr(this,null,e,t)}return y(a,[{key:"_getMaxDepth",value:function(e,t){t++;var i=e._children;if(null!=i)for(var n=t,a=0,s=i.length;a<s;a++){var r=i[a];r&&(t=Math.max(this._getMaxDepth(r,n),t))}return t}},{key:"_grow",value:function(e){var t=0<=e.x?1:-1,i=0<=e.y?1:-1,e=0<=e.z?1:-1,n=this._rootNode,a=this._rootNode.baseLength/2,s=2*this._rootNode.baseLength,r=this._rootNode.center,t=new R(r.x+t*a,r.y+i*a,r.z+e*a);if(this._rootNode=new gr(this,null,s,t),n.hasAnyObjects()){for(var o=this._rootNode._bestFitChild(n.center),h=[],l=0;l<8;l++)l==o&&(n._parent=this._rootNode,h[l]=n);this._rootNode._children=h}}},{key:"add",value:function(e){for(var t=0;!this._rootNode.add(e);){var i=a._tempVector30;if(R.subtract(e.bounds.getCenter(),this._rootNode.center,i),this._grow(i),20<++t)throw"Aborted Add operation as it seemed to be going on forever ("+(t-1)+") attempts at growing the octree."}this.count++}},{key:"remove",value:function(e){e=e._getOctreeNode().remove(e);return e&&this.count--,e}},{key:"update",value:function(e){var t=0,i=e._getOctreeNode();if(i){for(;!i._update(e);){var n=a._tempVector30;if(R.subtract(e.bounds.getCenter(),this._rootNode.center,n),this._grow(n),20<++t)throw"Aborted Add operation as it seemed to be going on forever ("+(t-1)+") attempts at growing the octree."}return!0}return!1}},{key:"shrinkRootIfPossible",value:function(){this._rootNode=this._rootNode.shrinkIfPossible(this._initialSize)}},{key:"addMotionObject",value:function(e){this._motionObjects.add(e)}},{key:"removeMotionObject",value:function(e){this._motionObjects.remove(e)}},{key:"updateMotionObjects",value:function(){for(var e=this._motionObjects.elements,t=0,i=this._motionObjects.length;t<i;t++){var n=e[t];this.update(n),n._setIndexInMotionList(-1)}this._motionObjects.length=0}},{key:"isCollidingWithBoundBox",value:function(e){return this._rootNode.isCollidingWithBoundBox(e)}},{key:"isCollidingWithRay",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Number.MAX_VALUE;return this._rootNode.isCollidingWithRay(e,t)}},{key:"getCollidingWithBoundBox",value:function(e,t){this._rootNode.getCollidingWithBoundBox(e,t)}},{key:"getCollidingWithRay",value:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:Number.MAX_VALUE;this._rootNode.getCollidingWithRay(e,t,i)}},{key:"getCollidingWithFrustum",value:function(e,t,i,n){this._rootNode.getCollidingWithFrustum(e,t,i,n)}},{key:"getMaxBounds",value:function(){return this._rootNode.getBound()}},{key:"drawAllBounds",value:function(e){var t=this._getMaxDepth(this._rootNode,-1);this._rootNode.drawAllBounds(e,-1,t)}},{key:"drawAllObjects",value:function(e){var t=this._getMaxDepth(this._rootNode,-1);this._rootNode.drawAllObjects(e,-1,t)}}]),a}(),xr=(vr._tempVector30=new R,function(){f(k,N);var i=T(k);function k(){var e,t;return b(this,k),(e=i.call(this))._lightCount=0,e._pointLights=new Ls,e._spotLights=new Ls,e._directionLights=new Ns,e._alternateLights=new Ps,e._lightmaps=[],e._skyRenderer=new us,e._reflectionMode=1,e._input=new Es,e._timer=L.timer,e._collsionTestList=[],e._renders=new Wa,e._opaqueQueue=new yr(!1),e._transparentQueue=new yr(!0),e._cameraPool=[],e._animatorPool=new Wa,e._scriptPool=new Array,e._tempScriptPool=new Array,e._needClearScriptPool=!1,e.currentCreationLayer=Math.pow(2,0),e.enableLight=!0,e._key=new ke,e._time=0,e._pickIdToSprite=new Object,Ea._enablePhysics&&(e._physicsSimulation=new Ms(k.physicsSettings)),e._shaderValues=new es(null),e.parallelSplitShadowMaps=[],e.enableFog=!1,e.fogStart=300,e.fogRange=1e3,e.fogColor=new R(.7,.7,.7),e.ambientColor=new R(.212,.227,.259),e.reflectionIntensity=1,Va._config._multiLighting||e._shaderValues.addDefine(A.SHADERDEFINE_LEGACYSINGALLIGHTING),Bt.supportWebGLPlusCulling&&(e._cullingBufferIndices=new Int32Array(1024),e._cullingBufferResult=new Int32Array(1024)),e._scene=O(e),e._input.__init__(Bt.canvas,O(e)),k.octreeCulling&&(e._octree=new vr(k.octreeInitialSize,k.octreeInitialCenter,k.octreeMinNodeSize,k.octreeLooseness)),Ka.debugFrustumCulling&&(e._debugTool=new pr,(t=new Os).renderQueue=Bs.RENDERQUEUE_TRANSPARENT,t.alphaTest=!1,t.depthWrite=!1,t.cull=Ds.CULL_BACK,t.blend=Ds.BLEND_ENABLE_ALL,t.blendSrc=Ds.BLENDPARAM_SRC_ALPHA,t.blendDst=Ds.BLENDPARAM_ONE_MINUS_SRC_ALPHA,t.depthTest=Ds.DEPTHTEST_LESS,e._debugTool.pixelLineRenderer.sharedMaterial=t),e}return y(k,[{key:"_allotPickColorByID",value:function(e,t){var i=Math.floor(e/65025),n=(e-=255*i*255,Math.floor(e/255)),e=e-=255*n;t.x=i/255,t.y=n/255,t.z=e/255,t.w=1}},{key:"_searchIDByPickColor",value:function(e){return 255*e.x*255+255*e.y+e.z}},{key:"url",get:function(){return this._url}},{key:"enableFog",get:function(){return this._enableFog},set:function(e){this._enableFog!==e&&((this._enableFog=e)?this._shaderValues.addDefine(or.SHADERDEFINE_FOG):this._shaderValues.removeDefine(or.SHADERDEFINE_FOG))}},{key:"fogColor",get:function(){return this._shaderValues.getVector3(k.FOGCOLOR)},set:function(e){this._shaderValues.setVector3(k.FOGCOLOR,e)}},{key:"fogStart",get:function(){return this._shaderValues.getNumber(k.FOGSTART)},set:function(e){this._shaderValues.setNumber(k.FOGSTART,e)}},{key:"fogRange",get:function(){return this._shaderValues.getNumber(k.FOGRANGE)},set:function(e){this._shaderValues.setNumber(k.FOGRANGE,e)}},{key:"ambientColor",get:function(){return this._shaderValues.getVector3(k.AMBIENTCOLOR)},set:function(e){this._shaderValues.setVector3(k.AMBIENTCOLOR,e)}},{key:"skyRenderer",get:function(){return this._skyRenderer}},{key:"customReflection",get:function(){return this._shaderValues.getTexture(k.REFLECTIONTEXTURE)},set:function(e){this._shaderValues.setTexture(k.REFLECTIONTEXTURE,e),e?this._shaderValues.addDefine(or.SHADERDEFINE_REFLECTMAP):this._shaderValues.removeDefine(or.SHADERDEFINE_REFLECTMAP)}},{key:"reflectionIntensity",get:function(){return this._shaderValues.getNumber(k.REFLETIONINTENSITY)},set:function(e){e=Math.max(Math.min(e,1),0),this._shaderValues.setNumber(k.REFLETIONINTENSITY,e)}},{key:"physicsSimulation",get:function(){return this._physicsSimulation}},{key:"reflectionMode",get:function(){return this._reflectionMode},set:function(e){this._reflectionMode=e}},{key:"timer",get:function(){return this._timer},set:function(e){this._timer=e}},{key:"input",get:function(){return this._input}},{key:"_setLightmapToChildNode",value:function(e){e instanceof ja&&e._render._applyLightMapParams();for(var t=e._children,i=0,n=t.length;i<n;i++)this._setLightmapToChildNode(t[i])}},{key:"_update",value:function(){var e=this.timer._delta/1e3,t=(this._time+=e,this._shaderValues.setNumber(k.TIME,this._time),this._physicsSimulation);Ea._enablePhysics&&!Ms.disableSimulation&&(t._updatePhysicsTransformFromRender(),Cs._addUpdateList=!1,t._simulate(e),t._updateCharacters(),Cs._addUpdateList=!0,t._updateCollisions(),t._eventScripts()),this._input._update(),this._clearScript(),this._updateScript(),Fa._update(this),this._lateUpdateScript()}},{key:"_binarySearchIndexInCameraPool",value:function(e){for(var t=0,i=this._cameraPool.length-1;t<=i;){var n=Math.floor((t+i)/2),a=this._cameraPool[n]._renderingOrder;if(a==e._renderingOrder)return n;a>e._renderingOrder?i=n-1:t=n+1}return t}},{key:"onEnable",value:function(){this._input._onCanvasEvent(Bt.canvas)}},{key:"onDisable",value:function(){this._input._offCanvasEvent(Bt.canvas)}},{key:"_setCreateURL",value:function(e){this._url=re.formatURL(e)}},{key:"_getGroup",value:function(){return this._group}},{key:"_setGroup",value:function(e){this._group=e}},{key:"_clearScript",value:function(){if(this._needClearScriptPool){for(var e=this._scriptPool,t=0,i=e.length;t<i;t++){var n=e[t];n&&(n._indexInPool=this._tempScriptPool.length,this._tempScriptPool.push(n))}this._scriptPool=this._tempScriptPool,e.length=0,this._tempScriptPool=e,this._needClearScriptPool=!1}}},{key:"_updateScript",value:function(){for(var e=this._scriptPool,t=0,i=e.length;t<i;t++){var n=e[t];n&&n.enabled&&n.onUpdate()}}},{key:"_lateUpdateScript",value:function(){for(var e=this._scriptPool,t=0,i=e.length;t<i;t++){var n=e[t];n&&n.enabled&&n.onLateUpdate()}}},{key:"_addScript",value:function(e){var t=this._scriptPool;e._indexInPool=t.length,t.push(e)}},{key:"_removeScript",value:function(e){this._scriptPool[e._indexInPool]=null,e._indexInPool=-1,this._needClearScriptPool=!0}},{key:"_preRenderScript",value:function(){for(var e=this._scriptPool,t=0,i=e.length;t<i;t++){var n=e[t];n&&n.enabled&&n.onPreRender()}}},{key:"_postRenderScript",value:function(){for(var e=this._scriptPool,t=0,i=e.length;t<i;t++){var n=e[t];n&&n.enabled&&n.onPostRender()}}},{key:"_prepareSceneToRender",value:function(){var e=this._shaderValues;if(Va._config._multiLighting){var t=k._lightTexture,i=k._lightPixles,n=t.width,a=4*n,s=0,r=this._directionLights._length,o=this._directionLights._elements;if(0<r){for(var h=this._directionLights.getSunLight(),l=0;l<r;l++,s++){var u,c=(u=o[l])._direction,_=u._intensityColor,f=a*s;R.scale(u.color,u._intensity,_),u.transform.worldMatrix.getForward(c),R.normalize(c,c),i[f]=_.x,i[f+1]=_.y,i[f+2]=_.z,i[f+4]=c.x,i[f+5]=c.y,i[f+6]=c.z,l==h&&(e.setVector3(k.SUNLIGHTDIRCOLOR,_),e.setVector3(k.SUNLIGHTDIRECTION,c))}e.addDefine(or.SHADERDEFINE_DIRECTIONLIGHT)}else e.removeDefine(or.SHADERDEFINE_DIRECTIONLIGHT);var d=this._pointLights._length;if(0<d){for(var p=this._pointLights._elements,l=0;l<d;l++,s++){var y,g=(y=p[l]).transform.position,_=y._intensityColor,f=a*s;R.scale(y.color,y._intensity,_),i[f]=_.x,i[f+1]=_.y,i[f+2]=_.z,i[f+3]=y.range,i[f+4]=g.x,i[f+5]=g.y,i[f+6]=g.z}e.addDefine(or.SHADERDEFINE_POINTLIGHT)}else e.removeDefine(or.SHADERDEFINE_POINTLIGHT);var m=this._spotLights._length;if(0<m){for(var v=this._spotLights._elements,l=0;l<m;l++,s++){var x=v[l],c=x._direction,g=x.transform.position,_=x._intensityColor,f=a*s;R.scale(x.color,x._intensity,_),x.transform.worldMatrix.getForward(c),R.normalize(c,c),i[f]=_.x,i[f+1]=_.y,i[f+2]=_.z,i[f+3]=x.range,i[f+4]=g.x,i[f+5]=g.y,i[f+6]=g.z,i[f+7]=x.spotAngle*Math.PI/180,i[f+8]=c.x,i[f+9]=c.y,i[f+10]=c.z}e.addDefine(or.SHADERDEFINE_SPOTLIGHT)}else e.removeDefine(or.SHADERDEFINE_SPOTLIGHT);0<s&&t.setSubPixels(0,0,n,s,i,0),e.setTexture(k.LIGHTBUFFER,t),e.setInt(k.DIRECTIONLIGHTCOUNT,this._directionLights._length),e.setTexture(k.CLUSTERBUFFER,Za.instance._clusterTexture)}else 0<this._directionLights._length?(u=this._directionLights._elements[0],R.scale(u.color,u._intensity,u._intensityColor),u.transform.worldMatrix.getForward(u._direction),R.normalize(u._direction,u._direction),e.setVector3(k.LIGHTDIRCOLOR,u._intensityColor),e.setVector3(k.LIGHTDIRECTION,u._direction),e.setVector3(k.SUNLIGHTDIRCOLOR,u._intensityColor),e.setVector3(k.SUNLIGHTDIRECTION,u._direction),e.addDefine(or.SHADERDEFINE_DIRECTIONLIGHT)):e.removeDefine(or.SHADERDEFINE_DIRECTIONLIGHT),0<this._pointLights._length?(y=this._pointLights._elements[0],R.scale(y.color,y._intensity,y._intensityColor),e.setVector3(k.POINTLIGHTCOLOR,y._intensityColor),e.setVector3(k.POINTLIGHTPOS,y.transform.position),e.setNumber(k.POINTLIGHTRANGE,y.range),e.addDefine(or.SHADERDEFINE_POINTLIGHT)):e.removeDefine(or.SHADERDEFINE_POINTLIGHT),0<this._spotLights._length?(n=this._spotLights._elements[0],R.scale(n.color,n._intensity,n._intensityColor),e.setVector3(k.SPOTLIGHTCOLOR,n._intensityColor),e.setVector3(k.SPOTLIGHTPOS,n.transform.position),n.transform.worldMatrix.getForward(n._direction),R.normalize(n._direction,n._direction),e.setVector3(k.SPOTLIGHTDIRECTION,n._direction),e.setNumber(k.SPOTLIGHTRANGE,n.range),e.setNumber(k.SPOTLIGHTSPOTANGLE,n.spotAngle*Math.PI/180),e.addDefine(or.SHADERDEFINE_SPOTLIGHT)):e.removeDefine(or.SHADERDEFINE_SPOTLIGHT)}},{key:"_addCamera",value:function(e){for(var t=this._binarySearchIndexInCameraPool(e),i=e._renderingOrder,n=this._cameraPool.length;t<n&&this._cameraPool[t]._renderingOrder<=i;)t++;this._cameraPool.splice(t,0,e)}},{key:"_removeCamera",value:function(e){this._cameraPool.splice(this._cameraPool.indexOf(e),1)}},{key:"_preCulling",value:function(e,t,i,n){Ka.renderObjectCulling(t,this,e,i,n,!1)}},{key:"_clear",value:function(e,t){var i,n,a=t.viewport,s=t.camera,r=s._getRenderTexture(),o=a.width,h=a.height,l=s._needInternalRenderTexture()?i=0:(i=a.x,s._getCanvasHeight()-a.y-h),t=(e.viewport(i,l,o,h),s.clearFlag);switch(t=t!==cs.CLEARFLAG_SKY||s.skyRenderer._isAvailable()||this._skyRenderer._isAvailable()?t:cs.CLEARFLAG_SOLIDCOLOR){case cs.CLEARFLAG_SOLIDCOLOR:var u=s.clearColor;if(e.enable(e.SCISSOR_TEST),e.scissor(i,l,o,h),u?e.clearColor(u.x,u.y,u.z,u.w):e.clearColor(0,0,0,0),r)switch(n=e.COLOR_BUFFER_BIT,r.depthStencilFormat){case W.DEPTH_16:n|=e.DEPTH_BUFFER_BIT;break;case W.STENCIL_8:n|=e.STENCIL_BUFFER_BIT;break;case W.DEPTHSTENCIL_16_8:n=(n|=e.DEPTH_BUFFER_BIT)|e.STENCIL_BUFFER_BIT}else n=e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT;v.setDepthMask(e,!0),e.clear(n),e.disable(e.SCISSOR_TEST);break;case cs.CLEARFLAG_SKY:case cs.CLEARFLAG_DEPTHONLY:if(e.enable(e.SCISSOR_TEST),e.scissor(i,l,o,h),r)switch(r.depthStencilFormat){case W.DEPTH_16:n=e.DEPTH_BUFFER_BIT;break;case W.STENCIL_8:n=e.STENCIL_BUFFER_BIT;break;case W.DEPTHSTENCIL_16_8:n=e.DEPTH_BUFFER_BIT|e.STENCIL_BUFFER_BIT}else n=e.DEPTH_BUFFER_BIT;v.setDepthMask(e,!0),e.clear(n),e.disable(e.SCISSOR_TEST);break;case cs.CLEARFLAG_NONE:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}}},{key:"_renderScene",value:function(e){var t=e.camera;if(this._opaqueQueue._render(e),t.clearFlag===cs.CLEARFLAG_SKY&&(t.skyRenderer._isAvailable()?t.skyRenderer._render(e):this._skyRenderer._isAvailable()&&this._skyRenderer._render(e)),this._transparentQueue._render(e),Ka.debugFrustumCulling)for(var i=this._debugTool._render._renderElements,n=0,a=i.length;n<a;n++)i[n]._update(this,e,null,null),i[n]._render(e)}},{key:"_parse",value:function(e,t){var i=e.lightmaps;if(i){for(var n=i.length,a=[],s=0;s<n;s++)a[s]=E.getRes(i[s].path);this.setlightmaps(a)}var r=e.ambientColor,r=(r&&((o=this.ambientColor).fromArray(r),this.ambientColor=o),e.sky);if(r)switch(this._skyRenderer.material=E.getRes(r.material.path),r.mesh){case"SkyBox":this._skyRenderer.mesh=ls.instance;break;case"SkyDome":this._skyRenderer.mesh=As.instance;break;default:this.skyRenderer.mesh=ls.instance}var o=e.reflectionTexture,r=(o&&(this.customReflection=E.getRes(o)),this.enableFog=e.enableFog,this.fogStart=e.fogStart,this.fogRange=e.fogRange,e.fogColor);r&&((o=this.fogColor).fromArray(r),this.fogColor=o)}},{key:"_onActive",value:function(){m(g(k.prototype),"_onActive",this).call(this),L.stage._scene3Ds.push(this)}},{key:"_onInActive",value:function(){m(g(k.prototype),"_onInActive",this).call(this);var e=L.stage._scene3Ds;e.splice(e.indexOf(this),1)}},{key:"_addRenderObject",value:function(e){var t,i,n,a;this._octree&&e._supportOctree?this._octree.add(e):(this._renders.add(e),Bt.supportWebGLPlusCulling&&(t=e._getIndexInList(),(i=this._cullingBufferIndices.length)<=t&&(n=this._cullingBufferIndices,a=this._cullingBufferResult,this._cullingBufferIndices=new Int32Array(i+1024),this._cullingBufferResult=new Int32Array(i+1024),this._cullingBufferIndices.set(n,0),this._cullingBufferResult.set(a,0)),this._cullingBufferIndices[t]=e._cullingBufferIndex))}},{key:"_removeRenderObject",value:function(e){var t;this._octree&&e._supportOctree?this._octree.remove(e):(Bt.supportWebGLPlusCulling&&(t=this._renders.elements[this._renders.length-1]),this._renders.remove(e),Bt.supportWebGLPlusCulling&&(this._cullingBufferIndices[t._getIndexInList()]=t._cullingBufferIndex))}},{key:"_getRenderQueue",value:function(e){return e<=2500?this._opaqueQueue:this._transparentQueue}},{key:"setlightmaps",value:function(e){for(var t=this._lightmaps,i=0,n=t.length;i<n;i++)t[i]._removeReference();if(!e)throw new Error("Scene3D: value value can't be null.");var a=e.length;for(t.length=a,i=0;i<a;i++){var s=e[i];s._addReference(),t[i]=s}for(i=0,n=this._children.length;i<n;i++)this._setLightmapToChildNode(this._children[i])}},{key:"getlightmaps",value:function(){return this._lightmaps.slice()}},{key:"destroy",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this.destroyed||(m(g(k.prototype),"destroy",this).call(this,e),this._skyRenderer.destroy(),this._skyRenderer=null,this._directionLights=null,this._pointLights=null,this._spotLights=null,this._alternateLights=null,this._lightmaps=null,this._shaderValues=null,this._renders=null,this._cameraPool=null,this._octree=null,this.parallelSplitShadowMaps=null,this._physicsSimulation&&this._physicsSimulation._destroy(),E.clearRes(this.url))}},{key:"render",value:function(e,t,i){e._curSubmit=w.RENDERBASE,0<this._children.length&&e.addRenderObject(this)}},{key:"renderSubmit",value:function(){var e,t,i;S.instance;for(this._prepareSceneToRender(),e=0,i=(t=this._cameraPool.length)-1;e<t;e++){Bt.supportWebGLPlusRendering&&es.setRuntimeValueMode(e==i);var n=this._cameraPool[e];n.enableRender&&n.render()}return Ct.set2DRenderConfig(),1}},{key:"getRenderType",value:function(){return 0}},{key:"releaseRender",value:function(){}},{key:"reUse",value:function(e,t){return 0}}],[{key:"__init__",value:function(){var e,t,i=Va._config;i._multiLighting&&(e=i.maxLightCount,t=i.lightClusterCount,Za.instance=new Za(t.x,t.y,t.z,Math.min(i.maxLightCount,i._maxAreaLightCountPerClusterAverage)),(k._lightTexture=Ra._createFloatTextureBuffer(4,e)).lock=!0,k._lightPixles=new Float32Array(4*e*4)),or.SHADERDEFINE_FOG=A.getDefineByName("FOG"),or.SHADERDEFINE_DIRECTIONLIGHT=A.getDefineByName("DIRECTIONLIGHT"),or.SHADERDEFINE_POINTLIGHT=A.getDefineByName("POINTLIGHT"),or.SHADERDEFINE_SPOTLIGHT=A.getDefineByName("SPOTLIGHT"),or.SHADERDEFINE_CAST_SHADOW=A.getDefineByName("CASTSHADOW"),or.SHADERDEFINE_SHADOW_PSSM1=A.getDefineByName("SHADOWMAP_PSSM1"),or.SHADERDEFINE_SHADOW_PSSM2=A.getDefineByName("SHADOWMAP_PSSM2"),or.SHADERDEFINE_SHADOW_PSSM3=A.getDefineByName("SHADOWMAP_PSSM3"),or.SHADERDEFINE_SHADOW_PCF_NO=A.getDefineByName("SHADOWMAP_PCF_NO"),or.SHADERDEFINE_SHADOW_PCF1=A.getDefineByName("SHADOWMAP_PCF1"),or.SHADERDEFINE_SHADOW_PCF2=A.getDefineByName("SHADOWMAP_PCF2"),or.SHADERDEFINE_SHADOW_PCF3=A.getDefineByName("SHADOWMAP_PCF3"),or.SHADERDEFINE_REFLECTMAP=A.getDefineByName("REFLECTMAP")}},{key:"load",value:function(e,t){L.loader.create(e,t,null,k.HIERARCHY)}}]),k}()),kr=(xr.HIERARCHY="HIERARCHY",xr.physicsSettings=new t,xr.octreeCulling=!1,xr.octreeInitialSize=64,xr.octreeInitialCenter=new R(0,0,0),xr.octreeMinNodeSize=2,xr.octreeLooseness=1.25,xr.REFLECTIONMODE_SKYBOX=0,xr.REFLECTIONMODE_CUSTOM=1,xr.FOGCOLOR=A.propertyNameToID("u_FogColor"),xr.FOGSTART=A.propertyNameToID("u_FogStart"),xr.FOGRANGE=A.propertyNameToID("u_FogRange"),xr.DIRECTIONLIGHTCOUNT=A.propertyNameToID("u_DirationLightCount"),xr.LIGHTBUFFER=A.propertyNameToID("u_LightBuffer"),xr.CLUSTERBUFFER=A.propertyNameToID("u_LightClusterBuffer"),xr.SUNLIGHTDIRECTION=A.propertyNameToID("u_SunLight.direction"),xr.SUNLIGHTDIRCOLOR=A.propertyNameToID("u_SunLight.color"),xr.LIGHTDIRECTION=A.propertyNameToID("u_DirectionLight.direction"),xr.LIGHTDIRCOLOR=A.propertyNameToID("u_DirectionLight.color"),xr.POINTLIGHTPOS=A.propertyNameToID("u_PointLight.position"),xr.POINTLIGHTRANGE=A.propertyNameToID("u_PointLight.range"),xr.POINTLIGHTATTENUATION=A.propertyNameToID("u_PointLight.attenuation"),xr.POINTLIGHTCOLOR=A.propertyNameToID("u_PointLight.color"),xr.SPOTLIGHTPOS=A.propertyNameToID("u_SpotLight.position"),xr.SPOTLIGHTDIRECTION=A.propertyNameToID("u_SpotLight.direction"),xr.SPOTLIGHTSPOTANGLE=A.propertyNameToID("u_SpotLight.spot"),xr.SPOTLIGHTRANGE=A.propertyNameToID("u_SpotLight.range"),xr.SPOTLIGHTCOLOR=A.propertyNameToID("u_SpotLight.color"),xr.SHADOWDISTANCE=A.propertyNameToID("u_shadowPSSMDistance"),xr.SHADOWLIGHTVIEWPROJECT=A.propertyNameToID("u_lightShadowVP"),xr.SHADOWMAPPCFOFFSET=A.propertyNameToID("u_shadowPCFoffset"),xr.SHADOWMAPTEXTURE1=A.propertyNameToID("u_shadowMap1"),xr.SHADOWMAPTEXTURE2=A.propertyNameToID("u_shadowMap2"),xr.SHADOWMAPTEXTURE3=A.propertyNameToID("u_shadowMap3"),xr.AMBIENTCOLOR=A.propertyNameToID("u_AmbientColor"),xr.REFLECTIONTEXTURE=A.propertyNameToID("u_ReflectTexture"),xr.REFLETIONINTENSITY=A.propertyNameToID("u_ReflectIntensity"),xr.TIME=A.propertyNameToID("u_Time"),function(){f(t,p);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,null,[{key:"getItemWithType",value:function(e,t){var i;{if(e&&t)return(i=this.getItem(e))||(t.toString()==h.toString()?i=new h(e):t.toString()==pn.toString()?(i=new pn).source=e:t.toString()==Un.toString()?i=new Un(e):t.toString()==Sn.toString()?(i=new Sn).font=e:t.toString()==N.toString()&&((i=new N).skin=e)),i;console.warn("empty url or type")}}},{key:"recycle",value:function(e,t,i,n){e&&(void 0===i&&(i=!0),n?o.timer.once(n,this,this.doRecycle,[e,t,i],!1):this.doRecycle(e,t,i))}},{key:"doRecycle",value:function(e,t,i){e.destroyed||(e.removeSelf(),e.offAll(),i&&e._destroyAllComponent(),e instanceof Ga?(e.transform.position=new R(0,0,0),e.transform.rotation=new Ca,this.recover(t,e)):e instanceof xr?this.recover(t,e):e instanceof pn?(e.stop(),e.rotation=0,e.scale(1,1),e.pos(0,0),e.zOrder=0,e.visible=!0,this.recover(e._url||t,e)):e instanceof ka?(e.stop(),e.destroy()):e instanceof Sn?(e.rotation=0,e.scale(1,1),e.pos(0,0),e.zOrder=0,e.visible=!0,e.alpha=1,this.recover(e.font||t,e)):(e.alpha=1,e.rotation=0,e.scale(1,1),e.pos(0,0),e.zOrder=0,e.visible=!0,this.recover(e.recycleKey||e.skin||t,e)))}}]),t}()),wr=function(){function e(){b(this,e)}return y(e,null,[{key:"getFishIcon",value:function(e){return"fishxy/fight/fishicon/fish_"+e+".png"}},{key:"getSceneBackground",value:function(e){return I.onIOS?"res/fishxy/effect/Conventional/dldby_scene_ios_"+e+".lh":"res/fishxy/effect/Conventional/dldby_scene_"+e+".lh"}}]),e}(),br=(wr.FISH_DEFINE_CONF="res/fishxy/fish_define.json",wr.Level_GUN_CONF="res/fishxy/level_gun_config.json",function(){f(t,Ri);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,null,[{key:"randInt",value:function(e,t){return e+Math.floor(Math.random()*(t-e))}},{key:"randSign",value:function(){return.5<=Math.random()?-1:1}},{key:"getSign",value:function(e){return e<0?-1:1}},{key:"ifTouch",value:function(e,t,i,n){var a=new ne(0,0,e.width,e.height),s=new ie(t,i);return(n=void 0===n?!0:n)&&(s=e.globalToLocal(new ie(t,i))),a.contains(s.x,s.y)}},{key:"relativeCoordinate",value:function(e,t){var i=new ie(e.x,e.y),n=new ie(t.x,t.y),i=e.parent.localToGlobal(i),n=t.parent.localToGlobal(n);return void 0===t.anchorX?new ie(i.x-n.x,i.y-n.y):new ie(i.x-n.x+t.anchorX*t.width,i.y-n.y+t.anchorY*t.height)}},{key:"boxCircleIntersect",value:function(e,t,i,n,a,s){if(void 0===s)throw new Error("目前没实现");var s=-s/180*Math.PI,r=n.x-e.x,n=-(n.y-e.y);return this.v.x=Math.abs(r*Math.cos(s)+n*Math.sin(s)),this.v.y=Math.abs(-r*Math.sin(s)+n*Math.cos(s)),this.h.setTo(t/2,i/2),this.u.setTo(this.v.x-this.h.x,this.v.y-this.h.y),this.u.x=0<this.u.x?this.u.x:0,this.u.y=0<this.u.y?this.u.y:0,this.u.x*this.u.x+this.u.y*this.u.y<=a*a}},{key:"twoPointAngle",value:function(e,t,i,n){return 180*Math.atan2(n-t,i-e)/Math.PI}},{key:"pingPongSE",value:function(e,t,i){if(t==i)return t;var n=i-t;return n+=n,(e-=Math.floor((e-t)/n)*n)<i?e:i+i-e}},{key:"pingPongL",value:function(e,t){if(0==t)return 0;var i=t+t;return(e-=Math.floor(e/i)*i)<t?e:i-e}},{key:"repeatSE",value:function(e,t,i){if(t==i)return t;i-=t;return e-Math.floor((e-t)/i)*i}},{key:"repeatL",value:function(e,t){return 0==t?0:e-Math.floor(e/t)*t}},{key:"clamp",value:function(e,t,i){return i<e?i:e<t?t:e}},{key:"sceenPointToWorld",value:function(e,t,i){if(null==e)throw Error("camera is null");var n,a,s,r;e.orthographic?(n=u.width,s=u.height,a=e.orthographicVerticalSize*e.aspectRatio/n,r=e.orthographicVerticalSize/s,i.x=(.5*-n+t.x)*a,i.y=(.5*s-t.y)*r,R.transformCoordinate(i,e.transform.worldMatrix,i),i.z=t.z):(e.projectionViewMatrix.invert(this.tempMatrix4x4),i.x=(t.x-e.viewport.x)/e.viewport.width*2-1,i.y=-((t.y-e.viewport.y)/e.viewport.height*2-1),n=e.nearPlane>this.EPSILON?e.nearPlane:.3,a=t.z>this.EPSILON?-t.z-n:-n,s=e.projectionMatrix.elements,i.z=-s[10]-s[14]/a,R.transformV3ToV4(i,this.tempMatrix4x4,this.temp0Vector4),1!==(r=this.temp0Vector4.w)&&(i.x=this.temp0Vector4.x/r,i.y=this.temp0Vector4.y/r,i.z=this.temp0Vector4.z/r))}},{key:"lookAt",value:function(e,t,i){R.normalize(e,this.temp1Vector3),R.cross(t,this.temp1Vector3,this.temp2Vector3),R.normalize(this.temp2Vector3,this.temp2Vector3),R.cross(this.temp1Vector3,this.temp2Vector3,this.temp3Vector3);var e=this.temp2Vector3,t=this.temp3Vector3,n=this.temp1Vector3,a=Ca._tempMatrix3x3.elements;a[0]=e.x,a[1]=e.y,a[2]=e.z,a[3]=t.x,a[4]=t.y,a[5]=t.z,a[6]=n.x,a[7]=n.y,a[8]=n.z,Ca.rotationMatrix(Ca._tempMatrix3x3,i)}}]),t}()),Sr=(br.EPSILON=1e-6,br.temp0Point=new ie,br.temp1Point=new ie,br.temp0Vector2=new ba,br.temp0Vector3=new R,br.temp1Vector3=new R,br.temp2Vector3=new R,br.temp3Vector3=new R,br.temp0Vector4=new Sa,br.tempQuaternion=new Ca,br.tempMatrix4x4=new Pa,br.v=new ie,br.h=new ie,br.u=new ie,function(){function t(e){b(this,t),this.nCurveLength=-1,null==e?(this.points_vec=[],this.points_vec.push(R._ZERO)):e.length<=0?this.points_vec.push(R._ZERO):this.points_vec=e,this.getLength(),this.checkCircle()}return y(t,[{key:"checkCircle",value:function(){var e,t;this.isCircle=!1,3<this.points_vec.length&&(e=this.points_vec[0],t=this.points_vec[this.points_vec.length-1],e.x==t.x&&e.y==t.y&&e.z==t.z&&(this.isCircle=!0))}},{key:"getPosition",value:function(e,t){2<arguments.length&&void 0!==arguments[2]&&!arguments[2]||(e=br.clamp(e,0,1));try{var i=this.points_vec.length-3;if(i<=0)return void(t=this.points_vec[0]);var n=Math.min(Math.floor(e*i),i-1),a=this.points_vec[n],s=this.points_vec[n+1],r=this.points_vec[n+2],o=this.points_vec[n+3],h=(this.isCircle&&(0==n&&(a=this.points_vec[i]),n+1==i&&(o=this.points_vec[2])),e*i-n),l=h*h,u=l*h,c=.5*h,_=.5*l,f=l+l,d=.5*u,p=l-d-c,y=u+d-_-f+1,g=-u-d+f+c,m=d-_;t.x=p*a.x+y*s.x+g*r.x+m*o.x,t.y=p*a.y+y*s.y+g*r.y+m*o.y,t.z=p*a.z+y*s.z+g*r.z+m*o.z}catch(e){R._ZERO.cloneTo(t)}this.transform&&R.transformCoordinate(t,this.transform.worldMatrix,t)}},{key:"getLength",value:function(){if(0<=this.nCurveLength)return this.nCurveLength;if(null==this.points_vec||this.points_vec.length<3)return this.nCurveLength=0,this.nCurveLength;this.nCurveLength=0;for(var e=1;e<this.points_vec.length-2;e++){if(null==this.points_vec[e]||null==this.points_vec[e+1])return;this.nCurveLength+=R.distance(this.points_vec[e],this.points_vec[e+1])}return this.nCurveLength}},{key:"getForwardNormal",value:function(e,t,i,n){var a,s=this.getLength();s<=0||(a=br.temp1Vector3,this.getPosition(e+(i/=s),a),R.subtract(a,t,a),R.normalize(a,a),s=br.temp2Vector3,this.getPosition(e-i,s),R.subtract(t,s,s),R.normalize(s,s),R.lerp(a,s,.5,n),R.normalize(n,n))}},{key:"getForwardAngle",value:function(e,t){var i=this.getLength(),n=br.temp0Vector3,a=br.temp1Vector3,s=br.temp2Vector3;return this.getPosition(e+t+t/i,n),this.getPosition(e-t-t/i,a),R.subtract(n,a,s),R.normalize(s,s),-(180*Math.atan2(s.y,-s.x)/Math.PI)}}]),t}()),Ir=function(){function e(){b(this,e)}return y(e,[{key:"clone",value:function(){return new e}}]),e}(),Tr=function(){f(i,Ir);var t=T(i);function i(){var e;return b(this,i),(e=t.apply(this,arguments)).position=0,e.roll=0,e.rotateVector3=new R,e}return y(i,[{key:"clone",value:function(){var e=new i;return e.curve=this.curve,e.targetScale=this.targetScale,e.autoLookDirection=this.autoLookDirection,e.target=this.target,e.firstRun=!0,e}},{key:"UpdateTransform",value:function(){var e;null!=this.curve&&null!=this.target&&(e=br.temp0Vector3,this.curve.getPosition(this.position,e,!0),this.autoLookDirection&&(this.rotateVector3.z=-this.rotateVector3.z,this.rotateVector3.z=this.curve.getForwardAngle(this.position,.01)+180),this.target&&this.target.updateTransform(e,this.rotateVector3))}},{key:"SetPositionOnCurve",value:function(e){this.position=e,this.UpdateTransform()}},{key:"SetRoll",value:function(e){this.roll=e,this.UpdateTransform()}},{key:"SetCurve",value:function(e){this.curve=e,this.UpdateTransform()}},{key:"SetTarget",value:function(e){this.target=e,this.UpdateTransform()}}]),i}(),Cr=((e=$i=$i||{})[e.Action=0]="Action",e[e.DirectVarAccess=1]="DirectVarAccess",e[e.Disable=2]="Disable",function(){function t(e){b(this,t),this.targetName="",this.startTime=0,this.length=1,this.updateEvent="",this.updateMode=$i.Action,this.callback=null,this.loopClip=!1,this.activeCalculateOnly=!1,this.cutscene=e}return y(t,[{key:"bindCallback",value:function(){null!=this.targetAction&&(this.callback=this.targetAction[this.updateEvent])}},{key:"setValue",value:function(e){null!=this.callback&&this.callback.call(this.targetAction,e)}},{key:"setTarget",value:function(e){this.target=e,null!=this.targetAction&&this.targetAction instanceof Tr&&(this.targetAction.SetTarget(e),null==this.lastValue&&(this.lastValue=this.startTime),this.setValue(this.lastValue))}},{key:"onTargetDestroy",value:function(){this.cutscene.removeCurveClip(this)}},{key:"getValue",value:function(e){e=this.animCurve.Evaluate(e);return this.loopClip&&1<e&&(e-=Math.floor(e)),e}}]),t}()),Mr=function(){function t(){b(this,t),this.name="event clip",this.startTime=0,this.targetFunction="",this.paramVariationIndex=0}return y(t,[{key:"clone",value:function(){var e=new t;return e.name=this.name,e.startTime=this.startTime,e.targetFunction=this.targetFunction,e.paramVariationIndex=this.paramVariationIndex,e.params=this.params,e}},{key:"trigger",value:function(){var e,t=[],i=Y(this.params);try{for(i.s();!(e=i.n()).done;)var n=e.value,t=t.concat(n)}catch(e){i.e(e)}finally{i.f()}this.target[this.targetFunction]&&this.target[this.targetFunction].apply(this.target,t)}}]),t}(),Er=function(){function a(){b(this,a),this.cutsceneName="Cutscene01",this.loop=!1,this.loopCount=0,this.resetOnStop=!1,this.resetPlayCountOnStop=!0,this.offsetTime=0,this.speedMagnification=1,this.timer=0,this.startTime=0,this.playing=!1,this.playReverse=!1,this.totalPlays=0,this.fTotalTime=-1,this.isFinish=!1,this.curves=[],this.events=[],this.finishedEvents=[]}return y(a,[{key:"clone",value:function(){var e=new a;e.cutsceneName=this.cutsceneName,e.loop=this.loop,e.loopCount=this.loopCount,e.resetOnStop=this.resetOnStop,e.resetPlayCountOnStop=this.resetPlayCountOnStop,e.offsetTime=this.offsetTime,e.speedMagnification=this.speedMagnification,e.timer=this.timer,e.startTime=this.startTime,e.playing=this.playing,e.playReverse=this.playReverse,e.totalPlays=this.totalPlays,e.fTotalTime=this.fTotalTime,e.isFinish=this.isFinish;for(var t=0;t<this.curves.length;t++){var i=e.addCurveClip();i.target=this.curves[t].target,i.targetName=this.curves[t].targetName,i.targetAction=this.curves[t].targetAction.clone(),i.startTime=this.curves[t].startTime,i.length=this.curves[t].length,i.updateEvent=this.curves[t].updateEvent,i.updateMode=this.curves[t].updateMode,i.animCurve=this.curves[t].animCurve,i.loopClip=this.curves[t].loopClip,i.activeCalculateOnly=this.curves[t].activeCalculateOnly,i.bindCallback()}e.events=[];for(var n=0;n<this.events.length;n++)e.events.push(this.events[n].clone());return e}},{key:"clear",value:function(){this.curves=[],this.events=[],this.finishedEvents=[]}},{key:"Start",value:function(){this.updateCutscene(0,!1)}},{key:"getTotalTime",value:function(){if(0<=this.fTotalTime)return this.fTotalTime;for(var e=this.fTotalTime=0;e<this.curves.length;e++){var t=this.curves[e];this.fTotalTime<t.startTime+t.length&&(this.fTotalTime=t.startTime+t.length)}return this.fTotalTime}},{key:"resetSpeed",value:function(){this.speedMagnification=1}},{key:"setSpeed",value:function(e){this.speedMagnification=e}},{key:"getSpeed",value:function(){return this.speedMagnification}},{key:"Update",value:function(){var e;this.timer+=u.timer.delta*this.speedMagnification*.001,this.playing&&(e=this.getTotalTime(),this.timer>this.startTime+e?(this.resetSpeed(),this.playReverse?(this.updateCutscene(0,!0),this.stop()):(this.updateCutscene(this.timer-this.startTime,!0),this.playing=!1,this.isFinish=!0,this.loop&&(this.loopCount<=0||this.totalPlays<this.loopCount)?(this.play(),this.startTime+=u.timer.delta/1e3):this.stop())):this.playReverse?this.updateCutscene(e-(this.timer-this.startTime),!0):this.updateCutscene(this.timer-this.startTime,!0))}},{key:"updateCutscene",value:function(e,t){var i=this.getTotalTime();if(!(e<0||i<e)){for(var n=0;n<this.curves.length;n++){var a=this.curves[n],s=!1,r=e-a.startTime,r=(0<=r&&r<a.length&&(s=!0),a.getValue(r));if(s||!a.activeCalculateOnly)if(a.updateMode==$i.Action)(null==a.lastValue||(s=r-a.lastValue)<-br.EPSILON||s>br.EPSILON)&&(a.setValue(r),a.lastValue=r);else if(a.updateMode==$i.Disable)continue}if(1==t&&0<this.events.length)for(var o=this.getCurrentEvents(e),n=0;n<o.length;n++){var h=o[n];h.target?h.trigger():console.warn("Warning: Tried to play event "+h.name+" that has no target set."),this.finishedEvents.push(h)}}}},{key:"play",value:function(){this.playing||(this.startTime=this.timer-this.offsetTime,this.playing=!0,this.playReverse=!1,this.finishedEvents=[],this.totalPlays++)}},{key:"continue",value:function(e){this.startTime+=e,this.playing=!0,this.playReverse=!1,this.finishedEvents=[]}},{key:"stop",value:function(){this.playing=!1,this.playReverse=!1,this.finishedEvents=[],this.resetPlayCountOnStop&&(this.totalPlays=0),this.resetOnStop&&this.updateCutscene(0,!1)}},{key:"resetToBeginning",value:function(){this.timer=0,this.startTime=0,this.playing=!1,this.isFinish=!1,this.resetSpeed(),this.Start(),this.play()}},{key:"getCurrentEvents",value:function(e){var t=[];if(this.playReverse)for(i=0;i<this.events.length;i++)e<=this.events[i].startTime&&-1==this.finishedEvents.indexOf(this.events[i])&&t.push(this.events[i]);else for(var i=0;i<this.events.length;i++)e>=this.events[i].startTime&&-1==this.finishedEvents.indexOf(this.events[i])&&t.push(this.events[i]);return t}},{key:"addCurveClip",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:-1,t=new Cr(this);return e<0||e>=this.curves.length?this.curves.push(t):this.curves.splice(e,0,t),t}},{key:"insertCurveClip",value:function(e,t){return e=Math.max(Math.min(e,this.curves.length),0),this.curves.splice(e,0,t),t}},{key:"removeCurveClip",value:function(e){e=this.curves.indexOf(e);0<=e&&this.curves.splice(e,1)}},{key:"addEvent",value:function(){var e=new Mr;return this.events.push(e),e}},{key:"deleteEvent",value:function(e){e=this.events.indexOf(e);0<=e&&this.events.splice(e,1)}},{key:"setEventTarget",value:function(e){var t,i=Y(this.events);try{for(i.s();!(t=i.n()).done;)t.value.target=e}catch(e){i.e(e)}finally{i.f()}}}],[{key:"isInArray",value:function(e,t){return 0<=e.indexOf(t)}}]),a}(),Rr=y(function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;b(this,e),this.time=t,this.value=i,this.inTangent=n,this.outTangent=a}),Ar=((n=en=en||{})[n.Default=0]="Default",n[n.Once=1]="Once",n[n.Loop=2]="Loop",n[n.PingPong=4]="PingPong",n[n.ClampForever=8]="ClampForever",function(){function s(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;b(this,s),this.Init(e)}return y(s,[{key:"Cleanup",value:function(){}},{key:"Evaluate",value:function(e){if(null==this.keys||0==this.keys.length)return 0;if(this.keys.length<2)return this.keys[0].value;var t=0,i=this.keys.length-1,n=this.keys[t].time,a=this.keys[i].time;if(a<=e){if(this.postWrapMode==en.Loop)e=br.repeatSE(e,n,a);else{if(this.postWrapMode!=en.PingPong)return this.keys[i].value;e=br.pingPongSE(e,n,a)}if(e==n)return this.keys[t].value;if(e==a)return this.keys[i].value}else if(e<=n){if(this.preWrapMode==en.Loop)e=br.repeatSE(e,n,a);else{if(this.preWrapMode!=en.PingPong)return this.keys[t].value;br.pingPongSE(e,n,a)}if(e==n)return this.keys[t].value;if(e==a)return this.keys[i].value}for(var s,r,o,h,l,u=i,c=0;c<this.keys.length;c++)if(this.keys[c].time>=e){u=c;break}return 0<u?(i=u,n=this.keys[i].time-this.keys[t=u-1].time,a=(e-this.keys[t].time)/n,l=this.keys[t].value,o=this.keys[i].value,(1-(h=3*(s=a*a)-2*(r=s*a)))*l+((l=r-s)+a-s)*(this.keys[t].outTangent*n)+h*o+l*(this.keys[i].inTangent*n)):this.keys[0].value}},{key:"AddKey",value:function(e,t){return this.AddKeyFrame(new Rr(e,t))}},{key:"AddKeyFrame",value:function(e){return this.keys.push(e),this.sort(),e}},{key:"Init",value:function(e){this.keys=null==e?[]:e,this.sort()}},{key:"bsearchWithoutRecursion",value:function(e){for(var t,i=0,n=this.keys.length-1;i<=n;){if(t=Math.floor((i+n)/2),e==this.keys[t].time)return t;e>this.keys[t].time?i=t+1:e<this.keys[t].time&&(n=t-1)}return-1}},{key:"sort",value:function(){for(var e,t,i=1;i<this.keys.length;i++)for(e=i;0!=e&&this.keys[e].time<this.keys[e-1].time;)t=this.keys[e],this.keys[e]=this.keys[e-1],this.keys[e-1]=t,e--}}],[{key:"Linear",value:function(e,t,i,n){var a=(n-t)/(i-e);return new s([new Rr(e,t,0,a),new Rr(i,n,a,0)])}},{key:"EaseInOut",value:function(e,t,i,n){return new s([new Rr(e,t,0,0),new Rr(i,n,0,0)])}}]),s}());function Lr(e,t){var i,n=Y(an);try{for(n.s();!(i=n.n()).done;){var a=i.value;if(a.key==e)return a}}catch(e){n.e(e)}finally{n.f()}if(t)return(t=new nn).key=e,t.metadatas={},an.push(t),t}function Nr(e,t,i,n){var a="object"==P(t)?t.constructor:t,s=(s=e)+(void 0===i?"":"_propertyKey_"+i)+(void 0===n?"":"_paramIndex_"+n);if(Lr(a=i||n?t.constructor:a))return Lr(a).metadatas[s];for(;t.__proto__;){var r=t.__proto__.constructor;if(Lr(r)&&void 0!==Lr(r).metadatas[s])return Lr(r).metadatas[s];t=t.__proto__}}function r(e){return tn.metadata("Commander",e)}function Pr(e){return tn.metadata("AutoShowErr",e)}function Br(e){return tn.metadata("ShowLoading",e)}function Dr(e,t){var i=e[t];delete e[t],Object.defineProperty(e,t,{get:function(){return i},set:function(e){i=Number(e)},enumerable:!0,configurable:!0})}function Or(){return tn.metadata("IgnoreClone",!0)}function Fr(e){return tn.metadata("ServerName",e)}function Vr(e){return tn.metadata("RawData",e)}function Ur(e){return tn.metadata("ShowLog",e)}i=tn=tn||{},nn=y(function e(){b(this,e)}),an=new Array,i.metadata=function(a,s){return function(e,t,i){var n=e;(t||i)&&(n=e.constructor);e=(e=a)+(void 0===t?"":"_propertyKey_"+t)+(void 0===i?"":"_paramIndex_"+i);Lr(n,!0).metadatas[e]=s}},i.getMetadata=Nr,i.getDecorator=function(e,t,i,n){return Nr(e.toString().match(/metadata\("(.*)",/)[1],t,i,n)};var zr=function(){function s(){b(this,s)}return y(s,null,[{key:"copyProperty",value:function(e,t){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])}},{key:"deepClone",value:function(e){var t,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length?arguments[2]:void 0;if("object"!=P(e))return e;for(t in e)if(null===e[t])i[t]=null;else if(void 0===e[t])i[t]=void 0;else if(!tn.getDecorator(Or,e,t))if(e[t]instanceof Array){i[t]=[];for(var a=0;a<e[t].length;a++)i[t][a]=s.deepClone(e[t][a],i[t][a],n)}else!n&&"function"==typeof e[t]||(i[t]="object"===P(e[t])?s.deepClone(e[t],i[t],n):e[t]);return i}},{key:"getClassName",value:function(e){return e.constructor.toString().match(/\s(\S*)\(/)[1]}},{key:"getByFullName",value:function(e,t){var i,n=e,a=Y(t.split("."));try{for(a.s();!(i=a.n()).done;)n=n[i.value]}catch(e){a.e(e)}finally{a.f()}return n}}]),s}(),Yr=function(){f(s,ae);var i=T(s);function s(e){var t;return b(this,s),(t=i.call(this)).forever_event_list=[],t.cache=[],t.is_pause=!1,t.name=e,t}return y(s,[{key:"on",value:function(e,t,i,n,a){if(e)return e=this.getEventType(e),m(g(s.prototype),a?"once":"on",this).call(this,e,t,i,n);console.warn("protocol is null")}},{key:"once",value:function(e,t,i,n){return this.on(e,t,i,n,!0)}},{key:"onForever",value:function(e,t,i,n){return this.forever_event_list.push({type:e,caller:t,listener:i,args:n}),this.on(e,t,i,n)}},{key:"event",value:function(e,t){if(e){if(!this.is_pause)return e=this.getEventType(e),m(g(s.prototype),"event",this).call(this,e,t);this.cache.push({type:e,data:t})}else console.warn("event name is null")}},{key:"off",value:function(t,i,n){return t=this.getEventType(t),this.forever_event_list.find(function(e){if(e.type==t&&e.caller==i&&e.listener==n)return!0})?this:m(g(s.prototype),"off",this).call(this,t,i,n)}},{key:"offAll",value:function(e){if(e)e=this.getEventType(e),m(g(s.prototype),"offAll",this).call(this,e);else{m(g(s.prototype),"offAll",this).call(this);var t,i=Y(this.forever_event_list);try{for(i.s();!(t=i.n()).done;){var n=t.value;m(g(s.prototype),"on",this).call(this,n.type,n.caller,n.listener,n.args)}}catch(e){i.e(e)}finally{i.f()}}return this}},{key:"offForever",value:function(e,t,i){for(var n=0;n<this.forever_event_list.length;n++){var a=this.forever_event_list[n];a.type==e&&a.caller==t&&a.listener==i&&(this.forever_event_list.splice(n,1),n--)}return this.off(e,t,i)}},{key:"pause",value:function(){this.is_pause=!0}},{key:"resume",value:function(){for(var e in this.is_pause=!1,this.cache)this.event(this.cache[e].type,this.cache[e].data);this.cache=[]}},{key:"getEventType",value:function(e){var t,i;return"string"==typeof e?e:(t=tn.getDecorator(Fr,e),(i=tn.getDecorator(r,e).toString())||console.error(zr.getClassName(e)+" have no Commander"),t+"_"+i)}}]),s}(),Gr=function(){f(n,Yr);var i=T(n);function n(e){var t;return b(this,n),(t=i.call(this)).model=e,t}return y(n,[{key:"getTransform",value:function(){return this.model?this.model.transform:null}},{key:"updateTransform",value:function(e,t){}},{key:"pathOver",value:function(){this.model=this.model}}]),n}(),Xr=function(){function i(e,t){b(this,i),this.curves=e,this.cutscenes=t}return y(i,[{key:"clone",value:function(){for(var e=[],t=0;t<this.cutscenes.length;t++)e.push(this.cutscenes[t].clone());return new i(this.curves,e)}},{key:"clear",value:function(){for(var e=0;e<this.cutscenes.length;e++)this.cutscenes[e].clear();this.cutscenes=[]}},{key:"update",value:function(){for(var e=0;e<this.cutscenes.length;e++){var t=this.cutscenes[e];if(t.Update(),!t.loop&&t.isFinish){var i,n=Y(t.curves);try{for(n.s();!(i=n.n()).done;){var a=i.value;a.target&&a.target.pathOver()}}catch(e){n.e(e)}finally{n.f()}this.cutscenes.splice(e,1),e--}}}},{key:"getCutsceneCount",value:function(){return this.cutscenes.length}},{key:"getCutscene",value:function(e){return this.cutscenes[e]}},{key:"isPathFinish",value:function(){return this.cutscenes.length<=0}},{key:"setEventTarget",value:function(e){var t,i=Y(this.cutscenes);try{for(i.s();!(t=i.n()).done;)t.value.setEventTarget(e)}catch(e){i.e(e)}finally{i.f()}}}]),i}(),Wr=function(){f(i,sn);var t=T(i);function i(){var e;return b(this,i),(e=t.apply(this,arguments)).fishPathes=[],e}return y(i,[{key:"addFishPath",value:function(e){this.fishPathes.push(e)}},{key:"onUpdate",value:function(){this.owner.timer.callLater(this,this.update)}},{key:"update",value:function(){for(var e=0;e<this.fishPathes.length;e++){var t=this.fishPathes[e];t.update(),t.isPathFinish()&&(this.fishPathes.splice(e,1),e--)}}},{key:"clear",value:function(){for(var e=0;e<this.fishPathes.length;e++)this.fishPathes[e].clear();this.fishPathes=[]}}],[{key:"load",value:function(){this.loadFishPathes(),this.loadFishArray()}},{key:"loadFishPathes",value:function(){null==this.mapFishPath&&(this.mapFishPath={},this.loadPath(this.resourceFishPath,this.mapFishPath,this.listFishPath))}},{key:"loadFishArray",value:function(){null==this.mapFishArray&&(this.mapFishArray={},this.loadPath(this.resourceFishArray,this.mapFishArray,this.listFishArray))}},{key:"loadPath",value:function(e,t){var i,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],a=o.loader.getRes(e);for(i in a){var s=a[i],r=s.curves,s=s.cutscenes,r=this.loadCurves(r),s=this.loadCutscene(s,r),r=new Xr(r,s);t[i]=r,n.push(r)}}},{key:"createPathByName",value:function(e){return null!=this.mapFishPath[e]?this.mapFishPath[e].clone():null}},{key:"createPathByIndex",value:function(e){return e=br.clamp(e,0,this.listFishPath.length),this.listFishPath[e].clone()}},{key:"createArrayByName",value:function(e){return null!=this.mapFishArray[e]?this.mapFishArray[e].clone():null}},{key:"createArrayByIndex",value:function(e){return e=br.clamp(e,0,this.listFishArray.length),this.listFishArray[e].clone()}},{key:"getPathCount",value:function(){return this.listFishPath.length}},{key:"getArrayCount",value:function(){return this.listFishArray.length}},{key:"loadCurves",value:function(e){var t,i={};for(t in e){for(var n=e[t],a=[],s=0;s<n.length;s++)a.push(new R(n[s][0],n[s][1],n[s][2]));var r=new Sr(a);i[t]=r}return i}},{key:"loadCutscene",value:function(e,t){for(var i=[],n=0;n<e.length;n++){for(var a=new Er,s=(i.push(a),e[n]),r=(a.cutsceneName=s.name,a.loop=s.loop,a.loopCount=s.loopCount,a.resetOnStop=s.resetOnStop,a.resetPlayCountOnStop=s.resetPlayCountOnStop,a.offsetTime=s.offsetTime,a.speedMagnification=s.speedMagnification,s.clips),o=0;o<r.length;o++){var h=r[o],l=a.addCurveClip(),u=(l.startTime=h.startTime,l.length=h.length,l.updateEvent=h.updateEvent,l.loopClip=h.loopClip,l.activeCalculateOnly=h.activeCalculateOnly,h.targetAction),c=(l.targetName=h.targetName,h.target),_=("Action_FollowCurve"==u&&((u=new Tr).curve=t[c.curve],u.roll=c.roll,u.autoLookDirection=c.autoLookDirection,_=c.targetScale,u.targetScale=new R(_[0],_[1],_[2]),l.targetAction=u),l.bindCallback(),h.animCurve),u=(_.key,_.key),h=new Ar(u),f=(h.preWrapMode=_.preWrapMode,h.postWrapMode=_.postWrapMode,l.animCurve=h,c.targetCurve);if(f){var d=new Ga,u=new Gr(d);l.setTarget(u);for(var p=0;p<f.length;p++){var y=t[f[p]];y&&(y.transform=d.transform)}}}var g=s.events;if(null!=g)for(var m=0;m<g.length;m++){var v=g[m],x=a.addEvent();x.name=v.name,x.startTime=v.startTime,x.targetFunction=v.targetFunction,x.params=v.param}}return i}}]),i}();function s(e,t,i,n){var a,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var o=e.length-1;0<=o;o--)(a=e[o])&&(r=(s<3?a(r):3<s?a(t,i,r):a(t,i))||r);return 3<s&&r&&Object.defineProperty(t,i,r),r}Wr.resourceFishPath="res/fishxy/fish_path.json",Wr.listFishPath=[],Wr.resourceFishArray="res/fishxy/fish_array_path.json",Wr.listFishArray=[];var Hr,jr,qr,Kr,Qr,Zr,Jr,$r,eo,to,io,no,ao,so,ro,oo,ho,lo,uo,co,_o,fo,po,yo,go,mo,vo,xo,ko,wo,bo,t=function(){function e(){b(this,e)}return y(e,[{key:"isUsdtPlatform",get:function(){return"--usdt"==I.window.platform}}]),e}(),e=(s([Dr],t.prototype,"user_id",void 0),s([Dr],t.prototype,"appId",void 0),s([Dr],t.prototype,"time",void 0),function(){function e(){b(this,e),this.gameInfo={id:2024,name:"西游捕鱼"}}return y(e,[{key:"serverTime",get:function(){return o.timer.currTimer-this.gameServerTimeOffset},set:function(e){this.gameServerTimeOffset=o.timer.currTimer-e}}]),e}()),_=y(function e(){b(this,e)}),So=(_.config=new t,_.data=new e,_.isFocus=!0,_.event=new Yr("game_event"),_.EventType={GameSocketOpen:"GameSocketOpen",GameSocketClose:"GameSocketClose",OnAppPause:"OnAppPause",OnAppResume:"OnAppResume",UpdatePlatformUserInfo:"UpdatePlatformUserInfo",LoginComplete:"LoginComplete",LoginFail:"LoginFail",TimeOut:"TimeOut"},(n=po=po||{})[n.Jgb=24]="Jgb",n[n.Xmsb=25]="Xmsb",n[n.Ffwb=26]="Ffwb",n[n.Jclj=27]="Jclj",n[n.BlueShake=28]="BlueShake",n[n.Boom=29]="Boom",n[n.Flash=30]="Flash",n[n.WealthGod=33]="WealthGod",n[n.Boss=34]="Boss",po),Io=((i=vo=vo||{}).Init="FishInit",i.EnterScene="FishEnterScene",i.EnterScreen="FishEnterScreen",i.OutScreen="FishOutScreen",i.RunAway="FishRunAway",i.Died="FishDied",i.Destroy="FishDestroy",vo),To=function(){f(i,sn);var t=T(i);function i(){var e;return b(this,i),(e=t.apply(this,arguments)).colors=new Array,e.shapes=new Array,e}return y(i,[{key:"init",value:function(e){this.fish=e,this.testTimer=0}},{key:"onUpdate",value:function(){this.updateLifeState()}},{key:"updateLifeState",value:function(){var t=this;this.fish.lifeState==Io.Init?(this.fish.lifeState=Io.EnterScene,_.event.event(Io.EnterScene,this.fish),this.fish.event(Io.EnterScene,this.fish)):this.fish.lifeState==Io.EnterScene||this.fish.lifeState==Io.OutScreen?this.isInnerScreen()&&(this.fish.lifeState=Io.EnterScreen,Oo.I.enterScreenFishes.push(this.fish),_.event.event(Io.EnterScreen,this.fish),this.fish.event(Io.EnterScreen,this.fish)):this.fish.lifeState==Io.EnterScreen&&this.isOutSideScreen()&&(this.fish.lifeState=Io.OutScreen,Oo.I.enterScreenFishes.remove(function(e){return e.uniqueId==t.fish.uniqueId}),_.event.event(Io.OutScreen,this.fish),this.fish.event(Io.OutScreen,this.fish))}},{key:"isOutSideScreen",value:function(){return null==this.fish.collider}},{key:"isInnerScreen",value:function(){return null!=this.fish.collider}},{key:"createTestShape",value:function(e,t,i,n,a){var s;this.shapes[e]||((s=u.addChild(new N)).pos(t,i),this.colors[e]="#"+Math.floor(2677216*Math.random()),s.graphics.drawCircle(0,0,a,this.colors[e]),this.shapes.push(s)),this.shapes[e].graphics.clear(!0),this.shapes[e].graphics.save(),this.shapes[e].graphics.alpha(.5),this.shapes[e].graphics.drawCircle(0,0,a,this.colors[e]),this.shapes[e].graphics.fillText("x=".concat(this.shapes[e].x.toFixed(2),", y=").concat(this.shapes[e].y.toFixed(2),", z=").concat(n.toFixed(2)),0,0,"20px Arial","#ff0000","center"),this.shapes[e].graphics.restore(),this.shapes[e].pos(t,i)}},{key:"clearTestShape",value:function(){var e,t=Y(this.shapes);try{for(t.s();!(e=t.n()).done;)e.value.graphics.clear()}catch(e){t.e(e)}finally{t.f()}}},{key:"onDestroy",value:function(){this.fish=null,this.clearTestShape()}}]),i}(),Co=function(){function e(){b(this,e),this.position=new ie}return y(e,[{key:"cacularteWorldPosition",value:function(){this.position.setTo(this.shape.x,this.shape.y),this.shape.parent.localToGlobal(this.position)}},{key:"isInScreen",get:function(){if(-10<this.position.x&&-10<this.position.y&&this.position.x<u.width+10&&this.position.y<u.height+10)return!0}}]),e}(),Mo=function(){function i(e,t){b(this,i),this.fish=e,this.shadow=t,this.shadow.zOrder=i.ShadowZOrder}return y(i,[{key:"setDice",value:function(e,t){e&&(this.bubbleTransform=t,this.bubble=p.getItem("fish_bubbleUI"),this.bubble||(this.bubble=new Ki.fishxy.animation.fish_dice_bubbleUI),this.bubble.scale(this.bubbleTransform[2],this.bubbleTransform[2]),this.bubble.zOrder=this.zOrder+.1,this.fish.parent.addChild(this.bubble))}},{key:"playAnimation",value:function(e,t,i){this.fish[e].play(t,i),this.shadow[e].play(t,i)}},{key:"getAnimation",value:function(e){return this.fish[e]}},{key:"stopAnimation",value:function(e){this.fish[e].stop(),this.shadow[e].stop()}},{key:"addToParent",value:function(e){this.fish.zOrder=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,e.addChild(this.fish),e.addChild(this.shadow)}},{key:"removeSelf",value:function(){this.fish.removeSelf(),this.shadow.removeSelf(),this.bubble&&(this.bubble.removeSelf(),p.recover("fish_bubbleUI",this.bubble),this.bubble=null)}},{key:"x",get:function(){return this.fish.x},set:function(e){this.fish.x=e,this.shadow.x=e+i.ShadowOffset.x,this.bubble&&(this.bubble.x=e+this.bubbleTransform[0])}},{key:"y",get:function(){return this.fish.y},set:function(e){this.fish.y=e,this.shadow.y=e+i.ShadowOffset.y,this.bubble&&(this.bubble.y=e+this.bubbleTransform[1])}},{key:"rotation",get:function(){return this.fish.rotation},set:function(e){this.fish.rotation=e,this.shadow.rotation=e}},{key:"scaleX",get:function(){return this.fish.scaleX},set:function(e){this.fish.scaleX=e,this.shadow.scaleX=e}},{key:"scaleY",get:function(){return this.fish.scaleY},set:function(e){this.fish.scaleY=e,this.shadow.scaleY=e}},{key:"pos",value:function(e,t){this.fish.pos(e,t),this.shadow.pos(e+i.ShadowOffset.x,t+i.ShadowOffset.y),this.bubble&&this.bubble.pos(e,t)}},{key:"scale",value:function(e,t){this.fish.scale(e,t),this.shadow.scale(e,t)}},{key:"zOrder",get:function(){return this.fish.zOrder},set:function(e){this.fish.zOrder=e,this.bubble&&(this.bubble.zOrder=e+.1)}},{key:"alpha",get:function(){return this.fish.alpha},set:function(e){this.fish.alpha=e}},{key:"filters",set:function(e){this.fish.filters=e}},{key:"addChild",value:function(e){return this.fish.addChild(e)}},{key:"addComponent",value:function(e){return this.fish.addComponent(e)}},{key:"getChildByName",value:function(e){return this.fish.getChildByName(e)}}]),i}(),Eo=(Mo.ShadowOffset=new ie(-20,-20),Mo.ShadowZOrder=-100,function(){function u(){b(this,u)}return y(u,null,[{key:"randString",value:function(){for(var e="",t=1;t<=32;t++)e+=Math.floor(16*Math.random()).toString(16),8!=t&&12!=t&&16!=t&&20!=t||(e+="-");return e}},{key:"formatNumber",value:function(e){var t,i;return 1e4<=e&&e<1e8?(t=Math.floor(e/1e4).toString().length,0<=(i=(e/1e4).toString()).indexOf(".")&&t<=4&&(i=i.substring(0,i.lastIndexOf(".")+(5-t))),parseFloat(i)+"万"):1e8<=e?(t=Math.floor(e/1e8).toString().length,0<=(i=(e/1e8).toString()).indexOf(".")&&t<=4&&(i=i.substring(0,i.lastIndexOf(".")+(5-t))),parseFloat(i)+"亿"):""+e}},{key:"formatNumber2",value:function(e){return u.toThousands(Number(e).toFixed(2))}},{key:"toThousands",value:function(e){for(var t=Number(e)<0,i=[],e=e.toString().replace("-","").split("."),n=e[0].split("").reverse(),e="00"==e[1]||null==e[1]?"":"."+e[1],a=0;a<n.length;a++)0!=a&&a%3==0&&i.unshift(","),i.unshift(n[a]);e=i.join("")+e;return t?"-"+e:e}},{key:"hidePhoneNumber",value:function(e){var t=e.toString();return isNaN(Number(e))||11!=t.length?t:"****"+t.substr(7,4)}},{key:"tofixNumber",value:function(e){if(void 0===e)return"";if(null===e)return"";var e=Number(Number(e).toFixed(2)),t=Number(e.toFixed(0)),i=Number(e.toFixed(1)),e=Number(e.toFixed(2));return(t==i&&t==e?t:i==e?i:e).toString()}},{key:"tweenNumber",value:function(a,s,r){var e=this,t=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1e3,i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:50,o=5<arguments.length?arguments[5]:void 0;if(s!=r)for(var h=s,l=Math.floor(t/i),n=(void 0===o&&(r<=1||r!=Math.floor(r))&&(o=2),0);n<l;n++)!function(n){a.timer.once(n*i,e,function(){var e,t,i;h+=(r-s)/l,a.text=u.toThousands(h.toFixed(o)),n==l-1&&(e=Number(r.toFixed(0)),t=Number(r.toFixed(1)),i=Number(r.toFixed(2)),a.text=u.toThousands(e==t&&e==i||0==o?e:t==i||1==o?t:r.toFixed(o)))})}(n)}}]),u}()),Ro=function(){function e(){b(this,e)}return y(e,null,[{key:"init",value:function(){var e=this;o.stage.on(Me.FOCUS,this,function(){e.isPlayingBeHited=!1,e.curMusic&&0==yi.musicPosition&&e.playMusic(e.curMusic,!0)})}},{key:"playMusic",value:function(e,t){this.curMusic==e&&!t||(this.curMusic=e,yi.playMusic("res/fishxy/sound/"+e,0))}},{key:"playBeHit",value:function(e){var t=this;this.isPlayingBeHited||(this.isPlayingBeHited=!0,u.timerOnce(2e3,this,function(){t.isPlayingBeHited=!1}),yi.playSound("res/fishxy/sound/"+e,1))}},{key:"playSound",value:function(e){yi.playSound("res/fishxy/sound/"+e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,2<arguments.length?arguments[2]:void 0)}}]),e}(),Ao=(Ro.isPlayingBeHited=!1,(t=wo=wo||{})[t.None=0]="None",t[t.Small=1]="Small",t[t.Medium=2]="Medium",t[t.MediumLarge=3]="MediumLarge",t[t.Large=4]="Large",t[t.Special=5]="Special",t[t.Boss=6]="Boss",wo),Lo=function(){f(i,Yr);var t=T(i);function i(){var e;return b(this,i),(e=t.apply(this,arguments)).redFilter1=new Te([1,0,0,0,255,0,.7,0,0,0,0,0,.7,0,0,0,0,0,1,0]),e.redFilter2=new Te([1,0,0,0,255,0,.5,0,0,0,0,0,.5,0,0,0,0,0,1,0]),e.shadowFilter=new Te([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.6,0]),e}return y(i,[{key:"load",value:function(e){this.timer=new Oi,this.define=e;var t=new Ki.fishxy.animation.fish[e.model+"UI"],e=new Ki.fishxy.animation.fish[e.model+"UI"];e.filters=[this.shadowFilter],this.sprite=new Mo(t,e),this.script=this.sprite.addComponent(To)}},{key:"init",value:function(){this.lifeState=Io.Init,this.sprite.addToParent(d.I.view.fish_layer),this.sprite.zOrder=this.define.fishid,this.resetModel(),this.script.init(this)}},{key:"setDice",value:function(e){this.sprite.setDice(e,this.define.bulle_transform)}},{key:"resetModel",value:function(){this.sprite.filters=[],this.sprite.pos(0,0),this.sprite.scale(1,1),this.sprite.rotation=0,this.sprite.alpha=1,this.alreadyChangePathScale=!1}},{key:"setCurveClip",value:function(e){this.curveClip=e}},{key:"hit",value:function(e){this.setHitedColor1(),this.timer.clear(this,this.setHitedColor2),this.timer.once(200,this,this.setHitedColor2),this.timer.clear(this,this.setColorNormal),this.timer.once(400,this,this.setColorNormal)}},{key:"setHitedColor1",value:function(){this.sprite.filters=[this.redFilter1]}},{key:"setHitedColor2",value:function(){this.sprite.filters=[this.redFilter2]}},{key:"setColorNormal",value:function(){this.sprite.filters=[]}},{key:"stopMove",value:function(){this.curveClip&&(this.curveClip.onTargetDestroy(),this.curveClip=null)}},{key:"die",value:function(e){this.setDie(),this.playDieSound(e),this.playDieEffectAndDestroy()}},{key:"setDie",value:function(){this.lifeState=Io.Died,this.event(Io.Died),this.stopMove()}},{key:"playDieSound",value:function(e){e&&e.isSelf&&(e=1==(e=br.randInt(1,31).toString()).length?"0"+e:e,this.define.kind==Ao.Small&&Math.random()<.2||this.define.kind==Ao.Medium&&Math.random()<.4||this.define.kind==Ao.MediumLarge&&Math.random()<.8||this.define.kind==Ao.Large||this.define.kind==Ao.Medium&&Math.random()<.4?Ro.playBeHit("XYFishwords_W_0"+e+".mp3"):this.define.fishid>=So.Jgb&&this.define.fishid<=So.Jclj?Ro.playSound("SFX_UI_031.mp3"):this.define.fishid==So.Flash?Ro.playSound("SFX_UI_040.mp3"):this.define.fishid==So.Boom?Ro.playSound("SFX_UI_029.mp3"):this.define.fishid==So.Boss&&Ro.playBeHit("XYFishwords_MB_06.mp3"))}},{key:"playDieEffectAndDestroy",value:function(){this.sprite.stopAnimation("ani1");var e,t=Y(this.define.die_effect);try{for(t.s();!(e=t.n()).done;)switch(e.value){case"none":this.destroy();break;case"blink":this.blinkDie();break;case"zoom_out":this.zoomOutDie();break;case"rotate_fade_out":this.rotateFadeOutDie();break;case"shake_zoom_out":this.shakeZoomOutDie();break;case"blue_explode":this.explodeDie(this.position,"blue");break;case"boom_explode":this.boomDie();break;case"dragon_box_explode":this.dragonBoxDie();break;case"shake_scene":d.I.shakeScene();break;case"flash":this.flashDie()}}catch(e){t.e(e)}finally{t.f()}}},{key:"blinkDie",value:function(){var e=this;Ci.to(this.sprite,{alpha:0},200,null,x.create(this,function(){Ci.to(e.sprite,{alpha:1},200,null,x.create(e,function(){Ci.to(e.sprite,{alpha:0},200,null,x.create(e,function(){Ci.to(e.sprite,{alpha:1},200,null,x.create(e,function(){Ci.to(e.sprite,{alpha:0},200,null,x.create(e,e.destroy))}))}))}))}))}},{key:"zoomOutDie",value:function(){Ci.to(this.sprite,{scaleX:0,scaleY:0},300,null,x.create(this,this.destroy))}},{key:"rotateFadeOutDie",value:function(){var e=this;Ci.to(this.sprite,{rotation:this.sprite.rotation+360},500,null,x.create(this,function(){Ci.to(e.sprite,{alpha:0},300,null,x.create(e,e.destroy))}))}},{key:"shakeZoomOutDie",value:function(){var e=this,t=this.sprite.rotation;Ci.to(this.sprite,{rotation:t+60},150,null,x.create(this,function(){Ci.to(e.sprite,{rotation:t},150,null,x.create(e,function(){Ci.to(e.sprite,{rotation:t+60},150,null,x.create(e,function(){Ci.to(e.sprite,{rotation:t},150,null,x.create(e,function(){Ci.to(e.sprite,{rotation:t+60},150,null,x.create(e,function(){Ci.to(e.sprite,{rotation:t},150,null,x.create(e,function(){Ci.to(e.sprite,{scaleX:0,scaleY:0},150,null,x.create(e,e.destroy))}))}))}))}))}))}))}},{key:"explodeDie",value:function(e,t){if(!(i=p.getItem(t+"_explode")))for(var i=new N,n=0;n<12;n++){var a=new h("fishxy/animation/gun/normal/net/"+t+"_explode.png");a.anchorY=.5,a.rotation=30*n,i.addChild(a)}for(n=0;n<12;n++){var s=i.getChildAt(n),r=(s.pos(0,0),200*Math.cos(s.rotation/180*Math.PI)),o=200*Math.sin(s.rotation/180*Math.PI);Ci.to(s,{x:r,y:o},300,null,x.create(this,function(e){0==e&&(i.removeSelf(),p.recover(t+"_explode",i))},[n]))}i.pos(e.x,e.y),d.I.view.ui_effect_layer.addChild(i)}},{key:"flashDie",value:function(){var e=this,t=p.getItem("flash_die_effect");(t=t||new Ki.fishxy.animation.dldby_flash_eff1UI).pos(this.sprite.x,this.sprite.y),d.I.view.ui_effect_layer.addChild(t),t.ani1.play(0,!1),t.ani1.once(Me.COMPLETE,this,function(){e.destroy(),t.removeSelf(),p.recover("boom_die_effect",t)})}},{key:"boomDie",value:function(){this.destroy();var e=p.getItem("boom_die_effect");(e=e||new Ki.fishxy.animation.boom_die_effUI).pos(this.sprite.x,this.sprite.y),d.I.view.ui_effect_layer.addChild(e),e.ani1.play(0,!1),e.ani1.once(Me.COMPLETE,this,function(){e.removeSelf(),p.recover("boom_die_effect",e)})}},{key:"dragonBoxDie",value:function(){this.destroy();var e=p.getItem("jp_die_effect");(e=e||new Ki.fishxy.animation.dragon_box_die_effUI).pos(this.sprite.x,this.sprite.y),d.I.view.ui_effect_layer.addChild(e),e.ani1.play(0,!1),e.ani1.once(Me.COMPLETE,this,function(){e.removeSelf(),p.recover("jp_die_effect",e)})}},{key:"showUICoin",value:function(e,t){e.isSelf&&Ro.playSound("SFX_UI_025.mp3");var i=p.getItem("ui_die_effect");(i=i||new Ki.fishxy.animation.dldby_fish_die_uiUI).rate.font="bmfont_bigWin.fnt",i.rate.text="X"+t,i.fish_name.skin="fishxy/animation/common/fish_name_"+this.define.fishid+"_Cn.png",i.pos(e.fishDieUIPosition.x,e.fishDieUIPosition.y),i.ani1.play(0,!1),i.ani1.offAll(),i.ani1.once(Me.COMPLETE,this,function(){i.removeSelf(),p.recover("ui_die_effect",i)}),d.I.view.ui_effect_layer.addChild(i)}},{key:"showDiceLottery",value:function(e,t,i){var n=this,a=p.getItem("fish_die_diceUI");(a=a||new Ki.fishxy.animation.fish_die_diceUI).score.font="bmfont_pickFish.fnt",a.score.text="+"+Eo.tofixNumber(t/i),a.mult.font="bmfont_jiangchiZi.fnt",a.mult.text="x"+i,a.pos(e.fishDieUIPosition.x,e.fishDieUIPosition.y),a.dice.roll.play(0,!1),a.dice.roll.once(Me.COMPLETE,this,function(){a.dice[i].play(0,!1),a.dice.timerOnce(1500,n,function(){a.removeSelf(),p.recover("fish_die_diceUI",a)})}),d.I.view.ui_effect_layer.addChild(a)}},{key:"showBlueShakeLottery",value:function(e,t){var i=this,n=p.getItem("blue_shake_lotteryUI");if(!n){(n=new Ki.fishxy.animation.blue_shake_lotteryUI).list.vScrollBarSkin="",n.list.array=[];for(var a=0;a<10;a++)n.list.array=n.list.array.concat([50,75,100,125,150]);n.list.renderHandler=new x(this,function(e){e.getChildByName("score").text="x "+e.dataSource,e.getChildByName("score").font="bmfont_bigCoin.fnt"})}d.I.view.ui_effect_layer.addChild(n),n.pos(e.fishDieUIPosition.x,e.fishDieUIPosition.y),n.list.scrollTo(0);e=n.list.array.lastIndexOf(t)-7;n.list.tweenTo(e,3e3,x.create(this,function(){n.timer.once(1500,i,function(){n.removeSelf(),p.recover("blue_shake_lotteryUI",n)})}),Ti.expoOut)}},{key:"setUnCalculate",value:function(){this.curFrameHasCalFishCollider=!1}},{key:"fishColliderArr",get:function(){if(!this._fishColliderArr){this._fishColliderArr=[];var e,t=this.sprite.getChildByName("collider"),i=Y(0<t._children.length?t._children:[t]);try{for(i.s();!(e=i.n()).done;){var n=e.value,a=new Co;a.shape=n,a.raduis=a.shape.width/2,this._fishColliderArr.push(a)}}catch(e){i.e(e)}finally{i.f()}}if(!this.curFrameHasCalFishCollider){var s,r=Y(this._fishColliderArr);try{for(r.s();!(s=r.n()).done;)s.value.cacularteWorldPosition()}catch(e){r.e(e)}finally{r.f()}this.curFrameHasCalFishCollider=!0,this.timer.callLater(this,this.setUnCalculate)}return this._fishColliderArr}},{key:"collider",get:function(){var e,t=Y(this.fishColliderArr);try{for(t.s();!(e=t.n()).done;){var i=e.value;if(i.isInScreen)return i}}catch(e){t.e(e)}finally{t.f()}}},{key:"position",get:function(){return this.fishColliderArr[0].position}},{key:"playAnimation",value:function(e,t,i){this.sprite.playAnimation(e,t,i)}},{key:"stopAnimation",value:function(e){this.sprite.stopAnimation(e)}},{key:"getAnimation",value:function(e){return this.sprite.getAnimation(e)}},{key:"updateTransform",value:function(e,t){this.sprite.x=(e.x+8)/16*u.width,this.sprite.y=(4.5-e.y)/9*u.height,d.I.isMirror&&(this.sprite.y+=2*(u.height/2-this.sprite.y)),this.define.rotation&&(this.sprite.rotation=d.I.isMirror?t.z:-t.z,this.alreadyChangePathScale||(this.alreadyChangePathScale=!0,this.sprite.scaleY=this.sprite.x>u.width/2?-1:1))}},{key:"showFlashBubble",value:function(){var e=p.getItem("flash_effect1");(e=e||new Ki.fishxy.animation.dldby_flash_eff2UI).pos(this.position.x,this.position.y),e.ani1.play(0,!1),e.ani1.once(Me.COMPLETE,this,function(){e.removeSelf(),p.recover("flash_effect1",e)}),d.I.view.fight_layer.addChild(e)}},{key:"showLineRender",value:function(t){var i=this,n=p.getItem("flash_line"),e=((n=n||new Ki.fishxy.animation.dldby_flash_lineUI).ani1.play(0,!0),n.ani1.once(Me.COMPLETE,this,function(){n.timer.clear(i,e),n.removeSelf(),p.recover("flash_effect1",n)}),d.I.view.fight_layer.addChild(n),function(){n.pos(i.position.x,i.position.y);var e=i.position.distance(t.position.x,t.position.y);n.scaleX=e/311,n.rotation=br.twoPointAngle(i.position.x,i.position.y,t.position.x,t.position.y)});n.timer.frameLoop(1,this,e)}},{key:"showCoin",value:function(r,e){for(var t,o=this,h=(r.isSelf&&0<this.define.die_coin_num&&Ro.playSound("SFX_UI_023.mp3"),new Array),i=0;i<this.define.die_coin_num;i++)!function(e){var t=e%2==0?1:0,e=(2!=r.member.position&&3!=r.member.position||(t=e%2),Math.floor(e/2)),i=p.getItem("dldby_jinbi_eff"),n=((i=i||new Ki.fishxy.animation.dldby_jinbi_effUI).t.gray=!r.isSelf,h.push(i),i.scale(.8,.8),o.position.x+50*e),a=o.position.y+60*t,s=a+(0==t?-80:80);i.timer.once(80*e,o,function(){d.I.view.ui_layer.addChild(i),i.pos(n,a),Ci.from(i,{y:s},1e3,Ti.elasticOut)})}(i);u.timer.once(this.define.die_coin_num/2*80+1200,this,function(){for(var e=0;e<h.length;e++)!function(e){var t=h[e],i=r.coinPosition.distance(t.x,t.y);Ci.to(t,{x:r.coinPosition.x,y:r.coinPosition.y,scaleX:.6,scaleY:.6},i,null,x.create(o,function(){t.removeSelf(),p.recover("dldby_jinbi_eff",t),r.coinSprite.scale(1.5,1.5),Ci.to(r.coinSprite,{scaleX:1,scaleY:1},100)}),50*e)}(e)}),0<e&&r.isSelf&&((t=p.getItem("fish_die_label"))||((t=new Sn).width=200,t.align="center",t.anchorX=t.anchorY=.5,t.font="bmfont_bigCoin.fnt"),d.I.view.fight_layer.addChild(t),t.text="+"+Eo.tofixNumber(e),t.pos(this.position.x,this.position.y),Ci.to(t,{y:this.position.y-100},1e3,Ti.elasticOut,x.create(this,function(){Ci.to(t,{y:o.position.y-200,alpha:0},1e3,null,x.create(o,function(){t.alpha=1,t.removeSelf(),p.recover("fish_die_label",t)}),100)})))}},{key:"isSpecialFish",get:function(){return this.define.fishid==So.Jgb||this.define.fishid==So.Xmsb||this.define.fishid==So.Ffwb||this.define.fishid==So.Jclj}},{key:"pathOver",value:function(){this.destroy()}},{key:"destroy",value:function(){var e=this;Oo.I.removeFish(this),this.lifeState=Io.Destroy,this.event(Io.Destroy,this),this.offAll(),_.event.event(Io.Destroy,this),_.event.offAllCaller(this),this.curveClip=null,this.timer.clearAll(this),this.sprite.removeSelf(),this.timer.once(5e3,this,function(){Oo.I.recycleFish(e)})}}]),i}(),No=function(){function e(){b(this,e)}return y(e,null,[{key:"getDeviceId",value:function(){var e=Si.getItem("deviceId");return e||(e=Eo.randString(),Si.setItem("deviceId",e)),e}},{key:"randomDeviceId",value:function(){for(var e,t="h5_",i=0;i<32;i++)e=0==parseInt(""+2*Math.random())?parseInt(""+26*Math.random())+97:parseInt(""+10*Math.random())+48,t+=String.fromCharCode(e);return t}},{key:"urlPathName",value:function(e){var e=e.split("//"),t=e[1].indexOf("/");return e[1].substring(t+1)}},{key:"getUrlParam",value:function(e){var t={},i=((1<arguments.length&&void 0!==arguments[1]?arguments[1]:null)||window.location.href).split("?");if(1<i.length)for(var n=i[1].split("&"),a=0;a<n.length;++a){var s=n[a].split("=");t[s[0]]=s[1]}return t.hasOwnProperty(e)?t[e]:null}},{key:"getParentUrl",value:function(){var t="";if(parent!==window)try{t=parent.location.href}catch(e){t=document.referrer}return t}}]),e}(),Po=function(){function h(){b(this,h)}return y(h,null,[{key:"isContainChinese",value:function(e){return/[\u4E00-\u9FA5\uF900-\uFA2D]/.test(e)}},{key:"getStringWidth",value:function(e,t){30===t&&(i=17,n=19,a=30);for(var i,n,a,s=0,r=0;r<e.length;r++)h.isContainChinese(e[r])?s+=a:e[r].toUpperCase()==e[r]?s+=n:s+=i;return s}},{key:"getStringLength",value:function(e){for(var t=0,i=0;i<e.length;i++)h.isContainChinese(e[i])?t+=2:t+=1;return t}},{key:"briefString",value:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"...";if(!e)return"";var n,a="",s=0,r=Y(e.split(""));try{for(r.s();!(n=r.n()).done;){var o=n.value;if(t<s){a+=i;break}a+=o,h.isContainChinese(o)?s+=2:s+=1}}catch(e){r.e(e)}finally{r.f()}return a}},{key:"endWith",value:function(e,t){var i=e.length-t.length;return 0<=i&&e.lastIndexOf(t)==i}},{key:"getCenterStarString",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:9;return e?"1"!=No.getUrlParam("bb",No.getParentUrl())&&e==_.data.account.nickname?t<e.length?e.substr(0,t)+"...":e:"****"+e.substr(Math.max(e.length-4,0),4):""}}]),h}(),Bo=function(){f(a,Lo);var e=T(a);function a(){return b(this,a),e.apply(this,arguments)}return y(a,[{key:"init",value:function(){var e=this;m(g(a.prototype),"init",this).call(this),this.initUI(),this.timer.once(500,this,this.showUI),this.playBossAnimation("show"),this.getAnimation("show").once(Me.COMPLETE,this,function(){e.playBossAnimation("move")}),Ro.playSound("XYFishwords_MB_01.mp3"),Ro.playMusic("BGM_004.mp3")}},{key:"initUI",value:function(){this.ui||(this.ui=new Ki.fishxy.animation.fish.YU034_UIUI,this.ui.anchorX=.5,this.ui.time.font="bmfont_bossTime.fnt",this.ui.blood.font="bmfont_bossZi.fnt"),this.ui.visible=!1,this.ui.time.text="300",this.setHp(this.hp),d.I.view.fight_layer.addChild(this.ui)}},{key:"showUI",value:function(){this.ui.visible=!0,this.timer.loop(1,this,this.updateUITransform),this.timer.loop(1e3,this,this.updateTime)}},{key:"updateUITransform",value:function(){this.ui.pos(this.position.x,this.position.y-340)}},{key:"updateTime",value:function(){Number(this.ui.time.text)<=0||(this.ui.time.text=(Number(this.ui.time.text)-1).toString())}},{key:"pathOver",value:function(){this.runAway()}},{key:"runAway",value:function(){var e=this;Ro.playSound("SFX_UI_038.mp3"),this.playBossAnimation("hide"),this.getAnimation("hide").once(Me.COMPLETE,this,function(){e.showBossWin("run_away",null,null,100*e.hp),e.destroy()}),this.lifeState=Io.RunAway,this.ui.visible=!1}},{key:"hit",value:function(e){var t=this;m(g(a.prototype),"hit",this).call(this,e),this.sprite.stopAnimation("move"),this.getAnimation("hit").isPlaying||(this.playBossAnimation("hit"),this.getAnimation("hit").offAllCaller(this),this.getAnimation("hit").once(Me.COMPLETE,this,function(){t.playBossAnimation("move")})),e&&e.isSelf&&Math.random()<.1&&Ro.playBeHit("XYFishwords_MB_0"+br.randInt(3,5)+".mp3")}},{key:"die",value:function(){var e=this;this.setDie(),this.playBossAnimation("die"),this.getAnimation("die").once(Me.COMPLETE,this,function(){e.showBossWin("die",e.killUser.member.nickname,e.killScore),e.destroy()})}},{key:"setHp",value:function(e){e<0||(this.hp=e,this.ui.blood.text=Math.ceil(100*e)+"%",this.ui.blood_panel.width=340*e,this.ui.getChildByName("box_90").visible=.9<=e,this.ui.getChildByName("box_70").visible=.7<=e,this.ui.getChildByName("box_40").visible=.4<=e,this.ui.getChildByName("box_1").visible=.01<=e)}},{key:"setRemainTime",value:function(e){this.ui.time.text=e.toString()}},{key:"showBossWin",value:function(e,t,i,n){a.bossWin||((a.bossWin=new Ki.fishxy.fight.BossWinDialogUI).exact_coin.font="bmfont_bigCoin.fnt",a.bossWin.die_coin.font="bmfont_bigCoin.fnt",a.bossWin.remain_blood.font="bmfont_bossTime.fnt"),a.bossWin.die.visible="die"==e,a.bossWin.die_nickname.text=Po.getCenterStarString(t),a.bossWin.die_coin.text=Eo.tofixNumber(i),a.bossWin.run_away.visible="run_away"==e,a.bossWin.remain_blood.text=Eo.tofixNumber(n)+"%",a.bossWin.exact.visible="exact"==e,a.bossWin.exact_coin.text=Eo.tofixNumber(i),a.bossWin.popup(),a.bossWin.timer.once(3e3,a.bossWin,a.bossWin.close)}},{key:"playBossAnimation",value:function(e,t,i){this.lifeState!=Io.RunAway&&(m(g(a.prototype),"stopAnimation",this).call(this,"die"),m(g(a.prototype),"stopAnimation",this).call(this,"move"),m(g(a.prototype),"stopAnimation",this).call(this,"show"),m(g(a.prototype),"stopAnimation",this).call(this,"hit"),m(g(a.prototype),"stopAnimation",this).call(this,"hide"),m(g(a.prototype),"playAnimation",this).call(this,e,t,i))}},{key:"destroy",value:function(){m(g(a.prototype),"destroy",this).call(this),this.ui&&this.ui.removeSelf(),Ro.playMusic("BGM_003.mp3")}}]),a}(),Do=function(){f(t,Lo);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"init",value:function(){m(g(t.prototype),"init",this).call(this),this.playAnimation("ani1",0,!0)}}]),t}(),Oo=function(){function n(){b(this,n),this.fishes=new Array,this.enterScreenFishes=new Array,this.aa=!1}return y(n,[{key:"init",value:function(){this.initPath()}},{key:"initPath",value:function(){this.fishPathManager=d.I.view.addComponent(Wr),Wr.load()}},{key:"addRoute",value:function(e){var t,i=Y(e);try{for(i.s();!(t=i.n()).done;){var n=t.value,a=(_.DEBUG,void 0);if(a=1e3<n.target_conf.target_path_id?(n.target_conf.target_path_id-=1e3,Wr.createArrayByName(n.target_conf.target_path_id.toString())):Wr.createPathByName(n.target_conf.target_path_id.toString())){this.fishPathManager.addFishPath(a);for(var s=0,r=0;r<a.getCutsceneCount();r++){var o=a.getCutscene(r);0<o.getTotalTime()-n.target_conf.use_time?o.continue(-n.target_conf.use_time):o.play();for(var h=0;h<o.curves.length;h++,s++){if(s>=n.target_infos.length)return;if(!n.target_infos[s].is_dead){var l=o.curves[h],u=parseInt(l.targetName);if(!(null==u||NaN==u||u<1)){var c=this.getFishInPool(u);if(!c)return void console.warn("can't load fishid:"+u);this.fishes.push(c),c.uniqueId=n.target_infos[s].target_id,0<n.target_infos[s].state_infos.length?c.setDice(7==n.target_infos[s].state_infos[0].state_id):c.setDice(!1),c instanceof Bo&&(c.setHp(n.target_infos[s].target_blood),c.setRemainTime(o.getTotalTime()-n.target_conf.use_time)),l.setTarget(c),c.setCurveClip(l),o.setEventTarget(c)}}}}}else console.warn("can't find route ",n.target_conf.target_path_id)}}catch(e){i.e(e)}finally{i.f()}}},{key:"sweepFish",value:function(e){var t=this.getFishByUniqueId(e.boom_id),i=this.getFishByUniqueId(e.target_id);t&&i&&(t.define.fishid==So.Flash&&t.showLineRender(i),i.showFlashBubble(),e.target_dead&&(t=d.I.getUser(e.uid),i.die(t)))}},{key:"bossWarning",value:function(e){if(1==e.screen_level){var t,i=Y(this.fishPathManager.fishPathes);try{for(i.s();!(t=i.n()).done;){var n,a=Y(t.value.cutscenes);try{for(a.s();!(n=a.n()).done;)n.value.setSpeed(15)}catch(e){a.e(e)}finally{a.f()}}}catch(e){i.e(e)}finally{i.f()}d.I.changeBackground(3e3),d.I.showFishArrayComingEffect()}else 2==e.screen_level&&d.I.showBossComing()}},{key:"getFishInPool",value:function(t){var e=kr.getItem(n.FishPoolSign+t);if(e)return e.init(),e;var i=o.loader.getRes(wr.FISH_DEFINE_CONF).find(function(e){if(e.fishid==t)return!0});return null==i?null:((e=new(t===So.Boss?Bo:Do)).load(i),e.init(),e)}},{key:"getFishByUniqueId",value:function(t){return this.fishes.find(function(e){return e.uniqueId==t})}},{key:"removeFish",value:function(t){this.fishes.remove(function(e){return e.uniqueId==t.uniqueId}),this.enterScreenFishes.remove(function(e){return e.uniqueId==t.uniqueId})}},{key:"recycleFish",value:function(e){kr.recover(n.FishPoolSign+e.define.fishid,e)}},{key:"removeAllFish",value:function(){this.fishPathManager.clear();var e,t=Y(this.fishes.concat());try{for(t.s();!(e=t.n()).done;)e.value.destroy()}catch(e){t.e(e)}finally{t.f()}this.fishes=[]}},{key:"getResource",value:function(){return[new ha(wr.FISH_DEFINE_CONF),new ha(Wr.resourceFishPath),new ha(Wr.resourceFishArray)]}},{key:"destroy",value:function(){}}],[{key:"I",get:function(){return this._instance||(this._instance=new n),this._instance}}]),n}(),Fo=(Oo.FishPoolSign="FishPoolSign_FishId_",y(function e(){b(this,e)})),Vo=function(){f(n,Fo);var i=T(n);function n(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new mi;return b(this,n),(e=i.call(this))._bytes=t,e._bytes.endian="BIG_ENDIAN",e}return y(n,[{key:"readInt64",value:function(){var e=this._bytes.readUint32().toString(16),t="00000000".substr(0,8-e.length)+e,e=this._bytes.readUint32().toString(16);return t+="00000000".substr(0,8-e.length)+e,Number(parseInt(t,16).toString())}},{key:"writeInt64",value:function(e){e=e.toString(16),e="00000000".substr(0,16-e.length)+e;this._bytes.writeUint32(parseInt(e.substr(0,8),16)),this._bytes.writeUint32(parseInt(e.substr(8,8),16))}},{key:"readBoolean",value:function(){return 0!=this._bytes.readByte()}},{key:"writeBoolean",value:function(e){e?this._bytes.writeByte(1):this._bytes.writeByte(0)}}]),n}(),Uo=(s([Or()],Vo.prototype,"_bytes",void 0),function(){f(t,Vo);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t)}()),c=function(){f(t,Vo);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t)}(),zo=((e=Hr=Hr||{}).name="game",n=function(){f(t,Uo);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"encode",value:function(){var e=Date.now().toString();this.ping_id=Number(e.substr(5)),this._bytes.clear(),this._bytes.writeInt32(this.ping_id)}}]),t}(),n=s([Fr(e.name),r(20189)],n),e.GameHeartReq=n,n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.ping_id=this._bytes.readInt32()}}]),t}(),n=s([Fr(e.name),r(20190),Ur(!1)],n),e.GameHeartResp=n,n=function(){f(t,Uo);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"encode",value:function(){this._bytes.writeInt32(this.v3)}}]),t}(),n=s([Fr(e.name),r(5006)],n),e.GameValidateReq=n,n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.v1=this._bytes.readInt32(),this.v2=this._bytes.readInt32()}}]),t}(),n=s([Fr(e.name),r(5006)],n),e.GameValidateResp=n,n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.vesion=this._bytes.readUTFString()}}]),t}(),n=s([Fr(e.name),r(9999)],n),e.GameVersionResp=n,n=function(){f(i,Uo);var t=T(i);function i(){var e;return b(this,i),(e=t.apply(this,arguments)).roomid=0,e}return y(i,[{key:"encode",value:function(){this._bytes.writeInt32(this.roomid)}}]),i}(),n=s([Fr(e.name),r(5001)],n),e.GameRoomIdReq=n,n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){}}]),t}(),n=s([Fr(e.name),r(5001)],n),e.GameRoomIdResp=n,n=function(){f(t,Uo);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"encode",value:function(){this._bytes.writeInt32(this.userid),this._bytes.writeUTFString(this.password),this._bytes.writeByte(this.client_type),this._bytes.writeUTFString(this.client_info),this._bytes.writeByte(this.version),this.writeBoolean(this.fixseat),this._bytes.writeUTFString(this.dbname),this.writeInt64(this.first_money),this._bytes.writeInt32(this.roomid),this._bytes.writeUTFString(this.linecode),this._bytes.writeInt32(this.all_npc)}}]),t}(),n=s([Fr(e.name),r(20100)],n),e.GameLoginReq=n,n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.id=this._bytes.readInt32(),this.into_money=this._bytes.readFloat64(),this.is_award=this._bytes.readByte(),this.re_enter=this.readBoolean(),this.showdouble=this._bytes.readByte()}}]),t}(),n=s([Fr(e.name),r(20105)],n),e.LoginSuccessResp=n,n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.error=this._bytes.readInt16(),this.body=this._bytes.readInt16(),this.infos=[];for(var e=this._bytes.readInt16();e--;)this.infos.push(this._bytes.readUTFString())}}]),t}(),n=s([Fr(e.name),r(20149)],n),e.GameLoginFailResp=n,n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.money=this._bytes.readFloat64(),this.money=parseFloat(this.money.toFixed(2)),this.result=this._bytes.readUTFString()}}]),t}(),n=s([Fr(e.name),r(20106)],n),e.UpdateIntomoney=n,n=function(){f(t,Uo);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"encode",value:function(){}}]),t}(),n=s([Fr(e.name),r(20102),tn.metadata("Priority",50)],n),e.GameQuitReq=n,n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.desk_uuid=this._bytes.readUTFString()}}]),t}(),n=s([Fr(e.name),r(20181)],n),e.GameExtrainfo=n,n=function(){f(t,Uo);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"encode",value:function(){this._bytes.writeInt16(this.tableId),this._bytes.writeByte(this.sitIndex)}}]),t}(),n=s([Fr(e.name),r(20103)],n),e.GameSitReq=n,jr=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.userName=this._bytes.readUTFString(),this.roomName=this._bytes.readUTFString(),this.enterMoney=this._bytes.readInt32(),this.dizhu=this._bytes.readInt32(),this.isScore=this.readBoolean(),this.isShow=this._bytes.readUTFString(),this.tableId=this._bytes.readInt32()}}]),t}(),e.DeskMatchInfos=jr,qr=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.uid=this._bytes.readInt32(),this.headid=this._bytes.readInt16()}}]),t}(),e.SeatInfo=qr,n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.tableId=this._bytes.readInt16(),this.isPlaying=this.readBoolean(),this.matchInfos=new jr(this._bytes),this.matchInfos.decode(),this.seatInfos=[];for(var e=this._bytes.readInt16();e--;){var t=new qr(this._bytes);t.decode(),this.seatInfos.push(t)}this.isPassWord=this.readBoolean()}}]),t}(),e.DeskInfo=n,n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.userid=this._bytes.readInt32(),this.nickname=this._bytes.readUTFString(),this.avatar_no=this._bytes.readInt16(),this.level=this._bytes.readInt16(),this.into_money=this._bytes.readFloat64(),this.netspeed=this._bytes.readInt32(),this.deskno=this._bytes.readInt16(),this.win_times=this._bytes.readInt32(),this.lose_times=this._bytes.readInt32(),this.winning=this._bytes.readByte(),this.vip_level=this._bytes.readInt16()}}]),t}(),e.DeskRankInfovo=n,n=function(){f(t,Uo);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"encode",value:function(){}}]),t}(),n=s([Fr(e.name),r(20161)],n),e.GameReadyReq=n,Kr=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.active_point=this._bytes.readInt32(),this.avatar_img=this._bytes.readUTFString(),this.avatar_no=this._bytes.readInt16(),this.bag_money=this._bytes.readFloat64(),this.bag_money=parseFloat(this.bag_money.toFixed(2)),this.client_address=this._bytes.readUTFString(),this.exp=this._bytes.readInt32(),this.into_money=this._bytes.readFloat64(),this.into_money=parseFloat(this.into_money.toFixed(2)),this.is_staff=this.readBoolean(),this.keynum=this._bytes.readInt32(),this.level=this._bytes.readInt16(),this.lose_times=this._bytes.readInt32(),this.mobile_type=this._bytes.readInt16(),this.nickname=this._bytes.readUTFString(),this.position=this._bytes.readByte(),this.ready=this.readBoolean(),this.uid=this._bytes.readInt32(),this.vip_level=this._bytes.readByte(),this.waiting=this.readBoolean(),this.win_times=this._bytes.readInt32(),this.winning=this._bytes.readInt32(),this.wzcardnum=this._bytes.readInt32(),this.upoint=this._bytes.readInt32(),this.win_rate=this._bytes.readInt32(),this.win_num=this._bytes.readInt32(),this.max_winmoney=this._bytes.readInt32(),this.lose_num=this._bytes.readInt32(),this.max_cards=[];for(var e=this._bytes.readInt16();e--;)this.max_cards.push(this._bytes.readByte());for(this.cannon_type=this._bytes.readInt32(),this.cannon_level=this._bytes.readFloat64(),this.cannon_level=parseFloat(this.cannon_level.toFixed(2)),this.score=this._bytes.readFloat64(),this.score=parseFloat(this.score.toFixed(2)),this.money=this._bytes.readFloat64(),this.money=parseFloat(this.money.toFixed(2)),this.cannons=[],e=this._bytes.readInt16();e--;)this.cannons.push(this._bytes.readFloat64());for(this.is_dummy=this.readBoolean(),this.fast_shoot=this.readBoolean(),this.lock_fish=this._bytes.readInt32(),this.lock_angle=this._bytes.readInt32(),this.is_shoot_stop=this.readBoolean(),this.ip=this._bytes.readUTFString(),this.buttle_num=this._bytes.readInt32(),this.rank=this._bytes.readInt32(),this.jushu=this._bytes.readInt32(),this.myprops=[],e=this._bytes.readInt16();e--;){var t=new Zr(this._bytes);t.decode(),this.myprops.push(t)}}}]),t}(),e.GameMemberInfo=Kr,Qr=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.score=this._bytes.readFloat64(),this.score=parseFloat(this.score.toFixed(2)),this.uid=this._bytes.readInt32(),this.nickname=this._bytes.readUTFString(),this.rank=this._bytes.readInt32()}}]),t}(),e.Top10Info=Qr,Zr=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.pid=this._bytes.readInt32(),this.num=this._bytes.readInt32()}}]),t}(),Jr=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.state_id=this._bytes.readInt32(),this.state_type=this._bytes.readInt32(),this.con_time=this._bytes.readFloat64(),this.con_time=parseFloat(this.con_time.toFixed(2)),this.param_type=this._bytes.readInt32()}}]),t}(),$r=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.magic_id=this._bytes.readInt32(),this.magic_type=this._bytes.readInt32(),this.param_types=[];for(var e=this._bytes.readInt16();e--;)this.param_types.push(this._bytes.readInt32())}}]),t}(),n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.continue_timeout=this._bytes.readByte(),this.init_money=this._bytes.readFloat64(),this.init_money=parseFloat(this.init_money.toFixed(2)),this.max_player_num=this._bytes.readByte(),this.p2p=this._bytes.readByte(),this.top_money=this._bytes.readFloat64(),this.top_money=parseFloat(this.top_money.toFixed(2)),this.unit_money=this._bytes.readFloat64(),this.unit_money=parseFloat(this.unit_money.toFixed(2)),this.memberinfos=[];for(var e=this._bytes.readInt16();e--;){var t=new Kr(this._bytes);t.decode(),this.memberinfos.push(t)}for(this.bb_money=this._bytes.readFloat64(),this.bb_money=parseFloat(this.bb_money.toFixed(2)),this.sb_money=this._bytes.readFloat64(),this.sb_money=parseFloat(this.sb_money.toFixed(2)),this.nolimit=this._bytes.readByte(),this.max_chip=this._bytes.readFloat64(),this.max_chip=parseFloat(this.max_chip.toFixed(2)),this.init_bets=[],e=this._bytes.readInt16();e--;)this.init_bets.push(this._bytes.readFloat64());for(this.level_type=this._bytes.readInt32(),this.cannon_rate=this._bytes.readFloat64(),this.cannon_rate=parseFloat(this.cannon_rate.toFixed(2)),this.cannon_doubles=[],e=this._bytes.readInt16();e--;)this.cannon_doubles.push(this._bytes.readFloat64());for(this.calltype=this._bytes.readInt32(),this.deskno=this._bytes.readInt32(),this.max_bullet_multiple=this._bytes.readFloat64(),this.max_bullet_multiple=parseFloat(this.max_bullet_multiple.toFixed(2)),this.min_bullet_multiple=this._bytes.readFloat64(),this.min_bullet_multiple=parseFloat(this.min_bullet_multiple.toFixed(2)),this.myprops=[],e=this._bytes.readInt16();e--;){var i=new Zr(this._bytes);i.decode(),this.myprops.push(i)}for(this.awards=[],e=this._bytes.readInt16();e--;)this.awards.push(this._bytes.readFloat64());for(this.apply_cost=this._bytes.readFloat64(),this.apply_cost=parseFloat(this.apply_cost.toFixed(2)),this.apply_num=this._bytes.readInt32(),this.need_num=this._bytes.readInt32(),this.buttle_num=this._bytes.readInt32(),this.game_mode=this._bytes.readInt32(),this.apply_surplus=this._bytes.readInt32(),this.step=this._bytes.readInt32(),this.top10=[],e=this._bytes.readInt16();e--;){var n=new Qr(this._bytes);n.decode(),this.top10.push(n)}for(this.round=this._bytes.readInt32(),this.matchtime=this._bytes.readInt32(),this.cn=this._bytes.readInt32(),this.multiple=[],e=this._bytes.readInt16();e--;)this.multiple.push(this._bytes.readFloat64());for(this.title=this._bytes.readUTFString(),this.promotioncn=this._bytes.readInt32(),this.promotion_jushu=this._bytes.readInt32(),this.max_round=this._bytes.readInt32(),this.max_unit_money=this._bytes.readFloat64(),this.max_unit_money=parseFloat(this.max_unit_money.toFixed(2)),this.max_mult=this._bytes.readInt32(),this.min_mult=this._bytes.readInt32(),this.match_type=this._bytes.readInt32(),this.def_cannon=[],e=this._bytes.readInt16();e--;)this.def_cannon.push(this._bytes.readInt32());for(this.def_avatar=[],e=this._bytes.readInt16();e--;)this.def_avatar.push(this._bytes.readFloat64());for(this.cannon_types=[],e=this._bytes.readInt16();e--;)this.cannon_types.push(this._bytes.readInt32());for(this.cannon_levels=[],e=this._bytes.readInt16();e--;)this.cannon_levels.push(this._bytes.readInt32());for(this.avatar_speeds=[],e=this._bytes.readInt16();e--;)this.avatar_speeds.push(this._bytes.readInt32());for(this.avatar_lock_types=[],e=this._bytes.readInt16();e--;)this.avatar_lock_types.push(this._bytes.readInt32());for(this.avatar_props=[],e=this._bytes.readInt16();e--;)this.avatar_props.push(this._bytes.readInt32());for(this.shoot_interval=this._bytes.readFloat64(),this.shoot_interval=parseFloat(this.shoot_interval.toFixed(2)),this.bullet_max=this._bytes.readInt32(),this.angle_min=this._bytes.readFloat64(),this.angle_min=parseFloat(this.angle_min.toFixed(2)),this.angle_max=this._bytes.readFloat64(),this.angle_max=parseFloat(this.angle_max.toFixed(2)),this.data_effect=[],e=this._bytes.readInt16();e--;){var a=new Jr(this._bytes);a.decode(),this.data_effect.push(a)}for(this.data_magic=[],e=this._bytes.readInt16();e--;){var s=new $r(this._bytes);s.decode(),this.data_magic.push(s)}}}]),t}(),n=s([Fr(e.name),r(20162)],n),e.GameEnterResp=n,n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.memberinfo=[];for(var e=this._bytes.readInt16();e--;){var t=new Kr(this._bytes);t.decode(),this.memberinfo.push(t)}for(this.myprops=[],e=this._bytes.readInt16();e--;){var i=new Zr(this._bytes);i.decode(),this.myprops.push(i)}}}]),t}(),n=s([Fr(e.name),r(20159)],n),e.UserEnterResp=n,n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.uid=this._bytes.readInt32()}},{key:"encode",value:function(){this._bytes.writeInt32(this.uid)}}]),t}(),n=s([Fr(e.name),r(20160)],n),e.UserLeaveResp=n,n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.tableId=this._bytes.readInt16(),this.uid=this._bytes.readInt32(),this.result=this._bytes.readUTFString()}}]),t}(),n=s([Fr(e.name),r(20152)],n),e.SitUpResp=n,n=function(){f(t,Uo);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"encode",value:function(){this._bytes.writeInt32(this.uid),this._bytes.writeFloat64(this.angle)}}]),t}(),n=s([Fr(e.name),r(27800)],n),e.ShootReq=n,n=function(){f(t,Uo);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"encode",value:function(){this._bytes.writeInt32(this.uid),this._bytes.writeInt32(this.bullet_id);var e=this.target_ids.length;for(this._bytes.writeInt16(e);e--;)this._bytes.writeInt32(this.target_ids[this.target_ids.length-1-e])}}]),t}(),n=s([Fr(e.name),r(27801)],n),e.HitReq=n,n=function(){f(t,Uo);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"encode",value:function(){this._bytes.writeInt32(this.uid),this._bytes.writeInt32(this.cannon_type)}}]),t}(),n=s([Fr(e.name),r(27802)],n),e.SwitchCannonTypeReq=n,n=function(){f(t,Uo);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"encode",value:function(){this._bytes.writeInt32(this.uid),this._bytes.writeInt32(this.cannon_level)}}]),t}(),n=s([Fr(e.name),r(27803)],n),e.SwitchCannonLevelReq=n,n=function(){f(t,Uo);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"encode",value:function(){this._bytes.writeInt32(this.uid),this._bytes.writeInt32(this.speed)}}]),t}(),n=s([Fr(e.name),r(27804)],n),e.ChangeShootSpeedReq=n,n=function(){f(t,Uo);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"encode",value:function(){this._bytes.writeInt32(this.uid),this._bytes.writeInt32(this.target_id)}}]),t}(),n=s([Fr(e.name),r(27805)],n),e.ChangeLockTargetReq=n,n=function(){f(t,Uo);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"encode",value:function(){this._bytes.writeInt32(this.uid),this._bytes.writeInt32(this.lock_type)}}]),t}(),n=s([Fr(e.name),r(27806)],n),e.ChangeLockKindReq=n,n=function(){f(t,Uo);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"encode",value:function(){this._bytes.writeInt32(this.uid),this._bytes.writeInt32(this.shoot_auto)}}]),t}(),n=s([Fr(e.name),r(27807)],n),e.ChangeShootAutoReq=n,eo=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.state_id=this._bytes.readInt32(),this.stete_level=this._bytes.readInt32(),this.left_time=this._bytes.readFloat64()}}]),t}(),to=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.screen_level=this._bytes.readInt32(),this.left_time=this._bytes.readFloat64(),this.state_infos=[];for(var e=this._bytes.readInt16();e--;){var t=new eo(this._bytes);t.decode(),this.state_infos.push(t)}}}]),t}(),io=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.gun_type=this._bytes.readInt32(),this.gun_level=this._bytes.readInt32()}}]),t}(),no=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.location=this._bytes.readInt32(),this.speed=this._bytes.readInt32(),this.angle=this._bytes.readFloat64(),this.lock_target=this._bytes.readInt32(),this.lock_kind=this._bytes.readInt32(),this.is_shoot=this._bytes.readInt32(),this.gun_info=new io(this._bytes),this.gun_info.decode(),this.state_infos=[];for(var e=this._bytes.readInt16();e--;){var t=new eo(this._bytes);t.decode(),this.state_infos.push(t)}}}]),t}(),e.ConsoleInfo=no,ao=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.target_id=this._bytes.readInt32(),this.target_type=this._bytes.readInt32(),this.is_dead=this._bytes.readInt32(),this.target_blood=this._bytes.readFloat64(),this.state_infos=[];for(var e=this._bytes.readInt16();e--;){var t=new eo(this._bytes);t.decode(),this.state_infos.push(t)}}}]),t}(),e.TargetInfo=ao,so=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.target_path_id=this._bytes.readInt32(),this.use_time=this._bytes.readFloat64()}}]),t}(),e.TargetConf=so,ro=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.target_infos=[];for(var e=this._bytes.readInt16();e--;){var t=new ao(this._bytes);t.decode(),this.target_infos.push(t)}this.target_conf=new so(this._bytes),this.target_conf.decode()}}]),t}(),e.TargetPathInfo=ro,oo=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.bullet_id=this._bytes.readInt32(),this.bullet_type=this._bytes.readInt32(),this.location=this._bytes.readInt32(),this.is_dead=this._bytes.readInt32(),this.state_infos=[];for(var e=this._bytes.readInt16();e--;){var t=new eo(this._bytes);t.decode(),this.state_infos.push(t)}}}]),t}(),ho=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.bullet_type=this._bytes.readInt32(),this.bullet_speed=this._bytes.readInt32(),this.bullet_angle=this._bytes.readFloat64(),this.bullet_lock=this._bytes.readInt32(),this.use_time=this._bytes.readFloat64()}}]),t}(),lo=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.bullet_infos=[];for(var e=this._bytes.readInt16();e--;){var t=new oo(this._bytes);t.decode(),this.bullet_infos.push(t)}this.bullet_attr=new ho(this._bytes),this.bullet_attr.decode()}}]),t}(),n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.screen_infos=new to(this._bytes),this.screen_infos.decode(),this.console_infos=[];for(var e=this._bytes.readInt16();e--;){var t=new no(this._bytes);t.decode(),this.console_infos.push(t)}for(this.target_path_infos=[],e=this._bytes.readInt16();e--;){var i=new ro(this._bytes);i.decode(),this.target_path_infos.push(i)}for(this.bullet_path_infos=[],e=this._bytes.readInt16();e--;){var n=new lo(this._bytes);n.decode(),this.bullet_path_infos.push(n)}}}]),t}(),n=s([Fr(e.name),r(27808)],n),e.SyncYardResp=n,n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.screen_level=this._bytes.readInt32(),this.left_time=this._bytes.readFloat64(),this.state_infos=[];for(var e=this._bytes.readInt16();e--;){var t=new eo(this._bytes);t.decode(),this.state_infos.push(t)}}}]),t}(),n=s([Fr(e.name),r(27809)],n),e.LevelStartResp=n,n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.screen_level=this._bytes.readInt32(),this.warn_time=this._bytes.readFloat64(),this.is_clear=this._bytes.readInt32()}}]),t}(),n=s([Fr(e.name),r(27810)],n),e.BossWarningResp=n,n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){}}]),t}(),n=s([Fr(e.name),r(27811)],n),e.BossFinishResp=n,n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){}}]),t}(),n=s([Fr(e.name),r(27812)],n),e.LevelFinishResp=n,uo=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.bullet_id=this._bytes.readInt32(),this.location=this._bytes.readInt32(),this.state_infos=[];for(var e=this._bytes.readInt16();e--;){var t=new eo(this._bytes);t.decode(),this.state_infos.push(t)}}}]),t}(),co=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.bullet_type=this._bytes.readInt32(),this.bullet_speed=this._bytes.readInt32(),this.bullet_angle=this._bytes.readFloat64(),this.bullet_lock=this._bytes.readInt32()}}]),t}(),n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.infos=[];for(var e=this._bytes.readInt16();e--;){var t=new uo(this._bytes);t.decode(),this.infos.push(t)}this.bullet_attr=new co(this._bytes),this.bullet_attr.decode()}}]),t}(),n=s([Fr(e.name),r(27813)],n),e.BulletEnterResp=n,_o=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.target_id=this._bytes.readInt32(),this.target_type=this._bytes.readInt32(),this.target_blood=this._bytes.readFloat64(),this.state_infos=[];for(var e=this._bytes.readInt16();e--;){var t=new eo(this._bytes);t.decode(),this.state_infos.push(t)}}}]),t}(),n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.infos=[];for(var e=this._bytes.readInt16();e--;){var t=new _o(this._bytes);t.decode(),this.infos.push(t)}for(this.path_ids=[],e=this._bytes.readInt16();e--;)this.path_ids.push(this._bytes.readInt32())}}]),t}(),n=s([Fr(e.name),r(27814)],n),e.TargetEnterResp=n,n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.uid=this._bytes.readInt32(),this.gun_type=this._bytes.readInt32(),this.gun_level=this._bytes.readInt32()}}]),t}(),n=s([Fr(e.name),r(27815)],n),e.SwitchCannonResp=n,n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.uid=this._bytes.readInt32(),this.speed=this._bytes.readInt32()}}]),t}(),n=s([Fr(e.name),r(27816)],n),e.ChangeShootSpeedResp=n,n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.uid=this._bytes.readInt32(),this.angle=this._bytes.readFloat64()}}]),t}(),n=s([Fr(e.name),r(27817)],n),e.ChangeShootAngleResp=n,n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.uid=this._bytes.readInt32(),this.is_shoot=this._bytes.readInt32()}}]),t}(),n=s([Fr(e.name),r(27818)],n),e.ChangeShootAutoResp=n,n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.uid=this._bytes.readInt32(),this.target_id=this._bytes.readInt32()}}]),t}(),n=s([Fr(e.name),r(27819)],n),e.ChangeLockTargetResp=n,n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.uid=this._bytes.readInt32(),this.lock_kind=this._bytes.readInt32()}}]),t}(),n=s([Fr(e.name),r(27820)],n),e.ChangeLockKindResp=n,n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.uid=this._bytes.readInt32(),this.type=this._bytes.readInt32(),this.category=this._bytes.readInt32(),this.souce_id=this._bytes.readInt32(),this.score=this._bytes.readFloat64(),this.param=this._bytes.readInt32()}}]),t}(),n=s([Fr(e.name),r(27821)],n),e.UpdateScoreResp=n,n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.uid=this._bytes.readInt32(),this.bullet_id=this._bytes.readInt32(),this.bullet_dead=this._bytes.readInt32(),this.target_id=this._bytes.readInt32(),this.target_dead=this._bytes.readInt32(),this.target_blood=this._bytes.readFloat64()}}]),t}(),n=s([Fr(e.name),r(27822)],n),e.BeHitResp=n,n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.uid=this._bytes.readInt32(),this.boom_id=this._bytes.readInt32(),this.target_id=this._bytes.readInt32(),this.target_blood=this._bytes.readFloat64(),this.target_dead=this._bytes.readInt32()}}]),t}(),n=s([Fr(e.name),r(27823)],n),e.BeSweepResp=n,n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.state_info=new eo(this._bytes),this.state_info.decode()}}]),t}(),n=s([Fr(e.name),r(27824)],n),e.YardEffectGetResp=n,n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.uid=this._bytes.readInt32(),this.state_info=new eo(this._bytes),this.state_info.decode()}}]),t}(),n=s([Fr(e.name),r(27825)],n),e.AvatarEffectGetResp=n,n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.move_id=this._bytes.readInt32(),this.state_info=new eo(this._bytes),this.state_info.decode()}}]),t}(),n=s([Fr(e.name),r(27826)],n),e.MovableEffectGetResp=n,n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.state_info=new eo(this._bytes),this.state_info.decode()}}]),t}(),n=s([Fr(e.name),r(27827)],n),e.YardEffectRaiseResp=n,n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.uid=this._bytes.readInt32(),this.state_info=new eo(this._bytes),this.state_info.decode()}}]),t}(),n=s([Fr(e.name),r(27828)],n),e.AvatarEffectRaiseResp=n,n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.move_id=this._bytes.readInt32(),this.state_info=new eo(this._bytes),this.state_info.decode()}}]),t}(),n=s([Fr(e.name),r(27829)],n),e.MovableEffectRaiseResp=n,n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.state_info=new eo(this._bytes),this.state_info.decode()}}]),t}(),n=s([Fr(e.name),r(27830)],n),e.YardEffectOverResp=n,n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.uid=this._bytes.readInt32(),this.state_info=new eo(this._bytes),this.state_info.decode()}}]),t}(),n=s([Fr(e.name),r(27831)],n),e.AvatarEffectOverResp=n,n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.move_id=this._bytes.readInt32(),this.state_info=new eo(this._bytes),this.state_info.decode()}}]),t}(),n=s([Fr(e.name),r(27832)],n),e.MovableEffectOverResp=n,n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.uid=this._bytes.readInt32(),this.prop_id=this._bytes.readInt32(),this.add_num=this._bytes.readInt32(),this.new_num=this._bytes.readInt32(),this.target_id=this._bytes.readInt32()}}]),t}(),n=s([Fr(e.name),r(27833)],n),e.PropAddResp=n,n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.uid=this._bytes.readInt32(),this.prop_id=this._bytes.readInt32(),this.use_num=this._bytes.readInt32(),this.new_num=this._bytes.readInt32()}}]),t}(),n=s([Fr(e.name),r(27834)],n),e.PropUseResp=n,n=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.dummy_id=this._bytes.readInt32()}}]),t}(),n=s([Fr(e.name),r(27835)],n),e.DcontrolResp=n,Hr),Yo=y(function e(){b(this,e)}),Go=(Yo.SocketOpen="SocketOpen",Yo.SocketClose="SocketClose",Yo.SocketError="SocketError",Yo.SocketDelay="SocketDelay",function(){function l(e,t,i,n,a,s,r,o,h){b(this,l),this.isFirst=!0,this.name=e,this.decoder=n,this.dispatcher=i,this.debug=r,this.heartReq=a,this.heartResp=s,this.loadingView=o,this.binaryType=h,this.timer=new Oi,this.open(t)}return y(l,[{key:"open",value:function(e){this.url=e,this.socket=new WebSocket(this.url),this.timer.once(1e4,this,this.connectTimeOut),this.binaryType&&(this.socket.binaryType=this.binaryType),this.socket.onopen=this.onOpen.bind(this),this.socket.onmessage=this.onMessage.bind(this),this.socket.onclose=this.onClose.bind(this),this.socket.onerror=this.onError.bind(this)}},{key:"connectTimeOut",value:function(){this.socket.CONNECTING||(console.log(this.name,"connect time out"),this.dispatcher.event(Yo.SocketClose,this.name),this.close())}},{key:"setErrorHander",value:function(e){this.errHandler=e}},{key:"send",value:function(e){var t,i,n,a;this.socket?(tn.getDecorator(Br,e),i=(t=tn.getDecorator(Vr,e))||this.decoder.encode(e),n=tn.getDecorator(r,e),a=tn.getDecorator(r,this.heartReq),n||t||console.warn("no cls conf",e),n==a||"true"!==No.getUrlParam("netlog")&&!0!==I.window.netlog||(console.log("%c "+this.name+" send  -----\x3e>>>  "+n+"   "+(new Date).toLocaleString(),"background:#ccfbac;"),console.log(e)),this.waitForSend(i)):this.debug&&console.error(this.name+" socket is closed",e)}},{key:"waitForSend",value:function(e){var t=this;this.socket&&(this.isFirst?setTimeout(function(){t.socket&&(1===t.socket.readyState?(t.isFirst=!1,t.socket.send(e)):t.waitForSend(e))},20):(this.isFirst=!1,this.socket.send(e)))}},{key:"onOpen",value:function(){this.debug&&console.log(this.name+" open"),this.timer.clear(this,this.connectTimeOut),this.dispatcher.event(Yo.SocketOpen,this.name)}},{key:"onMessage",value:function(e){var t=this.decoder.decode(e.data);if(this.heartFlag=!0,"true"!==No.getUrlParam("netlog")&&!0!==I.window.netlog||(t.body?!1!==tn.getDecorator(Ur,t.body)&&(console.log("%c "+this.name+" receive  <<<<-----  "+t.cmd+"   "+(new Date).toLocaleString(),"background:#f3c0b0;"),console.log(t.body)):console.log(t.cmd,e.data)),t.isErr&&this.errHandler&&!1!==tn.getDecorator(Pr,t.body))return console.warn(t),void this.errHandler.runWith([t.errno]);this.dispatcher.event(this.name+"_"+t.cmd,[t.body,t.errno])}},{key:"onClose",value:function(){console.log(this.name+" close accident"),this.dispatcher.event(Yo.SocketClose,this.name),this.close()}},{key:"onError",value:function(){console.log(this.name+" error"),this.dispatcher.event(Yo.SocketClose,this.name),this.close()}},{key:"close",value:function(){this.socket&&(this.socket.onopen=null,this.socket.onmessage=null,this.socket.onclose=null,this.socket.onerror=null,this.socket.close(),this.socket=null,console.log(this.name+" close")),this.dispatcher&&(this.dispatcher=null),this.timer&&(this.timer.clearAll(this),this.timer=null)}},{key:"startHeart",value:function(){this.sendHeart(),this.timer.loop(1e3,this,this.sendHeart),this.timer.loop(1e4,this,this.checkHeart)}},{key:"sendHeart",value:function(){this.socket.OPEN&&this.heartReq&&this.send(this.heartReq)}},{key:"checkHeart",value:function(){!this.heartFlag&&this.heartResp?(console.log(this.name+": heart timeout"),this.dispatcher.event(Yo.SocketClose,this.name),this.close()):this.heartFlag=!1}}]),l}()),Xo=y(function e(){b(this,e)}),Wo=y(function e(){b(this,e)}),Ho=((po=fo=fo||{}).name="lobby",i=function(){f(t,Uo);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"encode",value:function(){}}]),t}(),i=s([Fr(po.name),r(5e3)],i),po.LobbyHeartBeat=i,i=function(){f(t,Uo);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"encode",value:function(){this._bytes.writeInt32(this.v3)}}]),t}(),i=s([Fr(po.name),r(5006)],i),po.LobbyValidateReq=i,i=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.v1=this._bytes.readInt32(),this.v2=this._bytes.readInt32()}}]),t}(),i=s([Fr(po.name),r(5006)],i),po.LobbyValidateResp=i,i=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.vesion=this._bytes.readUTFString()}}]),t}(),i=s([Fr(po.name),r(9999)],i),po.LobbyVersionResp=i,i=function(){f(t,Uo);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"encode",value:function(){this._bytes.writeInt32(0)}}]),t}(),i=s([Fr(po.name),r(5001)],i),po.LobbyRoomIdReq=i,i=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){}}]),t}(),i=s([Fr(po.name),r(5001)],i),po.LobbyRoomIdResp=i,i=function(){f(t,Uo);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"encode",value:function(){this._bytes.writeInt32(this.uid),this._bytes.writeInt32(this.agent_id),this._bytes.writeUTFString(this.device_id)}}]),t}(),i=s([Fr(po.name),r(10001)],i),po.GuestLoginReq=i,i=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.uid=this._bytes.readInt32(),this.username=this._bytes.readUTFString(),this.password=this._bytes.readUTFString(),this.nickname=this._bytes.readUTFString(),this.level=this._bytes.readInt32(),this.vip_level=this._bytes.readInt32(),this.avatar_no=this._bytes.readInt32(),this.avatar_img=this._bytes.readUTFString(),this.bag_money=this._bytes.readFloat64(),this.bag_money=parseFloat(this.bag_money.toFixed(2)),this.bank_money=this._bytes.readFloat64(),this.bank_money=parseFloat(this.bank_money.toFixed(2)),this.dollar_money=this.readInt64(),this.result=this._bytes.readUTFString()}}]),t}(),i=s([Fr(po.name),r(10001)],i),po.GuestLoginResp=i,i=function(){f(t,Uo);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"encode",value:function(){this._bytes.writeUTFString(this.username),this._bytes.writeUTFString(this.password),this._bytes.writeUTFString(this.captcha),this._bytes.writeUTFString(this.proving),this._bytes.writeUTFString(this.machineCode),this._bytes.writeByte(this.client_type),this._bytes.writeUTFString(this.token),this._bytes.writeByte(this.is_encoded)}}]),t}(),i=s([Fr(po.name),r(1e4)],i),po.AccountLoginReq=i,i=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.username=this._bytes.readUTFString(),this.password=this._bytes.readUTFString(),this.result=this._bytes.readUTFString()}}]),t}(),i=s([Fr(po.name),r(1e4)],i),po.AccountLoginResp=i,i=function(){f(t,Uo);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"encode",value:function(){}}]),t}(),i=s([Fr(po.name),r(10002)],i),po.GetAccountReq=i,yo=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.userid=this._bytes.readInt32(),this.username=this._bytes.readUTFString(),this.password=this._bytes.readUTFString(),this.nickname=this._bytes.readUTFString(),this.realname=this._bytes.readUTFString(),this.sex=this._bytes.readInt16(),this.birthday=this._bytes.readUTFString(),this.avatar_no=this._bytes.readInt16(),this.inviter_id=this._bytes.readInt32(),this.chick_task=this._bytes.readInt16(),this.email=this._bytes.readUTFString(),this.telephone=this._bytes.readUTFString(),this.qq=this._bytes.readUTFString(),this.agent_user_id=this._bytes.readInt32(),this.cert_type=this._bytes.readInt16(),this.cert_no=this._bytes.readUTFString(),this.validate_realname=this._bytes.readInt16(),this.validate_cert=this._bytes.readInt16(),this.validate_video=this._bytes.readInt32(),this.validate_email=this._bytes.readInt16(),this.validate_qq=this._bytes.readInt16(),this.validate_mobile=this._bytes.readInt16(),this.wechat_id=this._bytes.readUTFString(),this.wechat_lock=this._bytes.readInt16(),this.bank_validate=this._bytes.readInt16(),this.bag_money=this._bytes.readFloat64(),this.bag_money=parseFloat(this.bag_money.toFixed(2)),this.vip_level=this._bytes.readInt16(),this.bank_money=this._bytes.readFloat64(),this.bank_money=parseFloat(this.bank_money.toFixed(2)),this.pay_money=this.readInt64(),this.dollar_money=this.readInt64(),this.promo_dollar=this.readInt64(),this.win_dollar_sum=this.readInt64(),this.online_time=this._bytes.readInt32(),this.level=this._bytes.readInt16(),this.happycard=this._bytes.readInt32(),this.locked=this._bytes.readInt16(),this.exp_value=this._bytes.readInt32(),this.award_value=this._bytes.readInt32(),this.gold_money=this.readInt64(),this.next_exp=this._bytes.readInt32(),this.gfname=this._bytes.readUTFString(),this.wfname=this._bytes.readUTFString(),this.gfname1=this._bytes.readUTFString(),this.wfname1=this._bytes.readUTFString(),this.win_times=this._bytes.readInt32(),this.lost_times=this._bytes.readInt32(),this.ol_roomd_id=this._bytes.readInt32(),this.linecode=this._bytes.readUTFString(),this.game_hid=this._bytes.readUTFString(),this.show_back_button=this._bytes.readInt32(),this.vip_tp=this._bytes.readInt32(),this.realusername=this._bytes.readUTFString(),this.all_npc=this._bytes.readInt32(),this.currency=this._bytes.readUTFString()}}]),t}(),po.AccountResp=yo,i=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.body=new yo(this._bytes),this.body.decode(),this.result=this._bytes.readUTFString()}}]),t}(),i=s([Fr(po.name),r(10002)],i),po.GetAccountResp=i,i=function(){f(t,Uo);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"encode",value:function(){this._bytes.writeByte(this.rt),this._bytes.writeInt16(this.gt),this._bytes.writeInt32(this.maxv),this._bytes.writeInt32(this.agentid),this._bytes.writeInt32(this.minv),this._bytes.writeUTFString(this.currency),this._bytes.writeInt32(this.new_agent_id),this._bytes.writeInt32(this.new_main_agent_id)}}]),t}(),i=s([Fr(po.name),r(10008)],i),po.QueryRoomReq=i,go=function(){f(i,c);var t=T(i);function i(){var e;return b(this,i),(e=t.apply(this,arguments)).websocket=Jo.defaultWebsocket,e.fixed_seat=!0,e}return y(i,[{key:"decode",value:function(){this.room_id=this._bytes.readInt32(),this.title=this._bytes.readUTFString(),this.game_type=this._bytes.readInt16(),this.room_type=this._bytes.readInt16(),this.room_level=this._bytes.readInt16(),this.unit_money=this._bytes.readFloat64(),this.unit_money=parseFloat(this.unit_money.toFixed(2)),this.init_money=this._bytes.readFloat64(),this.init_money=parseFloat(this.init_money.toFixed(2)),this.top_money=this._bytes.readFloat64(),this.top_money=parseFloat(this.top_money.toFixed(2)),this.min_money=this._bytes.readFloat64(),this.min_money=parseFloat(this.min_money.toFixed(2)),this.max_money=this._bytes.readFloat64(),this.max_money=parseFloat(this.max_money.toFixed(2)),this.entry_fee=this._bytes.readInt32(),this.max_online=this._bytes.readInt16(),this.online_num=this._bytes.readInt16(),this.is_active=this.readBoolean(),this.close_reason=this._bytes.readUTFString(),this.remark=this._bytes.readUTFString(),this.match_id=this._bytes.readInt32(),this.create_time=this._bytes.readUTFString(),this.end_time=this._bytes.readUTFString(),this.star_level=this._bytes.readInt16(),this.dbname=this._bytes.readUTFString(),this.is_end=this.readBoolean(),this.tag=this._bytes.readUTFString(),this.cmp=this._bytes.readUTFString(),this.flex=this.readBoolean(),this.ver=this._bytes.readInt16(),this.is_old=this.readBoolean(),this.socket_encode=this._bytes.readUTFString(),this.common_top=this.readBoolean(),this.match_top=this.readBoolean(),this.cannon_rate=[];for(var e=this._bytes.readInt16();e--;)this.cannon_rate.push(this._bytes.readFloat64())}}]),i}(),po.RoomInfo=go,i=function(){f(t,c);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"decode",value:function(){this.rooms=[];for(var e=this._bytes.readInt16();e--;){var t=new go(this._bytes);t.decode(),this.rooms.push(t)}this.result=this._bytes.readUTFString()}}]),t}(),i=s([Fr(po.name),r(10008)],i),po.RoomInfoListResp=i,fo),jo=function(){f(t,Xo);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"encode",value:function(e){var t=new mi,i=(t.endian="BIG_ENDIAN",tn.getDecorator(r,e)),i=(t.writeUint16(i),e.encode(),e._bytes);return i&&t.writeArrayBuffer(i.buffer),t.buffer}},{key:"decode",value:function(e){var t,i=new mi(e),n=(i.endian="BIG_ENDIAN",i.readUint16()),a=new Wo;for(t in a.cmd=n,Ho)if(n==tn.getDecorator(r,Ho[t])&&Ho[t].__proto__==c){var s=new Ho[t](i);s.decode(),a.body=s;break}return a}}]),t}(),qo=function(){function e(){b(this,e)}return y(e,null,[{key:"setItem",value:function(e,t){var i="object"!=P(t)?(i={value:t,_type:P(t)},JSON.stringify(i)):JSON.stringify(t);Si.setItem(e,i)}},{key:"getItem",value:function(e,t){var i=Si.getItem(e);if(null===i||""==i)return t;if("null"==i)return null;if("undefined"!=i)switch((i=JSON.parse(i))._type){case"number":return Number(i.value);case"boolean":return Boolean(i.value);case"string":return i.value;default:return i}}}]),e}(),Ko=y(function e(t){b(this,e),this.userid=0,this.s_key="",this.agent=0,this.username="",this.user_end="",this.domain="",this.password="",this.nickname="",this.realname="",this.sex=0,this.avatar_no=0,this.birthday="",this.client_address="",this.email="",this.telephone="",this.qq="",this.cert_type=0,this.cert_no="",this.bag_money=0,this.bank_money=0,this.pay_money=0,this.dollar_money=0,this.award_dollar=0,this.award_dollar_sum=0,this.win_dollar_sum=0,this.online_time=0,this.level=0,this.vip_level=0,this.exp_value=0,this.next_exp=0,this.award_value=0,this.next_gift=11,this.happycard=0,this.validate_realname=0,this.validate_cert=0,this.validate_video=0,this.validate_email=0,this.validate_qq=0,this.validate_mobile=0,this.inviter_id=0,this.is_virgin_paid=-1,this.agent_user_id=0,this.chick_task=-1,this.bank_validate=0,this.locked=0,this.ol_roomd_id=0,this.linecode="",this.gametype="",this.game_hid="",this.show_back_button=1,this.vip_tp=1,this.all_npc=0,this.realusername="",this.currency="",this.platform="",zr.deepClone(t,this)}),Qo=function(){f(t,Xo);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"encode",value:function(e){var t=new mi,i=(t.endian="BIG_ENDIAN",tn.getDecorator(r,e)),i=(t.writeUint16(i),e.encode(),e._bytes);return i&&t.writeArrayBuffer(i.buffer),t.buffer}},{key:"decode",value:function(e){var t,i=new mi(e),n=(i.endian="BIG_ENDIAN",i.readUint16()),a=new Wo;for(t in a.cmd=n,zo)if(n==tn.getDecorator(r,zo[t])&&zo[t].__proto__==c){var s=new zo[t](i);s.decode(),a.body=s;break}return a}}]),t}(),Zo=((vo=mo=mo||{}).BLOB="blob",vo.ARRAY_BUFFER="arraybuffer",mo),Jo=function(){function e(){b(this,e)}return y(e,[{key:"send",value:function(e){var t=tn.getDecorator(Fr,e);t?t==Ho.name&&this.lobbySocket?this.lobbySocket.send(e):t==zo.name&&this.gameSocket&&e instanceof Uo&&this.gameSocket.send(e):console.error("没有配置ServerName",e)}},{key:"loginLobby",value:function(){_.defaultLoadingView.show(),this.lobbySocket=new Go(Ho.name,e.defaultWebsocket,_.event,new jo,new Ho.LobbyHeartBeat,null,_.DEBUG,_.defaultLoadingView,Zo.ARRAY_BUFFER),_.event.once(Ho.LobbyValidateResp,this,this.onLobbyValidateResp)}},{key:"onLobbyValidateResp",value:function(e){var t=new Ho.LobbyValidateReq;t.v3=e.v1^e.v1+e.v2,this.send(t),_.event.once(Ho.LobbyVersionResp,this,this.onLobbyVersionResp)}},{key:"onLobbyVersionResp",value:function(e){var e=Number(e.vesion),t=e;e==t?(this.send(new Ho.LobbyRoomIdReq),_.event.once(Ho.LobbyRoomIdResp,this,this.loginLobbySuccess)):t<e?console.warn(e,"客户端版本太低，请清理缓存或联系客服"):console.warn("服务端版本太低，请联系客服")}},{key:"loginLobbySuccess",value:function(){console.log("lobby服务器连接成功");No.getUrlParam("token");var e=new Ho.GuestLoginReq;e.device_id=No.randomDeviceId(),e.uid=qo.getItem("guestid_fishxy")||0,e.agent_id=0,this.send(e),_.event.once(Ho.GuestLoginResp,this,this.onGuestLoginResp),this.lobbySocket.startHeart()}},{key:"onGuestLoginResp",value:function(e){"ok"==e.result?(qo.setItem("guestid_fishxy",e.uid),this.send(new Ho.GetAccountReq),_.event.once(Ho.GetAccountResp,this,this.onGetAccountResp)):console.warn(e.result,"请刷新网页重新进入")}},{key:"onGetAccountResp",value:function(e){_.data.account=new Ko(e.body);e=new Ho.QueryRoomReq;e.rt=-1,e.gt=_.data.gameInfo.id,e.maxv=39999,e.agentid=0,e.minv=0,e.currency=_.data.account.currency,e.new_agent_id=_.data.account.agent_id,e.new_main_agent_id=_.data.account.main_agent_id,this.send(e),_.event.once(Ho.RoomInfoListResp,this,function(e){"ok"!=e.result?console.warn(e.result):(_.data.rooms=e.rooms,_.event.event(_.EventType.LoginComplete),_.defaultLoadingView.hide())})}},{key:"loginGame",value:function(e){this.loginRoom=e,this.gameSocket=new Go(zo.name,e.websocket,_.event,new Qo,new zo.GameHeartReq,new zo.GameHeartResp,_.DEBUG,_.defaultLoadingView,Zo.ARRAY_BUFFER),_.event.once(zo.GameValidateResp,this,this.onGameValidateResp)}},{key:"onGameValidateResp",value:function(e){var t=new zo.GameValidateReq;t.v3=e.v1^e.v1+e.v2,this.send(t),_.event.once(zo.GameVersionResp,this,this.onGameVersionResp)}},{key:"onGameVersionResp",value:function(e){var t,e=Number(e.vesion),i=e;e==i?((t=new zo.GameRoomIdReq).roomid=this.loginRoom.room_id,this.send(t),_.event.once(zo.GameRoomIdResp,this,this.onGameRoomIdResp)):i<e?console.warn(e,"客户端版本太低，请清理缓存或联系客服"):console.warn("服务端版本太低，请联系客服")}},{key:"onGameRoomIdResp",value:function(){console.log("game服务器连接成功");var e=new zo.GameLoginReq;e.all_npc=_.data.account.all_npc,e.userid=_.data.account.userid,e.password=_.data.account.password,e.client_type=0,e.client_info="h5",e.version=3,e.fixseat=this.loginRoom.fixed_seat,e.dbname=this.loginRoom.dbname,e.first_money=this.loginRoom.min_money,e.roomid=this.loginRoom.room_id,e.linecode=_.data.account.linecode,this.send(e),_.event.once(zo.LoginSuccessResp,this,this.onLoginSuccessResp),this.gameSocket.startHeart()}},{key:"onLoginSuccessResp",value:function(e){e.re_enter||((e=new zo.GameSitReq).sitIndex=-1,e.tableId=-1,this.send(e)),_.event.once(zo.UpdateIntomoney,this,this.onUpdateIntomoney)}},{key:"onUpdateIntomoney",value:function(){var e=new zo.GameReadyReq;this.send(e)}}],[{key:"I",get:function(){return this.instance||(this.instance=new e),this.instance}}]),e}(),$o=(Jo.defaultWebsocket="ws://asdfasdf.789.cn:9032/",function(){f(i,Ki.fishxy.fight.HelpDialogUI);var t=T(i);function i(){var e;return b(this,i),(e=t.apply(this,arguments)).currentPage=0,e}return y(i,[{key:"pop",value:function(e){var t=this;_.defaultLoadingView.show(),o.loader.load("fishxy/fight/dialog.atlas",x.create(this,function(){t.alreadyInit||t.init(),t.alreadyInit=!0,t.selectTab(e),t.popup(),_.defaultLoadingView.hide()}))}},{key:"init",value:function(){this.initTabBtn(),this.initContent0(),this.initContent1(),this.initContent3()}},{key:"initContent0",value:function(){this.next_page_btn.on(Me.CLICK,this,this.selectPage,[this.next_page_btn]),this.prev_page_btn.on(Me.CLICK,this,this.selectPage,[this.prev_page_btn]),this.page_label.font="bmfont_gold.fnt";var e=this.getChildByName("content_0").getChildByName("page_0");e.array=[];for(var t=1;t<13;t++)e.array.push(this.getFishListData(t));e.renderHandler=new x(this,function(e){e.getChildByName("rate").font="bmfont_fishBeiZi.fnt"});var i=this.getChildByName("content_0").getChildByName("page_1");i.array=[];for(t=13;t<24;t++)i.array.push(this.getFishListData(t));i.array.push(this.getFishListData(28)),i.renderHandler=new x(this,function(e,t){e=e.getChildByName("rate");e.font="bmfont_fishBeiZi.fnt",t<5?e.scale(1,1):5<=t&&t<9?e.scale(.75,.75):e.scale(.65,.65)}),this.selectPage()}},{key:"getFishListData",value:function(t){var e=o.loader.getRes(wr.FISH_DEFINE_CONF).find(function(e){return e.fishid==t});return{icon:wr.getFishIcon(e.fishid),fish_name:"fishxy/fight/dialog/fish_"+e.fishid+".png",rate:"x"+e.rate_desc}}},{key:"selectPage",value:function(e){e==this.next_page_btn?(Ro.playSound("SFX_UI_Button_Increase.mp3"),this.currentPage++,6<this.currentPage&&(this.currentPage=6)):e==this.prev_page_btn&&(Ro.playSound("SFX_UI_Button_Decrease.mp3"),this.currentPage--,this.currentPage<0&&(this.currentPage=0)),this.page_label.text=this.currentPage+1+"/7";for(var t=0;t<7;t++)this.getChildByName("content_0").getChildByName("page_"+t).visible=this.currentPage==t}},{key:"initContent1",value:function(){var e,t=Y(this.getChildByName("content_1")._children);try{for(t.s();!(e=t.n()).done;){var i,n=Y(e.value._children);try{for(n.s();!(i=n.n()).done;){var a=i.value;a instanceof Sn&&(a.font="bmfont_zongFen.fnt")}}catch(e){n.e(e)}finally{n.f()}}}catch(e){t.e(e)}finally{t.f()}}},{key:"initContent3",value:function(){var e=this;this.mmm.on(Me.CLICK,this,function(){}),this.music.on(Me.CLICK,this,function(){0==e.music.index?(e.music.index=1,yi.musicMuted=!1):(e.music.index=0,yi.musicMuted=!0)}),this.sound.on(Me.CLICK,this,function(){0==e.sound.index?(e.sound.index=1,yi.soundMuted=!1):(e.sound.index=0,yi.soundMuted=!0)})}},{key:"initTabBtn",value:function(){for(var e=0;e<4;e++)this.getChildByName("tab_"+e).on(Me.CLICK,this,this.selectTab,[e])}},{key:"selectTab",value:function(e){Ro.playSound("SFX_UI_001.mp3");for(var t=0;t<4;t++)this.getChildByName("tab_"+t).index=t==e?1:0,this.getChildByName("content_"+t).visible=t==e}}],[{key:"I",get:function(){return i._instance=i._instance?i._instance:new i}}]),i}()),eh=function(){function n(){b(this,n)}return y(n,null,[{key:"getBody",value:function(e,t){for(var i in n)if(n[i].error==e)return n[i].body[t];return""}}]),n}(),th=(eh.LoginFailedNomoney={error:20107,body:["金币不足"]},eh.JoinFailedGaming={error:20108,body:["牌桌正在游戏中"]},eh.JoinFailedMaxClient={error:20109,body:["牌桌达到最大人数"]},eh.LoginFailedFull={error:20110,body:[""]},eh.JoinFailedPosition={error:20111,body:["该座位有人"]},eh.LoginFailedTimeout={error:20112,body:["登录超时"]},eh.LoginFailedAuth={error:20113,body:["账号密码错误"]},eh.LoginFailedInactive={error:20114,body:["账号未激活"]},eh.LoginFailedSuperuser={error:20115,body:["管理员无法进入游戏"]},eh.LoginFailedNousemoney={error:20116,body:[""]},eh.LoginFailedClosed={error:20117,body:["房间已关闭"]},eh.LoginFailedGuest={error:20118,body:["游客登录失败,请升级为正式用户!"]},eh.LoginFailedNotexist={error:20119,body:["账号不存在"]},eh.LoginFromSomewhere={error:20120,body:["帐号在其他地方登录"]},eh.LoginFailedOtherroom={error:20121,body:["账号正在其他房间"]},eh.LoginFailedLowlv={error:20122,body:[""]},eh.LoginFailedIp={error:20123,body:["您的IP被限制"]},eh.LoginFailedX={error:20124,body:["未知的错误(错误号: 13)"]},eh.LoginFailedAssetsover={error:20125,body:["资产过多请移步高一级房间"]},eh.Loadmoney={error:20126,body:[""]},eh.LoadmoneyFail={error:20127,body:[""]},eh.LoginFailedMaxloseday={error:20128,body:["您今天的输赢累计已经超过输赢限制，请明天再次游戏"]},eh.LoginFailedMaxlosegame={error:20129,body:["您本次的输赢已经超过限制！"]},eh.LoginFailedLeaving={error:20130,body:["进入房间登录失败:结算未完成！"]},eh.SitFailed={error:20131,body:["消息格式不正确！","牌桌创建失败！","本桌已有相同ip！","已坐满！","已在游戏中！","密码不正确或者钱不够！","还未退出！"]},function(){f(n,Ki.fishxy.fight.AlertDialog1UI);var e=T(n);function n(){return b(this,n),e.apply(this,arguments)}return y(n,[{key:"showInfo",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",i=1<arguments.length?arguments[1]:void 0;_.defaultLoadingView.show(),o.loader.load("fishxy/fight/dialog.atlas",x.create(this,function(){e.info_label.text=t,e.ok.on(Me.CLICK,e,function(){i instanceof x&&(i.run(),e.close())}),m(g(n.prototype),"popup",e).call(e),_.defaultLoadingView.hide()}))}}],[{key:"I",get:function(){return n._instance=n._instance?n._instance:new n}}]),n}()),ih=((t=xo=xo||{})[t.Level=1]="Level",t[t.Jgb=2]="Jgb",t[t.Xmsb=3]="Xmsb",t[t.Ffwb=4]="Ffwb",t[t.Jclj=5]="Jclj",xo),nh=function(){f(i,sn);var t=T(i);function i(){var e;return b(this,i),(e=t.apply(this,arguments)).colliderWorldPosition=new ie,e}return y(i,[{key:"setData",value:function(e,t){this.uniqueId=e,this.node=this.owner,this.node.zOrder=100,d.I.view.fight_layer.addChild(this.node),this.user=t,this.clearHitInfos(),i.Pool[e]=this}},{key:"onAwake",value:function(){this.collider=this.owner.getChildByName("collider"),this.radius=this.collider.width/2}},{key:"onUpdate",value:function(){if(this.colliderWorldPosition.setTo(this.collider.x,this.collider.y),this.collider.parent.localToGlobal(this.colliderWorldPosition),_.isFocus)this.update(u.timer.delta);else for(var e=u.timer.delta/17,t=0;t<e;t++)this.update(17)}},{key:"clearHitInfos",value:function(){this.hitInfos=[]}},{key:"isAlreadyHited",value:function(t){return void 0!==this.hitInfos.find(function(e){return e.fishUniqueId==t.uniqueId})}},{key:"hit",value:function(e){this.hitInfos=this.hitInfos.concat(e),this.user.isOther||this.reqHit(e)}},{key:"reqHit",value:function(e){var t=new zo.HitReq;t.uid=this.user.member.uid,t.bullet_id=this.uniqueId,t.target_ids=e.map(function(e){return e.fishUniqueId}),Jo.I.send(t)}},{key:"recover",value:function(){this.user.isSelf&&this.isLimitBulletNumber&&this.user.status.curtBulletCount--,delete i.Pool[this.uniqueId]}}]),i}(),ah=(nh.Pool={},function(){function e(){b(this,e),this.txt=new Sn}return y(e,[{key:"show",value:function(e,t,i){var n=this;t.addChild(this.txt),this.txt.text=e,this.txt.color="#cfe3f3",this.txt.strokeColor="#000000",this.txt.stroke=3,this.txt.fontSize=40,this.txt.align="center",this.txt.width=u.width,this.txt.centerX=0,this.txt.y=u.height/2,this.txt.alpha=1,this.txt.timer.once(1500,this,function(){Ci.to(n.txt,{y:u.height/2-100,alpha:0},1e3,null,x.create(n,function(){n.txt.removeSelf(),i instanceof x&&i.run()}))})}}]),e}()),sh=function(){function e(){b(this,e)}return y(e,[{key:"listen",value:function(){_.event.on(Yo.SocketClose,this,this.onSocketClose),_.event.once(zo.GameLoginFailResp,this,this.gameLoginFailResp),_.event.on(zo.GameEnterResp,this,this.onGameEnterResp),_.event.on(zo.UserEnterResp,this,this.onUserEnterResp),_.event.on(zo.UserLeaveResp,this,this.onUserLeaveResp),_.event.on(zo.SitUpResp,this,this.onSitUpResp),_.event.on(zo.SyncYardResp,this,this.onSyncYardResp),_.event.on(zo.UpdateScoreResp,this,this.onUpdateScoreResp),_.event.on(zo.PropAddResp,this,this.onPropAddResp),_.event.on(zo.PropUseResp,this,this.onPropUseResp),_.event.on(zo.BulletEnterResp,this,this.onBulletEnterResp),_.event.on(zo.AvatarEffectGetResp,this,this.onAvatarEffectGet),_.event.on(zo.AvatarEffectOverResp,this,this.onAvatarEffectOver),_.event.on(zo.SwitchCannonResp,this,this.onSwitchCannonResp),_.event.on(zo.ChangeShootAutoResp,this,this.onChangeAutoShootResp),_.event.on(zo.ChangeShootSpeedResp,this,this.onChangeShootSpeedResp),_.event.on(zo.ChangeLockKindResp,this,this.onChangeLockKindResp),_.event.on(zo.ChangeLockTargetResp,this,this.onChangeLockTargetResp),_.event.on(zo.DcontrolResp,this,this.onNpcControlResp),_.event.on(zo.BossWarningResp,this,this.onBoosWarningResp),_.event.on(zo.TargetEnterResp,this,this.onNewFish),_.event.on(zo.BeSweepResp,this,this.onBeSweepResp),_.event.on(zo.BeHitResp,this,this.onBeHitResp)}},{key:"onGameEnterResp",value:function(e){d.I.starGame(e)}},{key:"onSyncYardResp",value:function(e){Oo.I.removeAllFish(),Oo.I.addRoute(e.target_path_infos);var t,i=Y(e.console_infos);try{for(i.s();!(t=i.n()).done;){var n=t.value,a=d.I.getUserByPosition(n.location);a&&a.setStatus(n)}}catch(e){i.e(e)}finally{i.f()}}},{key:"onUserEnterResp",value:function(e){var e=e.memberinfo[0],t=(d.I.getUser(e.uid)&&d.I.getUser(e.uid).sitUpGame(),d.I.isMirror&&(0==e.position?e.position=3:1==e.position?e.position=2:2==e.position?e.position=1:3==e.position&&(e.position=0)),d.I.view.user_layer.getChildByName("seat_"+e.position).getComponent(Th));t.setMember(e),d.I.users.push(t)}},{key:"onUserLeaveResp",value:function(e){for(var t in nh.Pool){t=nh.Pool[t];t.user.member.uid==e.uid&&t.recover()}}},{key:"onSitUpResp",value:function(e){e.uid==_.data.account.userid?d.I.closeBrowser():(e=d.I.getUser(e.uid))&&e.sitUpGame()}},{key:"onNpcControlResp",value:function(e){d.I.npcIds=d.I.npcIds.concat(e.dummy_id)}},{key:"onUpdateScoreResp",value:function(e){var t,i=d.I.getUser(e.uid);i&&(i.addMoney(e.score),2==e.type&&(t=Oo.I.getFishByUniqueId(e.souce_id))&&(t.showCoin(i,e.score),1<=e.category&&e.category<=7?(t.showUICoin(i,e.param),t.define.fishid==So.BlueShake&&t.showBlueShakeLottery(i,e.param)):15===e.category&&1==e.param?i.isSelf&&d.I.showDragonBoxAward(e.score):17===e.category?i.isSelf&&0<=e.param&&e.param<=2?(Ro.playSound("SFX_UI_039.mp3"),t.showBossWin("exact",null,e.score)):3==e.param&&t instanceof Bo&&(t.killScore=e.score,t.killUser=i):18===e.category&&t.showDiceLottery(i,e.score,e.param)))}},{key:"onPropAddResp",value:function(i){var e,n,a,s=this,r=d.I.getUser(i.uid);r&&(r.setPropsNum(i.prop_id,i.new_num),(e=Oo.I.getFishByUniqueId(i.target_id))&&(n="award_props_"+i.prop_id,a=(a=kr.getItem(n))||new Ki.fishxy.animation["award_props_"+i.prop_id+"UI"],d.I.view.ui_effect_layer.addChild(a),a.pos(e.position.x,e.position.y),a.scale(1,1),a.ani1.play(0,!1),a.ani1.once(Me.COMPLETE,this,function(){var e=r.getPropsCardPosition(i.prop_id),t=1.5*e.distance(a.x,a.y);Ci.to(a,{x:e.x,y:e.y,scaleX:.4,scaleY:.4},t,null,x.create(s,function(){a.removeSelf(),kr.recover(n,a),r.getPropsCard(i.prop_id).setNum(r.getPropsNum(i.prop_id))}))})))}},{key:"onPropUseResp",value:function(e){var t=d.I.getUser(e.uid);t&&t.setPropsNum(e.prop_id,e.new_num)}},{key:"onBulletEnterResp",value:function(e){var t=d.I.getUserByPosition(e.infos[0].location);!t||t.status.isChangingGun&&t.isOther||(t.isSelf||t.status.targetFish||(t.gun.serverRotation=e.bullet_attr.bullet_angle),t.gun.shoot(e.infos.map(function(e){return e.bullet_id})))}},{key:"onAvatarEffectGet",value:function(e){var t;3<=e.state_info.state_id&&e.state_info.state_id<=6&&((t=d.I.getUser(e.uid)).isOther||(t.status.isChangingGun=!0,(t=new zo.SwitchCannonTypeReq).uid=e.uid,t.cannon_type={1:{name:"清屏",id:0},2:{name:"冻结",id:0},3:{name:"如意金箍棒",id:2},4:{name:"降魔水波",id:3},5:{name:"佛法无边",id:4},6:{name:"九齿乱击",id:5},7:{name:"骰子",id:18}}[e.state_info.state_id].id,Jo.I.send(t)))}},{key:"onAvatarEffectOver",value:function(t){var i=d.I.getUser(t.uid);i.status.isChangingGun=!0,i.changeGun(ih.Level,i.status.gunLevel,!1,x.create(this,function(){var e;i.isOther||((e=new zo.SwitchCannonTypeReq).uid=t.uid,e.cannon_type=ih.Level,Jo.I.send(e))}))}},{key:"onSwitchCannonResp",value:function(e){var t=d.I.getUser(e.uid);t&&t.changeGun(e.gun_type,e.gun_level)}},{key:"onChangeAutoShootResp",value:function(e){var t=d.I.getUser(e.uid);t&&(t.status.isAutoFire=Boolean(e.is_shoot))}},{key:"onChangeShootSpeedResp",value:function(e){var t=d.I.getUser(e.uid);t&&(t.status.fireSpeed=e.speed)}},{key:"onChangeLockKindResp",value:function(e){var t=d.I.getUser(e.uid);t&&(t.status.lockKind=e.lock_kind==Ao.None?Ao.None:e.lock_kind+3,t.isSelf&&e.lock_kind!=Ao.None&&u.frameOnce(2,this,function(){t.status.targetFish||(new ah).show("当前鱼池中没有"+(t.status.lockKind==Ao.Large?"大鱼":"特殊鱼"),d.I.view.ui_layer)}))}},{key:"onChangeLockTargetResp",value:function(e){var t=d.I.getUser(e.uid);t&&!t.isSelf&&(e=Oo.I.getFishByUniqueId(e.target_id))&&t.gun.lockFish(e)}},{key:"onNewFish",value:function(e){var t,i=new zo.TargetPathInfo,n=(i.target_conf=new zo.TargetConf,i.target_conf.target_path_id=e.path_ids[0],i.target_conf.use_time=0,i.target_infos=[],Y(e.infos));try{for(n.s();!(t=n.n()).done;){var a=t.value,s=new zo.TargetInfo;s.target_id=a.target_id,s.target_type=a.target_type,s.target_blood=a.target_blood,s.state_infos=a.state_infos,s.is_dead=0,i.target_infos.push(s)}}catch(e){n.e(e)}finally{n.f()}Oo.I.addRoute([i])}},{key:"onBoosWarningResp",value:function(e){Oo.I.bossWarning(e)}},{key:"onBeSweepResp",value:function(e){Oo.I.sweepFish(e)}},{key:"onBeHitResp",value:function(e){var t,i=Oo.I.getFishByUniqueId(e.target_id);i&&(e.target_dead&&i.lifeState!=Io.Died?(t=d.I.getUser(e.uid),i.die(t)):i instanceof Bo&&i.lifeState==Io.EnterScreen&&i.setHp(e.target_blood))}},{key:"onSocketClose",value:function(e){d.I.socketClose(e)}},{key:"gameLoginFailResp",value:function(e){var t="";switch(e.error){case eh.LoginFailedNomoney.error:case eh.LoginFailedNousemoney.error:t=0<e.infos.length?"您当前正在"+e.infos[0]+"中,请稍后再进！":"身上携带的钱不够进入当前房间，请取钱或者充值";break;case eh.LoginFailedLowlv.error:t="账号级别达到"+e.body+"才能进入游戏!";break;case eh.Loadmoney.error:case eh.LoadmoneyFail.error:break;case eh.SitFailed.error:case eh.LoginFailedClosed.error:t=eh.getBody(e.error,e.body);break;case eh.LoginFailedX.error:return void d.I.closeBrowser();default:t=eh.getBody(e.error,e.body)}_.event.off(Yo.SocketClose,this,this.onSocketClose),_.defaultLoadingView.hide(),th.I.showInfo(t,x.create(d.I,d.I.closeBrowser))}}],[{key:"I",get:function(){return this._instance||(this._instance=new e),this._instance}}]),e}(),rh=function(){f(t,on);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t)}(),d=function(){f(i,ln);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).users=[],e.npcIds=[],e.timer=new Oi,i.I=O(e),e}return y(i,[{key:"init",value:function(){this.initFunctionBtn(),this.initScene(),Oo.I.init(),sh.I.listen(),Jo.I.loginGame(this.args.room),_.defaultLoadingView.show("分配房间中...",x.create(this,this.closeBrowser)),Ro.playMusic("BGM_003.mp3")}},{key:"initScene",value:function(){this.view.zOrder=100,this.changeBackground(),this.initWater(),this.adjustUI(),_.event.on(Me.RESIZE,this,this.adjustUI)}},{key:"starGame",value:function(e){if(this.enter=e,this.isReconect){this.isReconect=!1;var t,i=Y(this.users);try{for(i.s();!(t=i.n()).done;)t.value.sitUpGame()}catch(e){i.e(e)}finally{i.f()}}this.alreadyInitBtn||(this.initOperationBtn(),this.initShootEvent(),this.alreadyInitBtn=!0),this.initUsers(e.memberinfos),this.clearAllBullet(),this.timer.once(100,this,function(){_.defaultLoadingView.hide()}),_.DEBUG&&this.timer.loop(5e3,this,function(){})}},{key:"initFunctionBtn",value:function(){var e=this;this.view.show_group_btn.on(Me.CLICK,this,function(){e.view.show_group_btn.visible=!1,e.view.hide_group_btn.visible=!0,Ci.to(e.view.right_box,{x:-270},200)}),this.view.hide_group_btn.on(Me.CLICK,this,function(){e.view.show_group_btn.visible=!0,e.view.hide_group_btn.visible=!1,Ci.to(e.view.right_box,{x:60},300)}),this.view.help_btn.on(Me.CLICK,this,function(){$o.I.pop(0)}),this.view.setting_btn.on(Me.CLICK,this,function(){$o.I.pop(3)}),this.view.exit_btn.on(Me.CLICK,this,function(){e.exitGame()})}},{key:"initOperationBtn",value:function(){this.view.lock_big_clip.on(Me.CLICK,this,this.onClickLockFishKindBtn,[Ao.Large]),this.view.lock_special_clip.on(Me.CLICK,this,this.onClickLockFishKindBtn,[Ao.Special]),this.view.lock_cancel_btn.on(Me.CLICK,this,this.onClickLockCancelBtn),this.view.lock_cancel_btn.disabled=!0}},{key:"onClickLockFishKindBtn",value:function(e){var t;this.getSelfUser().status.lockKind!=e?((t=new zo.ChangeLockKindReq).uid=this.getSelfUser().member.uid,t.lock_type=e-3,Jo.I.send(t)):this.getSelfUser().gun.lockKind()}},{key:"onClickLockCancelBtn",value:function(){var e=new zo.ChangeLockKindReq,e=(e.uid=this.getSelfUser().member.uid,e.lock_type=Ao.None,Jo.I.send(e),new zo.ChangeLockTargetReq);e.uid=this.getSelfUser().member.uid,e.target_id=0,Jo.I.send(e)}},{key:"initShootEvent",value:function(){var t=this;this.view.fight_layer.on(Me.MOUSE_DOWN,this,function(){var e=t.getSelfUser();e.mousePoint.x=u.mouseX,e.mousePoint.y=u.mouseY,e.gun.onMouseDown()}),this.view.fight_layer.on(Me.MOUSE_UP,this,function(){var e=t.getSelfUser();e.mousePoint.x=u.mouseX,e.mousePoint.y=u.mouseY,e.gun.onMouseUp()}),this.view.fight_layer.on(Me.MOUSE_MOVE,this,function(){var e=t.getSelfUser();e.mousePoint.x=u.mouseX,e.mousePoint.y=u.mouseY,e.gun.onMouseMove()})}},{key:"initUsers",value:function(e){this.users=[];var t=e.find(function(e){return e.uid==_.data.account.userid});if(2==t.position||3==t.position){this.isMirror=!0;var i,n=Y(e);try{for(n.s();!(i=n.n()).done;){var a=i.value;0==a.position?a.position=3:1==a.position?a.position=2:2==a.position?a.position=1:3==a.position&&(a.position=0)}}catch(e){n.e(e)}finally{n.f()}}else this.isMirror=!1;var s,r=Y(e);try{for(r.s();!(s=r.n()).done;){var o=s.value,h=this.view.user_layer.getChildByName("seat_"+o.position).getComponent(Th);h.setMember(o),this.users.push(h)}}catch(e){r.e(e)}finally{r.f()}}},{key:"adjustUI",value:function(){this.view.size(u.width,u.height),this.adjustWeapon(),this.adjustWater()}},{key:"adjustWeapon",value:function(){for(var e=0;e<this.view.user_layer.numChildren;e++)this.view.user_layer.getChildAt(e).x=0==e||3==e?u.width/5:u.width/5*4}},{key:"adjustWater",value:function(){for(var e=0,t=0;t<3;t++)for(var i=0;i<5;i++){var n=this.view.warter_layer.getChildAt(e++);n.img.width=u.width/5,n.img.height=u.height/3,n.x=u.width/5*i,n.y=u.height/3*t}}},{key:"initWater",value:function(){for(var e=0;e<15;e++){var t=new Ki.fishxy.animation.water_effectUI;t.ani1.play(0,!0),this.view.warter_layer.addChild(t)}}},{key:"getUser",value:function(t){return this.users?this.users.find(function(e){return e.member.uid==t}):null}},{key:"getUserByPosition",value:function(e){return this.isMirror&&(0==e?e=3:1==e?e=2:2==e?e=1:3==e&&(e=0)),this.view.user_layer.getChildByName("seat_"+e).getComponent(Th)}},{key:"getSelfUser",value:function(){return this.getUser(_.data.account.userid)}},{key:"showDragonBoxAward",value:function(e){function t(){n.timer.frameOnce(2,i,function(){n.sk.play(0,!1),n.popupEffect=null,n.score.font="bmfont_bigCoin.fnt",Eo.tweenNumber(n.score,0,e,1e3),n.popup(),n.timer.once(3e3,i,function(){n.close(),kr.recover("dragon_box_eff",n)})})}var i=this,n=kr.getItem("dragon_box_eff");n?t():o.loader.load(["fishxy/animation/dragon_box/JACKPOT_Cn.sk","fishxy/animation/dragon_box/JACKPOT_Cn.png"],x.create(this,function(){n=new Ki.fishxy.animation.dragon_box_effUI,t()}))}},{key:"shakeScene",value:function(){var e,t=this;e=this.view.bg,Ci.to(e,{x:15,y:15},50,null,x.create(t,function(){Ci.to(e,{x:0,y:0},50,null,x.create(t,function(){Ci.to(e,{x:15,y:15},50,null,x.create(t,function(){Ci.to(e,{x:0,y:0},50,null,x.create(t,function(){Ci.to(e,{x:15,y:15},50,null,x.create(t,function(){Ci.to(e,{x:0,y:0},50)}))}))}))}))}))}},{key:"showFishArrayComingEffect",value:function(){Ro.playSound("SFX_UI_027.mp3");var e=kr.getItem("fish_array_coming");(e=e||new Ki.fishxy.animation.fish_array_comingUI).size(u.width,u.height),e.zOrder=999,this.view.fight_layer.addChild(e),e.wave.scaleY=u.height/720,e.wave.x=u.width,e.bg.width=u.width,e.bg.x=u.width,Ci.to(e.bg,{x:0},1e3,null,x.create(this,function(){Ro.playSound("SFX_UI_028.mp3"),Ci.to(e.wave,{x:-e.wave.width},3e3)})),e.ani1.play(0,!1),e.ani1.once(Me.COMPLETE,this,function(){e.removeSelf(),kr.recover("fish_array_coming",e)})}},{key:"showBossComing",value:function(){Ro.playSound("SFX_UI_037.mp3");var e=kr.getItem("boss_coming_ui");(e=e||new Ki.fishxy.animation.boss_comingUI).size(u.width,u.height),e.ani1.play(0,!0),e.ani2.play(0,!1),e.ani2.once(Me.COMPLETE,e.ani3,e.ani3.play,[0,!0]),e.item.x=u.width,Ci.to(e.item,{x:u.width-e.item.width},6e3),e.tips1.x=u.width,Ci.to(e.tips1,{x:u.width-e.tips1.width},5500,null,null,1500),e.tips2.x=0,Ci.to(e.tips2,{x:e.tips2.width-u.width},5500,null,null,1500),e.timer.once(5e3,this,function(){e.removeSelf(),kr.recover("boss_coming_ui",e)}),i.I.view.ui_layer.addChild(e)}},{key:"changeBackground",value:function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;if(void 0===this.view.bg.skin)this.view.bg.skin="fishxy/fight/bg/img_game_bg"+br.randInt(0,4)+".png";else{for(;this.view.bg.skin==e||!e;)e="fishxy/fight/bg/img_game_bg"+br.randInt(0,4)+".png";this.view.bg_temp.skin=this.view.bg.skin,this.view.bg_temp.alpha=1,Ci.to(this.view.bg_temp,{alpha:0},t),this.view.bg.skin=e,this.view.bg.alpha=0,Ci.to(this.view.bg,{alpha:1},t)}}},{key:"getViewCtor",value:function(){return Ki.fishxy.fight.FightSceneUI}},{key:"getResource",value:function(){return[new ha("fishxy/fight/mainui.atlas"),new ha("fishxy/font/bmfont_RoleGoldZi.fnt"),new ha("fishxy/font/bmfont_bigWin.fnt"),new ha("fishxy/font/bmfont_bigCoin.fnt"),new ha("fishxy/font/bmfont_gold.fnt"),new ha("fishxy/font/bmfont_fishBeiZi.fnt"),new ha("fishxy/font/bmfont_zongFen.fnt"),new ha("fishxy/font/bmfont_bossTime.fnt"),new ha("fishxy/font/bmfont_bossZi.fnt"),new ha("fishxy/font/bmfont_fireCoin.fnt"),new ha("fishxy/font/bmfont_pickFish.fnt"),new ha("fishxy/font/bmfont_jiangchiZi.fnt"),new ha(wr.Level_GUN_CONF)].concat(Oo.I.getResource())}},{key:"destroy",value:function(){}},{key:"clearAllBullet",value:function(){for(var e in nh.Pool)nh.Pool[e].recover();nh.Pool={}}},{key:"socketClose",value:function(e){var t=this;e==zo.name&&(this.userExitGame?this.closeBrowser():(_.defaultLoadingView.show("网络连接中，请稍后"),this.isReconect||(this.isReconect=!0,this.allUserOffLine()),this.timer.once(2e3,this,function(){Jo.I.loginGame(t.args.room)})))}},{key:"exitGame",value:function(){this.userExitGame=!0,_.defaultLoadingView.show("正在退出游戏..."),Jo.I.send(new zo.GameQuitReq),this.timer.loop(3e3,this,function(){Jo.I.send(new zo.GameQuitReq)})}},{key:"closeBrowser",value:function(){Jo.I.gameSocket.close(),I.window.parent.postMessage("closeFrame","*")}},{key:"allUserOffLine",value:function(){if(this.users){var e,t=Y(this.users);try{for(t.s();!(e=t.n()).done;)e.value.offLine()}catch(e){t.e(e)}finally{t.f()}}}}]),i}(),oh=((wo=ko=ko||{})[wo.Level=0]="Level",wo[wo.Jgb=13]="Jgb",wo[wo.Xmsb=14]="Xmsb",wo[wo.Ffwb=15]="Ffwb",wo[wo.Jclj=16]="Jclj",ko),hh=y(function e(t,i){b(this,e),this.fishUniqueId=t,this.fishCollider=i}),lh=function(){f(i,nh);var t=T(i);function i(){var e;return b(this,i),(e=t.apply(this,arguments)).direction=new ie,e.speed=new ie,e}return y(i,[{key:"init",value:function(e,t,i,n){this.setData(e,t),this.target=n,this.gunConfiger=i,this.calSpeed(),t.status.curtBulletCount++}},{key:"calSpeed",value:function(){this.target&&this.target.lifeState==Io.EnterScreen&&(this.node.rotation=br.getRotation(this.node.x,this.node.y,this.target.collider.position.x,this.target.collider.position.y)),this.direction.x=this.node.rotation<-90||90<this.node.rotation?-1:1,this.direction.y=Math.tan(this.node.rotation*Math.PI/180)*this.direction.x,this.direction.normalize(),this.speed.x=this.direction.x,this.speed.y=this.direction.y}},{key:"update",value:function(e){this.checkTarget(),this.bounce(),this.updateTransform(e),this.checkCrash()}},{key:"type",get:function(){return oh.Level}},{key:"checkTarget",value:function(){this.target&&this.target.lifeState!=Io.EnterScreen&&(this.target=null)}},{key:"updateTransform",value:function(e){this.target&&this.calSpeed(),this.node.x+=this.speed.x*e*1.5,this.node.y+=this.speed.y*e*1.5}},{key:"bounce",value:function(){(this.node.x<0||this.node.x>u.width)&&(this.node.x=this.node.x<0?0:u.width,this.node.rotation=180*br.getSign(this.node.rotation)-this.node.rotation,this.calSpeed()),(this.node.y<0||this.node.y>u.height)&&(this.node.y=this.node.y<0?0:u.height,this.node.rotation=-this.node.rotation,this.calSpeed())}},{key:"checkCrash",value:function(){if(_.DEBUG,this.target&&this.target.lifeState==Io.EnterScreen&&!this.isAlreadyHited(this.target))this.checkFish(this.target);else{var e,t=Y(Oo.I.fishes);try{for(t.s();!(e=t.n()).done;){var i=e.value;if(!this.isAlreadyHited(i)&&i.lifeState==Io.EnterScreen&&this.checkFish(i))return}}catch(e){t.e(e)}finally{t.f()}}}},{key:"checkFish",value:function(e){var t,i=Y(e.fishColliderArr);try{for(i.s();!(t=i.n()).done;){var n,a=t.value;if(a.position.distance(this.colliderWorldPosition.x,this.colliderWorldPosition.y)<=a.raduis+this.radius)return n=this.netFish(e,a),e.hit(this.user),n.unshift(new hh(e.uniqueId,a)),this.hit(n),this.createNet(this.colliderWorldPosition.x,this.colliderWorldPosition.y),this.recover(),!0}}catch(e){i.e(e)}finally{i.f()}}},{key:"netFish",value:function(e,t){var i,n=new Array,a=Y(Oo.I.fishes);try{for(a.s();!(i=a.n()).done;){var s=i.value;if(s.lifeState==Io.EnterScreen&&s.uniqueId!=e.uniqueId&&!this.isAlreadyHited(s)){var r,o=Y(s.fishColliderArr);try{for(o.s();!(r=o.n()).done;){var h=r.value;if(t.position.distance(h.position.x,h.position.y)<=60){s.hit(this.user),n.push(new hh(s.uniqueId,h));break}}}catch(e){o.e(e)}finally{o.f()}}}}catch(e){a.e(e)}finally{a.f()}return n}},{key:"createNet",value:function(e,t){var i=this,n=(n=kr.getItem(this.gunConfiger.net))||new Ki.fishxy.animation.bullet[this.gunConfiger.net],e=(d.I.view.fight_layer.addChild(n),n.rotation=br.randInt(0,360),n.pos(e,t),n.ani1);e.play(0,!1),e.offAll(Me.COMPLETE),e.once(Me.COMPLETE,this,function(){n.removeSelf(),kr.recover(i.gunConfiger.net,n)})}},{key:"isLimitBulletNumber",get:function(){return!0}},{key:"recover",value:function(){m(g(i.prototype),"recover",this).call(this),this.node.removeSelf(),kr.recover(this.node.recycleKey,this.node),this.target=null}}]),i}(),uh=function(){function t(e){b(this,t),this.timer=new Oi,this.gunRecoverSign=e}return y(t,[{key:"init",value:function(e){this.user=e,this.isRecover=!1,this.initGun()}},{key:"stop",value:function(){this.timer.clearAll(this)}},{key:"initGun",value:function(){this.gunView=this.getGunView(),this.playAnimation("stay"),this.cannon_level_label=this.gunView.getChildByName("cannon_level"),this.cannon_level_label.font="bmfont_fireCoin.fnt",this.cannon_level_label.text=this.user.status.gunLevel.toString(),2!=this.user.member.position&&3!=this.user.member.position||(this.cannon_level_label.rotation=180)}},{key:"updateRateText",value:function(){this.cannon_level_label.text=this.user.status.gunRate}},{key:"requestShoot",value:function(){this.user.status.lastShootTime=Date.now(),this.user.isSelf&&this.user.startNoActionCountDown();var e=new zo.ShootReq;e.uid=this.user.member.uid,e.angle=this.serverRotation,Jo.I.send(e)}},{key:"playAnimation",value:function(e,t,i){"stay"==e?this.gunView.attack.stop():"attack"==e&&this.gunView.stay.stop(),this.gunView[e].play(t,i)}},{key:"stopAnimation",value:function(e){this.gunView[e].stop()}},{key:"muzzleWorldPos",get:function(){var e=this.getRotationComponent().getChildByName("muzzle");return br.temp0Point.setTo(e.x,e.y),this.getRotationComponent().localToGlobal(br.temp0Point)}},{key:"getRotationComponent",value:function(){return this.gunView}},{key:"serverRotation",get:function(){return this.user.member.position<2?90-this.getRotationComponent().rotation:this.getRotationComponent().rotation-90},set:function(e){this.user.member.position<2?this.getRotationComponent().rotation=90-e:this.getRotationComponent().rotation=e+90}},{key:"rotation",get:function(){return this.user.member.position<2?-this.serverRotation:this.serverRotation}},{key:"setDiretion",value:function(e,t){br.temp0Point.setTo(e,t),this.getRotationComponent().parent.globalToLocal(br.temp0Point);e=Ri.getRotation(this.getRotationComponent().x,this.getRotationComponent().y,br.temp0Point.x,br.temp0Point.y);this.getRotationComponent().rotation=e+90}},{key:"name",get:function(){return this.gunView.name},set:function(e){this.gunView.name=e}},{key:"pos",value:function(e,t){this.gunView.pos(e,t)}},{key:"addTo",value:function(e){e.addChild(this.gunView)}},{key:"setIndex",value:function(e){this.gunView.parent.setChildIndex(this.gunView,e)}},{key:"recover",value:function(){this.isRecover=!0,this.gunView.removeSelf(),p.recover(this.gunRecoverSign,this)}}]),t}(),ch=function(){function e(){b(this,e)}return y(e,null,[{key:"getGun",value:function(e,t){var i=o.loader.getRes(wr.Level_GUN_CONF),n=i.rooms[e][t-1];return i.guns.find(function(e){return e.gun_id==n})}}]),e}(),_h=function(){f(t,ah);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"popup",value:function(){var e=this;this.isShowing||(this.isShowing=!0,m(g(t.prototype),"show",this).call(this,"开炮过于频繁，屏幕最大炮弹限制10发",d.I.view.ui_layer,x.create(this,function(){e.isShowing=!1})))}}],[{key:"I",get:function(){return this._instance||(this._instance=new t),this._instance}}]),t}(),fh=function(){f(t,uh);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"onMouseDown",value:function(){this.user.status.isMouseDown=!0,this.user.status.lockKind||this.setDiretion(this.user.mousePoint.x,this.user.mousePoint.y)}},{key:"onMouseMove",value:function(){this.user.status.isMouseDown&&!this.user.status.lockKind&&this.setDiretion(this.user.mousePoint.x,this.user.mousePoint.y)}},{key:"onUpdate",value:function(){var e;this.user.isSelf?(!this.user.status.targetFish||this.user.status.targetFish.lifeState==Io.EnterScreen&&this.user.status.targetFish.define.kind==this.user.status.lockKind||(this.user.status.targetFish=null,(e=new zo.ChangeLockTargetReq).uid=this.user.member.uid,e.target_id=0,Jo.I.send(e)),this.user.status.lockKind&&!this.user.status.targetFish&&this.lockKind(),!this.user.status.isMouseDown||Date.now()-this.user.status.lastShootTime<Th.FIRE_SPEED/this.user.status.fireSpeed||(this.user.gun.isLimitBulletNumber&&10<=this.user.status.curtBulletCount?_h.I.popup():(this.user.status.isEnoughMoney=this.user.member.bag_money>=d.I.enter.cannon_rate*this.user.status.gunLevel,this.user.status.isEnoughMoney&&(this.user.status.lockKind?this.user.status.targetFish&&(this.setDiretion(this.user.status.targetFish.position.x,this.user.status.targetFish.position.y),this.requestShoot()):this.requestShoot())))):this.user.status.targetFish&&this.user.status.targetFish.define.kind!=this.user.status.lockKind&&(this.user.status.targetFish=null)}},{key:"shoot",value:function(e){this.user.isSelf&&Ro.playSound("SFX_UI_022.mp3"),this.playAnimation("attack",0,!1),this.gunView.attack.once(Me.STOPPED,this,this.playAnimation,["default"]),this.createBullet(e[0])}},{key:"lockFish",value:function(e){this.user.status.targetFish=e}},{key:"onMouseUp",value:function(){this.user.status.isMouseDown&&(this.user.status.isMouseDown=!1)}},{key:"initGun",value:function(){m(g(t.prototype),"initGun",this).call(this)}},{key:"getGunView",value:function(){return this.gunConfiger=ch.getGun(0,this.user.status.gunLevel),new Ki.fishxy.animation.gun[this.gunConfiger.name]}},{key:"createBullet",value:function(e){var t=kr.getItem(this.gunConfiger.bullet);return(t=t||new Ki.fishxy.animation.bullet[this.gunConfiger.bullet]).rotation=this.rotation,t.pos(this.muzzleWorldPos.x,this.muzzleWorldPos.y),(t.getComponent(lh)||t.addComponent(lh)).init(e,this.user,this.gunConfiger,this.user.status.targetFish),t}},{key:"lockKind",value:function(){var e,t=this,i=this.user.status.targetFish;if(i){for(var n=Oo.I.fishes,a=n.indexOf(i),s=!1,r=a+1;r<=n.length&&!((s=r==n.length?!(r=0):s)&&a<r);r++)if(n[r].define.kind==this.user.status.lockKind&&n[r].lifeState==Io.EnterScreen){e=n[r];break}}else Oo.I.fishes.sort(function(){return.5<Math.random()?1:-1}),e=Oo.I.fishes.find(function(e){return e.define.kind==t.user.status.lockKind&&e.lifeState==Io.EnterScreen});i!=e&&(this.user.status.targetFish=e,(i=new zo.ChangeLockTargetReq).uid=this.user.member.uid,i.target_id=e?e.uniqueId:0,Jo.I.send(i))}},{key:"canLockTarget",get:function(){return!0}},{key:"isLevelGun",get:function(){return!0}},{key:"isSpecialGun",get:function(){return!1}},{key:"isLimitBulletNumber",get:function(){return!0}}]),t}(),dh=function(){f(n,Ki.fishxy.fight.NoActionCountDownDilaogUI);var e=T(n);function n(){return b(this,n),e.apply(this,arguments)}return y(n,[{key:"popup",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],i=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];_.defaultLoadingView.show(),o.loader.load("fishxy/fight/dialog.atlas",x.create(this,function(){e.init(),m(g(n.prototype),"popup",e).call(e,t,i),_.defaultLoadingView.hide()}))}},{key:"init",value:function(){u.offAllCaller(this),u.once(Me.CLICK,this,this.close),this.closeHandler=x.create(this,this.stopTimer),this.timer_label.text="15",u.timerLoop(1e3,this,this.countDown)}},{key:"countDown",value:function(){"0"==this.timer_label.text?this.stopTimer():this.timer_label.text=(Number(this.timer_label.text)-1).toString()}},{key:"stopTimer",value:function(){u.timer.clearAll(this)}}],[{key:"I",get:function(){return n._instance=n._instance?n._instance:new n}}]),n}(),ph=function(){function t(e){b(this,t),this.gunLevel=-1,this.curtBulletCount=0,this.lastShootTime=0,this._fireSpeed=1,this.user=e}return y(t,[{key:"gunRate",get:function(){var e=((d.I.enter.cannon_levels[this.gunLevel-1]||0)*d.I.enter.cannon_rate).toFixed(2);return Eo.tofixNumber(e)}},{key:"fireSpeed",get:function(){return this._fireSpeed},set:function(e){this.user.gun&&(this._fireSpeed=-1!=e?e:2*this._fireSpeed,5<this._fireSpeed&&(this._fireSpeed=1),this.user.isSelf&&(this.user.fire_speed_btn.index=Math.floor(this._fireSpeed/2)))}},{key:"isMouseDown",get:function(){return this._isMouseDown},set:function(e){this._isMouseDown=e}},{key:"isAutoFire",get:function(){return this._isAutoFire},set:function(e){this._isAutoFire=e,this.user.isSelf&&(this.user.auto_fire_btn.index=e?1:0)}},{key:"lockKind",get:function(){return this._lockKind},set:function(e){this._lockKind=e,this.user.isSelf&&(d.I.view.lock_big_clip.index=e==Ao.Large?1:0,d.I.view.lock_special_clip.index=e==Ao.Special?1:0,d.I.view.lock_cancel_btn.disabled=0==e)}},{key:"resetStatus",value:function(){this.lockKind=null,this.isMouseDown=!1,this.targetFish=null,this.isChangingGun=!1}}]),t}(),yh=function(){function e(){b(this,e),this.pointGrap=30,this.initLine(),this.initCross()}return y(e,[{key:"initLine",value:function(){this.pointArray=new Array,this.line=new vn,this.line.height=12,this.line.anchorY=.5,d.I.view.fight_layer.addChild(this.line)}},{key:"initCross",value:function(){this.cross=new h,this.cross.anchorX=this.cross.anchorY=.5,this.cross.scale(1,1),this.cross.visible=!1,this.cross.skin="fishxy/fight/mainui/img_cross_1.png",d.I.view.fight_layer.addChild(this.cross)}},{key:"update",value:function(e,t){this.updateCross(t),this.updateLine(e,t),this.cross.visible=!0,this.line.visible=!0}},{key:"updateCross",value:function(e){this.cross.pos(e.x,e.y)}},{key:"updateLine",value:function(e,t){var i=e.distance(t.x,t.y)-this.pointGrap-10,n=Math.floor(i/this.pointGrap);if(this.pointArray.length>n)for(var a=this.pointArray.length-1;n<=a;a--)kr.recycle(this.pointArray[a]),this.pointArray.pop();else if(this.pointArray.length<n)for(var s=this.pointArray.length;s<n;s++){var r=kr.getItemWithType("fishxy/fight/mainui/aiming_line.png",h);r.x=(s+1)*this.pointGrap,this.line.addChild(r),this.pointArray.push(r)}this.line.pos(e.x,e.y),this.line.rotation=br.twoPointAngle(this.line.x,this.line.y,t.x,t.y)}},{key:"hide",value:function(){this.line.visible=this.cross.visible=!1}}],[{key:"I",get:function(){return this._instance||(this._instance=new e),this._instance}}]),e}(),gh=function(){f(i,uh);var t=T(i);function i(){var e;return b(this,i),(e=t.apply(this,arguments)).alreadyFire=!1,e.isMouseDown=!1,e}return y(i,[{key:"init",value:function(e){var t=this;m(g(i.prototype),"init",this).call(this,e),e.isNpc&&this.timer.once(br.randInt(4e3,1e4),this,function(){e.gun.setDiretion(u.width/2+br.randInt(-500,500),u.height/2),t.requestShoot()}),e.isSelf&&(this.countDownFireTime=10,this.timer.loop(1e3,this,this.countDownFire))}},{key:"countDownFire",value:function(){this.countDownFireTime--,0==this.countDownFireTime?(this.requestShoot(),this.user.setCountDownFireVisible(!1),this.timer.clear(this,this.countDownFire)):(this.user.setCountDownFireVisible(!0),this.user.setCountDownFireTime(this.countDownFireTime))}},{key:"shoot",value:function(e){this.doShoot(e),this.user.isSelf&&(this.user.setCountDownFireVisible(!1),this.timer.clear(this,this.countDownFire),this.user.startNoActionCountDown())}},{key:"showGunLogo",value:function(){var e=this,t=p.getItem("gun_logo_"+this.user.status.gunType);(t=t||this.getGunLogo()).pos(u.width/2,u.height/2),d.I.view.ui_layer.addChild(t),u.timer.once(3e3,this,function(){t.removeSelf(),p.recover("gun_logo_"+e.user.status.gunType,t)})}},{key:"onUpdate",value:function(){}},{key:"onMouseDown",value:function(){this.alreadyFire||(this.isMouseDown=!0,this.setDiretion(this.user.mousePoint.x,this.user.mousePoint.y))}},{key:"onMouseUp",value:function(){!this.alreadyFire&&this.isMouseDown&&(this.isMouseDown=!1,this.user.status.isChangingGun||this.requestShoot())}},{key:"onMouseMove",value:function(){this.isMouseDown&&this.setDiretion(this.user.mousePoint.x,this.user.mousePoint.y)}},{key:"lockFish",value:function(e){}},{key:"lockKind",value:function(){}},{key:"isLevelGun",get:function(){return!1}},{key:"isSpecialGun",get:function(){return!0}},{key:"canLockTarget",get:function(){return!1}},{key:"isLimitBulletNumber",get:function(){return!1}},{key:"recover",value:function(){this.isMouseDown=!1,this.alreadyFire=!1,this.timer.clear(this,this.countDownFire),this.user.setCountDownFireVisible(!1),m(g(i.prototype),"recover",this).call(this)}}]),i}(),mh=function(){f(i,nh);var t=T(i);function i(){var e;return b(this,i),(e=t.apply(this,arguments)).speed=new ie,e.boundPoint=new ie,e.boundTimes=0,e}return y(i,[{key:"init",value:function(e,t){this.setData(e,t),this.node.zOrder=10,this.createLighterEffect(),this.calBoundPosition(),this.tweenToBoundPoint()}},{key:"update",value:function(){this.checkCrash()}},{key:"type",get:function(){return oh.Jgb}},{key:"calBoundPosition",value:function(){var e=Math.tan(this.node.rotation/180*Math.PI),t=this.node.y-e*this.node.x,i=-90<=this.node.rotation&&this.node.rotation<=90?u.width:0,n=e*i+t;n<0?i=((n=0)-t)/e:n>u.height&&(i=((n=u.height)-t)/e),this.boundPoint.setTo(i,n)}},{key:"tweenToBoundPoint",value:function(){var e=this,t=(this.clearHitInfos(),this.boundPoint.distance(this.node.x,this.node.y));Ci.to(this.node,{x:this.boundPoint.x,y:this.boundPoint.y},t/3,null,x.create(this,function(){e.node.rotation=(e.node.rotation+180)%360,e.tweenToGun(),e.createBoundEffect()}))}},{key:"tweenToGun",value:function(){var e=this,t=(this.clearHitInfos(),this.boundPoint.distance(this.user.gun.muzzleWorldPos.x,this.user.gun.muzzleWorldPos.y));Ci.to(this.node,{x:this.user.gun.muzzleWorldPos.x,y:this.user.gun.muzzleWorldPos.y},t/3,null,x.create(this,function(){e.node.rotation=(e.node.rotation+180)%360,5<=++e.boundTimes?e.recover():e.node.timer.once(300,e,e.tweenToBoundPoint)}))}},{key:"createBoundEffect",value:function(){var e=kr.getItem("jgb_bound_effect");(e=e||new Ki.fishxy.animation.jgb_bound_explodeUI).pos(this.node.x,this.node.y),0==this.boundPoint.x?e.rotation=90:this.boundPoint.x==u.width?e.rotation=-90:0==this.boundPoint.y?e.rotation=180:this.boundPoint.y==u.height&&(e.rotation=0),e.ani1.play(0,!1),e.ani1.once(Me.COMPLETE,this,function(){e.removeSelf(),kr.recover("jgb_bound_effect",e)}),d.I.view.fight_layer.addChild(e)}},{key:"createLighterEffect",value:function(){this.lighterEffect||(this.lighterEffect=new Ki.fishxy.animation.gun.bgxyby_gun_13_lighterUI),this.lighterEffect.pos(this.node.x,this.node.y),this.lighterEffect.rotation=this.node.rotation,d.I.view.fight_layer.addChild(this.lighterEffect)}},{key:"checkCrash",value:function(){var e,t=Y(Oo.I.fishes);try{for(t.s();!(e=t.n()).done;){var i=e.value;if(!this.isAlreadyHited(i)&&i.lifeState==Io.EnterScreen&&!i.isSpecialFish){var n,a=Y(i.fishColliderArr);try{for(a.s();!(n=a.n()).done;){var s=n.value;if(s.position.distance(this.colliderWorldPosition.x,this.colliderWorldPosition.y)<=s.raduis+this.radius){i.hit(this.user),this.hit([new hh(i.uniqueId,s)]),this.createNet(s.position.x,s.position.y);break}}}catch(e){a.e(e)}finally{a.f()}}}}catch(e){t.e(e)}finally{t.f()}}},{key:"createNet",value:function(e,t){var i=(i=kr.getItem("jgb_net"))||new Ki.fishxy.animation.bullet.bgxyby_net_13UI;d.I.view.fight_layer.addChild(i),i.scale(.7,.7),i.pos(e,t),i.rotation=br.randInt(0,360),i.ani1.play(0,!1),i.ani1.offAll(Me.COMPLETE),i.ani1.once(Me.COMPLETE,this,function(){i.removeSelf(),kr.recover("jgb_net",i)})}},{key:"isLimitBulletNumber",get:function(){return!1}},{key:"recover",value:function(){var e=this;m(g(i.prototype),"recover",this).call(this),Ci.clearAll(this),Ci.to(this.lighterEffect,{alpha:0},500,null,x.create(this,function(){e.lighterEffect.alpha=1,e.lighterEffect.removeSelf()})),Ci.to(this.node,{alpha:0},500,null,x.create(this,function(){e.node.alpha=1,e.node.removeSelf(),kr.recover("jgb_bullet",e.node),e.boundTimes=0}))}}]),i}(),vh=function(){f(t,gh);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"getGunView",value:function(){return new Ki.fishxy.animation.gun.bgxyby_gun_13UI}},{key:"getGunLogo",value:function(){return new Ki.fishxy.animation.gun.bgxyby_gun_logo_13UI}},{key:"createBullet",value:function(e){var t=p.getItem("jgb_bullet");return(t=t||new Ki.fishxy.animation.bullet.bgxyby_bullet_13UI).rotation=this.rotation,t.pos(this.muzzleWorldPos.x,this.muzzleWorldPos.y),(t.getComponent(mh)||t.addComponent(mh)).init(e,this.user),t}},{key:"doShoot",value:function(e){this.user.isSelf&&(Ro.playSound("SFX_UI_032.mp3"),Ro.playSound("XYFishwords_MS_003.mp3")),this.playAnimation("attack",0,!1),this.gunView.bullet.visible=!1,this.createBullet(e[0])}}]),t}(),xh=function(){f(i,nh);var t=T(i);function i(){var e;return b(this,i),(e=t.apply(this,arguments)).direction=new ie,e.speed=new ie,e.timer=new Oi,e}return y(i,[{key:"init",value:function(e,t){var i=this;this.setData(e,t),this.calSpeed(),this.node.ani1.play(0,!0),this.timer.once(4e3,this,this.recover),this.timer.loop(700,this,function(){i.clearHitInfos(),i.checkCrash()})}},{key:"calSpeed",value:function(){this.direction.x=this.node.rotation<-90||90<this.node.rotation?-1:1,this.direction.y=Math.tan(this.node.rotation*Math.PI/180)*this.direction.x,this.direction.normalize(),this.speed.x=this.direction.x,this.speed.y=this.direction.y}},{key:"update",value:function(e){this.updateTransform(e),this.checkCrash()}},{key:"updateTransform",value:function(e){this.node.x+=this.speed.x*e,this.node.y+=this.speed.y*e}},{key:"type",get:function(){return oh.Xmsb}},{key:"checkCrash",value:function(){var e,t=Y(Oo.I.fishes);try{for(t.s();!(e=t.n()).done;){var i=e.value;if(i.lifeState==Io.EnterScreen&&!i.isSpecialFish&&!this.isAlreadyHited(i)){var n,a=Y(i.fishColliderArr);try{for(a.s();!(n=a.n()).done;){var s=n.value;if(br.boxCircleIntersect(this.colliderWorldPosition,this.collider.width,this.collider.height,s.position,s.raduis,this.node.rotation)){this.hit([new hh(i.uniqueId,s)]),this.createNet(s.position.x,s.position.y);break}}}catch(e){a.e(e)}finally{a.f()}}}}catch(e){t.e(e)}finally{t.f()}}},{key:"createNet",value:function(e,t){var i=(i=kr.getItem("xmsb_net"))||new Ki.fishxy.animation.bullet.bgxyby_net_14UI;d.I.view.fight_layer.addChild(i),i.scale(.7,.7),i.pos(e,t),i.ani1.play(0,!1),i.ani1.offAll(Me.COMPLETE),i.ani1.once(Me.COMPLETE,this,function(){i.removeSelf(),kr.recover("xmsb_net",i)})}},{key:"isLimitBulletNumber",get:function(){return!1}},{key:"recover",value:function(){var e=this;m(g(i.prototype),"recover",this).call(this),this.timer.clearAll(this),Ci.to(this.node,{alpha:0},500,null,x.create(this,function(){e.node.alpha=1,e.node.removeSelf(),kr.recover("xmsb_bullet",e.node)}))}}]),i}(),kh=function(){f(t,gh);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"getGunView",value:function(){return new Ki.fishxy.animation.gun.bgxyby_gun_14UI}},{key:"getGunLogo",value:function(){return new Ki.fishxy.animation.gun.bgxyby_gun_logo_14UI}},{key:"createBullet",value:function(e){var t=kr.getItem("xmsb_bullet");return(t=t||new Ki.fishxy.animation.bullet.bgxyby_bullet_14UI).rotation=this.rotation,t.pos(this.muzzleWorldPos.x,this.muzzleWorldPos.y),(t.getComponent(xh)||t.addComponent(xh)).init(e,this.user),t}},{key:"doShoot",value:function(e){var t=this;this.user.isSelf&&(Ro.playSound("SFX_UI_030.mp3"),Ro.playSound("XYFishwords_MW_01.mp3")),this.createBullet(e[0]),this.playAnimation("attack",0,!1),this.gunView.attack.once(Me.COMPLETE,this,function(){t.playAnimation("stay")})}}]),t}(),wh=function(){f(i,nh);var t=T(i);function i(){var e;return b(this,i),(e=t.apply(this,arguments)).direction=new ie,e.speed=new ie,e}return y(i,[{key:"init",value:function(e,t){this.setData(e,t),this.calSpeed()}},{key:"calSpeed",value:function(){this.direction.x=this.node.rotation<-90||90<this.node.rotation?-1:1,this.direction.y=Math.tan(this.node.rotation*Math.PI/180)*this.direction.x,this.direction.normalize(),this.speed.x=this.direction.x,this.speed.y=this.direction.y}},{key:"update",value:function(e){this.bounce(),this.updateTransform(e),this.checkCrash()}},{key:"type",get:function(){return oh.Ffwb}},{key:"updateTransform",value:function(e){this.node.x+=this.speed.x*e*1.5,this.node.y+=this.speed.y*e*1.5}},{key:"bounce",value:function(){(this.node.x<0||this.node.x>u.width)&&(this.node.x=this.node.x<0?0:u.width,this.node.rotation=180*br.getSign(this.node.rotation)-this.node.rotation,this.calSpeed()),(this.node.y<0||this.node.y>u.height)&&(this.node.y=this.node.y<0?0:u.height,this.node.rotation=-this.node.rotation,this.calSpeed())}},{key:"checkCrash",value:function(){var e,t=Y(Oo.I.fishes);try{for(t.s();!(e=t.n()).done;){var i=e.value;if(i.lifeState==Io.EnterScreen&&!i.isSpecialFish&&!this.isAlreadyHited(i)&&this.checkFish(i))return}}catch(e){t.e(e)}finally{t.f()}}},{key:"checkFish",value:function(e){var t,i=Y(e.fishColliderArr);try{for(i.s();!(t=i.n()).done;){var n=t.value;if(n.position.distance(this.colliderWorldPosition.x,this.colliderWorldPosition.y)<=n.raduis+this.radius)return e.hit(this.user),this.hit([new hh(e.uniqueId,n)]),this.createNet(this.colliderWorldPosition.x,this.colliderWorldPosition.y),this.recover(),!0}}catch(e){i.e(e)}finally{i.f()}}},{key:"createNet",value:function(e,t){var i=(i=kr.getItem("jgb_net"))||new Ki.fishxy.animation.bullet.bgxyby_net_13UI;d.I.view.fight_layer.addChild(i),i.scale(.7,.7),i.pos(e,t),i.rotation=br.randInt(0,360),i.ani1.play(0,!1),i.ani1.offAll(Me.COMPLETE),i.ani1.once(Me.COMPLETE,this,function(){i.removeSelf(),kr.recover("jgb_net",i)})}},{key:"isLimitBulletNumber",get:function(){return!1}},{key:"recover",value:function(){m(g(i.prototype),"recover",this).call(this),this.node.removeSelf(),kr.recover("ffwb_bullet",this.node)}}]),i}(),bh=function(){f(t,gh);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"getGunView",value:function(){return new Ki.fishxy.animation.gun.bgxyby_gun_15UI}},{key:"getGunLogo",value:function(){return new Ki.fishxy.animation.gun.bgxyby_gun_logo_15UI}},{key:"createParentBullet",value:function(){var e=p.getItem("ffwb_bullet_parent");(e=e||new Ki.fishxy.animation.bullet.bgxyby_bullet_15_parentUI).pos(u.width/2,u.height/2),d.I.view.fight_layer.addChild(e),e.timer.once(1e3,this,function(){e.removeSelf(),p.recover("ffwb_bullet_parent",e)})}},{key:"createChildBullet",value:function(e){var t=p.getItem("ffwb_bullet_child");return(t=t||new Ki.fishxy.animation.bullet.bgxyby_bullet_15_childUI).ani1.play(0,!0),t.rotation=br.randInt(0,360),t.pos(u.width/2,u.height/2),(t.getComponent(wh)||t.addComponent(wh)).init(e,this.user),t}},{key:"doShoot",value:function(e){var t=this;this.user.isSelf&&Ro.playSound("XYFishwords_MT_001_1.mp3"),this.playAnimation("attack",0,!1),this.gunView.attack.once(Me.COMPLETE,this,function(){t.playAnimation("stay")}),this.createParentBullet();for(var i=0;i<e.length;i++)this.createChildBullet(e[i])}}]),t}(),Sh=function(){f(i,nh);var t=T(i);function i(){var e;return b(this,i),(e=t.apply(this,arguments)).direction=new ie,e.speed=new ie,e}return y(i,[{key:"init",value:function(e,t,i){this.setData(e,t),this.target=i,this.calSpeed(),this.node.ani1.play(0,!0)}},{key:"calSpeed",value:function(){this.target&&(this.node.rotation=br.getRotation(this.node.x,this.node.y,this.target.sprite.x,this.target.sprite.y)),this.direction.x=this.node.rotation<-90||90<this.node.rotation?-1:1,this.direction.y=Math.tan(this.node.rotation*Math.PI/180)*this.direction.x,this.direction.normalize(),this.speed.x=this.direction.x,this.speed.y=this.direction.y}},{key:"update",value:function(e){this.checkTarget(),this.bounce(),this.updateTransform(e),this.checkCrash()}},{key:"type",get:function(){return oh.Jclj}},{key:"checkTarget",value:function(){this.target&&this.target.lifeState!=Io.EnterScreen&&(this.target=null)}},{key:"updateTransform",value:function(e){this.target&&this.calSpeed(),this.node.x+=this.speed.x*e*1.5,this.node.y+=this.speed.y*e*1.5}},{key:"bounce",value:function(){(this.node.x<0||this.node.x>u.width)&&(this.node.x=this.node.x<0?0:u.width,this.node.rotation=180*br.getSign(this.node.rotation)-this.node.rotation,this.calSpeed()),(this.node.y<0||this.node.y>u.height)&&(this.node.y=this.node.y<0?0:u.height,this.node.rotation=-this.node.rotation,this.calSpeed())}},{key:"checkCrash",value:function(){if(this.target&&this.target.lifeState==Io.EnterScreen)this.checkFish(this.target);else{var e,t=Y(Oo.I.fishes);try{for(t.s();!(e=t.n()).done;){var i=e.value;if(i.lifeState==Io.EnterScreen&&!i.isSpecialFish&&!this.isAlreadyHited(i)&&this.checkFish(i))return}}catch(e){t.e(e)}finally{t.f()}}}},{key:"checkFish",value:function(e){var t,i=Y(e.fishColliderArr);try{for(i.s();!(t=i.n()).done;){var n=t.value;if(n.position.distance(this.colliderWorldPosition.x,this.colliderWorldPosition.y)<=n.raduis+this.radius)return e.hit(this.user),this.hit([new hh(e.uniqueId,n)]),this.createNet(this.colliderWorldPosition.x,this.colliderWorldPosition.y),this.recover(),!0}}catch(e){i.e(e)}finally{i.f()}}},{key:"createNet",value:function(e,t){var i=(i=kr.getItem("jclj_net"))||new Ki.fishxy.animation.bullet.bgxyby_net_16UI;d.I.view.fight_layer.addChild(i),i.scale(.7,.7),i.pos(e,t),i.ani1.play(0,!1),i.ani1.offAll(Me.COMPLETE),i.ani1.once(Me.COMPLETE,this,function(){i.removeSelf(),kr.recover("jclj_net",i)})}},{key:"isLimitBulletNumber",get:function(){return!1}},{key:"recover",value:function(){m(g(i.prototype),"recover",this).call(this),this.speed.setTo(0,0),this.node.removeSelf(),kr.recover("jclj_bullet",this.node),this.target=null}}]),i}(),Ih=function(){f(t,gh);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"init",value:function(e){m(g(t.prototype),"init",this).call(this,e),this.showAllBullet(),this.findTarget(),this.createLockIcon()}},{key:"showAllBullet",value:function(){for(var e=0;e<9;e++)this.gunView.getChildByName("bullet_"+e).visible=!0}},{key:"findTarget",value:function(){var e,t=Y(Oo.I.fishes.sort(function(){return.5<Math.random()?1:-1}));try{for(t.s();!(e=t.n()).done;){var i=e.value;if(i.lifeState==Io.EnterScreen&&!i.isSpecialFish)return void(this.target=i)}}catch(e){t.e(e)}finally{t.f()}}},{key:"createLockIcon",value:function(){this.lock||(this.lock=new Ki.fishxy.animation.jclj_lock_iconUI),this.lock.ani1.play(0,!0),d.I.view.fight_layer.addChild(this.lock)}},{key:"onUpdate",value:function(){m(g(t.prototype),"onUpdate",this).call(this),this.target?(this.lock.pos(this.target.position.x,this.target.position.y),this.target.lifeState!=Io.EnterScreen&&(this.lock.pos(-999,-999),this.findTarget())):(this.lock.pos(-999,-999),this.findTarget())}},{key:"getGunView",value:function(){return new Ki.fishxy.animation.gun.bgxyby_gun_16UI}},{key:"getGunLogo",value:function(){return new Ki.fishxy.animation.gun.bgxyby_gun_logo_16UI}},{key:"createBullet",value:function(e,t,i,n,a){var s=p.getItem("jclj_bullet");(s=s||new Ki.fishxy.animation.bullet.bgxyby_bullet_16UI).rotation=n,s.pos(t,i),(s.getComponent(Sh)||s.addComponent(Sh)).init(e,this.user,a)}},{key:"doShoot",value:function(n){for(var a=this,s=(this.user.isSelf&&(Ro.playSound("SFX_UI_035.mp3"),Ro.playSound("XYFishwords_MP_03.mp3")),0),e=function(i){a.timer.once(1800*i+200,a,function(){for(var e=0;e<9;e++)!function(t){a.timer.once(200*t,a,function(){var e=a.gunView.getChildByName("bullet_"+t);e.alpha=0,br.temp0Point.setTo(e.x,e.y),a.gunView.localToGlobal(br.temp0Point),a.createBullet(n[s],br.temp0Point.x,br.temp0Point.y,e.globalRotation-90,a.target),s++,a.target&&a.setDiretion(a.target.position.x,a.target.position.y),i<2&&Ci.to(e,{alpha:1},300,null,null,1e3),8==t&&a.findTarget()})}(e)})},t=0;t<3;t++)e(t)}},{key:"recover",value:function(){this.lock.removeSelf(),m(g(t.prototype),"recover",this).call(this)}}]),t}(),Th=function(){f(i,sn);var t=T(i);function i(){var e;return b(this,i),(e=t.apply(this,arguments)).status=new ph(O(e)),e.noActionExitCountDown=0,e.noActionExitTimer=new Oi,e.tempPoint=new ie,e.mousePoint=new ie,e}return y(i,[{key:"isSelf",get:function(){return this.member&&this.member.uid==_.data.account.userid}},{key:"isNpc",get:function(){return this.member&&0<=d.I.npcIds.indexOf(this.member.uid)}},{key:"isOther",get:function(){return!(this.isSelf||this.isNpc)}},{key:"setMember",value:function(e){this.member=e,this.owner.getChildByName("user_info").getChildByName("nickname").text=Po.getCenterStarString(e.nickname),this.money_lab=this.owner.getChildByName("user_info").getChildByName("money"),this.money_lab.font="bmfont_RoleGoldZi.fnt",this.money_lab.text=e.bag_money.toFixed(2),this.owner.getChildByName("user_info").getChildByName("coin").skin=_.config.isUsdtPlatform?"fishxy/animation/common/usdt_icon.png":"fishxy/animation/common/coin_gold_0.png";var t,i=Y(e.myprops);try{for(i.s();!(t=i.n()).done;){var n=t.value;this.getPropsCard(n.pid).setNum(n.num)}}catch(e){i.e(e)}finally{i.f()}this.showWaitting(!1),this.showLoaction(),this.updateUserMoney(e.into_money),this.initGun(),this.status.isEnoughMoney=!0,this.status.isChangingGun=!1,this.status.curtBulletCount=0,this.status.fireSpeed=2,this.status.isAutoFire=!1,this.status.lockKind=Ao.None,this.status.targetFish=null,this.isSelf&&this.startNoActionCountDown()}},{key:"setStatus",value:function(e){this.changeGun(e.gun_info.gun_type,e.gun_info.gun_level,!0),this.gun.serverRotation=e.angle,this.status.fireSpeed=e.speed,this.status.lockKind=e.lock_kind,this.status.isAutoFire=Boolean(e.is_shoot),this.gun.lockFish(Oo.I.getFishByUniqueId(e.lock_target))}},{key:"initGun",value:function(){this.initOperationBtn(),this.changeGun(ih.Level,1),this.gun.serverRotation=90}},{key:"changeGun",value:function(e,t,i,n){var a,s,r,o,h,l,u,c=this;this.status.gunType==e&&this.status.gunLevel==t||(this.status.gunType=e,this.status.gunLevel=t,s=(a=this.owner.getChildByName("weapon").getChildByName("gun")).parent,r=this.gun?this.gun.serverRotation:a.rotation,o=new ie(a.x,a.y),h=a.parent.getChildIndex(a),(l=this.createGun(e,t)).init(this),l.name="gun",l.addTo(s),l.setIndex(h),l.serverRotation=r,l.pos(o.x,o.y),l.updateRateText(),this.isSelf&&l instanceof gh&&l.showGunLogo(),this.gun?this.gun.isLevelGun!=l.isSpecialGun||i?(this.gun.recover(),this.gun=l,this.status.isChangingGun=!1,n instanceof x&&n.run()):(l.gunView.visible=!1,u=200*(1<this.member.position?-1:1),Ci.to(this.gun.gunView,{y:o.y+u},800,null,x.create(this,function(){c.gun.recover(),(c.gun=l).gunView.visible=!0,Ci.from(l.gunView,{y:o.y+u},800,null,x.create(c,function(){c.status.isChangingGun=!1,n instanceof x&&n.run()}))}))):(a.removeSelf(),this.gun=l,n instanceof x&&n.run()))}},{key:"createGun",value:function(e,t){var t="gun_type_"+e+"_level_"+(e!=ih.Level?0:t),i=kr.getItem(t);return i||(e==ih.Level?new fh(t):e==ih.Jgb?new vh(t):e==ih.Xmsb?new kh(t):e==ih.Ffwb?new bh(t):e==ih.Jclj?new Ih(t):void 0)}},{key:"initOperationBtn",value:function(){var e,t;1<this.member.position||((e=this.owner.getChildByName("weapon").getChildByName("operation_btns")).visible=this.isSelf,(t=e.getChildByName("sub_gun_btn")).offAll(Me.CLICK),t.on(Me.CLICK,this,this.subGun),(t=e.getChildByName("add_gun_btn")).offAll(Me.CLICK),t.on(Me.CLICK,this,this.addGun),this.auto_fire_btn=e.getChildByName("auto_fire_btn"),this.auto_fire_btn.offAll(Me.CLICK),this.auto_fire_btn.on(Me.CLICK,this,this.onClickAutoFireBtn),this.fire_speed_btn=e.getChildByName("fire_speed_btn"),this.fire_speed_btn.offAll(Me.CLICK),this.fire_speed_btn.on(Me.CLICK,this,this.onClickFireSpeedBtn))}},{key:"addGun",value:function(){this.status.isChangingGun=!0;var e=this.status.gunLevel>=d.I.enter.cannon_levels.length?1:this.status.gunLevel+1,t=new zo.SwitchCannonLevelReq;t.uid=this.member.uid,t.cannon_level=e,Jo.I.send(t),this.status.isChangingGun=!0}},{key:"subGun",value:function(){this.status.isChangingGun=!0;var e=1==this.status.gunLevel?d.I.enter.cannon_levels.length:this.status.gunLevel-1,t=new zo.SwitchCannonLevelReq;t.uid=this.member.uid,t.cannon_level=e,Jo.I.send(t)}},{key:"onClickFireSpeedBtn",value:function(){var e=d.I.enter.avatar_speeds.indexOf(this.status.fireSpeed),e=2<=e?0:e+1,t=new zo.ChangeShootSpeedReq;t.uid=this.member.uid,t.speed=d.I.enter.avatar_speeds[e],Jo.I.send(t)}},{key:"onClickAutoFireBtn",value:function(){var e=new zo.ChangeShootAutoReq;e.uid=this.member.uid,e.shoot_auto=this.status.isAutoFire?0:1,Jo.I.send(e)}},{key:"onLateUpdate",value:function(){this.member&&(!this.status.isChangingGun&&this.gun.canLockTarget&&this.status.targetFish&&this.status.targetFish.lifeState==Io.EnterScreen?(this.gun.setDiretion(this.status.targetFish.position.x,this.status.targetFish.position.y),this.isSelf&&yh.I.update(this.gun.muzzleWorldPos,this.status.targetFish.collider.position)):this.isSelf&&yh.I.hide(),this.status.isChangingGun||this.gun.onUpdate())}},{key:"startNoActionCountDown",value:function(){this.noActionExitCountDown=0,this.noActionExitTimer.clearAll(this),this.noActionExitTimer.loop(1e3,this,this.loopNoActionCountDown)}},{key:"loopNoActionCountDown",value:function(){this.status.lockKind||this.status.isAutoFire?this.noActionExitCountDown=0:(this.noActionExitCountDown++,60!=this.noActionExitCountDown&&120!=this.noActionExitCountDown||Ro.playSound("long_time_not_shoot_"+br.randInt(1,3)+".mp3"),165==this.noActionExitCountDown&&dh.I.popup(),180==this.noActionExitCountDown&&(this.noActionExitTimer.clearAll(this),d.I.exitGame()))}},{key:"stopNoActionCountDown",value:function(){this.noActionExitTimer.clearAll(this)}},{key:"coinLabelPosition",get:function(){var e=this.owner.getChildByName("user_info").getChildByName("money");return this.tempPoint.setTo(e.x,e.y),e.parent.localToGlobal(this.tempPoint),this.tempPoint}},{key:"coinPosition",get:function(){var e=this.owner.getChildByName("user_info").getChildByName("coin");return this.tempPoint.setTo(e.x,e.y),e.parent.localToGlobal(this.tempPoint),this.tempPoint}},{key:"coinSprite",get:function(){return this.owner.getChildByName("user_info").getChildByName("coin")}},{key:"position",get:function(){var e=this.owner;return this.tempPoint.setTo(e.x,e.y),e.parent.localToGlobal(this.tempPoint),this.tempPoint}},{key:"gunPosition",get:function(){var e=this.owner.getChildByName("weapon").getChildByName("gun");return this.tempPoint.setTo(e.x,e.y),e.parent.localToGlobal(this.tempPoint),this.tempPoint}},{key:"fishDieUIPosition",get:function(){var e=this.owner.getChildByName("fish_die_ui_pos");return this.tempPoint.setTo(e.x,e.y),e.parent.localToGlobal(this.tempPoint),this.tempPoint}},{key:"getPropsCard",value:function(e){return this.owner.getChildByName("user_info").getChildByName("props").getChildAt(e).getComponent(Ch)}},{key:"getPropsNum",value:function(t){return this.member.myprops.find(function(e){return e.pid==t}).num}},{key:"setPropsNum",value:function(t,e){this.member.myprops.find(function(e){return e.pid==t}).num=e}},{key:"getPropsCardPosition",value:function(e){e=this.owner.getChildByName("user_info").getChildByName("props").getChildAt(e);return this.tempPoint.setTo(e.x,e.y),e.parent.localToGlobal(this.tempPoint),this.tempPoint}},{key:"showLoaction",value:function(){var e,t;_.DEBUG||this.isSelf&&((e=this.owner.getChildByName("location")).visible=!0,e.ani1.play(0,!0),t=0,e.ani1.on(Me.COMPLETE,this,function(){2==++t&&(e.ani1.stop(),e.visible=!1)}))}},{key:"showWaitting",value:function(e){e&&this.changeGun(ih.Level,1),this.owner.getChildByName("weapon").visible=!e,this.owner.getChildByName("waiting").visible=e,this.owner.getChildByName("user_info").visible=!e}},{key:"setCountDownFireTime",value:function(e){this.owner.getChildByName("count_down_fire").getChildByName("time").text=e.toString()}},{key:"setCountDownFireVisible",value:function(e){this.owner.getChildByName("count_down_fire").getChildByName("time").font="bmfont_bossTime.fnt",this.owner.getChildByName("count_down_fire").visible=e}},{key:"addMoney",value:function(e){this.member.bag_money+=e,0<=this.member.bag_money&&(this.money_lab.text=this.member.bag_money.toFixed(2),this.isSelf&&(_.data.account.bag_money=this.member.bag_money))}},{key:"updateUserMoney",value:function(e){this.member.bag_money=e,this.money_lab.text=e.toFixed(2),this.isSelf&&(_.data.account.bag_money=e)}},{key:"sitUpGame",value:function(){var t=this;this.showWaitting(!0),_.event.offAllCaller(this),this.status.resetStatus(),this.member&&(d.I.users.remove(function(e){return e.member.uid==t.member.uid}),this.isSelf&&this.noActionExitTimer.clearAll(this))}},{key:"offLine",value:function(){this.member&&this.isSelf&&this.noActionExitTimer.clearAll(this)}}]),i}(),Ch=(Th.FIRE_SPEED=400,function(){f(i,sn);var t=T(i);function i(){var e;return b(this,i),(e=t.apply(this,arguments)).num=0,e}return y(i,[{key:"onEnable",value:function(){this.user=this.owner.parent.parent.parent.getComponent(Th)}},{key:"onMouseOver",value:function(){this.isOver=!0,i.cardTips.num.text=this.num+"/3",i.cardTips.title.text=this.title,i.cardTips.content.text=this.content,d.I.view.ui_layer.addChild(i.cardTips)}},{key:"onMouseMove",value:function(){var e,t;this.isOver&&(e=0,e=1==this.user.member.position||2==this.user.member.position?u.mouseX-i.cardTips.width:u.mouseX,t=(t=0)==this.user.member.position||1==this.user.member.position?u.mouseY-i.cardTips.height:u.mouseY,i.cardTips.pos(e,t))}},{key:"onMouseOut",value:function(){this.isOver&&(this.isOver=!1,i.cardTips.removeSelf())}},{key:"onClick",value:function(){this.isOver=!0,this.onMouseMove(),u.timer.once(3e3,this,this.onMouseOut)}},{key:"setNum",value:function(e){this.num=e,this.owner.index=0<e?1:0,this.owner.getChildByName("num").text=e+"/3"}}],[{key:"cardTips",get:function(){return this._cardTips||(this._cardTips=new Ki.fishxy.fight.CardTipsUI),this._cardTips}}]),i}()),Mh=function(){function e(){b(this,e),this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0}return y(e,[{key:"initData",value:function(e){null!=e.x&&(this.x=e.x),null!=e.y&&(this.y=e.y),null!=e.skX&&(this.skX=e.skX),null!=e.skY&&(this.skY=e.skY),null!=e.scX&&(this.scX=e.scX),null!=e.scY&&(this.scY=e.scY)}},{key:"getMatrix",value:function(){var e=this.mMatrix||(this.mMatrix=new Ce);return e.identity(),e.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew(e,this.skewX*Math.PI/180,this.skewY*Math.PI/180),e.rotate(this.skX*Math.PI/180),e.translate(this.x,this.y),e}},{key:"skew",value:function(e,t,i){var n=Math.sin(i),i=Math.cos(i),a=Math.sin(t),t=Math.cos(t);return e.setTo(e.a*t-e.b*n,e.a*a+e.b*i,e.c*t-e.d*n,e.c*a+e.d*i,e.tx*t-e.ty*n,e.tx*a+e.ty*i),e}}]),e}(),Eh=function(){function a(){b(this,a),this.length=10,this.resultTransform=new Mh,this.resultMatrix=new Ce,this.inheritScale=!0,this.inheritRotation=!0,this.d=-1,this._children=[]}return y(a,[{key:"setTempMatrix",value:function(e){this._tempMatrix=e;for(var t=0,t=0,i=this._children.length;t<i;t++)this._children[t].setTempMatrix(this._tempMatrix)}},{key:"update",value:function(){for(var e,t,i,n,a,s=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,r=(this.rotation=this.transform.skX,s?(t=this.resultTransform.getMatrix(),Ce.mul(t,s,this.resultMatrix),this.resultRotation=this.rotation):(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone?this.inheritRotation&&this.inheritScale?(t=this.resultTransform.getMatrix(),Ce.mul(t,this.parentBone.resultMatrix,this.resultMatrix)):(s=this.parentBone,n=this.parentBone.resultMatrix,t=this.resultTransform.getMatrix(),i=n.a*t.tx+n.c*t.ty+n.tx,n=n.b*t.tx+n.d*t.ty+n.ty,a=new Ce,this.inheritRotation?(s=Math.atan2(s.resultMatrix.b,s.resultMatrix.a),e=Math.cos(s),s=Math.sin(s),a.setTo(e,s,-s,e,0,0),Ce.mul(this._tempMatrix,a,Ce.TEMP),Ce.TEMP.copyTo(a),t=this.resultTransform.getMatrix(),Ce.mul(t,a,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,t=this.resultTransform.getMatrix(),Ce.TEMP.identity(),Ce.TEMP.d=this.d,Ce.mul(t,Ce.TEMP,this.resultMatrix)),this.resultMatrix.tx=i,this.resultMatrix.ty=n):(t=this.resultTransform.getMatrix()).copyTo(this.resultMatrix)),0),r=0,o=this._children.length;r<o;r++)this._children[r].update()}},{key:"updateChild",value:function(){for(var e=0,e=0,t=this._children.length;e<t;e++)this._children[e].update()}},{key:"setRotation",value:function(e){this._sprite&&(this._sprite.rotation=180*e/Math.PI)}},{key:"updateDraw",value:function(e,t){a.ShowBones&&!a.ShowBones[this.name]||(this._sprite||(this._sprite=new N,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),L.stage.addChild(this._sprite)),this._sprite.x=e+this.resultMatrix.tx,this._sprite.y=t+this.resultMatrix.ty);for(var i=0,i=0,n=this._children.length;i<n;i++)this._children[i].updateDraw(e,t)}},{key:"addChild",value:function(e){this._children.push(e),e.parentBone=this}},{key:"findBone",value:function(e){if(this.name==e)return this;for(var t,i=0,n=this._children.length;i<n;i++)if(t=this._children[i].findBone(e))return t;return null}},{key:"localToWorld",value:function(e){var t=e[0],i=e[1];e[0]=t*this.resultMatrix.a+i*this.resultMatrix.c+this.resultMatrix.tx,e[1]=t*this.resultMatrix.b+i*this.resultMatrix.d+this.resultMatrix.ty}}]),a}(),Rh=(Eh.ShowBones={},y(function e(){b(this,e),this.boneIndexs=[]})),Ah=y(function e(){b(this,e),this.bones=[]}),Lh=y(function e(){b(this,e),this.deformSlotDataList=[]}),Nh=y(function e(){b(this,e),this.deformSlotDisplayList=[]}),Ph=function(){function e(){b(this,e),this.slotIndex=-1,this.timeList=[],this.vectices=[],this.tweenKeyList=[],this.frameIndex=0}return y(e,[{key:"binarySearch1",value:function(e,t){var i=0,n=e.length-2;if(0==n)return 1;for(var a=n>>>1;;){if(e[Math.floor(a+1)]<=t?i=a+1:n=a,i==n)return i+1;a=i+n>>>1}return 0}},{key:"apply",value:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;if(e+=.05,!(this.timeList.length<=0)){var n=0,a=this.timeList[0];if(!(e<a)){var s=this.vectices[0].length,r=[],a=this.binarySearch1(this.timeList,e);if(this.frameIndex=a,e>=this.timeList[this.timeList.length-1]){var o=this.vectices[this.vectices.length-1];if(i<1)for(n=0;n<s;n++)r[n]+=(o[n]-r[n])*i;else for(n=0;n<s;n++)r[n]=o[n];this.deformData=r}else{for(var h,l=this.vectices[this.frameIndex-1],u=this.vectices[this.frameIndex],c=this.timeList[this.frameIndex-1],_=this.timeList[this.frameIndex],i=this.tweenKeyList[a-1]?(e-c)/(_-c):0,n=0;n<s;n++)h=l[n],r[n]=h+(u[n]-h)*i;this.deformData=r}}}}}]),e}(),Bh=y(function e(){b(this,e),this.drawOrder=[]}),Dh=y(function e(){b(this,e)}),Oh=y(function e(){b(this,e)}),Fh=y(function e(){b(this,e)}),Vh=y(function e(){b(this,e)}),Uh=function(){function e(){b(this,e)}return y(e,null,[{key:"parse",value:function(e,t){var i,n,a,s,r,o=t.__getBuffer(),h=t.readUTFString(),l=(e._aniClassName=h,t.readUTFString().split("\n")),u=t.getUint8(),h=t.getUint32(),c=t.getUint32(),_=(0<h&&(r=o.slice(h,c)),new mi(r));for(0<c&&(e._publicExtData=o.slice(c,o.byteLength)),e._useParent=!!t.getUint8(),e._anis.length=u,i=0;i<u;i++)for(var f=e._anis[i]=new Oh,d=(f.nodes=[],f.name=l[t.getUint16()]),p=(e._aniMap[d]=i,f.bone3DMap={},f.playTime=t.getFloat32(),f.nodes.length=t.getUint8()),y=f.totalKeyframeDatasLength=0;y<p;y++){var g=f.nodes[y]=new Fh,m=(g.childs=[],t.getInt16()),m=(0<=m&&(g.name=l[m],f.bone3DMap[g.name]=y),g.keyFrame=[],g.parentIndex=t.getInt16(),-1==g.parentIndex?g.parent=null:g.parent=f.nodes[g.parentIndex],g.lerpType=t.getUint8(),t.getUint32()),v=(_.pos=m,g.keyframeWidth=_.getUint16());if(f.totalKeyframeDatasLength+=v,0===g.lerpType||1===g.lerpType)for(g.interpolationMethod=[],g.interpolationMethod.length=v,w=0;w<v;w++)g.interpolationMethod[w]=na.AnimationTemplet.interpolation[_.getUint8()];null!=g.parent&&g.parent.childs.push(g);for(var x,m=t.getUint16(),m=(0<m&&(g.extenData=o.slice(t.pos,t.pos+m),t.pos+=m),t.getUint16()),k=0,w=0,b=g.keyFrame.length=m;w<b;w++){if((x=g.keyFrame[w]=new Vh).duration=t.getFloat32(),x.startTime=k,2===g.lerpType){x.interpolationData=[];var S=t.getUint8(),I=t.getFloat32();switch(I){case 254:for(x.interpolationData.length=v,s=0;s<v;s++)x.interpolationData[s]=0;break;case 255:for(x.interpolationData.length=v,s=0;s<v;s++)x.interpolationData[s]=5;break;default:for(x.interpolationData.push(I),a=1;a<S;a++)x.interpolationData.push(t.getFloat32())}}for(x.data=new Float32Array(v),x.dData=new Float32Array(v),x.nextData=new Float32Array(v),n=0;n<v;n++)x.data[n]=t.getFloat32(),-1e-8<x.data[n]&&x.data[n]<1e-8&&(x.data[n]=0);k+=x.duration}x.startTime=f.playTime,g.playTime=f.playTime,e._calculateKeyFrame(g,m,v)}}}]),e}(),zh=function(){function m(){b(this,m)}return y(m,null,[{key:"READ_DATA",value:function(){m._DATA.offset=m._reader.getUint32(),m._DATA.size=m._reader.getUint32()}},{key:"READ_BLOCK",value:function(){for(var e=m._BLOCK.count=m._reader.getUint16(),t=m._BLOCK.blockStarts=[],i=m._BLOCK.blockLengths=[],n=0;n<e;n++)t.push(m._reader.getUint32()),i.push(m._reader.getUint32())}},{key:"READ_STRINGS",value:function(){var e=m._reader.getUint32(),t=m._reader.getUint16(),i=m._reader.pos;m._reader.pos=e+m._DATA.offset;for(var n=0;n<t;n++)m._strings[n]=m._reader.readUTFString();m._reader.pos=i}},{key:"parse",value:function(e,t){m._templet=e;(m._reader=t).__getBuffer();m.READ_DATA(),m.READ_BLOCK(),m.READ_STRINGS();for(var i=0,n=m._BLOCK.count;i<n;i++){var a=t.getUint16(),s=m._strings[a],r=m["READ_"+s];if(null==r)throw new Error("model file err,no this function:"+a+" "+s);r.call(null)}}},{key:"READ_ANIMATIONS",value:function(){var e,t=m._reader,i=t.__getBuffer(),n=t.getUint16(),a=[];for(a.length=n,e=0;e<n;e++)a[e]=na.AnimationTemplet.interpolation[t.getByte()];var s=t.getUint8();for(m._templet._anis.length=s,e=0;e<s;e++)for(var r=m._templet._anis[e]=new Oh,o=(r.nodes=[],r.name=m._strings[t.getUint16()]),h=(m._templet._aniMap[o]=e,r.bone3DMap={},r.playTime=t.getFloat32(),r.nodes.length=t.getInt16()),l=r.totalKeyframeDatasLength=0;l<h;l++){for(var u=r.nodes[l]=new Fh,c=(u.keyframeWidth=n,u.childs=[],t.getUint16()),c=(0<=c&&(u.name=m._strings[c],r.bone3DMap[u.name]=l),u.keyFrame=[],u.parentIndex=t.getInt16(),-1==u.parentIndex?u.parent=null:u.parent=r.nodes[u.parentIndex],r.totalKeyframeDatasLength+=n,u.interpolationMethod=a,null!=u.parent&&u.parent.childs.push(u),t.getUint16()),_=null,f=null,d=0,p=u.keyFrame.length=c;d<p;d++){(_=u.keyFrame[d]=new Vh).startTime=t.getFloat32(),f&&(f.duration=_.startTime-f.startTime),_.dData=new Float32Array(n),_.nextData=new Float32Array(n);var y=m._DATA.offset,g=t.getUint32(),y=i.slice(y+g,y+g+4*n);_.data=new Float32Array(y),f=_}_.duration=0,u.playTime=r.playTime,m._templet._calculateKeyFrame(u,c,n)}}}]),m}(),Yh=(zh._strings=[],zh._BLOCK={count:0},zh._DATA={offset:0,size:0},function(){function u(){b(this,u)}return y(u,null,[{key:"getBezierRate",value:function(e,t,i,n,a){var s=u._getBezierParamKey(t,i,n,a),r=100*s+e;if(u._bezierResultCache[r])return u._bezierResultCache[r];for(var o=u._getBezierPoints(t,i,n,a,s),h=o.length,l=0;l<h;l+=2)if(e<=o[l])return u._bezierResultCache[r]=o[l+1],o[l+1];return u._bezierResultCache[r]=1}},{key:"_getBezierParamKey",value:function(e,t,i,n){return 100*(100*(100*(100*e+t)+i)+n)}},{key:"_getBezierPoints",value:function(e,t,i,n,a){if(u._bezierPointsCache[a])return u._bezierPointsCache[a];e=[0,0,e,t,i,n,1,1],t=(new De).getBezierPoints(e,100,3);return u._bezierPointsCache[a]=t}}]),u}()),Gh=(Yh._bezierResultCache={},Yh._bezierPointsCache={},function(){f(m,oe);var t=T(m);function m(){var e;return b(this,m),(e=t.call(this))._anis=[],e._aniMap={},e.unfixedLastAniIndex=-1,e._fullFrames=null,e._boneCurKeyFrm=[],e}return y(m,[{key:"parse",value:function(e){e=new mi(e);this._aniVersion=e.readUTFString(),Uh.parse(this,e)}},{key:"_calculateKeyFrame",value:function(e,t,i){var n=e.keyFrame;n[t]=n[0];for(var a=0;a<t;a++)for(var s=n[a],r=0;r<i;r++)s.dData[r]=0===s.duration?0:(n[a+1].data[r]-s.data[r])/s.duration,s.nextData[r]=n[a+1].data[r];n.length--}},{key:"_onAsynLoaded",value:function(e){e=new mi(e);this._aniVersion=e.readUTFString(),("LAYAANIMATION:02"===this._aniVersion?zh:Uh).parse(this,e)}},{key:"getAnimationCount",value:function(){return this._anis.length}},{key:"getAnimation",value:function(e){return this._anis[e]}},{key:"getAniDuration",value:function(e){return this._anis[e].playTime}},{key:"getNodes",value:function(e){return this._anis[e].nodes}},{key:"getNodeIndexWithName",value:function(e,t){return this._anis[e].bone3DMap[t]}},{key:"getNodeCount",value:function(e){return this._anis[e].nodes.length}},{key:"getTotalkeyframesLength",value:function(e){return this._anis[e].totalKeyframeDatasLength}},{key:"getPublicExtData",value:function(){return this._publicExtData}},{key:"getAnimationDataWithCache",value:function(e,t,i,n){t=t[i];return t&&(i=t[e])?i[n]:null}},{key:"setAnimationDataWithCache",value:function(e,t,i,n,a){t=t[i]||(t[i]={});(t[e]||(t[e]=[]))[n]=a}},{key:"getNodeKeyFrame",value:function(e,t,i){var n=this._boneCurKeyFrm[t],a=e.length,s=e[n=null==n||a<=n?this._boneCurKeyFrm[t]=0:n],r=i-s.startTime;if(0==r||0<r&&s.duration>r)return n;var o=0;if(0<r){for(i+=.01,o=n+1;o<a;o++)if((s=e[o]).startTime<=i&&s.startTime+s.duration>i)return this._boneCurKeyFrm[t]=o;return a-1}for(o=0;o<n;o++)if((s=e[o]).startTime<=i&&s.startTime+s.duration>i)return this._boneCurKeyFrm[t]=o;return n}},{key:"getOriginalData",value:function(e,t,i,n,a){for(var s=this._anis[e].nodes,e=this._boneCurKeyFrm,r=(e.length<s.length&&(e.length=s.length),0),o=0,h=s.length,l=0;o<h;o++){var u=s[o],c=u.keyFrame,_=c[this.getNodeKeyFrame(c,o,a)],f=(u.dataOffset=l,a-_.startTime),c=u.lerpType;if(c)switch(c){case 0:case 1:for(r=0;r<u.keyframeWidth;)r+=u.interpolationMethod[r](u,r,t,l+r,_.data,f,_.dData,_.duration,_.nextData);break;case 2:for(var d=_.interpolationData,p=d.length,y=0,r=0;r<p;){var g=d[r];switch(g){case 6:case 7:r+=m.interpolation[g](u,y,t,l+y,_.data,f,_.dData,_.duration,_.nextData,d,r+1);break;default:r+=m.interpolation[g](u,y,t,l+y,_.data,f,_.dData,_.duration,_.nextData)}y++}}else for(r=0;r<u.keyframeWidth;)r+=u.interpolationMethod[r](u,r,t,l+r,_.data,f,_.dData,_.duration,_.nextData);l+=u.keyframeWidth}}},{key:"getNodesCurrentFrameIndex",value:function(e,t){var i=this._anis[e].nodes;e!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(i.length),this.unfixedCurrentTimes=new Float32Array(i.length),this.unfixedLastAniIndex=e);for(var n=0,a=i.length;n<a;n++){var s=i[n];for(t<this.unfixedCurrentTimes[n]&&(this.unfixedCurrentFrameIndexes[n]=0),this.unfixedCurrentTimes[n]=t;this.unfixedCurrentFrameIndexes[n]<s.keyFrame.length&&!(s.keyFrame[this.unfixedCurrentFrameIndexes[n]].startTime>this.unfixedCurrentTimes[n]);)this.unfixedCurrentFrameIndexes[n]++;this.unfixedCurrentFrameIndexes[n]--}return this.unfixedCurrentFrameIndexes}},{key:"getOriginalDataUnfixedRate",value:function(e,t,i){for(var n=this._anis[e].nodes,a=(e!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(n.length),this.unfixedCurrentTimes=new Float32Array(n.length),this.unfixedKeyframes=[],this.unfixedLastAniIndex=e),0),s=0,r=n.length,o=0;s<r;s++){var h=n[s];for(i<this.unfixedCurrentTimes[s]&&(this.unfixedCurrentFrameIndexes[s]=0),this.unfixedCurrentTimes[s]=i;this.unfixedCurrentFrameIndexes[s]<h.keyFrame.length&&!(h.keyFrame[this.unfixedCurrentFrameIndexes[s]].startTime>this.unfixedCurrentTimes[s]);)this.unfixedKeyframes[s]=h.keyFrame[this.unfixedCurrentFrameIndexes[s]],this.unfixedCurrentFrameIndexes[s]++;var l=this.unfixedKeyframes[s],u=(h.dataOffset=o,i-l.startTime);if(h.lerpType)switch(h.lerpType){case 0:case 1:for(a=0;a<h.keyframeWidth;)a+=h.interpolationMethod[a](h,a,t,o+a,l.data,u,l.dData,l.duration,l.nextData);break;case 2:for(var c=l.interpolationData,_=c.length,f=0,a=0;a<_;){var d=c[a];switch(d){case 6:case 7:a+=m.interpolation[d](h,f,t,o+f,l.data,u,l.dData,l.duration,l.nextData,c,a+1);break;default:a+=m.interpolation[d](h,f,t,o+f,l.data,u,l.dData,l.duration,l.nextData)}f++}}else for(a=0;a<h.keyframeWidth;)a+=h.interpolationMethod[a](h,a,t,o+a,l.data,u,l.dData,l.duration,l.nextData);o+=h.keyframeWidth}}}],[{key:"_LinearInterpolation_0",value:function(e,t,i,n,a,s,r,o,h){return i[n]=a[t]+s*r[t],1}},{key:"_QuaternionInterpolation_1",value:function(e,t,i,n,a,s,r,o,h){return Ri.slerpQuaternionArray(a,t,h,t,0===o?0:s/o,i,n),4}},{key:"_AngleInterpolation_2",value:function(e,t,i,n,a,s,r,o,h){return 0}},{key:"_RadiansInterpolation_3",value:function(e,t,i,n,a,s,r,o,h){return 0}},{key:"_Matrix4x4Interpolation_4",value:function(e,t,i,n,a,s,r,o,h){for(var l=0;l<16;l++,t++)i[n+l]=a[t]+s*r[t];return 16}},{key:"_NoInterpolation_5",value:function(e,t,i,n,a,s,r,o,h){return i[n]=a[t],1}},{key:"_BezierInterpolation_6",value:function(e,t,i,n,a,s,r,o,h){var l=9<arguments.length&&void 0!==arguments[9]?arguments[9]:null,u=10<arguments.length&&void 0!==arguments[10]?arguments[10]:0;return i[n]=a[t]+(h[t]-a[t])*Yh.getBezierRate(s/o,l[u],l[u+1],l[u+2],l[u+3]),5}},{key:"_BezierInterpolation_7",value:function(e,t,i,n,a,s,r,o,h){var l=9<arguments.length&&void 0!==arguments[9]?arguments[9]:null,u=10<arguments.length&&void 0!==arguments[10]?arguments[10]:0;return i[n]=l[u+4]+l[u+5]*Yh.getBezierRate((.001*s+l[u+6])/l[u+7],l[u],l[u+1],l[u+2],l[u+3]),9}}]),m}()),Xh=(Gh.interpolation=[Gh._LinearInterpolation_0,Gh._QuaternionInterpolation_1,Gh._AngleInterpolation_2,Gh._RadiansInterpolation_3,Gh._Matrix4x4Interpolation_4,Gh._NoInterpolation_5,Gh._BezierInterpolation_6,Gh._BezierInterpolation_7],na.AnimationTemplet=Gh,function(){function e(){b(this,e)}return y(e,null,[{key:"getRelativeUV",value:function(e,t){for(var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=e[0],a=e[2]-e[0],s=e[1],e=e[5]-e[1],r=((i=i||[]).length=t.length,i.length),o=1/a,h=1/e,l=0;l<r;l+=2)i[l]=(t[l]-n)*o,i[l+1]=(t[l+1]-s)*h;return i}},{key:"getAbsoluteUV",value:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(0==e[0]&&0==e[1]&&1==e[4]&&1==e[5])return i?(Se.copyArray(i,t),i):t;var n,a,s=e[0],r=e[2]-e[0],o=e[1],h=e[5]-e[1];for((i=i||[]).length=t.length,a=i.length,n=0;n<a;n+=2)i[n]=t[n]*r+s,i[n+1]=t[n+1]*h+o;return i}}]),e}()),Wh=function(){function e(){b(this,e),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertices=new Float32Array([0,0,100,0,100,100,0,100]),this.indexes=new Uint16Array([0,1,3,3,1,2]),this.useUvTransform=!1,this.canvasPadding=1}return y(e,[{key:"getBounds",value:function(){return ne._getWrapRec(this.vertices)}}]),e}(),Hh=function(){f(t,Wh);var e=T(t);function t(){return b(this,t),e.call(this)}return y(t,[{key:"init2",value:function(e,t,i,n){this.transform&&(this.transform=null);t=t||[0,1,3,3,1,2];this.texture=e,this.indexes=new Uint16Array(t),this.vertices=new Float32Array(i),this.uvs=new Float32Array(n)}}]),t}(),jh=function(){function v(){b(this,v),this.srcDisplayIndex=-1,this.type="src",this.displayIndex=-1,this.originalIndex=-1,this._replaceDic={}}return y(v,[{key:"showSlotData",value:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];this.currSlotData=e,t&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null}},{key:"showDisplayByName",value:function(e){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName(e))}},{key:"replaceDisplayByName",value:function(e,t){this.currSlotData&&(e=this.currSlotData.getDisplayByName(e),t=this.currSlotData.getDisplayByName(t),this.replaceDisplayByIndex(e,t))}},{key:"replaceDisplayByIndex",value:function(e,t){this.currSlotData&&(this._replaceDic[e]=t,this.originalIndex==e&&this.showDisplayByIndex(e))}},{key:"showDisplayByIndex",value:function(e){this.originalIndex=e,null!=this._replaceDic[e]&&(e=this._replaceDic[e]),this.currSlotData&&-1<e&&e<this.currSlotData.displayArr.length?(this.displayIndex=e,this.currDisplayData=this.currSlotData.displayArr[e],this.currDisplayData&&(e=this.currDisplayData.name,this.currTexture=this.templet.getTexture(e),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture)))):(this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null)}},{key:"replaceSkin",value:function(e){this._diyTexture=e,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)}},{key:"setParentMatrix",value:function(e){this._parentMatrix=e}},{key:"getSaveVerticle",value:function(e){return v.useSameMatrixAndVerticle&&this._preGraphicVerticle&&v.isSameArr(e,this._preGraphicVerticle)?e=this._preGraphicVerticle:(e=L.Utils.copyArray([],e),this._preGraphicVerticle=e),e}},{key:"getSaveMatrix",value:function(e){var t;return v.useSameMatrixAndVerticle&&this._preGraphicMatrix&&v.isSameMatrix(e,this._preGraphicMatrix)?e=this._preGraphicMatrix:(t=e.clone(),this._preGraphicMatrix=e=t),e}},{key:"draw",value:function(e,t){var i=2<arguments.length&&void 0!==arguments[2]&&arguments[2],n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1;if((null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var a,s,r,o,h=this.currTexture;switch(this._diyTexture&&(h=this._diyTexture),this.currDisplayData.type){case 0:e&&(o=this.getDisplayMatrix(),this._parentMatrix&&(s=!1,o&&(Ce.mul(o,this._parentMatrix,Ce.TEMP),o=i?(null==this._resultMatrix&&(this._resultMatrix=new Ce),this._resultMatrix):v._tempResultMatrix,this._diyTexture&&this.currDisplayData.uvs?((r=v._tempMatrix).identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(r.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(s=!0,r.rotate(-Math.PI/2)),Ce.mul(r,Ce.TEMP,o)):Ce.TEMP.copyTo(o),(o=i?o:this.getSaveMatrix(o))._checkTransform(),s?e.drawTexture(h,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,o,n):e.drawTexture(h,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,o,n))));break;case 1:if(null==(a=i?(null==this._skinSprite&&(this._skinSprite=v.createSkinMesh()),this._skinSprite):v.createSkinMesh()))return;null==this.currDisplayData.bones?(r=this.currDisplayData.weights,this.deformData&&(r=this.deformData),s=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=Xh.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=Xh.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=r,this.currDisplayData.triangles.length,o=this.currDisplayData.triangles,this.deformData&&!i&&(this._mVerticleArr=this.getSaveVerticle(this._mVerticleArr)),a.init2(h,o,this._mVerticleArr,s),r=this.getDisplayMatrix(),this._parentMatrix&&r&&(Ce.mul(r,this._parentMatrix,Ce.TEMP),o=i?(null==this._resultMatrix&&(this._resultMatrix=new Ce),this._resultMatrix):v._tempResultMatrix,Ce.TEMP.copyTo(o),i||(o=this.getSaveMatrix(o)),a.transform=o)):this.skinMesh(t,a),e.drawSkin(a,n);break;case 2:if(null==(a=i?(null==this._skinSprite&&(this._skinSprite=v.createSkinMesh()),this._skinSprite):v.createSkinMesh()))return;this.skinMesh(t,a),e.drawSkin(a,n)}}}},{key:"skinMesh",value:function(e,t){var i,n,a,s,r=this.currTexture,o=this.currDisplayData.bones,h=this._diyTexture?(r=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=Xh.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=Xh.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,l=this.currDisplayData.weights,u=this.currDisplayData.triangles,c=0,_=0,f=0,d=0,p=0,y=0,g=0;if(v._tempVerticleArr.length=0,s=v._tempVerticleArr,this.deformData&&0<this.deformData.length)for(var m=0,y=0,g=o.length;y<g;){for(f=o[y++]+y,_=c=0;y<f;y++)i=e[o[y]],n=l[d]+this.deformData[m++],a=l[d+1]+this.deformData[m++],p=l[d+2],c+=(n*i.a+a*i.c+i.tx)*p,_+=(n*i.b+a*i.d+i.ty)*p,d+=3;s.push(c,_)}else for(y=0,g=o.length;y<g;){for(f=o[y++]+y,_=c=0;y<f;y++)i=e[o[y]],n=l[d],a=l[d+1],p=l[d+2],c+=(n*i.a+a*i.c+i.tx)*p,_+=(n*i.b+a*i.d+i.ty)*p,d+=3;s.push(c,_)}this._mVerticleArr=s,u=u,this._mVerticleArr=this.getSaveVerticle(this._mVerticleArr),t.init2(r,u,this._mVerticleArr,h)}},{key:"drawBonePoint",value:function(e){e&&this._parentMatrix&&e.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")}},{key:"getDisplayMatrix",value:function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null}},{key:"getMatrix",value:function(){return this._resultMatrix}},{key:"copy",value:function(){var e=new v;return e.type="copy",e.name=this.name,e.attachmentName=this.attachmentName,e.srcDisplayIndex=this.srcDisplayIndex,e.parent=this.parent,e.displayIndex=this.displayIndex,e.templet=this.templet,e.currSlotData=this.currSlotData,e.currTexture=this.currTexture,e.currDisplayData=this.currDisplayData,e}}],[{key:"createSkinMesh",value:function(){return new Hh}},{key:"isSameArr",value:function(e,t){if(e.length!=t.length)return!1;for(var i=e.length,n=0;n<i;n++)if(e[n]!=t[n])return!1;return!0}},{key:"isSameMatrix",value:function(e,t){return e.a==t.a&&e.b==t.b&&e.c==t.c&&e.d==t.d&&Math.abs(e.tx-t.tx)<1e-5&&Math.abs(e.ty-t.ty)<1e-5}}]),v}(),qh=(jh._tempMatrix=new Ce,jh._tempResultMatrix=new Ce,jh.useSameMatrixAndVerticle=!0,jh._tempVerticleArr=[],y(function e(){b(this,e),this.slotArr=[]})),Kh=function(){function e(){b(this,e)}return y(e,[{key:"createTexture",value:function(e){return this.texture||(this.texture=new vt(e.bitmap,this.uvs),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=e.height,this.texture.height=e.width,this.texture.offsetX=-e.offsetX,this.texture.offsetY=-e.offsetY,this.texture.sourceWidth=e.sourceHeight,this.texture.sourceHeight=e.sourceWidth):(this.texture.width=e.width,this.texture.height=e.height,this.texture.offsetX=-e.offsetX,this.texture.offsetY=-e.offsetY,this.texture.sourceWidth=e.sourceWidth,this.texture.sourceHeight=e.sourceHeight),this.texture)}},{key:"destory",value:function(){this.texture&&this.texture.destroy()}}]),e}(),Qh=function(){function e(){b(this,e),this.displayArr=[]}return y(e,[{key:"getDisplayByName",value:function(e){for(var t=0,i=this.displayArr.length;t<i;t++)if(this.displayArr[t].attachmentName==e)return t;return-1}}]),e}(),Zh=y(function e(){b(this,e),this.boneNames=[],this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneIndexs=[]}),Jh=function(){f(n,Gh);var t=T(n);function n(){var e;return b(this,n),(e=t.apply(this,arguments))._graphicsCache=[],e.srcBoneMatrixArr=[],e.ikArr=[],e.tfArr=[],e.pathArr=[],e.boneSlotDic={},e.bindBoneBoneSlotDic={},e.boneSlotArray=[],e.skinDataArray=[],e.skinDic={},e.subTextureDic={},e.isParseFail=!1,e.drawOrderAniArr=[],e.eventAniArr=[],e.attachmentNames=null,e.deformAniArr=[],e.skinSlotDisplayDataArr=[],e._isParseAudio=!1,e._isDestroyed=!1,e._rate=30,e.isParserComplete=!1,e.aniSectionDic={},e._textureDic={},e.mBoneArr=[],e}return y(n,[{key:"loadAni",value:function(e){this._skBufferUrl=e,L.loader.load(e,x.create(this,this.onComplete),null,L.Loader.BUFFER)}},{key:"onComplete",value:function(){var e;this._isDestroyed?this.destroy():(e=L.Loader.getRes(this._skBufferUrl))?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,e)):this.event(Me.ERROR,"load failed:"+this._skBufferUrl)}},{key:"parseData",value:function(e,t){var i,n,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:30;this._path||(i=this._relativeUrl||this.url)&&(n=i.lastIndexOf("/"),this._path=0<n?i.slice(0,n)+"/":""),this._mainTexture=e,this._rate=a,this.parse(t)}},{key:"buildArmature",value:function(){return new aa(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:0)}},{key:"parse",value:function(e){m(g(n.prototype),"parse",this).call(this,e),this.event(Me.LOADED,this),this._aniVersion===n.LAYA_ANIMATION_VISION?this._isParseAudio=!0:this._aniVersion!=n.LAYA_ANIMATION_160_VISION&&console.log("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+n.LAYA_ANIMATION_VISION),this._mainTexture?this._parsePublicExtData():this._parseTexturePath()}},{key:"_parseTexturePath",value:function(){if(this._isDestroyed)this.destroy();else{for(var e,t=0,i=(this._loadList=[],new mi(this.getPublicExtData())),n=i.getInt32(),a=i.readUTFString().split("\n"),t=0;t<n;t++)e=this._path+a[2*t],a[2*t+1],i.getFloat32(),i.getFloat32(),i.getFloat32(),i.getFloat32(),i.getFloat32(),i.getFloat32(),i.getFloat32(),i.getFloat32(),-1==this._loadList.indexOf(e)&&this._loadList.push(e);L.loader.load(this._loadList,x.create(this,this._textureComplete))}}},{key:"_textureComplete",value:function(){for(var e,t=0,i=this._loadList.length;t<i;t++)e=this._loadList[t],this._textureDic[e]=L.Loader.getRes(e);this._parsePublicExtData()}},{key:"_parsePublicExtData",value:function(){for(var e=0,t=0,i=0,n=0,a=0,e=0,a=this.getAnimationCount();e<a;e++)this._graphicsCache.push([]);var D,s,r,O,F,V,U,o,h,z="Dragon"!=this._aniClassName,l=new mi(this.getPublicExtData()),u=0,Y=l.getInt32(),c=l.readUTFString(),G=c.split("\n");for(e=0;e<Y;e++){if(o=this._mainTexture,h=this._path+G[2*e],c=G[2*e+1],!(o=null==this._mainTexture?this._textureDic[h]:o))return this.event(Me.ERROR,this),void(this.isParseFail=!0);h=l.getFloat32(),D=l.getFloat32(),s=l.getFloat32(),r=l.getFloat32(),u=l.getFloat32(),O=isNaN(u)?0:u,u=l.getFloat32(),F=isNaN(u)?0:u,u=l.getFloat32(),V=isNaN(u)?s:u,u=l.getFloat32(),U=isNaN(u)?r:u,this.subTextureDic[c]=vt.create(o,h,D,s,r,-O,-F,V,U)}this._mainTexture=o;var _,f,d,p,X=l.getUint16();for(e=0;e<X;e++)(_=[]).push(l.getUint16()),_.push(l.getUint16()),_.push(l.getUint16()),_.push(l.getUint16()),this.aniSectionDic[e]=_;var y,g=l.getInt16(),W={};for(e=0;e<g;e++)f=new Eh,0==e?y=f:f.root=y,f.d=z?-1:1,d=l.readUTFString(),p=l.readUTFString(),f.length=l.getFloat32(),1==l.getByte()&&(f.inheritRotation=!1),1==l.getByte()&&(f.inheritScale=!1),f.name=d,p&&((p=W[p])?p.addChild(f):this.mRootBone=f),W[d]=f,this.mBoneArr.push(f);this.tMatrixDataLen=l.getUint16();var m,v,H=l.getUint16(),j=Math.floor(H/this.tMatrixDataLen),q=this.srcBoneMatrixArr;for(e=0;e<j;e++)(m=new Mh).scX=l.getFloat32(),m.skX=l.getFloat32(),m.skY=l.getFloat32(),m.scY=l.getFloat32(),m.x=l.getFloat32(),m.y=l.getFloat32(),8===this.tMatrixDataLen&&(m.skewX=l.getFloat32(),m.skewY=l.getFloat32()),q.push(m),(f=this.mBoneArr[e]).transform=m;var K,x,Q=l.getUint16();for(e=0;e<Q;e++){for(v=new Zh,K=l.getUint16(),t=0;t<K;t++)v.boneNames.push(l.readUTFString()),v.boneIndexs.push(l.getInt16());v.name=l.readUTFString(),v.targetBoneName=l.readUTFString(),v.targetBoneIndex=l.getInt16(),v.bendDirection=l.getFloat32(),v.mix=l.getFloat32(),v.isSpine=z,this.ikArr.push(v)}var Z,k,J=l.getUint16();for(e=0;e<J;e++){for(x=new Rh,Z=l.getUint16(),t=0;t<Z;t++)x.boneIndexs.push(l.getInt16());x.name=l.getUTFString(),x.targetIndex=l.getInt16(),x.rotateMix=l.getFloat32(),x.translateMix=l.getFloat32(),x.scaleMix=l.getFloat32(),x.shearMix=l.getFloat32(),x.offsetRotation=l.getFloat32(),x.offsetX=l.getFloat32(),x.offsetY=l.getFloat32(),x.offsetScaleX=l.getFloat32(),x.offsetScaleY=l.getFloat32(),x.offsetShearY=l.getFloat32(),this.tfArr.push(x)}var $,ee,te,ie,ne,ae,w,b,S,se,re=l.getUint16();for(e=0;e<re;e++){for((k=new Ah).name=l.readUTFString(),$=l.getUint16(),t=0;t<$;t++)k.bones.push(l.getInt16());k.target=l.readUTFString(),k.positionMode=l.readUTFString(),k.spacingMode=l.readUTFString(),k.rotateMode=l.readUTFString(),k.offsetRotation=l.getFloat32(),k.position=l.getFloat32(),k.spacing=l.getFloat32(),k.rotateMix=l.getFloat32(),k.translateMix=l.getFloat32(),this.pathArr.push(k)}var I,oe=l.getInt16();for(e=0;e<oe;e++){var he=l.getUint8(),le={};this.deformAniArr.push(le);for(var ue=0;ue<he;ue++)for((w=new Lh).skinName=l.getUTFString(),le[w.skinName]=w,ee=l.getInt16(),t=0;t<ee;t++)for(b=new Nh,w.deformSlotDataList.push(b),te=l.getInt16(),i=0;i<te;i++)for(S=new Ph,b.deformSlotDisplayList.push(S),S.slotIndex=l.getInt16(),S.attachment=l.getUTFString(),ie=l.getInt16(),n=0;n<ie;n++)for(1==l.getByte()?S.tweenKeyList.push(!0):S.tweenKeyList.push(!1),ne=l.getFloat32(),S.timeList.push(ne),S.vectices.push(se=[]),ae=l.getInt16(),a=0;a<ae;a++)se.push(l.getFloat32())}var ce,T,_e,C,fe=l.getInt16();for(e=0;e<fe;e++){for(ce=l.getInt16(),I=[],t=0;t<ce;t++){for((T=new Bh).time=l.getFloat32(),_e=l.getInt16(),i=0;i<_e;i++)T.drawOrder.push(l.getInt16());I.push(T)}this.drawOrderAniArr.push(I)}var de,M,pe=l.getInt16();for(e=0;e<pe;e++){for(de=l.getInt16(),C=[],t=0;t<de;t++)(M=new Dh).name=l.getUTFString(),this._isParseAudio&&(M.audioValue=l.getUTFString()),M.intValue=l.getInt32(),M.floatValue=l.getFloat32(),M.stringValue=l.getUTFString(),M.time=l.getFloat32(),C.push(M);this.eventAniArr.push(C)}var ye=l.getInt16();if(0<ye)for(this.attachmentNames=[],e=0;e<ye;e++)this.attachmentNames.push(l.getUTFString());var E,R,ge=l.getInt16();for(e=0;e<ge;e++)(E=new jh).name=l.readUTFString(),E.parent=l.readUTFString(),E.attachmentName=l.readUTFString(),E.srcDisplayIndex=E.displayIndex=l.getInt16(),(E.templet=this).boneSlotDic[E.name]=E,null==(R=this.bindBoneBoneSlotDic[E.parent])&&(this.bindBoneBoneSlotDic[E.parent]=R=[]),R.push(E),this.boneSlotArray.push(E);var A,L,N,me,ve,xe,ke,we,be,Se,P=l.readUTFString().split("\n"),B=0,Ie=l.getUint8();for(e=0;e<Ie;e++){for((A=new qh).name=P[B++],me=l.getUint8(),t=0;t<me;t++){for((L=new Qh).name=P[B++],E=this.boneSlotDic[L.name],ve=l.getUint8(),i=0;i<ve;i++){if(N=new Kh,this.skinSlotDisplayDataArr.push(N),N.name=P[B++],N.attachmentName=P[B++],N.transform=new Mh,N.transform.scX=l.getFloat32(),N.transform.skX=l.getFloat32(),N.transform.skY=l.getFloat32(),N.transform.scY=l.getFloat32(),N.transform.x=l.getFloat32(),N.transform.y=l.getFloat32(),L.displayArr.push(N),N.width=l.getFloat32(),N.height=l.getFloat32(),N.type=l.getUint8(),N.verLen=l.getUint16(),0<(g=l.getUint16()))for(N.bones=[],n=0;n<g;n++){var Te=l.getUint16();N.bones.push(Te)}if(0<(xe=l.getUint16()))for(N.uvs=[],n=0;n<xe;n++)N.uvs.push(l.getFloat32());if(0<(ke=l.getUint16()))for(N.weights=[],n=0;n<ke;n++)N.weights.push(l.getFloat32());if(0<(we=l.getUint16()))for(N.triangles=[],n=0;n<we;n++)N.triangles.push(l.getUint16());if(0<(be=l.getUint16()))for(N.vertices=[],n=0;n<be;n++)N.vertices.push(l.getFloat32());if(0<(Se=l.getUint16()))for(N.lengths=[],n=0;n<Se;n++)N.lengths.push(l.getFloat32())}A.slotArr.push(L)}this.skinDic[A.name]=A,this.skinDataArray.push(A)}1==l.getUint8()?(this.yReverseMatrix=new Ce(1,0,0,-1,0,0),y&&y.setTempMatrix(this.yReverseMatrix)):y&&y.setTempMatrix(new Ce),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event(Me.COMPLETE,this)}},{key:"getTexture",value:function(e){var t=this.subTextureDic[e];return null==(t=t||this.subTextureDic[e.substr(0,e.length-1)])?this._mainTexture:t}},{key:"showSkinByIndex",value:function(e,t){var i,n,a,s,r=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];if(t<0&&t>=this.skinDataArray.length)return!1;var o=this.skinDataArray[t];if(o){for(i=0,n=o.slotArr.length;i<n;i++)(s=o.slotArr[i])&&(a=e[s.name])&&(a.showSlotData(s,r),r&&"undefined"!=a.attachmentName&&"null"!=a.attachmentName?a.showDisplayByName(a.attachmentName):a.showDisplayByIndex(a.displayIndex));return!0}return!1}},{key:"getSkinIndexByName",value:function(e){for(var t=0,i=this.skinDataArray.length;t<i;t++)if(this.skinDataArray[t].name==e)return t;return-1}},{key:"getGrahicsDataWithCache",value:function(e,t){return this._graphicsCache[e]&&this._graphicsCache[e][t]?this._graphicsCache[e][t]:null}},{key:"_setCreateURL",value:function(e){this._skBufferUrl=this._relativeUrl=e,m(g(n.prototype),"_setCreateURL",this).call(this,e)}},{key:"setGrahicsDataWithCache",value:function(e,t,i){this._graphicsCache[e][t]=i}},{key:"deleteAniData",value:function(e){this._anis[e]&&((e=this._anis[e]).bone3DMap=null,e.nodes=null)}},{key:"destroy",value:function(){for(var e in this._isDestroyed=!0,this.subTextureDic)e&&this.subTextureDic[e].destroy();for(e in this._textureDic)e&&this._textureDic[e].destroy();for(var t=0,i=this.skinSlotDisplayDataArr.length;t<i;t++)this.skinSlotDisplayDataArr[t].destory();this.skinSlotDisplayDataArr.length=0,this._relativeUrl&&delete n.TEMPLET_DICTIONARY[this._relativeUrl],m(g(n.prototype),"destroy",this).call(this),L.loader.clearRes(this._skBufferUrl)}},{key:"getAniNameByIndex",value:function(e){e=this.getAnimation(e);return e?e.name:null}},{key:"rate",get:function(){return this._rate},set:function(e){this._rate=e}}]),n}(),$h=(Jh.LAYA_ANIMATION_160_VISION="LAYAANIMATION:1.6.0",Jh.LAYA_ANIMATION_VISION="LAYAANIMATION:1.7.0",na.Templet=Jh,function(){function e(){b(this,e)}return y(e,null,[{key:"init",value:function(){var e=M.regClass;e("ui",Ki),e("framework/view/ui/ButtonEffect.ts",rn),e("games/fishxy/scenes/fight/user/PropsCard.ts",Ch),e("games/fishxy/scenes/fight/user/UserSeatScript.ts",Th),e("Laya.Templet",Jh)}}]),e}()),el=($h.width=1280,$h.height=720,$h.scaleMode="fixedheight",$h.screenMode="horizontal",$h.alignV="middle",$h.alignH="center",$h.startScene="fishxy/fight/FightScene.scene",$h.sceneRoot="",$h.debug=!1,$h.stat=!1,$h.physicsDebug=!1,$h.exportSceneToJson=!0,$h.init(),function(){function e(){b(this,e)}return y(e,[{key:"setDefaultLoadingView",value:function(e){this.defaultLoadingScene=e}},{key:"setSceneEvent",value:function(e){this.event=e}},{key:"load",value:function(e,t,i,n){var a=this,s=(oa.closeAll(),this.event.offAll(),this.currentScene&&(this.currentScene.destroy(),this.currentScene.view.destroy()),new e);0==s.getResource().length?this.onAllCompleted(s,t,n):(this.loadingScene=new(i||this.defaultLoadingScene),this.loadSceneResource(this.loadingScene,null,new x(this,function(){a.loadingScene.createView(),a.loadingScene.view.size(o.stage.width,o.stage.height),a.loadingScene.init(),a.loadingScene.view.zOrder=100,a.loadingLayer.addChild(a.loadingScene.view),a.loadSceneResource(s,t,new x(a,a.onAllCompleted,[s,t,n]),new x(a.loadingScene,a.loadingScene.onProgress))})))}},{key:"loadSceneResource",value:function(e,t,i,n){var a,s=0,r=e.getResource().filter(function(e){return void 0===e.loadType||e.loadType==Qi.Sync}),o=x.create(this,function(){++s>=r.length?i instanceof x&&i.run():n instanceof x&&n.runWith(s/r.length)},null,!1),h=Y(r);try{for(h.s();!(a=h.n()).done;){var l=a.value;this.loadOneResource(l,o)}}catch(e){h.e(e)}finally{h.f()}}},{key:"onAllCompleted",value:function(e,t,i){e.createView(),this.sceneLayer.addChild(e.view),e.view.size(o.stage.width,o.stage.height),e.args=t,e.init(),i instanceof x&&i.run(),e.autoDestroyLoadingViewWhenLoadComplete()&&this.destroyLoadingScene();var n,a=Y((this.currentScene=e).getResource());try{for(a.s();!(n=a.n()).done;){var s=n.value;s.loadType==Qi.Async&&this.loadOneResource(s)}}catch(e){a.e(e)}finally{a.f()}}},{key:"loadOneResource",value:function(t,i){var n;t.url.endsWith(".fnt")?(n=new vi).loadFont(t.url,x.create(this,function(){var e=t.url.split("/"),e=e[e.length-1];ii.registerBitmapFont(e,n),i instanceof x&&i.run()})):o.loader.create(t.url,i)}},{key:"destroyLoadingScene",value:function(){this.loadingScene&&this.loadingScene.view&&(this.loadingScene.view.destroy(),this.loadingScene.destroy(),this.loadingScene=null)}},{key:"resetLayers",value:function(){this.currentScene&&(this.currentScene.view.destroy(),this.currentScene.destroy()),this.root||(this.root=new N,o.stage.addChild(this.root)),this.sceneLayer&&(this.sceneLayer.removeSelf(),this.sceneLayer.destroy(!0),this.sceneLayer=null),this.sceneLayer=new N,this.root.addChild(this.sceneLayer),this.loadingLayer&&(this.loadingLayer.removeSelf(),this.loadingLayer.destroy(!0),this.loadingLayer=null),this.loadingLayer=new N,this.loadingLayer.zOrder=9999,u.addChild(this.loadingLayer)}}],[{key:"I",get:function(){return this.instance||(this.instance=new e,this.instance.resetLayers()),this.instance}}]),e}()),tl=function(){f(t,hn);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"createView",value:function(){if(!this.view)return this.view=new(this.getViewCtor()),this.view.on(Me.CLICK,this,function(){}),this.view}}]),t}(),il=function(){f(i,tl);var t=T(i);function i(){var e;return b(this,i),(e=t.apply(this,arguments)).timer=new Oi,e}return y(i,[{key:"getViewCtor",value:function(){return Ki.fishxy.loading.LoadingSceneUI}},{key:"onProgress",value:function(e){this.setProgress(e)}},{key:"onComplete",value:function(){this.view.progress.width=660}},{key:"getResource",value:function(){return[new ha("fishxy/loading.atlas")]}},{key:"init",value:function(){this.view.progress.width=0,this.adjustUI(),_.event.on(Me.RESIZE,this,this.adjustUI,null,!1)}},{key:"adjustUI",value:function(){this.view.bg.size(u.width,u.height),this.view.size(u.width,u.height)}},{key:"setInfo",value:function(e){}},{key:"setProgress",value:function(e){this.view.progress.width=660*e}},{key:"destroy",value:function(){this.timer.clearAll(this),_.event.off(Me.RESIZE,this,this.adjustUI)}}]),i}(),nl=((e=bo=bo||{})[e.None=0]="None",e[e.Landscape=1]="Landscape",e[e.Portrait=2]="Portrait",function(){function i(){b(this,i),this._debug=!1,this._touchStatus=!1,this._portraitHeight=75,this._landscapeHeight=45,this._hasMove=!1,this._isGameOnly=!1,this._container=document.getElementById("layaContainer")}return y(i,[{key:"create",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];document.getElementById("maskDiv")||(this._isGameOnly=e,this._maskDiv=document.createElement("div"),I.onMobile&&(this._maskDiv.innerHTML='<br /><img src="html_res/full_screen_arrow.png" /><br />向上滑动可全屏游戏<br /><br />如果浏览器不支持滑动全屏<br />请点击屏幕直接进入',this._maskDiv.setAttribute("style","position:absolute; text-align:center; font-size:20px; color:#ffffff; left:0px; top:0px; background:rgba(0, 0, 0, 0.5);cursor: pointer;"),this._maskDiv.setAttribute("id","maskDiv"),document.body.appendChild(this._maskDiv),this.showMaskDiv(!1),this.onResizeHandle(),u.on(Me.RESIZE,this,this.onResizeHandle),document.addEventListener("scroll",this.onScroll,!1),document.addEventListener("gesturestart",function(e){e.preventDefault()}),window.addEventListener("resize",function(){i.instance.doResize(),i.instance.swipeFix()})),document.body.style.overflow="hidden")}},{key:"destroy",value:function(){this.removeTouchEvent()}},{key:"doResize",value:function(){window.scrollTo(0,0),this._container.style.height=window.innerHeight+"px",this._container.style.width=window.innerWidth+"px"}},{key:"addTouchEvent",value:function(){document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMoves,!1),document.addEventListener("touchend",this.onTouchEnd,!1),document.addEventListener("click",this.onClick,!1)}},{key:"removeTouchEvent",value:function(){document.removeEventListener("touchstart",this.onTouchStart,!1),document.removeEventListener("touchmove",this.onTouchMoves,!1),document.removeEventListener("touchend",this.onTouchEnd,!1),document.removeEventListener("click",this.onClick,!1)}},{key:"onTouchStart",value:function(e){i.instance._hasMove=!1,i.instance._touchStatus=!0,1<e.touches.length&&(e.stopPropagation(),e.preventDefault())}},{key:"onTouchMoves",value:function(e){i.instance._hasMove=!0,i.instance._touchStatus=!0,1<e.touches.length&&(e.stopPropagation(),e.preventDefault())}},{key:"onTouchEnd",value:function(){i.instance._touchStatus=!1}},{key:"onClick",value:function(){i.instance._hasMove||(i.instance.fullscreenEnabled(document)?i.instance.launchFullScreen(document.documentElement):i.instance.showMaskDiv(!1))}},{key:"onScroll",value:function(){var e=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;i.instance._container.style.top=e+"px",setTimeout(function(){i.instance.delayScroll()},50)}},{key:"delayScroll",value:function(){clearTimeout(i.DELAYSCROLLSETTIMEOUT),i.DELAYSCROLLSETTIMEOUT=setTimeout(function(){i.instance.scrollView()},150)}},{key:"scrollView",value:function(){var e=window.document,t=(window.scrollTo(0,0),setInterval(function(){e.body&&(clearInterval(t),setTimeout(function(){window.scrollTo(0,0),i.instance.swipeFix()},10))},15))}},{key:"onResizeHandle",value:function(){I.onMobile&&this.swipeFix()}},{key:"swipeFix",value:function(){this.isFullscreen?this.showMaskDiv(!1):this.showMaskDiv(!0)}},{key:"isFullscreen",get:function(){var e=this.screenMode()===bo.Portrait?this.screenHeight:this.screenWidth,t=this.screenMode()===bo.Portrait?this._portraitHeight:this._landscapeHeight;return window.innerHeight>e-t}},{key:"launchFullScreen",value:function(e){e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}},{key:"fullscreenEnabled",value:function(e){return e.fullscreenEnabled||e.mozFullScreenEnabled||e.webkitFullscreenEnabled||e.msFullscreenEnabled||!1}},{key:"screenHeight",get:function(){return window.screen.width>window.screen.height?window.screen.width:window.screen.height}},{key:"screenWidth",get:function(){return window.screen.width<window.screen.height?window.screen.width:window.screen.height}},{key:"clientHeight",get:function(){return document.documentElement.clientHeight||document.body.clientHeight}},{key:"clientWidth",get:function(){return document.documentElement.clientWidth||document.body.clientWidth}},{key:"getIsGameOnly",value:function(e){return e}},{key:"showMaskDiv",value:function(e){e=this.getIsGameOnly(e),this._maskDiv.style.visibility=e?"visible":"hidden",e?(this.addTouchEvent(),e=this.screenMode()===bo.Portrait?this.screenHeight:this.screenWidth,this._maskDiv.style.width=this.clientWidth+"px",this._maskDiv.style.height=e+1e3+"px"):this.removeTouchEvent()}},{key:"screenMode",value:function(){return this.clientWidth>=this.clientHeight?bo.Landscape:bo.Portrait}}],[{key:"instance",get:function(){return null==this._inst&&(this._inst=new i),this._inst}}]),i}()),al=function(){f(t,a);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t)}(),sl=function(){f(n,al);var i=T(n);function n(){b(this,n),(e=i.call(this)).bg=new N,e.bg.alpha=.5,e.bg.on(Me.CLICK,O(e),function(){}),e.bg.graphics.drawRect(0,0,9999,9999,"#000"),e.addChild(e.bg),e.box=new vn,e.box.size(193,193),e.addChild(e.box);var e,t=new h("fishxy/loading/loading_bg.png"),t=(t.centerX=t.centerY=0,e.box.addChild(t),e.close_btn=new h("fishxy/loading/btn_close.png"),e.addChild(e.close_btn),e.loading=new h("fishxy/loading/loading.png"),e.loading.anchorX=e.loading.anchorY=.5,e.box.addChild(e.loading),new h("fishxy/loading/loading_logo.png"));return t.centerX=t.centerY=0,e.box.addChild(t),e.label=new Sn,e.label.color="#fff",e.label.fontSize=25,e.label.width=1136,e.label.align="center",e.addChild(e.label),e.visible=!1,e.alpha=0,el.I.loadingLayer.addChild(O(e)),e.adjustUI(),_.event.onForever(Me.RESIZE,O(e),e.adjustUI),e}return y(n,[{key:"show",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",i=1<arguments.length?arguments[1]:void 0;this.visible||(this.label.text=t,this.visible=!0,Ci.to(this,{alpha:1},300),this.timer.frameLoop(1,this,function(){e.loading.rotation+=3.75/(1e3/60)*e.timer.delta}),this.close_btn.visible=i instanceof x,this.close_btn.offAllCaller(this),i instanceof x&&this.close_btn.on(Me.CLICK,this,function(){i.run()}))}},{key:"hide",value:function(){this.visible&&(this.visible=!1,Ci.to(this,{alpha:0},300),this.timer.clearAll(this))}},{key:"adjustUI",value:function(){this.close_btn.centerX=80,this.close_btn.centerY=-110,this.loading.centerX=this.loading.centerY=0,this.label.centerX=0,this.label.centerY=58,this.box.centerX=0,this.box.centerY=-53,this.size(u.width,u.height)}}]),n}(),rl=function(){f(i,al);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).loadingIndex=1,e.bg=new N,e.bg.alpha=.5,e.bg.on(Me.CLICK,O(e),function(){}),e.bg.graphics.drawRect(0,0,9999,9999,"#000"),e.addChild(e.bg),e.close_btn=new h("fishxy/loading/btn_close.png"),e.addChild(e.close_btn),e.loading=new h("fishxy/loading/bb_loading_1.png"),e.loading.anchorX=e.loading.anchorY=.5,e.loading.centerX=0,e.loading.centerY=-30,e.addChild(e.loading),e.label=new Sn,e.label.color="#fff",e.label.fontSize=25,e.label.width=1136,e.label.align="center",e.addChild(e.label),e.visible=!1,e.alpha=0,el.I.loadingLayer.addChild(O(e)),e.adjustUI(),_.event.onForever(Me.RESIZE,O(e),e.adjustUI),e}return y(i,[{key:"show",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",i=1<arguments.length?arguments[1]:void 0;this.visible||(this.label.text=t,this.visible=!0,Ci.to(this,{alpha:1},300),this.timer.loop(200,this,function(){e.loadingIndex++,3<e.loadingIndex&&(e.loadingIndex=1),e.loading.skin="fishxy/loading/bb_loading_"+e.loadingIndex+".png"}),this.close_btn.visible=i instanceof x,this.close_btn.offAllCaller(this),i instanceof x&&this.close_btn.on(Me.CLICK,this,function(){i.run()}))}},{key:"hide",value:function(){this.visible&&(this.visible=!1,Ci.to(this,{alpha:0},300),this.timer.clearAll(this))}},{key:"adjustUI",value:function(){this.loading.centerX=0,this.loading.centerY=-30,this.label.centerX=0,this.label.centerY=58,this.close_btn.centerX=80,this.close_btn.centerY=-100,this.size(u.width,u.height)}}]),i}(),ol=function(){f(i,al);var t=T(i);function i(){var e;return b(this,i),(e=t.call(this)).loadingIndex=1,e.bg=new N,e.bg.alpha=.5,e.bg.on(Me.CLICK,O(e),function(){}),e.bg.graphics.drawRect(0,0,9999,9999,"#000"),e.addChild(e.bg),e.close_btn=new h("fishxy/loading/btn_close.png"),e.addChild(e.close_btn),e.loading=new h("fishxy/loading/lg_loading_1.png"),e.loading.anchorX=e.loading.anchorY=.5,e.loading.centerX=0,e.loading.centerY=-30,e.addChild(e.loading),e.label=new Sn,e.label.color="#fff",e.label.fontSize=25,e.label.width=1136,e.label.align="center",e.addChild(e.label),e.visible=!1,e.alpha=0,el.I.loadingLayer.addChild(O(e)),e.adjustUI(),_.event.onForever(Me.RESIZE,O(e),e.adjustUI),e}return y(i,[{key:"show",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",i=1<arguments.length?arguments[1]:void 0;this.visible||(this.label.text=t,this.visible=!0,Ci.to(this,{alpha:1},300),this.timer.loop(200,this,function(){e.loadingIndex++,3<e.loadingIndex&&(e.loadingIndex=1),e.loading.skin="fishxy/loading/lg_loading_"+e.loadingIndex+".png"}),this.close_btn.visible=i instanceof x,this.close_btn.offAllCaller(this),i instanceof x&&this.close_btn.on(Me.CLICK,this,function(){i.run()}))}},{key:"hide",value:function(){this.visible&&(this.visible=!1,Ci.to(this,{alpha:0},300),this.timer.clearAll(this))}},{key:"adjustUI",value:function(){this.loading.centerX=0,this.loading.centerY=-30,this.label.centerX=0,this.label.centerY=58,this.close_btn.centerX=80,this.close_btn.centerY=-100,this.size(u.width,u.height)}}]),i}(),hl=function(){f(t,ln);var e=T(t);function t(){return b(this,t),e.apply(this,arguments)}return y(t,[{key:"init",value:function(){_.event.once(_.EventType.LoginComplete,this,this.onLoginComplete),_.data.account?this.onLoginComplete():(Jo.I.loginLobby(),_.event.on(Yo.SocketClose,this,this.onSocketClose))}},{key:"onLoginComplete",value:function(){_.data.rooms&&this.onSelectRoom(0)}},{key:"onSelectRoom",value:function(e){var e=_.data.rooms[e],t=new rh;t.room=e,el.I.load(d,t)}},{key:"onSocketClose",value:function(e){e==Ho.name&&this.view.timer.once(2e3,this,function(){Jo.I.loginLobby()})}},{key:"getViewCtor",value:function(){return Ki.fishxy.lobby.LobbySceneUI}},{key:"getResource",value:function(){return[]}},{key:"destroy",value:function(){}}]),t}();new(function(){function e(){b(this,e),o.init($h.width,$h.height,Et),o.DebugPanel&&o.DebugPanel.enable(),o.stage.scaleMode=$h.scaleMode,o.stage.screenMode=$h.screenMode,o.stage.alignV=$h.alignV,o.stage.alignH=$h.alignH,o.stage.useRetinalCanvas=!0,Ro.init(),o.URL.customFormat=function(e){return I.window.manifest&&I.window.manifest[e]||e},this.adjustUI(),I.window.addEventListener("resize",this.adjustUI.bind(this)),I.window.addEventListener("orientationchange",this.adjustUI.bind(this)),o.stage.on(Me.FOCUS,this,function(){_.isFocus=!0}),o.stage.on(Me.BLUR,this,function(){_.isFocus=!1}),_.DEBUG=I.window.DEBUG,_.DEBUG&&k.show(),ki.enable("fileconfig.json",x.create(this,this.onConfigLoaded))}return y(e,[{key:"onConfigLoaded",value:function(){var e;el.I.setSceneEvent(_.event),el.I.setDefaultLoadingView(il),I.window.isInIframe?(_.data.account=this.getAccountFromEgret(),"bb"==_.data.account.platform||"bb_test"==_.data.account.platform?_.defaultLoadingView=new rl:"lg"==_.data.account.platform||"lg_test"==_.data.account.platform?_.defaultLoadingView=new ol:_.defaultLoadingView=new sl,(e=new rh).room=this.getRoomFromEgret(),el.I.load(d,e)):(_.defaultLoadingView=new sl,nl.instance.create(),el.I.load(hl))}},{key:"getAccountFromEgret",value:function(){return new Ko(I.window.user)}},{key:"getRoomFromEgret",value:function(){var e=new Ho.RoomInfo;return e.websocket=I.window.user.websocket,e.fixed_seat=I.window.user.isFixSeat,e.dbname=I.window.user.dbname,e.min_money=I.window.user.minmoney,e.room_id=I.window.user.roomid,e}},{key:"adjustUI",value:function(){I.clientWidth/I.clientHeight>$h.width/$h.height?u.scaleMode="fixedheight":o.stage.scaleMode="fixedwidth",o.timer.once(1,this,function(){_.event.event(Me.RESIZE)})}}]),e}())}();
